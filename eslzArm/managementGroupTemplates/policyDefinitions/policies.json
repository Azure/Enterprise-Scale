{
  "$schema": "https://schema.management.azure.com/schemas/2019-08-01/managementGroupDeploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "metadata": {
    "_generator": {
      "name": "bicep",
      "version": "0.27.1.19265",
      "templateHash": "11067820150465502281"
    }
  },
  "parameters": {
    "topLevelManagementGroupPrefix": {
      "type": "string",
      "defaultValue": "alz",
      "metadata": {
        "message": "The JSON version of this file is programatically generated from Bicep. PLEASE DO NOT UPDATE MANUALLY!!",
        "description": "Provide a prefix (max 10 characters, unique at tenant-scope) for the Management Group hierarchy and other resources created as part of an Azure landing zone. DEFAULT VALUE = \"alz\""
      },
      "maxLength": 10
    },
    "location": {
      "type": "string",
      "defaultValue": "[deployment().location]",
      "metadata": {
        "description": "Optionally set the deployment location for policies with Deploy If Not Exists effect. DEFAULT VALUE = \"deployment().location\""
      }
    },
    "scope": {
      "type": "string",
      "defaultValue": "[tenantResourceId('Microsoft.Management/managementGroups', parameters('topLevelManagementGroupPrefix'))]",
      "metadata": {
        "description": "Optionally set the scope for custom Policy Definitions used in Policy Set Definitions (Initiatives). Must be one of '/', '/subscriptions/id' or '/providers/Microsoft.Management/managementGroups/id'. DEFAULT VALUE = '/providers/Microsoft.Management/managementGroups/${topLevelManagementGroupPrefix}'"
      }
    }
  },
  "variables": {
    "copy": [
      {
        "name": "processPolicyDefinitionsAll",
        "count": "[length(variables('loadPolicyDefinitions').All)]",
        "input": "[replace(replace(variables('loadPolicyDefinitions').All[copyIndex('processPolicyDefinitionsAll')], variables('templateVars').defaultDeploymentLocation, variables('deploymentLocation')), variables('templateVars').localizedDeploymentLocation, variables('deploymentLocation'))]"
      },
      {
        "name": "processPolicyDefinitionsAzureCloud",
        "count": "[length(variables('loadPolicyDefinitions').AzureCloud)]",
        "input": "[replace(replace(variables('loadPolicyDefinitions').AzureCloud[copyIndex('processPolicyDefinitionsAzureCloud')], variables('templateVars').defaultDeploymentLocation, variables('deploymentLocation')), variables('templateVars').localizedDeploymentLocation, variables('deploymentLocation'))]"
      },
      {
        "name": "processPolicyDefinitionsAzureChinaCloud",
        "count": "[length(variables('loadPolicyDefinitions').AzureChinaCloud)]",
        "input": "[replace(replace(variables('loadPolicyDefinitions').AzureChinaCloud[copyIndex('processPolicyDefinitionsAzureChinaCloud')], variables('templateVars').defaultDeploymentLocation, variables('deploymentLocation')), variables('templateVars').localizedDeploymentLocation, variables('deploymentLocation'))]"
      },
      {
        "name": "processPolicyDefinitionsAzureUSGovernment",
        "count": "[length(variables('loadPolicyDefinitions').AzureUSGovernment)]",
        "input": "[replace(replace(variables('loadPolicyDefinitions').AzureUSGovernment[copyIndex('processPolicyDefinitionsAzureUSGovernment')], variables('templateVars').defaultDeploymentLocation, variables('deploymentLocation')), variables('templateVars').localizedDeploymentLocation, variables('deploymentLocation'))]"
      },
      {
        "name": "policyDefinitionsAll",
        "count": "[length(variables('processPolicyDefinitionsAll'))]",
        "input": "[json(variables('processPolicyDefinitionsAll')[copyIndex('policyDefinitionsAll')])]"
      },
      {
        "name": "policyDefinitionsAzureCloud",
        "count": "[length(variables('processPolicyDefinitionsAzureCloud'))]",
        "input": "[json(variables('processPolicyDefinitionsAzureCloud')[copyIndex('policyDefinitionsAzureCloud')])]"
      },
      {
        "name": "policyDefinitionsAzureChinaCloud",
        "count": "[length(variables('processPolicyDefinitionsAzureChinaCloud'))]",
        "input": "[json(variables('processPolicyDefinitionsAzureChinaCloud')[copyIndex('policyDefinitionsAzureChinaCloud')])]"
      },
      {
        "name": "policyDefinitionsAzureUSGovernment",
        "count": "[length(variables('processPolicyDefinitionsAzureUSGovernment'))]",
        "input": "[json(variables('processPolicyDefinitionsAzureUSGovernment')[copyIndex('policyDefinitionsAzureUSGovernment')])]"
      }
    ],
    "$fxv#0": "{\n  \"name\": \"Append-AppService-httpsonly\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"AppService append enable https only setting to enforce https setting.\",\n    \"description\": \"Appends the AppService sites object to ensure that  HTTPS only is enabled for  server/service authentication and protects data in transit from network layer eavesdropping attacks. Please note Append does not enforce compliance use then deny.\",\n    \"metadata\": {\n      \"version\": \"1.0.0\",\n      \"category\": \"App Service\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"Append\",\n        \"allowedValues\": [\n          \"Append\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Web/sites\"\n          },\n          {\n            \"field\": \"Microsoft.Web/sites/httpsOnly\",\n            \"notequals\": true\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": [\n          {\n            \"field\": \"Microsoft.Web/sites/httpsOnly\",\n            \"value\": true\n          }\n        ]\n      }\n    }\n  }\n}\n",
    "$fxv#1": "{\n  \"name\": \"Append-AppService-latestTLS\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"AppService append sites with minimum TLS version to enforce.\",\n    \"description\": \"Append the AppService sites object to ensure that min Tls version is set to required minimum TLS version. Please note Append does not enforce compliance use then deny.\",\n    \"metadata\": {\n      \"version\": \"1.1.0\",\n      \"category\": \"App Service\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"Append\",\n        \"allowedValues\": [\n          \"Append\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"minTlsVersion\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"1.2\",\n        \"allowedValues\": [\n          \"1.2\",\n          \"1.0\",\n          \"1.1\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Select version minimum TLS Web App config\",\n          \"description\": \"Select version  minimum TLS version for a  Web App config to enforce\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"Microsoft.Web/sites/config/minTlsVersion\",\n            \"exists\": \"true\"\n          },\n          {\n            \"field\": \"Microsoft.Web/sites/config/minTlsVersion\",\n            \"notEquals\": \"[[parameters('minTlsVersion')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": [\n          {\n            \"field\": \"Microsoft.Web/sites/config/minTlsVersion\",\n            \"value\": \"[[parameters('minTlsVersion')]\"\n          }\n        ]\n      }\n    }\n  }\n}\n",
    "$fxv#10": "{\n  \"name\": \"Deny-AppServiceApiApp-http\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"API App should only be accessible over HTTPS\",\n    \"description\": \"Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.\",\n    \"metadata\": {\n      \"version\": \"1.0.0\",\n      \"category\": \"App Service\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"Deny\",\n        \"allowedValues\": [\n          \"Audit\",\n          \"Disabled\",\n          \"Deny\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Web/sites\"\n          },\n          {\n            \"field\": \"kind\",\n            \"like\": \"*api\"\n          },\n          {\n            \"field\": \"Microsoft.Web/sites/httpsOnly\",\n            \"equals\": \"false\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\"\n      }\n    }\n  }\n}\n",
    "$fxv#100": "{\n  \"name\": \"Deploy-Sql-vulnerabilityAssessments\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated]: Deploy SQL Database vulnerability Assessments\",\n    \"description\": \"Deploy SQL Database vulnerability Assessments when it not exist in the deployment. Superseded by https://www.azadvertizer.net/azpolicyadvertizer/Deploy-Sql-vulnerabilityAssessments_20230706.html\",\n    \"metadata\": {\n      \"version\": \"1.0.1-deprecated\",\n      \"category\": \"SQL\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"deprecated\": true,\n      \"supersededBy\": \"Deploy-Sql-vulnerabilityAssessments_20230706\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"vulnerabilityAssessmentsEmail\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"description\": \"The email address to send alerts. For multiple emails, format in the following 'email1@contoso.com;email2@contoso.com'\",\n          \"displayName\": \"The email address to send alerts. For multiple emails, format in the following 'email1@contoso.com;email2@contoso.com'\"\n        }\n      },\n      \"vulnerabilityAssessmentsStorageID\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"description\": \"The storage account ID to store assessments\",\n          \"displayName\": \"The storage account ID to store assessments\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.Sql/servers/databases\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Sql/servers/databases/vulnerabilityAssessments\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Sql/servers/databases/vulnerabilityAssessments/recurringScans.emails\",\n                \"equals\": \"[[parameters('vulnerabilityAssessmentsEmail')]\"\n              },\n              {\n                \"field\": \"Microsoft.Sql/servers/databases/vulnerabilityAssessments/recurringScans.isEnabled\",\n                \"equals\": true\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"sqlServerName\": {\n                    \"type\": \"String\"\n                  },\n                  \"sqlServerDataBaseName\": {\n                    \"type\": \"String\"\n                  },\n                  \"vulnerabilityAssessmentsEmail\": {\n                    \"type\": \"String\"\n                  },\n                  \"vulnerabilityAssessmentsStorageID\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"name\": \"[[concat(parameters('sqlServerName'),'/',parameters('sqlServerDataBaseName'),'/default')]\",\n                    \"type\": \"Microsoft.Sql/servers/databases/vulnerabilityAssessments\",\n                    \"apiVersion\": \"2017-03-01-preview\",\n                    \"properties\": {\n                      \"storageContainerPath\": \"[[concat('https://', last( split(parameters('vulnerabilityAssessmentsStorageID') ,  '/') ) , '.blob.core.windows.net/vulneraabilitylogs')]\",\n                      \"storageAccountAccessKey\": \"[[listkeys(parameters('vulnerabilityAssessmentsStorageID'), providers('Microsoft.Storage', 'storageAccounts').apiVersions[0]).keys[0].value]\",\n                      \"recurringScans\": {\n                        \"isEnabled\": true,\n                        \"emailSubscriptionAdmins\": false,\n                        \"emails\": [\n                          \"[[parameters('vulnerabilityAssessmentsEmail')]\"\n                        ]\n                      }\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"sqlServerName\": {\n                  \"value\": \"[[first(split(field('fullname'),'/'))]\"\n                },\n                \"sqlServerDataBaseName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"vulnerabilityAssessmentsEmail\": {\n                  \"value\": \"[[parameters('vulnerabilityAssessmentsEmail')]\"\n                },\n                \"vulnerabilityAssessmentsStorageID\": {\n                  \"value\": \"[[parameters('vulnerabilityAssessmentsStorageID')]\"\n                }\n              }\n            }\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3\",\n            \"/providers/Microsoft.Authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/Microsoft.Authorization/roleDefinitions/17d1049b-9a84-46fb-8f53-869881c3d3ab\"\n          ]\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#101": "{\n  \"name\": \"Deploy-Sql-vulnerabilityAssessments_20230706\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"Deploy SQL Database Vulnerability Assessments\",\n    \"description\": \"Deploy SQL Database Vulnerability Assessments when it does not exist in the deployment, and save results to the storage account specified in the parameters.\",\n    \"metadata\": {\n      \"version\": \"1.0.0\",\n      \"category\": \"SQL\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"replacesPolicy\": \"Deploy-Sql-vulnerabilityAssessments\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"vulnerabilityAssessmentsEmail\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"description\": \"The email address(es) to send alerts.\",\n          \"displayName\": \"The email address(es) to send alerts.\"\n        }\n      },\n      \"vulnerabilityAssessmentsStorageID\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"description\": \"The storage account ID to store assessments\",\n          \"displayName\": \"The storage account ID to store assessments\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.Sql/servers/databases\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Sql/servers/databases/vulnerabilityAssessments\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"count\": {\n                  \"field\": \"Microsoft.Sql/servers/databases/vulnerabilityAssessments/recurringScans.emails[*]\",\n                  \"where\": {\n                    \"value\": \"current(Microsoft.Sql/servers/databases/vulnerabilityAssessments/recurringScans.emails[*])\",\n                    \"notIn\": \"[[parameters('vulnerabilityAssessmentsEmail')]\"\n                  }\n                },\n                \"greater\": 0\n              },\n              {\n                \"field\": \"Microsoft.Sql/servers/databases/vulnerabilityAssessments/recurringScans.isEnabled\",\n                \"equals\": true\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"sqlServerName\": {\n                    \"type\": \"String\"\n                  },\n                  \"sqlServerDataBaseName\": {\n                    \"type\": \"String\"\n                  },\n                  \"vulnerabilityAssessmentsEmail\": {\n                    \"type\": \"Array\"\n                  },\n                  \"vulnerabilityAssessmentsStorageID\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"name\": \"[[concat(parameters('sqlServerName'),'/',parameters('sqlServerDataBaseName'),'/default')]\",\n                    \"type\": \"Microsoft.Sql/servers/databases/vulnerabilityAssessments\",\n                    \"apiVersion\": \"2017-03-01-preview\",\n                    \"properties\": {\n                      \"storageContainerPath\": \"[[concat('https://', last( split(parameters('vulnerabilityAssessmentsStorageID') ,  '/') ) , '.blob.core.windows.net/vulneraabilitylogs')]\",\n                      \"storageAccountAccessKey\": \"[[listkeys(parameters('vulnerabilityAssessmentsStorageID'), providers('Microsoft.Storage', 'storageAccounts').apiVersions[0]).keys[0].value]\",\n                      \"recurringScans\": {\n                        \"isEnabled\": true,\n                        \"emailSubscriptionAdmins\": false,\n                        \"emails\": \"[[parameters('vulnerabilityAssessmentsEmail')]\"\n                      }\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"sqlServerName\": {\n                  \"value\": \"[[first(split(field('fullname'),'/'))]\"\n                },\n                \"sqlServerDataBaseName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"vulnerabilityAssessmentsEmail\": {\n                  \"value\": \"[[parameters('vulnerabilityAssessmentsEmail')]\"\n                },\n                \"vulnerabilityAssessmentsStorageID\": {\n                  \"value\": \"[[parameters('vulnerabilityAssessmentsStorageID')]\"\n                }\n              }\n            }\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3\",\n            \"/providers/Microsoft.Authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/Microsoft.Authorization/roleDefinitions/17d1049b-9a84-46fb-8f53-869881c3d3ab\"\n          ]\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#102": "{\n  \"name\": \"Deploy-SqlMi-minTLS\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"SQL managed instances deploy a specific min TLS version requirement.\",\n    \"description\": \"Deploy a specific min TLS version requirement and enforce SSL on SQL managed instances. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.\",\n    \"metadata\": {\n      \"version\": \"1.2.0\",\n      \"category\": \"SQL\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect SQL servers\",\n          \"description\": \"Enable or disable the execution of the policy minimum TLS version SQL servers\"\n        }\n      },\n      \"minimalTlsVersion\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"1.2\",\n        \"allowedValues\": [\n          \"1.2\",\n          \"1.1\",\n          \"1.0\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Select version for SQL server\",\n          \"description\": \"Select version minimum TLS version SQL servers to enforce\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Sql/managedInstances\"\n          },\n          {\n            \"field\": \"Microsoft.Sql/managedInstances/minimalTlsVersion\",\n            \"notequals\": \"[[parameters('minimalTlsVersion')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Sql/managedInstances\",\n          \"evaluationDelay\": \"AfterProvisioningSuccess\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Sql/managedInstances/minimalTlsVersion\",\n                \"equals\": \"[[parameters('minimalTlsVersion')]\"\n              }\n            ]\n          },\n          \"name\": \"current\",\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/4939a1f6-9ae0-4e48-a1e0-f2cbe897382d\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"minimalTlsVersion\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Sql/managedInstances\",\n                    \"apiVersion\": \"2020-02-02-preview\",\n                    \"name\": \"[[concat(parameters('resourceName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"properties\": {\n                      \"minimalTlsVersion\": \"[[parameters('minimalTlsVersion')]\"\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"minimalTlsVersion\": {\n                  \"value\": \"[[parameters('minimalTlsVersion')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#103": "{\n  \"name\": \"Deploy-Storage-sslEnforcement\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"Azure Storage deploy a specific min TLS version requirement and enforce SSL/HTTPS \",\n    \"description\": \"Deploy a specific min TLS version requirement and enforce SSL on Azure Storage. Enables secure server to client by enforce minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your Azure Storage.\",\n    \"metadata\": {\n      \"version\": \"1.2.0\",\n      \"category\": \"Storage\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect Azure Storage\",\n          \"description\": \"Enable or disable the execution of the policy minimum TLS version Azure STorage\"\n        }\n      },\n      \"minimumTlsVersion\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"TLS1_2\",\n        \"allowedValues\": [\n          \"TLS1_2\",\n          \"TLS1_1\",\n          \"TLS1_0\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Select TLS version for Azure Storage server\",\n          \"description\": \"Select version minimum TLS version Azure STorage to enforce\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Storage/storageAccounts\"\n          },\n          {\n            \"anyOf\": [\n              {\n                \"field\": \"Microsoft.Storage/storageAccounts/supportsHttpsTrafficOnly\",\n                \"notEquals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Storage/storageAccounts/minimumTlsVersion\",\n                \"notEquals\": \"[[parameters('minimumTlsVersion')]\"\n              }\n            ]\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Storage/storageAccounts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Storage/storageAccounts/supportsHttpsTrafficOnly\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Storage/storageAccounts/minimumTlsVersion\",\n                \"equals\": \"[[parameters('minimumTlsVersion')]\"\n              }\n            ]\n          },\n          \"name\": \"current\",\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/17d1049b-9a84-46fb-8f53-869881c3d3ab\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"minimumTlsVersion\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Storage/storageAccounts\",\n                    \"apiVersion\": \"2019-06-01\",\n                    \"name\": \"[[concat(parameters('resourceName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"properties\": {\n                      \"supportsHttpsTrafficOnly\": true,\n                      \"minimumTlsVersion\": \"[[parameters('minimumTlsVersion')]\"\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"minimumTlsVersion\": {\n                  \"value\": \"[[parameters('minimumTlsVersion')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#104": "{\n  \"name\": \"Deploy-VNET-HubSpoke\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Virtual Network with peering to the hub\",\n    \"description\": \"This policy deploys virtual network and peer to the hub\",\n    \"metadata\": {\n      \"version\": \"1.1.0\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"vNetName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"vNetName\",\n          \"description\": \"Name of the landing zone vNet\"\n        }\n      },\n      \"vNetRgName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"vNetRgName\",\n          \"description\": \"Name of the landing zone vNet RG\"\n        }\n      },\n      \"vNetLocation\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"vNetLocation\",\n          \"description\": \"Location for the vNet\"\n        }\n      },\n      \"vNetCidrRange\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"vNetCidrRange\",\n          \"description\": \"CIDR Range for the vNet\"\n        }\n      },\n      \"hubResourceId\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"hubResourceId\",\n          \"description\": \"Resource ID for the HUB vNet\"\n        }\n      },\n      \"dnsServers\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"DNSServers\",\n          \"description\": \"Default domain servers for the vNET.\"\n        },\n        \"defaultValue\": []\n      },\n      \"vNetPeerUseRemoteGateway\": {\n        \"type\": \"Boolean\",\n        \"metadata\": {\n          \"displayName\": \"vNetPeerUseRemoteGateway\",\n          \"description\": \"Enable gateway transit for the LZ network\"\n        },\n        \"defaultValue\": false\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Resources/subscriptions\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"deployIfNotExists\",\n        \"details\": {\n          \"type\": \"Microsoft.Network/virtualNetworks\",\n          \"name\": \"[[parameters('vNetName')]\",\n          \"deploymentScope\": \"subscription\",\n          \"existenceScope\": \"resourceGroup\",\n          \"ResourceGroupName\": \"[[parameters('vNetRgName')]\",\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"name\",\n                \"like\": \"[[parameters('vNetName')]\"\n              },\n              {\n                \"field\": \"location\",\n                \"equals\": \"[[parameters('vNetLocation')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"location\": \"northeurope\",\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"parameters\": {\n                \"vNetRgName\": {\n                  \"value\": \"[[parameters('vNetRgName')]\"\n                },\n                \"vNetName\": {\n                  \"value\": \"[[parameters('vNetName')]\"\n                },\n                \"vNetLocation\": {\n                  \"value\": \"[[parameters('vNetLocation')]\"\n                },\n                \"vNetCidrRange\": {\n                  \"value\": \"[[parameters('vNetCidrRange')]\"\n                },\n                \"hubResourceId\": {\n                  \"value\": \"[[parameters('hubResourceId')]\"\n                },\n                \"dnsServers\": {\n                  \"value\": \"[[parameters('dnsServers')]\"\n                },\n                \"vNetPeerUseRemoteGateway\": {\n                  \"value\": \"[[parameters('vNetPeerUseRemoteGateway')]\"\n                }\n              },\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"vNetRgName\": {\n                    \"type\": \"String\"\n                  },\n                  \"vNetName\": {\n                    \"type\": \"String\"\n                  },\n                  \"vNetLocation\": {\n                    \"type\": \"String\"\n                  },\n                  \"vNetCidrRange\": {\n                    \"type\": \"String\"\n                  },\n                  \"vNetPeerUseRemoteGateway\": {\n                    \"type\": \"bool\",\n                    \"defaultValue\": false\n                  },\n                  \"hubResourceId\": {\n                    \"type\": \"String\"\n                  },\n                  \"dnsServers\": {\n                    \"type\": \"Array\",\n                    \"defaultValue\": []\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Resources/deployments\",\n                    \"apiVersion\": \"2021-04-01\",\n                    \"name\": \"[[concat('alz-vnet-rg-', parameters('vNetLocation'), '-', substring(uniqueString(subscription().id),0,6))]\",\n                    \"location\": \"[[parameters('vNetLocation')]\",\n                    \"dependsOn\": [],\n                    \"properties\": {\n                      \"mode\": \"Incremental\",\n                      \"template\": {\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                        \"contentVersion\": \"1.0.0.0\",\n                        \"parameters\": {},\n                        \"variables\": {},\n                        \"resources\": [\n                          {\n                            \"type\": \"Microsoft.Resources/resourceGroups\",\n                            \"apiVersion\": \"2021-04-01\",\n                            \"name\": \"[[parameters('vNetRgName')]\",\n                            \"location\": \"[[parameters('vNetLocation')]\",\n                            \"properties\": {}\n                          }\n                        ],\n                        \"outputs\": {}\n                      }\n                    }\n                  },\n                  {\n                    \"type\": \"Microsoft.Resources/deployments\",\n                    \"apiVersion\": \"2021-04-01\",\n                    \"name\": \"[[concat('alz-vnet-', parameters('vNetLocation'), '-', substring(uniqueString(subscription().id),0,6))]\",\n                    \"dependsOn\": [\n                      \"[[concat('alz-vnet-rg-', parameters('vNetLocation'), '-', substring(uniqueString(subscription().id),0,6))]\"\n                    ],\n                    \"properties\": {\n                      \"mode\": \"Incremental\",\n                      \"template\": {\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                        \"contentVersion\": \"1.0.0.0\",\n                        \"parameters\": {},\n                        \"variables\": {},\n                        \"resources\": [\n                          {\n                            \"type\": \"Microsoft.Network/virtualNetworks\",\n                            \"apiVersion\": \"2021-02-01\",\n                            \"name\": \"[[parameters('vNetName')]\",\n                            \"location\": \"[[parameters('vNetLocation')]\",\n                            \"dependsOn\": [],\n                            \"properties\": {\n                              \"addressSpace\": {\n                                \"addressPrefixes\": [\n                                  \"[[parameters('vNetCidrRange')]\"\n                                ]\n                              },\n                              \"dhcpOptions\": {\n                                \"dnsServers\": \"[[parameters('dnsServers')]\"\n                              }\n                            }\n                          },\n                          {\n                            \"type\": \"Microsoft.Network/virtualNetworks/virtualNetworkPeerings\",\n                            \"apiVersion\": \"2021-02-01\",\n                            \"name\": \"[[concat(parameters('vNetName'), '/peerToHub')]\",\n                            \"dependsOn\": [\n                              \"[[parameters('vNetName')]\"\n                            ],\n                            \"properties\": {\n                              \"remoteVirtualNetwork\": {\n                                \"id\": \"[[parameters('hubResourceId')]\"\n                              },\n                              \"allowVirtualNetworkAccess\": true,\n                              \"allowForwardedTraffic\": true,\n                              \"allowGatewayTransit\": false,\n                              \"useRemoteGateways\": \"[[parameters('vNetPeerUseRemoteGateway')]\"\n                            }\n                          },\n                          {\n                            \"type\": \"Microsoft.Resources/deployments\",\n                            \"apiVersion\": \"2021-04-01\",\n                            \"name\": \"[[concat('alz-hub-peering-', parameters('vNetLocation'), '-', substring(uniqueString(subscription().id),0,6))]\",\n                            \"subscriptionId\": \"[[split(parameters('hubResourceId'),'/')[2]]\",\n                            \"resourceGroup\": \"[[split(parameters('hubResourceId'),'/')[4]]\",\n                            \"dependsOn\": [\n                              \"[[parameters('vNetName')]\"\n                            ],\n                            \"properties\": {\n                              \"mode\": \"Incremental\",\n                              \"expressionEvaluationOptions\": {\n                                \"scope\": \"inner\"\n                              },\n                              \"template\": {\n                                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                                \"contentVersion\": \"1.0.0.0\",\n                                \"parameters\": {\n                                  \"remoteVirtualNetwork\": {\n                                    \"type\": \"String\",\n                                    \"defaultValue\": false\n                                  },\n                                  \"hubName\": {\n                                    \"type\": \"String\",\n                                    \"defaultValue\": false\n                                  }\n                                },\n                                \"variables\": {},\n                                \"resources\": [\n                                  {\n                                    \"type\": \"Microsoft.Network/virtualNetworks/virtualNetworkPeerings\",\n                                    \"name\": \"[[[concat(parameters('hubName'),'/',last(split(parameters('remoteVirtualNetwork'),'/')))]\",\n                                    \"apiVersion\": \"2021-02-01\",\n                                    \"properties\": {\n                                      \"allowVirtualNetworkAccess\": true,\n                                      \"allowForwardedTraffic\": true,\n                                      \"allowGatewayTransit\": true,\n                                      \"useRemoteGateways\": false,\n                                      \"remoteVirtualNetwork\": {\n                                        \"id\": \"[[[parameters('remoteVirtualNetwork')]\"\n                                      }\n                                    }\n                                  }\n                                ],\n                                \"outputs\": {}\n                              },\n                              \"parameters\": {\n                                \"remoteVirtualNetwork\": {\n                                  \"value\": \"[[concat(subscription().id,'/resourceGroups/',parameters('vNetRgName'), '/providers/','Microsoft.Network/virtualNetworks/', parameters('vNetName'))]\"\n                                },\n                                \"hubName\": {\n                                  \"value\": \"[[split(parameters('hubResourceId'),'/')[8]]\"\n                                }\n                              }\n                            }\n                          }\n                        ],\n                        \"outputs\": {}\n                      }\n                    },\n                    \"resourceGroup\": \"[[parameters('vNetRgName')]\"\n                  }\n                ],\n                \"outputs\": {}\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#105": "{\n    \"name\": \"Deploy-Vm-autoShutdown\",\n    \"type\": \"Microsoft.Authorization/policyDefinitions\",\n    \"apiVersion\": \"2021-06-01\",\n    \"scope\": null,\n    \"properties\": {\n        \"policyType\": \"Custom\",\n        \"mode\": \"Indexed\",\n        \"displayName\": \"Deploy Virtual Machine Auto Shutdown Schedule\",\n        \"description\": \"Deploys an auto shutdown schedule to a virtual machine\",\n        \"metadata\": {\n            \"version\": \"1.0.0\",\n            \"category\": \"Compute\",\n            \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n            \"alzCloudEnvironments\": [\n                \"AzureCloud\",\n                \"AzureChinaCloud\",\n                \"AzureUSGovernment\"\n            ]\n        },\n        \"parameters\": {\n            \"time\": {\n                \"type\": \"String\",\n                \"metadata\": {\n                    \"displayName\": \"Scheduled Shutdown Time\",\n                    \"description\": \"Daily Scheduled shutdown time. i.e. 2300 = 11:00 PM\"\n                },\n                \"defaultValue\": \"0000\"\n            },\n            \"timeZoneId\": {\n                \"type\": \"string\",\n                \"defaultValue\": \"UTC\",\n                \"metadata\": {\n                    \"displayName\": \"Time zone\",\n                    \"description\": \"The time zone ID (e.g. Pacific Standard time).\"\n                }\n            },\n            \"EnableNotification\": {\n                \"type\": \"string\",\n                \"defaultValue\": \"Disabled\",\n                \"metadata\": {\n                    \"displayName\": \"Send Notification before auto-shutdown\",\n                    \"description\": \"If notifications are enabled for this schedule (i.e. Enabled, Disabled).\"\n                },\n                \"allowedValues\": [\n                    \"Disabled\",\n                    \"Enabled\"\n                ]\n            },\n            \"NotificationEmailRecipient\": {\n                \"type\": \"string\",\n                \"defaultValue\": \"\",\n                \"metadata\": {\n                    \"displayName\": \"Email Address\",\n                    \"description\": \"Email address to be used for notification\"\n                }\n            },\n            \"NotificationWebhookUrl\": {\n                \"type\": \"string\",\n                \"defaultValue\": \"\",\n                \"metadata\": {\n                    \"displayName\": \"Webhook URL\",\n                    \"description\": \"A notification will be posted to the specified webhook endpoint when the auto-shutdown is about to happen.\"\n                }\n            }\n        },\n        \"policyRule\": {\n            \"if\": {\n                \"field\": \"type\",\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\n            },\n            \"then\": {\n                \"effect\": \"deployIfNotExists\",\n                \"details\": {\n                    \"type\": \"Microsoft.DevTestLab/schedules\",\n                    \"existenceCondition\": {\n                        \"allOf\": [\n                            {\n                                \"field\": \"Microsoft.DevTestLab/schedules/taskType\",\n                                \"equals\": \"ComputeVmShutdownTask\"\n                            },\n                            {\n                                \"field\": \"Microsoft.DevTestLab/schedules/targetResourceId\",\n                                \"equals\": \"[[concat(resourceGroup().id,'/providers/Microsoft.Compute/virtualMachines/',field('name'))]\"\n                            }\n                        ]\n                    },\n                    \"roleDefinitionIds\": [\n                        \"/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\"\n                    ],\n                    \"deployment\": {\n                        \"properties\": {\n                            \"mode\": \"incremental\",\n                            \"template\": {\n                                \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n                                \"contentVersion\": \"1.0.0.0\",\n                                \"parameters\": {\n                                    \"vmName\": {\n                                        \"type\": \"string\"\n                                    },\n                                    \"location\": {\n                                        \"type\": \"string\"\n                                    },\n                                    \"time\": {\n                                        \"type\": \"string\",\n                                        \"defaultValue\": \"\",\n                                        \"metadata\": {\n                                            \"description\": \"Daily Scheduled shutdown time. i.e. 2300 = 11:00 PM\"\n                                        }\n                                    },\n                                    \"timeZoneId\": {\n                                        \"type\": \"string\",\n                                        \"defaultValue\": \"\",\n                                        \"metadata\": {\n                                            \"description\": \"The time zone ID (e.g. Pacific Standard time).\"\n                                        }\n                                    },\n                                    \"EnableNotification\": {\n                                        \"type\": \"string\",\n                                        \"defaultValue\": \"\",\n                                        \"metadata\": {\n                                            \"description\": \"If notifications are enabled for this schedule (i.e. Enabled, Disabled).\"\n                                        }\n                                    },\n                                    \"NotificationEmailRecipient\": {\n                                        \"type\": \"string\",\n                                        \"defaultValue\": \"\",\n                                        \"metadata\": {\n                                            \"description\": \"Email address to be used for notification\"\n                                        }\n                                    },\n                                    \"NotificationWebhookUrl\": {\n                                        \"type\": \"string\",\n                                        \"defaultValue\": \"\",\n                                        \"metadata\": {\n                                            \"description\": \"A notification will be posted to the specified webhook endpoint when the auto-shutdown is about to happen.\"\n                                        }\n                                    }\n                                },\n                                \"variables\": {},\n                                \"resources\": [\n                                    {\n                                        \"name\": \"[[concat('shutdown-computevm-',parameters('vmName'))]\",\n                                        \"type\": \"Microsoft.DevTestLab/schedules\",\n                                        \"location\": \"[[parameters('location')]\",\n                                        \"apiVersion\": \"2018-09-15\",\n                                        \"properties\": {\n                                            \"status\": \"Enabled\",\n                                            \"taskType\": \"ComputeVmShutdownTask\",\n                                            \"dailyRecurrence\": {\n                                                \"time\": \"[[parameters('time')]\"\n                                            },\n                                            \"timeZoneId\": \"[[parameters('timeZoneId')]\",\n                                            \"notificationSettings\": {\n                                                \"status\": \"[[parameters('EnableNotification')]\",\n                                                \"timeInMinutes\": 30,\n                                                \"webhookUrl\": \"[[parameters('NotificationWebhookUrl')]\",\n                                                \"emailRecipient\": \"[[parameters('NotificationEmailRecipient')]\",\n                                                \"notificationLocale\": \"en\"\n                                            },\n                                            \"targetResourceId\": \"[[resourceId('Microsoft.Compute/virtualMachines', parameters('vmName'))]\"\n                                        }\n                                    }\n                                ],\n                                \"outputs\": {}\n                            },\n                            \"parameters\": {\n                                \"vmName\": {\n                                    \"value\": \"[[field('name')]\"\n                                },\n                                \"location\": {\n                                    \"value\": \"[[field('location')]\"\n                                },\n                                \"time\": {\n                                    \"value\": \"[[parameters('time')]\"\n                                },\n                                \"timeZoneId\": {\n                                    \"value\": \"[[parameters('timeZoneId')]\"\n                                },\n                                \"EnableNotification\": {\n                                    \"value\": \"[[parameters('EnableNotification')]\"\n                                },\n                                \"NotificationEmailRecipient\": {\n                                    \"value\": \"[[parameters('NotificationEmailRecipient')]\"\n                                },\n                                \"NotificationWebhookUrl\": {\n                                    \"value\": \"[[parameters('NotificationWebhookUrl')]\"\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    }\n}",
    "$fxv#106": "{\n  \"name\": \"Deploy-Windows-DomainJoin\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"Deploy Windows Domain Join Extension with keyvault configuration\",\n    \"description\": \"Deploy Windows Domain Join Extension with keyvault configuration when the extension does not exist on a given windows Virtual Machine\",\n    \"metadata\": {\n      \"version\": \"1.0.0\",\n      \"category\": \"Guest Configuration\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"domainUsername\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"domainUsername\"\n        }\n      },\n      \"domainPassword\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"domainPassword\"\n        }\n      },\n      \"domainFQDN\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"domainFQDN\"\n        }\n      },\n      \"domainOUPath\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"domainOUPath\"\n        }\n      },\n      \"keyVaultResourceId\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"keyVaultResourceId\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\n          },\n          {\n            \"field\": \"Microsoft.Compute/imagePublisher\",\n            \"equals\": \"MicrosoftWindowsServer\"\n          },\n          {\n            \"field\": \"Microsoft.Compute/imageOffer\",\n            \"equals\": \"WindowsServer\"\n          },\n          {\n            \"field\": \"Microsoft.Compute/imageSKU\",\n            \"in\": [\n              \"2008-R2-SP1\",\n              \"2008-R2-SP1-smalldisk\",\n              \"2008-R2-SP1-zhcn\",\n              \"2012-Datacenter\",\n              \"2012-datacenter-gensecond\",\n              \"2012-Datacenter-smalldisk\",\n              \"2012-datacenter-smalldisk-g2\",\n              \"2012-Datacenter-zhcn\",\n              \"2012-datacenter-zhcn-g2\",\n              \"2012-R2-Datacenter\",\n              \"2012-r2-datacenter-gensecond\",\n              \"2012-R2-Datacenter-smalldisk\",\n              \"2012-r2-datacenter-smalldisk-g2\",\n              \"2012-R2-Datacenter-zhcn\",\n              \"2012-r2-datacenter-zhcn-g2\",\n              \"2016-Datacenter\",\n              \"2016-datacenter-gensecond\",\n              \"2016-datacenter-gs\",\n              \"2016-Datacenter-Server-Core\",\n              \"2016-datacenter-server-core-g2\",\n              \"2016-Datacenter-Server-Core-smalldisk\",\n              \"2016-datacenter-server-core-smalldisk-g2\",\n              \"2016-Datacenter-smalldisk\",\n              \"2016-datacenter-smalldisk-g2\",\n              \"2016-Datacenter-with-Containers\",\n              \"2016-datacenter-with-containers-g2\",\n              \"2016-Datacenter-with-RDSH\",\n              \"2016-Datacenter-zhcn\",\n              \"2016-datacenter-zhcn-g2\",\n              \"2019-Datacenter\",\n              \"2019-Datacenter-Core\",\n              \"2019-datacenter-core-g2\",\n              \"2019-Datacenter-Core-smalldisk\",\n              \"2019-datacenter-core-smalldisk-g2\",\n              \"2019-Datacenter-Core-with-Containers\",\n              \"2019-datacenter-core-with-containers-g2\",\n              \"2019-Datacenter-Core-with-Containers-smalldisk\",\n              \"2019-datacenter-core-with-containers-smalldisk-g2\",\n              \"2019-datacenter-gensecond\",\n              \"2019-datacenter-gs\",\n              \"2019-Datacenter-smalldisk\",\n              \"2019-datacenter-smalldisk-g2\",\n              \"2019-Datacenter-with-Containers\",\n              \"2019-datacenter-with-containers-g2\",\n              \"2019-Datacenter-with-Containers-smalldisk\",\n              \"2019-datacenter-with-containers-smalldisk-g2\",\n              \"2019-Datacenter-zhcn\",\n              \"2019-datacenter-zhcn-g2\",\n              \"Datacenter-Core-1803-with-Containers-smalldisk\",\n              \"datacenter-core-1803-with-containers-smalldisk-g2\",\n              \"Datacenter-Core-1809-with-Containers-smalldisk\",\n              \"datacenter-core-1809-with-containers-smalldisk-g2\",\n              \"Datacenter-Core-1903-with-Containers-smalldisk\",\n              \"datacenter-core-1903-with-containers-smalldisk-g2\",\n              \"datacenter-core-1909-with-containers-smalldisk\",\n              \"datacenter-core-1909-with-containers-smalldisk-g1\",\n              \"datacenter-core-1909-with-containers-smalldisk-g2\"\n            ]\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\"\n          ],\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Compute/virtualMachines/extensions/type\",\n                \"equals\": \"JsonADDomainExtension\"\n              },\n              {\n                \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\n                \"equals\": \"Microsoft.Compute\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"parameters\": {\n                \"vmName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"domainUsername\": {\n                  \"reference\": {\n                    \"keyVault\": {\n                      \"id\": \"[[parameters('keyVaultResourceId')]\"\n                    },\n                    \"secretName\": \"[[parameters('domainUsername')]\"\n                  }\n                },\n                \"domainPassword\": {\n                  \"reference\": {\n                    \"keyVault\": {\n                      \"id\": \"[[parameters('keyVaultResourceId')]\"\n                    },\n                    \"secretName\": \"[[parameters('domainPassword')]\"\n                  }\n                },\n                \"domainOUPath\": {\n                  \"value\": \"[[parameters('domainOUPath')]\"\n                },\n                \"domainFQDN\": {\n                  \"value\": \"[[parameters('domainFQDN')]\"\n                },\n                \"keyVaultResourceId\": {\n                  \"value\": \"[[parameters('keyVaultResourceId')]\"\n                }\n              },\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"vmName\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"domainUsername\": {\n                    \"type\": \"String\"\n                  },\n                  \"domainPassword\": {\n                    \"type\": \"securestring\"\n                  },\n                  \"domainFQDN\": {\n                    \"type\": \"String\"\n                  },\n                  \"domainOUPath\": {\n                    \"type\": \"String\"\n                  },\n                  \"keyVaultResourceId\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {\n                  \"domainJoinOptions\": 3,\n                  \"vmName\": \"[[parameters('vmName')]\"\n                },\n                \"resources\": [\n                  {\n                    \"apiVersion\": \"2015-06-15\",\n                    \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\n                    \"name\": \"[[concat(variables('vmName'),'/joindomain')]\",\n                    \"location\": \"[[resourceGroup().location]\",\n                    \"properties\": {\n                      \"publisher\": \"Microsoft.Compute\",\n                      \"type\": \"JsonADDomainExtension\",\n                      \"typeHandlerVersion\": \"1.3\",\n                      \"autoUpgradeMinorVersion\": true,\n                      \"settings\": {\n                        \"Name\": \"[[parameters('domainFQDN')]\",\n                        \"User\": \"[[parameters('domainUserName')]\",\n                        \"Restart\": \"true\",\n                        \"Options\": \"[[variables('domainJoinOptions')]\",\n                        \"OUPath\": \"[[parameters('domainOUPath')]\"\n                      },\n                      \"protectedSettings\": {\n                        \"Password\": \"[[parameters('domainPassword')]\"\n                      }\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#107": "{\n  \"name\": \"Deploy-Diagnostics-VWanS2SVPNGW\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated]: Deploy Diagnostic Settings for VWAN S2S VPN Gateway to Log Analytics workspace\",\n    \"description\": \"Deploys the diagnostic settings for VWAN S2S VPN Gateway to stream to a Log Analytics workspace when any VWAN S2S VPN Gateway which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"version\": \"1.0.0-deprecated\",\n      \"category\": \"Monitoring\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"logAnalytics\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Log Analytics workspace\",\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\n          \"strongType\": \"omsWorkspace\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"profileName\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"setbypolicy\",\n        \"metadata\": {\n          \"displayName\": \"Profile name\",\n          \"description\": \"The diagnostic settings profile name\"\n        }\n      },\n      \"metricsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable metrics\",\n          \"description\": \"Whether to enable metrics stream to the Log Analytics workspace - True or False\"\n        }\n      },\n      \"logsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable logs\",\n          \"description\": \"Whether to enable logs stream to the Log Analytics workspace - True or False\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.Network/vpnGateways\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\n          \"name\": \"[[parameters('profileName')]\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/workspaceId\",\n                \"equals\": \"[[parameters('logAnalytics')]\"\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logAnalytics\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"profileName\": {\n                    \"type\": \"String\"\n                  },\n                  \"metricsEnabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"logsEnabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Network/vpnGateways/providers/diagnosticSettings\",\n                    \"apiVersion\": \"2017-05-01-preview\",\n                    \"name\": \"[[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"dependsOn\": [],\n                    \"properties\": {\n                      \"workspaceId\": \"[[parameters('logAnalytics')]\",\n                      \"metrics\": [\n                        {\n                          \"category\": \"AllMetrics\",\n                          \"enabled\": \"[[parameters('metricsEnabled')]\",\n                          \"retentionPolicy\": {\n                            \"days\": 0,\n                            \"enabled\": false\n                          },\n                          \"timeGrain\": null\n                        }\n                      ],\n                      \"logs\": [\n                        {\n                          \"category\": \"GatewayDiagnosticLog\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"IKEDiagnosticLog\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"RouteDiagnosticLog\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"TunnelDiagnosticLog\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        }\n                      ]\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"logAnalytics\": {\n                  \"value\": \"[[parameters('logAnalytics')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"profileName\": {\n                  \"value\": \"[[parameters('profileName')]\"\n                },\n                \"metricsEnabled\": {\n                  \"value\": \"[[parameters('metricsEnabled')]\"\n                },\n                \"logsEnabled\": {\n                  \"value\": \"[[parameters('logsEnabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#108": "{\n    \"name\": \"Audit-PrivateLinkDnsZones\",\n    \"type\": \"Microsoft.Authorization/policyDefinitions\",\n    \"apiVersion\": \"2021-06-01\",\n    \"scope\": null,    \n    \"properties\": {\n        \"policyType\": \"Custom\",\n        \"mode\": \"Indexed\",\n        \"displayName\": \"Audit or Deny the creation of Private Link Private DNS Zones\",\n        \"description\": \"This policy audits or denies, depending on assignment effect, the creation of a Private Link Private DNS Zones in the current scope, used in combination with policies that create centralized private DNS in connectivity subscription\",\n        \"metadata\": {\n            \"version\": \"1.0.2\",\n            \"category\": \"Network\",\n            \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n            \"alzCloudEnvironments\": [\n                \"AzureCloud\",\n                \"AzureChinaCloud\",\n                \"AzureUSGovernment\"\n            ]\n        },\n        \"parameters\": {\n            \"effect\": {\n                \"type\": \"String\",\n                \"allowedValues\": [\n                    \"Audit\",\n                    \"Deny\",\n                    \"Disabled\"\n                ],\n                \"defaultValue\": \"Audit\",\n                \"metadata\": {\n                    \"displayName\": \"Effect\",\n                    \"description\": \"Enable or disable the execution of the policy\"\n                }\n            },\n            \"privateLinkDnsZones\": {\n                \"type\": \"Array\",\n                \"metadata\": {\n                    \"displayName\": \"Private Link Private DNS Zones\",\n                    \"description\": \"An array of Private Link Private DNS Zones to check for the existence of in the assigned scope.\"\n                },\n                \"defaultValue\": [\n                    \"privatelink.adf.azure.com\",\n                    \"privatelink.afs.azure.net\",\n                    \"privatelink.agentsvc.azure-automation.net\",\n                    \"privatelink.analysis.windows.net\",\n                    \"privatelink.api.azureml.ms\",\n                    \"privatelink.azconfig.io\",\n                    \"privatelink.azure-api.net\",\n                    \"privatelink.azure-automation.net\",\n                    \"privatelink.azurecr.io\",\n                    \"privatelink.azure-devices.net\",\n                    \"privatelink.azure-devices-provisioning.net\",\n                    \"privatelink.azuredatabricks.net\",\n                    \"privatelink.azurehdinsight.net\",\n                    \"privatelink.azurehealthcareapis.com\",\n                    \"privatelink.azurestaticapps.net\",\n                    \"privatelink.azuresynapse.net\",\n                    \"privatelink.azurewebsites.net\",\n                    \"privatelink.batch.azure.com\",\n                    \"privatelink.blob.core.windows.net\",\n                    \"privatelink.cassandra.cosmos.azure.com\",\n                    \"privatelink.cognitiveservices.azure.com\",\n                    \"privatelink.database.windows.net\",\n                    \"privatelink.datafactory.azure.net\",\n                    \"privatelink.dev.azuresynapse.net\",\n                    \"privatelink.dfs.core.windows.net\",\n                    \"privatelink.dicom.azurehealthcareapis.com\",\n                    \"privatelink.digitaltwins.azure.net\",\n                    \"privatelink.directline.botframework.com\",\n                    \"privatelink.documents.azure.com\",\n                    \"privatelink.eventgrid.azure.net\",\n                    \"privatelink.file.core.windows.net\",\n                    \"privatelink.gremlin.cosmos.azure.com\",\n                    \"privatelink.guestconfiguration.azure.com\",\n                    \"privatelink.his.arc.azure.com\",\n                    \"privatelink.kubernetesconfiguration.azure.com\",\n                    \"privatelink.managedhsm.azure.net\",\n                    \"privatelink.mariadb.database.azure.com\",\n                    \"privatelink.media.azure.net\",\n                    \"privatelink.mongo.cosmos.azure.com\",\n                    \"privatelink.monitor.azure.com\",\n                    \"privatelink.mysql.database.azure.com\",\n                    \"privatelink.notebooks.azure.net\",\n                    \"privatelink.ods.opinsights.azure.com\",\n                    \"privatelink.oms.opinsights.azure.com\",\n                    \"privatelink.pbidedicated.windows.net\",\n                    \"privatelink.postgres.database.azure.com\",\n                    \"privatelink.prod.migration.windowsazure.com\",\n                    \"privatelink.purview.azure.com\",\n                    \"privatelink.purviewstudio.azure.com\",\n                    \"privatelink.queue.core.windows.net\",\n                    \"privatelink.redis.cache.windows.net\",\n                    \"privatelink.redisenterprise.cache.azure.net\",\n                    \"privatelink.search.windows.net\",\n                    \"privatelink.service.signalr.net\",\n                    \"privatelink.servicebus.windows.net\",\n                    \"privatelink.siterecovery.windowsazure.com\",\n                    \"privatelink.sql.azuresynapse.net\",\n                    \"privatelink.table.core.windows.net\",\n                    \"privatelink.table.cosmos.azure.com\",\n                    \"privatelink.tip1.powerquery.microsoft.com\",\n                    \"privatelink.token.botframework.com\",\n                    \"privatelink.vaultcore.azure.net\",\n                    \"privatelink.web.core.windows.net\",\n                    \"privatelink.webpubsub.azure.com\"\n                ]\n            }\n        },\n        \"policyRule\": {\n            \"if\": {\n                \"allOf\": [\n                    {\n                        \"field\": \"type\",\n                        \"equals\": \"Microsoft.Network/privateDnsZones\"\n                    },\n                    {\n                        \"field\": \"name\",\n                        \"in\": \"[[parameters('privateLinkDnsZones')]\"\n                    }\n                ]\n            },\n            \"then\": {\n                \"effect\": \"[[parameters('effect')]\"\n            }\n        }\n    }\n}\n",
    "$fxv#109": "{\n    \"name\": \"DenyAction-DiagnosticLogs\",\n    \"type\": \"Microsoft.Authorization/policyDefinitions\",\n    \"apiVersion\": \"2021-06-01\",\n    \"scope\": null,\n    \"properties\": {\n        \"policyType\": \"Custom\",\n        \"mode\": \"Indexed\",\n        \"displayName\": \"DenyAction implementation on Diagnostic Logs.\",\n        \"description\": \"DenyAction implementation on Diagnostic Logs.\",\n        \"metadata\": {\n            \"deprecated\": false,\n            \"version\": \"1.0.0\",\n            \"category\": \"Monitoring\",\n            \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n            \"alzCloudEnvironments\": [\n                \"AzureCloud\",\n                \"AzureChinaCloud\",\n                \"AzureUSGovernment\"\n            ]\n        },\n        \"parameters\": {},\n        \"policyRule\": {\n            \"if\": {\n                \"field\": \"type\",\n                \"equals\": \"Microsoft.Insights/diagnosticSettings\"\n            },\n            \"then\": {\n                \"effect\": \"denyAction\",\n                \"details\": {\n                    \"actionNames\": [\n                        \"delete\"\n                    ]\n                }\n            }\n        }\n    }\n}",
    "$fxv#11": "{\n  \"name\": \"Deny-AppServiceFunctionApp-http\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"Function App should only be accessible over HTTPS\",\n    \"description\": \"Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.\",\n    \"metadata\": {\n      \"version\": \"1.0.0\",\n      \"category\": \"App Service\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"Deny\",\n        \"allowedValues\": [\n          \"Audit\",\n          \"Disabled\",\n          \"Deny\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Web/sites\"\n          },\n          {\n            \"field\": \"kind\",\n            \"like\": \"functionapp*\"\n          },\n          {\n            \"field\": \"Microsoft.Web/sites/httpsOnly\",\n            \"equals\": \"false\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\"\n      }\n    }\n  }\n}\n",
    "$fxv#110": "{\n    \"name\": \"DenyAction-ActivityLogs\",\n    \"type\": \"Microsoft.Authorization/policyDefinitions\",\n    \"apiVersion\": \"2021-06-01\",\n    \"scope\": null,\n    \"properties\": {\n        \"policyType\": \"Custom\",\n        \"mode\": \"Indexed\",\n        \"displayName\": \"DenyAction implementation on Activity Logs\",\n        \"description\": \"This is a DenyAction implementation policy on Activity Logs.\",\n        \"metadata\": {\n            \"deprecated\": false,            \n            \"version\": \"1.0.0\",\n            \"category\": \"Monitoring\",\n            \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n            \"alzCloudEnvironments\": [\n                \"AzureCloud\",\n                \"AzureChinaCloud\",\n                \"AzureUSGovernment\"\n            ]\n        },\n        \"parameters\": {},\n        \"policyRule\": {\n            \"if\": {\n                \"field\": \"type\",\n                \"equals\": \"Microsoft.Resources/subscriptions/providers/diagnosticSettings\"\n            },\n            \"then\": {\n                \"effect\": \"denyAction\",\n                \"details\": {\n                    \"actionNames\": [\n                        \"delete\"\n                    ]\n                }\n            }\n        }\n    }\n}",
    "$fxv#111": "{\n  \"name\": \"Deploy-UserAssignedManagedIdentity-VMInsights\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"displayName\": \"[Deprecated]: Deploy User Assigned Managed Identity for VM Insights\",\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"description\": \"Policy is deprecated as it's no longer required. User-Assigned Management Identity is now centralized and deployed by Azure Landing Zones to the Management Subscription.\",\n    \"metadata\": {\n      \"version\": \"1.0.0-deprecated\",\n      \"category\": \"Managed Identity\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"deprecated\": true,\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"bringYourOwnUserAssignedManagedIdentity\": {\n        \"type\": \"Boolean\",\n        \"metadata\": {\n          \"displayName\": \"Bring Your Own User-Assigned Identity\",\n          \"description\": \"Enable this to use your pre-created user-assigned managed identity. The pre-created identity MUST exist within the subscription otherwise the policy deployment will fail. If enabled, ensure that the User-Assigned Identity Name and Identity Resource Group Name parameters match the pre-created identity. If not enabled, the policy will create per subscription, per resource user-assigned managed identities in a new resource group named 'Built-In-Identity-RG'.\"\n        },\n        \"allowedValues\": [\n          true,\n          false\n        ]\n      },\n      \"userAssignedIdentityName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"User-Assigned Managed Identity Name\",\n          \"description\": \"The name of the pre-created user-assigned managed identity.\"\n        },\n        \"defaultValue\": \"\"\n      },\n      \"identityResourceGroup\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"User-Assigned Managed Identity Resource Group Name\",\n          \"description\": \"The resource group in which the pre-created user-assigned managed identity resides.\"\n        },\n        \"defaultValue\": \"\"\n      },\n      \"builtInIdentityResourceGroupLocation\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Built-In-Identity-RG Location\",\n          \"description\": \"The location of the resource group 'Built-In-Identity-RG' created by the policy. This parameter is only used when 'Bring Your Own User Assigned Identity' parameter is false.\"\n        },\n        \"defaultValue\": \"eastus\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Policy Effect\",\n          \"description\": \"The effect determines what happens when the policy rule is evaluated to match.\"\n        },\n        \"allowedValues\": [\n          \"AuditIfNotExists\",\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"defaultValue\": \"DeployIfNotExists\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\n          },\n          {\n            \"value\": \"[[requestContext().apiVersion]\",\n            \"greaterOrEquals\": \"2018-10-01\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Compute/virtualMachines\",\n          \"name\": \"[[field('name')]\",\n          \"evaluationDelay\": \"AfterProvisioning\",\n          \"deploymentScope\": \"subscription\",\n          \"existenceCondition\": {\n            \"anyOf\": [\n              {\n                \"allOf\": [\n                  {\n                    \"field\": \"identity.type\",\n                    \"contains\": \"UserAssigned\"\n                  },\n                  {\n                    \"field\": \"identity.userAssignedIdentities\",\n                    \"containsKey\": \"[[if(parameters('bringYourOwnUserAssignedManagedIdentity'), concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', trim(parameters('identityResourceGroup')), '/providers/Microsoft.ManagedIdentity/userAssignedIdentities/', trim(parameters('userAssignedIdentityName'))), concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/Built-In-Identity-RG/providers/Microsoft.ManagedIdentity/userAssignedIdentities/Built-In-Identity-', field('location')))]\"\n                  }\n                ]\n              },\n              {\n                \"allOf\": [\n                  {\n                    \"field\": \"identity.type\",\n                    \"equals\": \"UserAssigned\"\n                  },\n                  {\n                    \"value\": \"[[string(length(field('identity.userAssignedIdentities')))]\",\n                    \"equals\": \"1\"\n                  }\n                ]\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"deployment\": {\n            \"location\": \"eastus\",\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"parameters\": {\n                \"bringYourOwnUserAssignedManagedIdentity\": {\n                  \"value\": \"[[parameters('bringYourOwnUserAssignedManagedIdentity')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"uaName\": {\n                  \"value\": \"[[if(parameters('bringYourOwnUserAssignedManagedIdentity'), parameters('userAssignedIdentityName'), 'Built-In-Identity')]\"\n                },\n                \"identityResourceGroup\": {\n                  \"value\": \"[[if(parameters('bringYourOwnUserAssignedManagedIdentity'), parameters('identityResourceGroup'), 'Built-In-Identity-RG')]\"\n                },\n                \"builtInIdentityResourceGroupLocation\": {\n                  \"value\": \"[[parameters('builtInIdentityResourceGroupLocation')]\"\n                },\n                \"vmName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"vmResourceGroup\": {\n                  \"value\": \"[[resourceGroup().name]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                }\n              },\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.1\",\n                \"parameters\": {\n                  \"bringYourOwnUserAssignedManagedIdentity\": {\n                    \"type\": \"bool\"\n                  },\n                  \"location\": {\n                    \"type\": \"string\"\n                  },\n                  \"uaName\": {\n                    \"type\": \"string\"\n                  },\n                  \"identityResourceGroup\": {\n                    \"type\": \"string\"\n                  },\n                  \"builtInIdentityResourceGroupLocation\": {\n                    \"type\": \"string\"\n                  },\n                  \"vmName\": {\n                    \"type\": \"string\"\n                  },\n                  \"vmResourceGroup\": {\n                    \"type\": \"string\"\n                  },\n                  \"resourceId\": {\n                    \"type\": \"string\"\n                  }\n                },\n                \"variables\": {\n                  \"uaNameWithLocation\": \"[[concat(parameters('uaName'),'-', parameters('location'))]\",\n                  \"precreatedUaId\": \"[[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', trim(parameters('identityResourceGroup')), '/providers/Microsoft.ManagedIdentity/userAssignedIdentities/', trim(parameters('uaName')))]\",\n                  \"autocreatedUaId\": \"[[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', trim(parameters('identityResourceGroup')), '/providers/Microsoft.ManagedIdentity/userAssignedIdentities/', trim(parameters('uaName')), '-', parameters('location'))]\",\n                  \"deployUALockName\": \"[[concat('deployUALock-', uniqueString(deployment().name))]\",\n                  \"deployUAName\": \"[[concat('deployUA-', uniqueString(deployment().name))]\",\n                  \"deployGetResourceProperties\": \"[[concat('deployGetResourceProperties-', uniqueString(deployment().name))]\",\n                  \"deployAssignUAName\": \"[[concat('deployAssignUA-', uniqueString(deployment().name))]\"\n                },\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\n                    \"apiVersion\": \"2020-06-01\",\n                    \"name\": \"[[parameters('identityResourceGroup')]\",\n                    \"location\": \"[[parameters('builtInIdentityResourceGroupLocation')]\"\n                  },\n                  {\n                    \"condition\": \"[[parameters('bringYourOwnUserAssignedManagedIdentity')]\",\n                    \"type\": \"Microsoft.Resources/deployments\",\n                    \"apiVersion\": \"2020-06-01\",\n                    \"name\": \"[[variables('deployUALockName')]\",\n                    \"resourceGroup\": \"[[parameters('identityResourceGroup')]\",\n                    \"dependsOn\": [\n                      \"[[resourceId('Microsoft.Resources/resourceGroups', parameters('identityResourceGroup'))]\"\n                    ],\n                    \"properties\": {\n                      \"mode\": \"Incremental\",\n                      \"expressionEvaluationOptions\": {\n                        \"scope\": \"inner\"\n                      },\n                      \"parameters\": {\n                        \"uaName\": {\n                          \"value\": \"[[parameters('uaName')]\"\n                        },\n                        \"location\": {\n                          \"value\": \"[[parameters('location')]\"\n                        }\n                      },\n                      \"template\": {\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                        \"contentVersion\": \"1.0.0.0\",\n                        \"parameters\": {\n                          \"uaName\": {\n                            \"type\": \"string\"\n                          },\n                          \"location\": {\n                            \"type\": \"string\"\n                          }\n                        },\n                        \"variables\": {},\n                        \"resources\": [\n                          {\n                            \"type\": \"Microsoft.ManagedIdentity/userAssignedIdentities\",\n                            \"name\": \"[[parameters('uaName')]\",\n                            \"apiVersion\": \"2018-11-30\",\n                            \"location\": \"[[parameters('location')]\"\n                          }\n                        ]\n                      }\n                    }\n                  },\n                  {\n                    \"condition\": \"[[not(parameters('bringYourOwnUserAssignedManagedIdentity'))]\",\n                    \"type\": \"Microsoft.Resources/deployments\",\n                    \"apiVersion\": \"2020-06-01\",\n                    \"name\": \"[[variables('deployUAName')]\",\n                    \"resourceGroup\": \"[[parameters('identityResourceGroup')]\",\n                    \"dependsOn\": [\n                      \"[[resourceId('Microsoft.Resources/resourceGroups', parameters('identityResourceGroup'))]\"\n                    ],\n                    \"properties\": {\n                      \"mode\": \"Incremental\",\n                      \"expressionEvaluationOptions\": {\n                        \"scope\": \"inner\"\n                      },\n                      \"parameters\": {\n                        \"uaName\": {\n                          \"value\": \"[[variables('uaNameWithLocation')]\"\n                        },\n                        \"location\": {\n                          \"value\": \"[[parameters('location')]\"\n                        }\n                      },\n                      \"template\": {\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                        \"contentVersion\": \"1.0.0.0\",\n                        \"parameters\": {\n                          \"uaName\": {\n                            \"type\": \"string\"\n                          },\n                          \"location\": {\n                            \"type\": \"string\"\n                          }\n                        },\n                        \"variables\": {},\n                        \"resources\": [\n                          {\n                            \"type\": \"Microsoft.ManagedIdentity/userAssignedIdentities\",\n                            \"name\": \"[[parameters('uaName')]\",\n                            \"apiVersion\": \"2018-11-30\",\n                            \"location\": \"[[parameters('location')]\"\n                          },\n                          {\n                            \"type\": \"Microsoft.ManagedIdentity/userAssignedIdentities/providers/locks\",\n                            \"apiVersion\": \"2016-09-01\",\n                            \"name\": \"[[concat(parameters('uaName'), '/Microsoft.Authorization/', 'CanNotDeleteLock-', parameters('uaName'))]\",\n                            \"dependsOn\": [\n                              \"[[parameters('uaName')]\"\n                            ],\n                            \"properties\": {\n                              \"level\": \"CanNotDelete\",\n                              \"notes\": \"Please do not delete this User-Assigned Identity since extensions enabled by Azure Policy are relying on their existence.\"\n                            }\n                          }\n                        ]\n                      }\n                    }\n                  },\n                  {\n                    \"type\": \"Microsoft.Resources/deployments\",\n                    \"apiVersion\": \"2020-06-01\",\n                    \"name\": \"[[variables('deployGetResourceProperties')]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"dependsOn\": [\n                      \"[[resourceId('Microsoft.Resources/resourceGroups', parameters('identityResourceGroup'))]\",\n                      \"[[variables('deployUAName')]\"\n                    ],\n                    \"properties\": {\n                      \"mode\": \"Incremental\",\n                      \"template\": {\n                        \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                        \"contentVersion\": \"1.0.0.0\",\n                        \"resources\": [],\n                        \"outputs\": {\n                          \"resource\": {\n                            \"type\": \"object\",\n                            \"value\": \"[[reference(parameters('resourceId'), '2019-07-01', 'Full')]\"\n                          }\n                        }\n                      }\n                    }\n                  },\n                  {\n                    \"type\": \"Microsoft.Resources/deployments\",\n                    \"apiVersion\": \"2020-06-01\",\n                    \"name\": \"[[concat(variables('deployAssignUAName'))]\",\n                    \"resourceGroup\": \"[[parameters('vmResourceGroup')]\",\n                    \"dependsOn\": [\n                      \"[[resourceId('Microsoft.Resources/resourceGroups', parameters('identityResourceGroup'))]\",\n                      \"[[variables('deployUAName')]\",\n                      \"[[variables('deployGetResourceProperties')]\"\n                    ],\n                    \"properties\": {\n                      \"mode\": \"Incremental\",\n                      \"expressionEvaluationOptions\": {\n                        \"scope\": \"inner\"\n                      },\n                      \"parameters\": {\n                        \"uaId\": {\n                          \"value\": \"[[if(parameters('bringYourOwnUserAssignedManagedIdentity'), variables('precreatedUaId'), variables('autocreatedUaId'))]\"\n                        },\n                        \"vmName\": {\n                          \"value\": \"[[parameters('vmName')]\"\n                        },\n                        \"location\": {\n                          \"value\": \"[[parameters('location')]\"\n                        },\n                        \"identityType\": {\n                          \"value\": \"[[if(contains(reference(variables('deployGetResourceProperties')).outputs.resource.value, 'identity'), reference(variables('deployGetResourceProperties')).outputs.resource.value.identity.type, '')]\"\n                        },\n                        \"userAssignedIdentities\": {\n                          \"value\": \"[[if(and(contains(reference(variables('deployGetResourceProperties')).outputs.resource.value, 'identity'), contains(reference(variables('deployGetResourceProperties')).outputs.resource.value.identity, 'userAssignedIdentities')), reference(variables('deployGetResourceProperties')).outputs.resource.value.identity.userAssignedIdentities, createObject())]\"\n                        }\n                      },\n                      \"template\": {\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                        \"contentVersion\": \"1.0.0.0\",\n                        \"parameters\": {\n                          \"uaId\": {\n                            \"type\": \"string\"\n                          },\n                          \"vmName\": {\n                            \"type\": \"string\"\n                          },\n                          \"location\": {\n                            \"type\": \"string\"\n                          },\n                          \"identityType\": {\n                            \"type\": \"string\"\n                          },\n                          \"userAssignedIdentities\": {\n                            \"type\": \"object\"\n                          }\n                        },\n                        \"variables\": {\n                          \"identityTypeValue\": \"[[if(contains(parameters('identityType'), 'SystemAssigned'), 'SystemAssigned,UserAssigned', 'UserAssigned')]\",\n                          \"userAssignedIdentitiesValue\": \"[[union(parameters('userAssignedIdentities'), createObject(parameters('uaId'), createObject()))]\",\n                          \"resourceWithSingleUAI\": \"[[and(equals(parameters('identityType'), 'UserAssigned'), equals(string(length(parameters('userAssignedIdentities'))), '1'))]\"\n                        },\n                        \"resources\": [\n                          {\n                            \"condition\": \"[[not(variables('resourceWithSingleUAI'))]\",\n                            \"apiVersion\": \"2019-07-01\",\n                            \"type\": \"Microsoft.Compute/virtualMachines\",\n                            \"name\": \"[[parameters('vmName')]\",\n                            \"location\": \"[[parameters('location')]\",\n                            \"identity\": {\n                              \"type\": \"[[variables('identityTypeValue')]\",\n                              \"userAssignedIdentities\": \"[[variables('userAssignedIdentitiesValue')]\"\n                            }\n                          }\n                        ]\n                      }\n                    }\n                  }\n                ]\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#112": "{\n  \"name\": \"Deploy-MDFC-Arc-SQL-DCR-Association\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated]: Configure Arc-enabled SQL Servers with DCR Association to Microsoft Defender for SQL user-defined DCR\",\n    \"description\": \"Policy is deprecated as the built-in policy now supports bringing your own UAMI and DCR. Superseded by https://www.azadvertizer.net/azpolicyadvertizer/2227e1f1-23dd-4c3a-85a9-7024a401d8b2.html\",\n    \"metadata\": {\n      \"version\": \"1.0.0-deprecated\",\n      \"category\": \"Security Center\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"deprecated\": true,\n      \"supersededBy\": \"2227e1f1-23dd-4c3a-85a9-7024a401d8b2\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        },\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"defaultValue\": \"DeployIfNotExists\"\n      },\n      \"workspaceRegion\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Workspace region\",\n          \"description\": \"Region of the Log Analytics workspace destination for the Data Collection Rule.\",\n          \"strongType\": \"location\"\n        }\n      },\n      \"dcrName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Data Collection Rule Name\",\n          \"description\": \"Name of the Data Collection Rule.\"\n        }\n      },\n      \"dcrResourceGroup\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Data Collection Rule Resource Group\",\n          \"description\": \"Resource Group of the Data Collection Rule.\"\n        }\n      },\n      \"dcrId\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Data Collection Rule Id\",\n          \"description\": \"Id of the Data Collection Rule.\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.HybridCompute/machines\"\n          },\n          {\n            \"field\": \"Microsoft.HybridCompute/machines/osName\",\n            \"equals\": \"Windows\"\n          },\n          {\n            \"field\": \"Microsoft.HybridCompute/machines/mssqlDiscovered\",\n            \"equals\": \"true\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Insights/dataCollectionRuleAssociations\",\n          \"name\": \"MicrosoftDefenderForSQL-RulesAssociation\",\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceGroup\": {\n                    \"type\": \"string\"\n                  },\n                  \"vmName\": {\n                    \"type\": \"string\"\n                  },\n                  \"workspaceRegion\": {\n                    \"type\": \"string\"\n                  },\n                  \"dcrName\": {\n                    \"type\": \"string\"\n                  },\n                  \"dcrResourceGroup\": {\n                    \"type\": \"string\"\n                  },\n                  \"dcrId\": {\n                    \"type\": \"string\"\n                  }\n                },\n                \"variables\": {\n                  \"locationLongNameToShortMap\": {\n                    \"australiacentral\": \"CAU\",\n                    \"australiaeast\": \"EAU\",\n                    \"australiasoutheast\": \"SEAU\",\n                    \"brazilsouth\": \"CQ\",\n                    \"canadacentral\": \"CCA\",\n                    \"canadaeast\": \"CCA\",\n                    \"centralindia\": \"CIN\",\n                    \"centralus\": \"CUS\",\n                    \"eastasia\": \"EA\",\n                    \"eastus2euap\": \"eus2p\",\n                    \"eastus\": \"EUS\",\n                    \"eastus2\": \"EUS2\",\n                    \"francecentral\": \"PAR\",\n                    \"germanywestcentral\": \"DEWC\",\n                    \"japaneast\": \"EJP\",\n                    \"jioindiawest\": \"CIN\",\n                    \"koreacentral\": \"SE\",\n                    \"koreasouth\": \"SE\",\n                    \"northcentralus\": \"NCUS\",\n                    \"northeurope\": \"NEU\",\n                    \"norwayeast\": \"NOE\",\n                    \"southafricanorth\": \"JNB\",\n                    \"southcentralus\": \"SCUS\",\n                    \"southeastasia\": \"SEA\",\n                    \"southindia\": \"CIN\",\n                    \"swedencentral\": \"SEC\",\n                    \"switzerlandnorth\": \"CHN\",\n                    \"switzerlandwest\": \"CHW\",\n                    \"uaenorth\": \"DXB\",\n                    \"uksouth\": \"SUK\",\n                    \"ukwest\": \"WUK\",\n                    \"westcentralus\": \"WCUS\",\n                    \"westeurope\": \"WEU\",\n                    \"westindia\": \"CIN\",\n                    \"westus\": \"WUS\",\n                    \"westus2\": \"WUS2\"\n                  },\n                  \"locationCode\": \"[[if(contains(variables('locationLongNameToShortMap'), parameters('workspaceRegion')), variables('locationLongNameToShortMap')[parameters('workspaceRegion')], parameters('workspaceRegion'))]\",\n                  \"subscriptionId\": \"[[subscription().subscriptionId]\",\n                  \"defaultRGName\": \"[[parameters('resourceGroup')]\",\n                  \"dcrName\": \"[[parameters('dcrName')]\",\n                  \"dcrId\": \"[[parameters('dcrId')]\",\n                  \"dcraName\": \"[[concat(parameters('vmName'),'/Microsoft.Insights/MicrosoftDefenderForSQL-RulesAssociation')]\"\n                },\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.HybridCompute/machines/providers/dataCollectionRuleAssociations\",\n                    \"name\": \"[[variables('dcraName')]\",\n                    \"apiVersion\": \"2021-04-01\",\n                    \"properties\": {\n                      \"description\": \"Configure association between Arc-enabled SQL Server and the Microsoft Defender for SQL user-defined DCR. Deleting this association will break the detection of security vulnerabilities for this Arc-enabled SQL Server.\",\n                      \"dataCollectionRuleId\": \"[[variables('dcrId')]\"\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceGroup\": {\n                  \"value\": \"[[parameters('dcrResourceGroup')]\"\n                },\n                \"vmName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"workspaceRegion\": {\n                  \"value\": \"[[parameters('workspaceRegion')]\"\n                },\n                \"dcrName\": {\n                  \"value\": \"[[parameters('dcrName')]\"\n                },\n                \"dcrResourceGroup\": {\n                  \"value\": \"[[parameters('dcrResourceGroup')]\"\n                },\n                \"dcrId\": {\n                  \"value\": \"[[parameters('dcrId')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#113": "{\n  \"name\": \"Deploy-MDFC-Arc-Sql-DefenderSQL-DCR\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated]: Configure Arc-enabled SQL Servers to auto install Microsoft Defender for SQL and DCR with a user-defined LAW\",\n    \"description\": \"Policy is deprecated as the built-in policy now supports bringing your own UAMI and DCR. Superseded by https://www.azadvertizer.net/azpolicyadvertizer/63d03cbd-47fd-4ee1-8a1c-9ddf07303de0.html\",\n    \"metadata\": {\n      \"version\": \"1.0.0-deprecated\",\n      \"category\": \"Security Center\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"deprecated\": true,\n      \"supersededBy\": \"63d03cbd-47fd-4ee1-8a1c-9ddf07303de0\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        },\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"defaultValue\": \"DeployIfNotExists\"\n      },\n      \"userWorkspaceResourceId\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Workspace Resource Id\",\n          \"description\": \"Workspace resource Id of the Log Analytics workspace destination for the Data Collection Rule.\",\n          \"strongType\": \"omsWorkspace\"\n        }\n      },\n      \"workspaceRegion\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Workspace region\",\n          \"description\": \"Region of the Log Analytics workspace destination for the Data Collection Rule.\",\n          \"strongType\": \"location\"\n        }\n      },\n      \"enableCollectionOfSqlQueriesForSecurityResearch\": {\n        \"type\": \"Boolean\",\n        \"metadata\": {\n          \"displayName\": \"Enable collection of SQL queries for security research\",\n          \"description\": \"Enable or disable the collection of SQL queries for security research.\"\n        },\n        \"allowedValues\": [\n          true,\n          false\n        ],\n        \"defaultValue\": false\n      },\n      \"dcrName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Data Collection Rule Name\",\n          \"description\": \"Name of the Data Collection Rule.\"\n        }\n      },\n      \"dcrResourceGroup\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Data Collection Rule Resource Group\",\n          \"description\": \"Resource Group of the Data Collection Rule.\"\n        }\n      },\n      \"dcrId\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Data Collection Rule Id\",\n          \"description\": \"Id of the Data Collection Rule.\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.HybridCompute/machines\"\n          },\n          {\n            \"field\": \"Microsoft.HybridCompute/machines/osName\",\n            \"equals\": \"Windows\"\n          },\n          {\n            \"field\": \"Microsoft.HybridCompute/machines/mssqlDiscovered\",\n            \"equals\": \"true\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Insights/dataCollectionRules\",\n          \"deploymentScope\": \"subscription\",\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"existenceScope\": \"subscription\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"location\",\n                \"equals\": \"[[parameters('workspaceRegion')]\"\n              },\n              {\n                \"field\": \"name\",\n                \"equals\": \"[[parameters('dcrName')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"location\": \"eastus\",\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceGroup\": {\n                    \"type\": \"string\"\n                  },\n                  \"vmName\": {\n                    \"type\": \"string\"\n                  },\n                  \"userWorkspaceResourceId\": {\n                    \"type\": \"string\"\n                  },\n                  \"workspaceRegion\": {\n                    \"type\": \"string\"\n                  },\n                  \"enableCollectionOfSqlQueriesForSecurityResearch\": {\n                    \"type\": \"bool\"\n                  },\n                  \"dcrName\": {\n                    \"type\": \"string\"\n                  },\n                  \"dcrResourceGroup\": {\n                    \"type\": \"string\"\n                  },\n                  \"dcrId\": {\n                    \"type\": \"string\"\n                  }\n                },\n                \"variables\": {\n                  \"locationLongNameToShortMap\": {\n                    \"australiacentral\": \"CAU\",\n                    \"australiaeast\": \"EAU\",\n                    \"australiasoutheast\": \"SEAU\",\n                    \"brazilsouth\": \"CQ\",\n                    \"canadacentral\": \"CCA\",\n                    \"canadaeast\": \"CCA\",\n                    \"centralindia\": \"CIN\",\n                    \"centralus\": \"CUS\",\n                    \"eastasia\": \"EA\",\n                    \"eastus2euap\": \"eus2p\",\n                    \"eastus\": \"EUS\",\n                    \"eastus2\": \"EUS2\",\n                    \"francecentral\": \"PAR\",\n                    \"germanywestcentral\": \"DEWC\",\n                    \"japaneast\": \"EJP\",\n                    \"jioindiawest\": \"CIN\",\n                    \"koreacentral\": \"SE\",\n                    \"koreasouth\": \"SE\",\n                    \"northcentralus\": \"NCUS\",\n                    \"northeurope\": \"NEU\",\n                    \"norwayeast\": \"NOE\",\n                    \"southafricanorth\": \"JNB\",\n                    \"southcentralus\": \"SCUS\",\n                    \"southeastasia\": \"SEA\",\n                    \"southindia\": \"CIN\",\n                    \"swedencentral\": \"SEC\",\n                    \"switzerlandnorth\": \"CHN\",\n                    \"switzerlandwest\": \"CHW\",\n                    \"uaenorth\": \"DXB\",\n                    \"uksouth\": \"SUK\",\n                    \"ukwest\": \"WUK\",\n                    \"westcentralus\": \"WCUS\",\n                    \"westeurope\": \"WEU\",\n                    \"westindia\": \"CIN\",\n                    \"westus\": \"WUS\",\n                    \"westus2\": \"WUS2\"\n                  },\n                  \"locationCode\": \"[[if(contains(variables('locationLongNameToShortMap'), parameters('workspaceRegion')), variables('locationLongNameToShortMap')[parameters('workspaceRegion')], parameters('workspaceRegion'))]\",\n                  \"subscriptionId\": \"[[subscription().subscriptionId]\",\n                  \"defaultRGName\": \"[[parameters('resourceGroup')]\",\n                  \"defaultRGLocation\": \"[[parameters('workspaceRegion')]\",\n                  \"dcrName\": \"[[parameters('dcrName')]\",\n                  \"dcrId\": \"[[parameters('dcrId')]\",\n                  \"dcraName\": \"[[concat(parameters('vmName'),'/Microsoft.Insights/MicrosoftDefenderForSQL-RulesAssociation')]\",\n                  \"deployDataCollectionRules\": \"[[concat('deployDataCollectionRules-', uniqueString(deployment().name))]\",\n                  \"deployDataCollectionRulesAssociation\": \"[[concat('deployDataCollectionRulesAssociation-', uniqueString(deployment().name))]\"\n                },\n                \"resources\": [\n                  {\n                    \"condition\": \"[[empty(parameters('dcrResourceGroup'))]\",\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\n                    \"name\": \"[[variables('defaultRGName')]\",\n                    \"apiVersion\": \"2022-09-01\",\n                    \"location\": \"[[variables('defaultRGLocation')]\",\n                    \"tags\": {\n                      \"createdBy\": \"MicrosoftDefenderForSQL\"\n                    }\n                  },\n                  {\n                    \"condition\": \"[[empty(parameters('dcrId'))]\",\n                    \"type\": \"Microsoft.Resources/deployments\",\n                    \"name\": \"[[variables('deployDataCollectionRules')]\",\n                    \"apiVersion\": \"2022-09-01\",\n                    \"resourceGroup\": \"[[variables('defaultRGName')]\",\n                    \"dependsOn\": [\n                      \"[[variables('defaultRGName')]\"\n                    ],\n                    \"properties\": {\n                      \"mode\": \"Incremental\",\n                      \"expressionEvaluationOptions\": {\n                        \"scope\": \"inner\"\n                      },\n                      \"parameters\": {\n                        \"defaultRGLocation\": {\n                          \"value\": \"[[variables('defaultRGLocation')]\"\n                        },\n                        \"workspaceResourceId\": {\n                          \"value\": \"[[parameters('userWorkspaceResourceId')]\"\n                        },\n                        \"dcrName\": {\n                          \"value\": \"[[variables('dcrName')]\"\n                        },\n                        \"dcrId\": {\n                          \"value\": \"[[variables('dcrId')]\"\n                        },\n                        \"enableCollectionOfSqlQueriesForSecurityResearch\": {\n                          \"value\": \"[[parameters('enableCollectionOfSqlQueriesForSecurityResearch')]\"\n                        }\n                      },\n                      \"template\": {\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n                        \"contentVersion\": \"1.0.0.0\",\n                        \"parameters\": {\n                          \"defaultRGLocation\": {\n                            \"type\": \"string\"\n                          },\n                          \"workspaceResourceId\": {\n                            \"type\": \"string\"\n                          },\n                          \"dcrName\": {\n                            \"type\": \"string\"\n                          },\n                          \"dcrId\": {\n                            \"type\": \"string\"\n                          },\n                          \"enableCollectionOfSqlQueriesForSecurityResearch\": {\n                            \"type\": \"bool\"\n                          }\n                        },\n                        \"variables\": {},\n                        \"resources\": [\n                          {\n                            \"type\": \"Microsoft.Insights/dataCollectionRules\",\n                            \"name\": \"[[parameters('dcrName')]\",\n                            \"apiVersion\": \"2021-04-01\",\n                            \"location\": \"[[parameters('defaultRGLocation')]\",\n                            \"tags\": {\n                              \"createdBy\": \"MicrosoftDefenderForSQL\"\n                            },\n                            \"properties\": {\n                              \"description\": \"Data collection rule for Microsoft Defender for SQL. Deleting this rule will break the detection of security vulnerabilities.\",\n                              \"dataSources\": {\n                                \"extensions\": [\n                                  {\n                                    \"extensionName\": \"MicrosoftDefenderForSQL\",\n                                    \"name\": \"MicrosoftDefenderForSQL\",\n                                    \"streams\": [\n                                      \"Microsoft-DefenderForSqlAlerts\",\n                                      \"Microsoft-DefenderForSqlLogins\",\n                                      \"Microsoft-DefenderForSqlTelemetry\",\n                                      \"Microsoft-DefenderForSqlScanEvents\",\n                                      \"Microsoft-DefenderForSqlScanResults\"\n                                    ],\n                                    \"extensionSettings\": {\n                                      \"enableCollectionOfSqlQueriesForSecurityResearch\": \"[[parameters('enableCollectionOfSqlQueriesForSecurityResearch')]\"\n                                    }\n                                  }\n                                ]\n                              },\n                              \"destinations\": {\n                                \"logAnalytics\": [\n                                  {\n                                    \"workspaceResourceId\": \"[[parameters('workspaceResourceId')]\",\n                                    \"name\": \"LogAnalyticsDest\"\n                                  }\n                                ]\n                              },\n                              \"dataFlows\": [\n                                {\n                                  \"streams\": [\n                                    \"Microsoft-DefenderForSqlAlerts\",\n                                    \"Microsoft-DefenderForSqlLogins\",\n                                    \"Microsoft-DefenderForSqlTelemetry\",\n                                    \"Microsoft-DefenderForSqlScanEvents\",\n                                    \"Microsoft-DefenderForSqlScanResults\"\n                                  ],\n                                  \"destinations\": [\n                                    \"LogAnalyticsDest\"\n                                  ]\n                                }\n                              ]\n                            }\n                          }\n                        ]\n                      }\n                    }\n                  },\n                  {\n                    \"type\": \"Microsoft.Resources/deployments\",\n                    \"name\": \"[[variables('deployDataCollectionRulesAssociation')]\",\n                    \"apiVersion\": \"2022-09-01\",\n                    \"resourceGroup\": \"[[parameters('resourceGroup')]\",\n                    \"dependsOn\": [\n                      \"[[variables('deployDataCollectionRules')]\"\n                    ],\n                    \"properties\": {\n                      \"mode\": \"Incremental\",\n                      \"expressionEvaluationOptions\": {\n                        \"scope\": \"inner\"\n                      },\n                      \"parameters\": {\n                        \"dcrId\": {\n                          \"value\": \"[[variables('dcrId')]\"\n                        },\n                        \"dcraName\": {\n                          \"value\": \"[[variables('dcraName')]\"\n                        }\n                      },\n                      \"template\": {\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n                        \"contentVersion\": \"1.0.0.0\",\n                        \"parameters\": {\n                          \"dcrId\": {\n                            \"type\": \"string\"\n                          },\n                          \"dcraName\": {\n                            \"type\": \"string\"\n                          }\n                        },\n                        \"resources\": [\n                          {\n                            \"type\": \"Microsoft.HybridCompute/machines/providers/dataCollectionRuleAssociations\",\n                            \"name\": \"[[parameters('dcraName')]\",\n                            \"apiVersion\": \"2021-04-01\",\n                            \"properties\": {\n                              \"description\": \"Configure association between Arc-enabled SQL Server and the Microsoft Defender for SQL user-defined DCR. Deleting this association will break the detection of security vulnerabilities for this Arc-enabled SQL Server.\",\n                              \"dataCollectionRuleId\": \"[[parameters('dcrId')]\"\n                            }\n                          }\n                        ]\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceGroup\": {\n                  \"value\": \"[[parameters('dcrResourceGroup')]\"\n                },\n                \"vmName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"userWorkspaceResourceId\": {\n                  \"value\": \"[[parameters('userWorkspaceResourceId')]\"\n                },\n                \"workspaceRegion\": {\n                  \"value\": \"[[parameters('workspaceRegion')]\"\n                },\n                \"enableCollectionOfSqlQueriesForSecurityResearch\": {\n                  \"value\": \"[[parameters('enableCollectionOfSqlQueriesForSecurityResearch')]\"\n                },\n                \"dcrName\": {\n                  \"value\": \"[[parameters('dcrName')]\"\n                },\n                \"dcrResourceGroup\": {\n                  \"value\": \"[[parameters('dcrResourceGroup')]\"\n                },\n                \"dcrId\": {\n                  \"value\": \"[[parameters('dcrId')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#114": "{\n  \"name\": \"Deploy-MDFC-SQL-AMA\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated]: Configure SQL Virtual Machines to automatically install Azure Monitor Agent\",\n    \"description\": \"Policy is deprecated as the built-in policy now supports bringing your own UAMI and DCR. Superseded by https://www.azadvertizer.net/azpolicyadvertizer/f91991d1-5383-4c95-8ee5-5ac423dd8bb1.html\",\n    \"metadata\": {\n      \"version\": \"1.0.0-deprecated\",\n      \"category\": \"Security Center\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"deprecated\": true,\n      \"supersededBy\": \"f91991d1-5383-4c95-8ee5-5ac423dd8bb1\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        },\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"defaultValue\": \"DeployIfNotExists\"\n      },\n      \"identityResourceGroup\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Identity Resource Group\",\n          \"description\": \"The name of the resource group created by the policy.\"\n        },\n        \"defaultValue\": \"\"\n      },\n      \"userAssignedIdentityName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"User Assigned Managed Identity Name\",\n          \"description\": \"The name of the user assigned managed identity.\"\n        },\n        \"defaultValue\": \"\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\n          },\n          {\n            \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\n            \"like\": \"Windows*\"\n          },\n          {\n            \"field\": \"Microsoft.Compute/imagePublisher\",\n            \"equals\": \"microsoftsqlserver\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\n          \"evaluationDelay\": \"AfterProvisioning\",\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\"\n          ],\n          \"name\": \"[[concat(field('fullName'), '/AzureMonitorWindowsAgent')]\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Compute/virtualMachines/extensions/type\",\n                \"equals\": \"AzureMonitorWindowsAgent\"\n              },\n              {\n                \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\n                \"equals\": \"Microsoft.Azure.Monitor\"\n              },\n              {\n                \"field\": \"Microsoft.Compute/virtualMachines/extensions/provisioningState\",\n                \"in\": [\n                  \"Succeeded\",\n                  \"Provisioning succeeded\"\n                ]\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"vmName\": {\n                    \"type\": \"string\"\n                  },\n                  \"location\": {\n                    \"type\": \"string\"\n                  },\n                  \"userAssignedManagedIdentity\": {\n                    \"type\": \"string\"\n                  },\n                  \"userAssignedIdentityName\": {\n                    \"type\": \"string\"\n                  },\n                  \"identityResourceGroup\": {\n                    \"type\": \"string\"\n                  }\n                },\n                \"variables\": {\n                  \"extensionName\": \"AzureMonitorWindowsAgent\",\n                  \"extensionPublisher\": \"Microsoft.Azure.Monitor\",\n                  \"extensionType\": \"AzureMonitorWindowsAgent\",\n                  \"extensionTypeHandlerVersion\": \"1.2\"\n                },\n                \"resources\": [\n                  {\n                    \"name\": \"[[concat(parameters('vmName'), '/', variables('extensionName'))]\",\n                    \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"tags\": {\n                      \"createdBy\": \"MicrosoftDefenderForSQL\"\n                    },\n                    \"apiVersion\": \"2023-03-01\",\n                    \"properties\": {\n                      \"publisher\": \"[[variables('extensionPublisher')]\",\n                      \"type\": \"[[variables('extensionType')]\",\n                      \"typeHandlerVersion\": \"[[variables('extensionTypeHandlerVersion')]\",\n                      \"autoUpgradeMinorVersion\": true,\n                      \"enableAutomaticUpgrade\": true,\n                      \"settings\": {\n                        \"authentication\": {\n                          \"managedIdentity\": {\n                            \"identifier-name\": \"mi_res_id\",\n                            \"identifier-value\": \"[[parameters('userAssignedManagedIdentity')]\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"vmName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"userAssignedManagedIdentity\": {\n                  \"value\": \"[[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', trim(parameters('identityResourceGroup')), '/providers/Microsoft.ManagedIdentity/userAssignedIdentities/', trim(parameters('userAssignedIdentityName')))]\"\n                },\n                \"userAssignedIdentityName\": {\n                  \"value\": \"[[parameters('userAssignedIdentityName')]\"\n                },\n                \"identityResourceGroup\": {\n                  \"value\": \"[[parameters('identityResourceGroup')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#115": "{\n  \"name\": \"Deploy-MDFC-SQL-DefenderSQL-DCR\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated]: Configure SQL Virtual Machines to auto install Microsoft Defender for SQL and DCR with a user-defined LAW\",\n    \"description\": \"Policy is deprecated as the built-in policy now supports bringing your own UAMI and DCR. Superseded by https://www.azadvertizer.net/azpolicyadvertizer/04754ef9-9ae3-4477-bf17-86ef50026304.html\",\n    \"metadata\": {\n      \"version\": \"1.0.1-deprecated\",\n      \"category\": \"Security Center\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"deprecated\": true,\n      \"supersededBy\": \"04754ef9-9ae3-4477-bf17-86ef50026304\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        },\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"defaultValue\": \"DeployIfNotExists\"\n      },\n      \"userWorkspaceResourceId\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Workspace Resource Id\",\n          \"description\": \"Workspace resource Id of the Log Analytics workspace destination for the Data Collection Rule.\",\n          \"strongType\": \"omsWorkspace\"\n        }\n      },\n      \"workspaceRegion\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Workspace region\",\n          \"description\": \"Region of the Log Analytics workspace destination for the Data Collection Rule.\",\n          \"strongType\": \"location\"\n        }\n      },\n      \"enableCollectionOfSqlQueriesForSecurityResearch\": {\n        \"type\": \"Boolean\",\n        \"metadata\": {\n          \"displayName\": \"Enable collection of SQL queries for security research\",\n          \"description\": \"Enable or disable the collection of SQL queries for security research.\"\n        },\n        \"allowedValues\": [\n          true,\n          false\n        ],\n        \"defaultValue\": false\n      },\n      \"dcrName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Data Collection Rule Name\",\n          \"description\": \"Name of the Data Collection Rule.\"\n        }\n      },\n      \"dcrResourceGroup\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Data Collection Rule Resource Group\",\n          \"description\": \"Resource Group of the Data Collection Rule.\"\n        }\n      },\n      \"dcrId\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Data Collection Rule Id\",\n          \"description\": \"Id of the Data Collection Rule.\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\n          },\n          {\n            \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\n            \"like\": \"Windows*\"\n          },\n          {\n            \"field\": \"Microsoft.Compute/imagePublisher\",\n            \"equals\": \"microsoftsqlserver\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Insights/dataCollectionRules\",\n          \"evaluationDelay\": \"AfterProvisioning\",\n          \"deploymentScope\": \"subscription\",\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"existenceScope\": \"subscription\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"location\",\n                \"equals\": \"[[parameters('workspaceRegion')]\"\n              },\n              {\n                \"field\": \"name\",\n                \"equals\": \"[[parameters('dcrName')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"location\": \"eastus\",\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceGroup\": {\n                    \"type\": \"string\"\n                  },\n                  \"location\": {\n                    \"type\": \"string\"\n                  },\n                  \"vmName\": {\n                    \"type\": \"string\"\n                  },\n                  \"userWorkspaceResourceId\": {\n                    \"type\": \"string\"\n                  },\n                  \"workspaceRegion\": {\n                    \"type\": \"string\"\n                  },\n                  \"enableCollectionOfSqlQueriesForSecurityResearch\": {\n                    \"type\": \"bool\"\n                  },\n                  \"dcrName\": {\n                    \"type\": \"string\"\n                  },\n                  \"dcrResourceGroup\": {\n                    \"type\": \"string\"\n                  },\n                  \"dcrId\": {\n                    \"type\": \"string\"\n                  }\n                },\n                \"variables\": {\n                  \"locationLongNameToShortMap\": {\n                    \"australiacentral\": \"CAU\",\n                    \"australiaeast\": \"EAU\",\n                    \"australiasoutheast\": \"SEAU\",\n                    \"brazilsouth\": \"CQ\",\n                    \"canadacentral\": \"CCA\",\n                    \"canadaeast\": \"CCA\",\n                    \"centralindia\": \"CIN\",\n                    \"centralus\": \"CUS\",\n                    \"eastasia\": \"EA\",\n                    \"eastus2euap\": \"eus2p\",\n                    \"eastus\": \"EUS\",\n                    \"eastus2\": \"EUS2\",\n                    \"francecentral\": \"PAR\",\n                    \"germanywestcentral\": \"DEWC\",\n                    \"japaneast\": \"EJP\",\n                    \"jioindiawest\": \"CIN\",\n                    \"koreacentral\": \"SE\",\n                    \"koreasouth\": \"SE\",\n                    \"northcentralus\": \"NCUS\",\n                    \"northeurope\": \"NEU\",\n                    \"norwayeast\": \"NOE\",\n                    \"southafricanorth\": \"JNB\",\n                    \"southcentralus\": \"SCUS\",\n                    \"southeastasia\": \"SEA\",\n                    \"southindia\": \"CIN\",\n                    \"swedencentral\": \"SEC\",\n                    \"switzerlandnorth\": \"CHN\",\n                    \"switzerlandwest\": \"CHW\",\n                    \"uaenorth\": \"DXB\",\n                    \"uksouth\": \"SUK\",\n                    \"ukwest\": \"WUK\",\n                    \"westcentralus\": \"WCUS\",\n                    \"westeurope\": \"WEU\",\n                    \"westindia\": \"CIN\",\n                    \"westus\": \"WUS\",\n                    \"westus2\": \"WUS2\"\n                  },\n                  \"locationCode\": \"[[if(contains(variables('locationLongNameToShortMap'), parameters('workspaceRegion')), variables('locationLongNameToShortMap')[parameters('workspaceRegion')], parameters('workspaceRegion'))]\",\n                  \"subscriptionId\": \"[[subscription().subscriptionId]\",\n                  \"defaultRGName\": \"[[parameters('dcrResourceGroup')]\",\n                  \"defaultRGLocation\": \"[[parameters('workspaceRegion')]\",\n                  \"dcrName\": \"[[parameters('dcrName')]\",\n                  \"dcrId\": \"[[parameters('dcrId')]\",\n                  \"dcraName\": \"[[concat(parameters('vmName'),'/Microsoft.Insights/MicrosoftDefenderForSQL-RulesAssociation')]\",\n                  \"deployDataCollectionRules\": \"[[concat('deployDataCollectionRules-', uniqueString(deployment().name))]\",\n                  \"deployDataCollectionRulesAssociation\": \"[[concat('deployDataCollectionRulesAssociation-', uniqueString(deployment().name))]\",\n                  \"deployDefenderForSQL\": \"[[concat('deployDefenderForSQL-', uniqueString(deployment().name))]\"\n                },\n                \"resources\": [\n                  {\n                    \"condition\": \"[[empty(parameters('dcrResourceGroup'))]\",\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\n                    \"name\": \"[[variables('defaultRGName')]\",\n                    \"apiVersion\": \"2022-09-01\",\n                    \"location\": \"[[variables('defaultRGLocation')]\",\n                    \"tags\": {\n                      \"createdBy\": \"MicrosoftDefenderForSQL\"\n                    }\n                  },\n                  {\n                    \"type\": \"Microsoft.Resources/deployments\",\n                    \"name\": \"[[variables('deployDefenderForSQL')]\",\n                    \"apiVersion\": \"2022-09-01\",\n                    \"resourceGroup\": \"[[parameters('resourceGroup')]\",\n                    \"properties\": {\n                      \"mode\": \"Incremental\",\n                      \"expressionEvaluationOptions\": {\n                        \"scope\": \"inner\"\n                      },\n                      \"parameters\": {\n                        \"location\": {\n                          \"value\": \"[[parameters('location')]\"\n                        },\n                        \"vmName\": {\n                          \"value\": \"[[parameters('vmName')]\"\n                        }\n                      },\n                      \"template\": {\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n                        \"contentVersion\": \"1.0.0.0\",\n                        \"parameters\": {\n                          \"location\": {\n                            \"type\": \"string\"\n                          },\n                          \"vmName\": {\n                            \"type\": \"string\"\n                          }\n                        },\n                        \"variables\": {},\n                        \"resources\": [\n                          {\n                            \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\n                            \"name\": \"[[concat(parameters('vmName'), '/', 'MicrosoftDefenderForSQL')]\",\n                            \"apiVersion\": \"2023-03-01\",\n                            \"location\": \"[[parameters('location')]\",\n                            \"tags\": {\n                              \"createdBy\": \"MicrosoftDefenderForSQL\"\n                            },\n                            \"properties\": {\n                              \"publisher\": \"Microsoft.Azure.AzureDefenderForSQL\",\n                              \"type\": \"AdvancedThreatProtection.Windows\",\n                              \"typeHandlerVersion\": \"2.0\",\n                              \"autoUpgradeMinorVersion\": true,\n                              \"enableAutomaticUpgrade\": true\n                            }\n                          }\n                        ]\n                      }\n                    }\n                  },\n                  {\n                    \"condition\": \"[[empty(parameters('dcrId'))]\",\n                    \"type\": \"Microsoft.Resources/deployments\",\n                    \"name\": \"[[variables('deployDataCollectionRules')]\",\n                    \"apiVersion\": \"2022-09-01\",\n                    \"resourceGroup\": \"[[variables('defaultRGName')]\",\n                    \"dependsOn\": [\n                      \"[[variables('defaultRGName')]\"\n                    ],\n                    \"properties\": {\n                      \"mode\": \"Incremental\",\n                      \"expressionEvaluationOptions\": {\n                        \"scope\": \"inner\"\n                      },\n                      \"parameters\": {\n                        \"defaultRGLocation\": {\n                          \"value\": \"[[variables('defaultRGLocation')]\"\n                        },\n                        \"workspaceResourceId\": {\n                          \"value\": \"[[parameters('userWorkspaceResourceId')]\"\n                        },\n                        \"dcrName\": {\n                          \"value\": \"[[variables('dcrName')]\"\n                        },\n                        \"dcrId\": {\n                          \"value\": \"[[variables('dcrId')]\"\n                        },\n                        \"enableCollectionOfSqlQueriesForSecurityResearch\": {\n                          \"value\": \"[[parameters('enableCollectionOfSqlQueriesForSecurityResearch')]\"\n                        }\n                      },\n                      \"template\": {\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n                        \"contentVersion\": \"1.0.0.0\",\n                        \"parameters\": {\n                          \"defaultRGLocation\": {\n                            \"type\": \"string\"\n                          },\n                          \"workspaceResourceId\": {\n                            \"type\": \"string\"\n                          },\n                          \"dcrName\": {\n                            \"type\": \"string\"\n                          },\n                          \"dcrId\": {\n                            \"type\": \"string\"\n                          },\n                          \"enableCollectionOfSqlQueriesForSecurityResearch\": {\n                            \"type\": \"bool\"\n                          }\n                        },\n                        \"variables\": {},\n                        \"resources\": [\n                          {\n                            \"type\": \"Microsoft.Insights/dataCollectionRules\",\n                            \"name\": \"[[parameters('dcrName')]\",\n                            \"apiVersion\": \"2021-04-01\",\n                            \"location\": \"[[parameters('defaultRGLocation')]\",\n                            \"tags\": {\n                              \"createdBy\": \"MicrosoftDefenderForSQL\"\n                            },\n                            \"properties\": {\n                              \"description\": \"Data collection rule for Microsoft Defender for SQL. Deleting this rule will break the detection of security vulnerabilities.\",\n                              \"dataSources\": {\n                                \"extensions\": [\n                                  {\n                                    \"extensionName\": \"MicrosoftDefenderForSQL\",\n                                    \"name\": \"MicrosoftDefenderForSQL\",\n                                    \"streams\": [\n                                      \"Microsoft-DefenderForSqlAlerts\",\n                                      \"Microsoft-DefenderForSqlLogins\",\n                                      \"Microsoft-DefenderForSqlTelemetry\",\n                                      \"Microsoft-DefenderForSqlScanEvents\",\n                                      \"Microsoft-DefenderForSqlScanResults\"\n                                    ],\n                                    \"extensionSettings\": {\n                                      \"enableCollectionOfSqlQueriesForSecurityResearch\": \"[[parameters('enableCollectionOfSqlQueriesForSecurityResearch')]\"\n                                    }\n                                  }\n                                ]\n                              },\n                              \"destinations\": {\n                                \"logAnalytics\": [\n                                  {\n                                    \"workspaceResourceId\": \"[[parameters('workspaceResourceId')]\",\n                                    \"name\": \"LogAnalyticsDest\"\n                                  }\n                                ]\n                              },\n                              \"dataFlows\": [\n                                {\n                                  \"streams\": [\n                                    \"Microsoft-DefenderForSqlAlerts\",\n                                    \"Microsoft-DefenderForSqlLogins\",\n                                    \"Microsoft-DefenderForSqlTelemetry\",\n                                    \"Microsoft-DefenderForSqlScanEvents\",\n                                    \"Microsoft-DefenderForSqlScanResults\"\n                                  ],\n                                  \"destinations\": [\n                                    \"LogAnalyticsDest\"\n                                  ]\n                                }\n                              ]\n                            }\n                          }\n                        ]\n                      }\n                    }\n                  },\n                  {\n                    \"type\": \"Microsoft.Resources/deployments\",\n                    \"name\": \"[[variables('deployDataCollectionRulesAssociation')]\",\n                    \"apiVersion\": \"2022-09-01\",\n                    \"resourceGroup\": \"[[parameters('resourceGroup')]\",\n                    \"dependsOn\": [\n                      \"[[variables('deployDataCollectionRules')]\"\n                    ],\n                    \"properties\": {\n                      \"mode\": \"Incremental\",\n                      \"expressionEvaluationOptions\": {\n                        \"scope\": \"inner\"\n                      },\n                      \"parameters\": {\n                        \"dcrId\": {\n                          \"value\": \"[[variables('dcrId')]\"\n                        },\n                        \"dcraName\": {\n                          \"value\": \"[[variables('dcraName')]\"\n                        }\n                      },\n                      \"template\": {\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n                        \"contentVersion\": \"1.0.0.0\",\n                        \"parameters\": {\n                          \"dcrId\": {\n                            \"type\": \"string\"\n                          },\n                          \"dcraName\": {\n                            \"type\": \"string\"\n                          }\n                        },\n                        \"resources\": [\n                          {\n                            \"type\": \"Microsoft.Compute/virtualMachines/providers/dataCollectionRuleAssociations\",\n                            \"name\": \"[[parameters('dcraName')]\",\n                            \"apiVersion\": \"2021-04-01\",\n                            \"properties\": {\n                              \"description\": \"Configure association between SQL Virtual Machine and the Microsoft Defender for SQL user-defined DCR. Deleting this association will break the detection of security vulnerabilities for this SQL Virtual Machine.\",\n                              \"dataCollectionRuleId\": \"[[parameters('dcrId')]\"\n                            }\n                          }\n                        ]\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceGroup\": {\n                  \"value\": \"[[resourceGroup().name]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"vmName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"userWorkspaceResourceId\": {\n                  \"value\": \"[[parameters('userWorkspaceResourceId')]\"\n                },\n                \"workspaceRegion\": {\n                  \"value\": \"[[parameters('workspaceRegion')]\"\n                },\n                \"enableCollectionOfSqlQueriesForSecurityResearch\": {\n                  \"value\": \"[[parameters('enableCollectionOfSqlQueriesForSecurityResearch')]\"\n                },\n                \"dcrName\": {\n                  \"value\": \"[[parameters('dcrName')]\"\n                },\n                \"dcrResourceGroup\": {\n                  \"value\": \"[[parameters('dcrResourceGroup')]\"\n                },\n                \"dcrId\": {\n                  \"value\": \"[[parameters('dcrId')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#116": "{\n  \"name\": \"Deploy-MDFC-SQL-DefenderSQL\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"displayName\": \"[Deprecated]: Configure SQL Virtual Machines to automatically install Microsoft Defender for SQL\",\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"description\": \"Policy is deprecated as the built-in policy now supports bringing your own UAMI and DCR. Superseded by https://www.azadvertizer.net/azpolicyadvertizer/ddca0ddc-4e9d-4bbb-92a1-f7c4dd7ef7ce.html\",\n    \"metadata\": {\n      \"version\": \"1.0.0-deprecated\",\n      \"category\": \"Security Center\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"deprecated\": true,\n      \"supersededBy\": \"ddca0ddc-4e9d-4bbb-92a1-f7c4dd7ef7ce\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        },\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"defaultValue\": \"DeployIfNotExists\"\n      },\n      \"workspaceRegion\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Workspace region\",\n          \"description\": \"Region of the Log Analytics workspace destination for the Data Collection Rule.\",\n          \"strongType\": \"location\"\n        }\n      },\n      \"dcrName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Data Collection Rule Name\",\n          \"description\": \"Name of the Data Collection Rule.\"\n        }\n      },\n      \"dcrResourceGroup\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Data Collection Rule Resource Group\",\n          \"description\": \"Resource Group of the Data Collection Rule.\"\n        }\n      },\n      \"dcrId\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Data Collection Rule Id\",\n          \"description\": \"Id of the Data Collection Rule.\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\n          },\n          {\n            \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\n            \"like\": \"Windows*\"\n          },\n          {\n            \"field\": \"Microsoft.Compute/imagePublisher\",\n            \"equals\": \"microsoftsqlserver\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\n          \"name\": \"[[concat(field('fullName'), '/MicrosoftDefenderForSQL')]\",\n          \"evaluationDelay\": \"AfterProvisioning\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Compute/virtualMachines/extensions/type\",\n                \"equals\": \"AdvancedThreatProtection.Windows\"\n              },\n              {\n                \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\n                \"equals\": \"Microsoft.Azure.AzureDefenderForSQL\"\n              },\n              {\n                \"field\": \"Microsoft.Compute/virtualMachines/extensions/provisioningState\",\n                \"in\": [\n                  \"Succeeded\",\n                  \"Provisioning succeeded\"\n                ]\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"location\": {\n                    \"type\": \"string\"\n                  },\n                  \"vmName\": {\n                    \"type\": \"string\"\n                  },\n                  \"workspaceRegion\": {\n                    \"type\": \"string\"\n                  },\n                  \"dcrResourceGroup\": {\n                    \"type\": \"string\"\n                  },\n                  \"dcrName\": {\n                    \"type\": \"string\"\n                  },\n                  \"dcrId\": {\n                    \"type\": \"string\"\n                  }\n                },\n                \"variables\": {\n                  \"locationLongNameToShortMap\": {\n                    \"australiacentral\": \"CAU\",\n                    \"australiaeast\": \"EAU\",\n                    \"australiasoutheast\": \"SEAU\",\n                    \"brazilsouth\": \"CQ\",\n                    \"canadacentral\": \"CCA\",\n                    \"canadaeast\": \"CCA\",\n                    \"centralindia\": \"CIN\",\n                    \"centralus\": \"CUS\",\n                    \"eastasia\": \"EA\",\n                    \"eastus2euap\": \"eus2p\",\n                    \"eastus\": \"EUS\",\n                    \"eastus2\": \"EUS2\",\n                    \"francecentral\": \"PAR\",\n                    \"germanywestcentral\": \"DEWC\",\n                    \"japaneast\": \"EJP\",\n                    \"jioindiawest\": \"CIN\",\n                    \"koreacentral\": \"SE\",\n                    \"koreasouth\": \"SE\",\n                    \"northcentralus\": \"NCUS\",\n                    \"northeurope\": \"NEU\",\n                    \"norwayeast\": \"NOE\",\n                    \"southafricanorth\": \"JNB\",\n                    \"southcentralus\": \"SCUS\",\n                    \"southeastasia\": \"SEA\",\n                    \"southindia\": \"CIN\",\n                    \"swedencentral\": \"SEC\",\n                    \"switzerlandnorth\": \"CHN\",\n                    \"switzerlandwest\": \"CHW\",\n                    \"uaenorth\": \"DXB\",\n                    \"uksouth\": \"SUK\",\n                    \"ukwest\": \"WUK\",\n                    \"westcentralus\": \"WCUS\",\n                    \"westeurope\": \"WEU\",\n                    \"westindia\": \"CIN\",\n                    \"westus\": \"WUS\",\n                    \"westus2\": \"WUS2\"\n                  },\n                  \"actualLocation\": \"[[if(empty(parameters('workspaceRegion')), parameters('location'), parameters('workspaceRegion'))]\",\n                  \"locationCode\": \"[[if(contains(variables('locationLongNameToShortMap'), variables('actualLocation')), variables('locationLongNameToShortMap')[variables('actualLocation')], variables('actualLocation'))]\",\n                  \"subscriptionId\": \"[[subscription().subscriptionId]\",\n                  \"defaultRGName\": \"[[parameters('dcrResourceGroup')]\",\n                  \"dcrName\": \"[[parameters('dcrName')]\",\n                  \"dcrId\": \"[[parameters('dcrId')]\",\n                  \"dcraName\": \"[[concat(parameters('vmName'),'/Microsoft.Insights/MicrosoftDefenderForSQL-RulesAssociation')]\"\n                },\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\n                    \"name\": \"[[concat(parameters('vmName'), '/', 'MicrosoftDefenderForSQL')]\",\n                    \"apiVersion\": \"2023-03-01\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"tags\": {\n                      \"createdBy\": \"MicrosoftDefenderForSQL\"\n                    },\n                    \"properties\": {\n                      \"publisher\": \"Microsoft.Azure.AzureDefenderForSQL\",\n                      \"type\": \"AdvancedThreatProtection.Windows\",\n                      \"typeHandlerVersion\": \"2.0\",\n                      \"autoUpgradeMinorVersion\": true,\n                      \"enableAutomaticUpgrade\": true\n                    },\n                    \"dependsOn\": [\n                      \"[[extensionResourceId(concat('/subscriptions/', variables('subscriptionId'), '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Compute/virtualMachines/', parameters('vmName')), 'Microsoft.Insights/dataCollectionRuleAssociations','MicrosoftDefenderForSQL-RulesAssociation')]\"\n                    ]\n                  },\n                  {\n                    \"type\": \"Microsoft.Compute/virtualMachines/providers/dataCollectionRuleAssociations\",\n                    \"name\": \"[[variables('dcraName')]\",\n                    \"apiVersion\": \"2021-04-01\",\n                    \"properties\": {\n                      \"description\": \"Configure association between SQL Virtual Machine and the Microsoft Defender for SQL DCR. Deleting this association will break the detection of security vulnerabilities for this SQL Virtual Machine.\",\n                      \"dataCollectionRuleId\": \"[[variables('dcrId')]\"\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"vmName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"workspaceRegion\": {\n                  \"value\": \"[[parameters('workspaceRegion')]\"\n                },\n                \"dcrResourceGroup\": {\n                  \"value\": \"[[parameters('dcrResourceGroup')]\"\n                },\n                \"dcrName\": {\n                  \"value\": \"[[parameters('dcrName')]\"\n                },\n                \"dcrId\": {\n                  \"value\": \"[[parameters('dcrId')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#117": "{\n    \"name\": \"Deny-APIM-TLS\",\n    \"type\": \"Microsoft.Authorization/policyDefinitions\",\n    \"apiVersion\": \"2021-06-01\",\n    \"scope\": null,\n    \"properties\": {\n        \"policyType\": \"Custom\",\n        \"mode\": \"All\",\n        \"displayName\": \"API Management services should use TLS version 1.2\",\n        \"description\": \"Azure API Management service should use TLS version 1.2\",\n        \"metadata\": {\n            \"version\": \"1.0.0\",\n            \"category\": \"API Management\",\n            \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n            \"alzCloudEnvironments\": [\n                \"AzureCloud\",\n                \"AzureChinaCloud\",\n                \"AzureUSGovernment\"\n            ]\n        },\n        \"parameters\": {\n            \"effect\": {\n                \"type\": \"String\",\n                \"allowedValues\": [\n                    \"Audit\",\n                    \"Deny\",\n                    \"Disabled\"\n                ],\n                \"defaultValue\": \"Deny\",\n                \"metadata\": {\n                    \"displayName\": \"Effect\",\n                    \"description\": \"Enable or disable the execution of the policy\"\n                }\n            }\n        },\n        \"policyRule\": {\n            \"if\": {\n                \"allOf\": [\n                    {\n                        \"field\": \"type\",\n                        \"equals\": \"Microsoft.ApiManagement/service\"\n                    },\n                    {\n                        \"anyOf\": [\n                            {\n                                \"value\": \"[[indexof(toLower(string(field('Microsoft.ApiManagement/service/customProperties'))), '\\\"microsoft.windowsazure.apimanagement.gateway.security.protocols.tls10\\\":\\\"true\\\"')]\",\n                                \"greater\": 0\n                            },\n                            {\n                                \"value\": \"[[indexof(toLower(string(field('Microsoft.ApiManagement/service/customProperties'))), '\\\"microsoft.windowsazure.apimanagement.gateway.security.protocols.tls10\\\":true')]\",\n                                \"greater\": 0\n                            },\n                            {\n                                \"value\": \"[[indexof(toLower(string(field('Microsoft.ApiManagement/service/customProperties'))), '\\\"microsoft.windowsazure.apimanagement.gateway.security.protocols.tls11\\\":\\\"true\\\"')]\",\n                                \"greater\": 0\n                            },\n                            {\n                                \"value\": \"[[indexof(toLower(string(field('Microsoft.ApiManagement/service/customProperties'))), '\\\"microsoft.windowsazure.apimanagement.gateway.security.protocols.tls11\\\":true')]\",\n                                \"greater\": 0\n                            }\n                        ]\n                    }\n                ]\n            },\n            \"then\": {\n                \"effect\": \"[[parameters('effect')]\"\n            }\n        }\n    }\n}",
    "$fxv#118": "{\n    \"name\": \"Deny-AppGw-Without-Tls\",\n    \"type\": \"Microsoft.Authorization/policyDefinitions\",\n    \"apiVersion\": \"2021-06-01\",\n    \"scope\": null,\n    \"properties\": {\n        \"policyType\": \"Custom\",\n        \"mode\": \"All\",\n        \"displayName\": \"Application Gateway should be deployed with predefined Microsoft policy that is using TLS version 1.2\",\n        \"description\": \"This policy enables you to restrict that Application Gateways is always deployed with predefined Microsoft policy that is using TLS version 1.2\",\n        \"metadata\": {\n            \"version\": \"1.0.0\",\n            \"category\": \"Network\",\n            \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n            \"alzCloudEnvironments\": [\n                \"AzureCloud\",\n                \"AzureChinaCloud\",\n                \"AzureUSGovernment\"\n            ]\n        },\n        \"parameters\": {\n            \"effect\": {\n                \"type\": \"String\",\n                \"allowedValues\": [\n                    \"Audit\",\n                    \"Deny\",\n                    \"Disabled\"\n                ],\n                \"defaultValue\": \"Deny\",\n                \"metadata\": {\n                    \"displayName\": \"Effect\",\n                    \"description\": \"Enable or disable the execution of the policy\"\n                }\n            },\n            \"predefinedPolicyName\": {\n                \"type\": \"array\",\n                \"metadata\": {\n                    \"displayName\": \"Predefined policy name\",\n                    \"description\": \"Predefined policy name\"\n                },\n                \"defaultValue\": [\n                    \"AppGwSslPolicy20220101\",\n                    \"AppGwSslPolicy20170401S\",\n                    \"AppGwSslPolicy20220101S\"\n                ]\n            }\n        },\n        \"policyRule\": {\n            \"if\": {\n                \"allOf\": [\n                    {\n                        \"field\": \"type\",\n                        \"equals\": \"Microsoft.Network/applicationGateways\"\n                    },\n                    {\n                        \"anyOf\": [\n                            {\n                                \"field\": \"Microsoft.Network/applicationGateways/sslPolicy.policyType\",\n                                \"notEquals\": \"Predefined\"\n                            },\n                            {\n                                \"field\": \"Microsoft.Network/applicationGateways/sslPolicy.policyType\",\n                                \"exists\": \"false\"\n                            },\n                            {\n                                \"field\": \"Microsoft.Network/applicationGateways/sslPolicy.policyName\",\n                                \"notIn\": \"[[parameters('predefinedPolicyName')]\"\n                            }\n                        ]\n                    }\n                ]\n            },\n            \"then\": {\n                \"effect\": \"[[parameters('effect')]\"\n            }\n        }\n    }\n}",
    "$fxv#119": "{\n    \"name\": \"Deny-AppService-without-BYOC\",\n    \"type\": \"Microsoft.Authorization/policyDefinitions\",\n    \"apiVersion\": \"2021-06-01\",\n    \"scope\": null,\n    \"properties\": {\n        \"policyType\": \"Custom\",\n        \"mode\": \"All\",\n        \"displayName\": \"App Service certificates must be stored in Key Vault\",\n        \"description\": \"App Service (including Logic apps and Function apps) must use certificates stored in Key Vault\",\n        \"metadata\": {\n            \"version\": \"1.0.0\",\n            \"category\": \"App Service\",\n            \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n            \"alzCloudEnvironments\": [\n                \"AzureCloud\",\n                \"AzureChinaCloud\",\n                \"AzureUSGovernment\"\n            ]\n        },\n        \"parameters\": {\n            \"effect\": {\n                \"type\": \"String\",\n                \"allowedValues\": [\n                    \"Audit\",\n                    \"Deny\",\n                    \"Disabled\"\n                ],\n                \"defaultValue\": \"Audit\",\n                \"metadata\": {\n                    \"displayName\": \"Effect\",\n                    \"description\": \"Enable or disable the execution of the policy\"\n                }\n            }\n        },\n        \"policyRule\": {\n            \"if\": {\n                \"allOf\": [\n                    {\n                        \"field\": \"type\",\n                        \"equals\": \"Microsoft.Web/certificates\"\n                    },\n                    {\n                        \"anyOf\": [\n                            {\n                                \"field\": \"Microsoft.Web/certificates/keyVaultId\",\n                                \"exists\": \"false\"\n                            },\n                            {\n                                \"field\": \"Microsoft.Web/certificates/keyVaultSecretName\",\n                                \"exists\": \"false\"\n                            }\n                        ]\n                    }\n                ]\n            },\n            \"then\": {\n                \"effect\": \"[[parameters('effect')]\"\n            }\n        }\n    }\n}",
    "$fxv#12": "{\n  \"name\": \"Deny-AppServiceWebApp-http\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"Web Application should only be accessible over HTTPS\",\n    \"description\": \"Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.\",\n    \"metadata\": {\n      \"version\": \"1.0.0\",\n      \"category\": \"App Service\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"Deny\",\n        \"allowedValues\": [\n          \"Audit\",\n          \"Disabled\",\n          \"Deny\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Web/sites\"\n          },\n          {\n            \"field\": \"kind\",\n            \"like\": \"app*\"\n          },\n          {\n            \"field\": \"Microsoft.Web/sites/httpsOnly\",\n            \"equals\": \"false\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\"\n      }\n    }\n  }\n}\n",
    "$fxv#120": "{\n    \"name\": \"Deny-AzFw-Without-Policy\",\n    \"type\": \"Microsoft.Authorization/policyDefinitions\",\n    \"apiVersion\": \"2021-06-01\",\n    \"scope\": null,\n    \"properties\": {\n        \"policyType\": \"Custom\",\n        \"mode\": \"All\",\n        \"displayName\": \"Azure Firewall should have a default Firewall Policy\",\n        \"description\": \"This policy denies the creation of Azure Firewall without a default Firewall Policy.\",\n        \"metadata\": {\n            \"version\": \"1.0.0\",\n            \"category\": \"Network\",\n            \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n            \"alzCloudEnvironments\": [\n                \"AzureCloud\",\n                \"AzureChinaCloud\",\n                \"AzureUSGovernment\"\n            ]\n        },\n        \"parameters\": {\n            \"effect\": {\n                \"type\": \"String\",\n                \"allowedValues\": [\n                    \"Audit\",\n                    \"Deny\",\n                    \"Disabled\"\n                ],\n                \"defaultValue\": \"Deny\",\n                \"metadata\": {\n                    \"displayName\": \"Effect\",\n                    \"description\": \"Enable or disable the execution of the policy\"\n                }\n            }\n        },\n        \"policyRule\": {\n            \"if\": {\n                \"allOf\": [\n                    {\n                        \"field\": \"type\",\n                        \"equals\": \"Microsoft.Network/azureFirewalls\"\n                    },\n                    {\n                        \"field\": \"Microsoft.Network/azureFirewalls/firewallPolicy.id\",\n                        \"exists\": \"false\"\n                    }\n                ]\n            },\n            \"then\": {\n                \"effect\": \"[[parameters('effect')]\"\n            }\n        }\n    }\n}",
    "$fxv#121": "{\n    \"name\": \"Deny-CognitiveServices-NetworkAcls\",\n    \"type\": \"Microsoft.Authorization/policyDefinitions\",\n    \"apiVersion\": \"2021-06-01\",\n    \"scope\": null,\n    \"properties\": {\n        \"policyType\": \"Custom\",\n        \"mode\": \"All\",\n        \"displayName\": \"Network ACLs should be restricted for Cognitive Services\",\n        \"description\": \"Azure Cognitive Services should not allow adding individual IPs or virtual network rules to the service-level firewall. Enable this to restrict inbound network access and enforce the usage of private endpoints.\",\n        \"metadata\": {\n            \"version\": \"1.0.0\",\n            \"category\": \"Cognitive Services\",\n            \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n            \"alzCloudEnvironments\": [\n                \"AzureCloud\",\n                \"AzureChinaCloud\",\n                \"AzureUSGovernment\"\n            ]\n        },\n        \"parameters\": {\n            \"effect\": {\n                \"type\": \"String\",\n                \"allowedValues\": [\n                    \"Audit\",\n                    \"Deny\",\n                    \"Disabled\"\n                ],\n                \"defaultValue\": \"Deny\",\n                \"metadata\": {\n                    \"displayName\": \"Effect\",\n                    \"description\": \"Enable or disable the execution of the policy\"\n                }\n            }\n        },\n        \"policyRule\": {\n            \"if\": {\n                \"allOf\": [\n                    {\n                        \"field\": \"type\",\n                        \"equals\": \"Microsoft.CognitiveServices/accounts\"\n                    },\n                    {\n                        \"anyOf\": [\n                            {\n                                \"count\": {\n                                    \"field\": \"Microsoft.CognitiveServices/accounts/networkAcls.ipRules[*]\"\n                                },\n                                \"greater\": 0\n                            },\n                            {\n                                \"count\": {\n                                    \"field\": \"Microsoft.CognitiveServices/accounts/networkAcls.virtualNetworkRules[*]\"\n                                },\n                                \"greater\": 0\n                            }\n                        ]\n                    }\n                ]\n            },\n            \"then\": {\n                \"effect\": \"[[parameters('effect')]\"\n            }\n        }\n    }\n}",
    "$fxv#122": "{\n    \"name\": \"Deny-CognitiveServices-Resource-Kinds\",\n    \"type\": \"Microsoft.Authorization/policyDefinitions\",\n    \"apiVersion\": \"2021-06-01\",\n    \"scope\": null,\n    \"properties\": {\n        \"policyType\": \"Custom\",\n        \"mode\": \"All\",\n        \"displayName\": \"Only explicit kinds for Cognitive Services should be allowed\",\n        \"description\": \"Azure Cognitive Services should only create explicit allowed kinds.\",\n        \"metadata\": {\n            \"version\": \"1.0.0\",\n            \"category\": \"Cognitive Services\",\n            \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n            \"alzCloudEnvironments\": [\n                \"AzureCloud\",\n                \"AzureChinaCloud\",\n                \"AzureUSGovernment\"\n            ]\n        },\n        \"parameters\": {\n            \"effect\": {\n                \"type\": \"String\",\n                \"allowedValues\": [\n                    \"Audit\",\n                    \"Deny\",\n                    \"Disabled\"\n                ],\n                \"defaultValue\": \"Deny\",\n                \"metadata\": {\n                    \"displayName\": \"Effect\",\n                    \"description\": \"Enable or disable the execution of the policy\"\n                }\n            },\n            \"allowedKinds\": {\n                \"type\": \"array\",\n                \"metadata\": {\n                    \"displayName\": \"Effect\",\n                    \"description\": \"Select the allowed resource kinds to be used with Cognitive Services\"\n                },\n                \"allowedValues\": [\n                    \"AnomalyDetector\",\n                    \"ComputerVision\",\n                    \"CognitiveServices\",\n                    \"ContentModerator\",\n                    \"CustomVision.Training\",\n                    \"CustomVision.Prediction\",\n                    \"Face\",\n                    \"FormRecognizer\",\n                    \"ImmersiveReader\",\n                    \"LUIS\",\n                    \"Personalizer\",\n                    \"SpeechServices\",\n                    \"TextAnalytics\",\n                    \"TextTranslation\",\n                    \"OpenAI\"\n                ],\n                \"defaultValue\": [\n                    \"AnomalyDetector\",\n                    \"ComputerVision\",\n                    \"CognitiveServices\",\n                    \"ContentModerator\",\n                    \"CustomVision.Training\",\n                    \"CustomVision.Prediction\",\n                    \"Face\",\n                    \"FormRecognizer\",\n                    \"ImmersiveReader\",\n                    \"LUIS\",\n                    \"Personalizer\",\n                    \"SpeechServices\",\n                    \"TextAnalytics\",\n                    \"TextTranslation\",\n                    \"OpenAI\"\n                ]\n            }\n        },\n        \"policyRule\": {\n            \"if\": {\n                \"allOf\": [\n                    {\n                        \"field\": \"type\",\n                        \"equals\": \"Microsoft.CognitiveServices/accounts\"\n                    },\n                    {\n                        \"field\": \"kind\",\n                        \"notIn\": \"[[parameters('allowedKinds')]\"\n                    }\n                ]\n            },\n            \"then\": {\n                \"effect\": \"[[parameters('effect')]\"\n            }\n        }\n    }\n}",
    "$fxv#123": "{\n    \"name\": \"Deny-CognitiveServices-RestrictOutboundNetworkAccess\",\n    \"type\": \"Microsoft.Authorization/policyDefinitions\",\n    \"apiVersion\": \"2021-06-01\",\n    \"scope\": null,\n    \"properties\": {\n        \"policyType\": \"Custom\",\n        \"mode\": \"All\",\n        \"displayName\": \"Outbound network access should be restricted for Cognitive Services\",\n        \"description\": \"Azure Cognitive Services allow restricting outbound network access. Enable this to limit outbound connectivity for the service.\",\n        \"metadata\": {\n            \"version\": \"1.0.0\",\n            \"category\": \"Cognitive Services\",\n            \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n            \"alzCloudEnvironments\": [\n                \"AzureCloud\",\n                \"AzureChinaCloud\",\n                \"AzureUSGovernment\"\n            ]\n        },\n        \"parameters\": {\n            \"effect\": {\n                \"type\": \"String\",\n                \"allowedValues\": [\n                    \"Audit\",\n                    \"Deny\",\n                    \"Disabled\"\n                ],\n                \"defaultValue\": \"Deny\",\n                \"metadata\": {\n                    \"displayName\": \"Effect\",\n                    \"description\": \"Enable or disable the execution of the policy\"\n                }\n            }\n        },\n        \"policyRule\": {\n            \"if\": {\n                \"allOf\": [\n                    {\n                        \"field\": \"type\",\n                        \"equals\": \"Microsoft.CognitiveServices/accounts\"\n                    },\n                    {\n                        \"anyOf\": [\n                            {\n                                \"field\": \"Microsoft.CognitiveServices/accounts/restrictOutboundNetworkAccess\",\n                                \"exists\": \"false\"\n                            },\n                            {\n                                \"field\": \"Microsoft.CognitiveServices/accounts/restrictOutboundNetworkAccess\",\n                                \"notEquals\": true\n                            }\n                        ]\n                    }\n                ]\n            },\n            \"then\": {\n                \"effect\": \"[[parameters('effect')]\"\n            }\n        }\n    }\n}",
    "$fxv#124": "{\n    \"name\": \"Deny-EH-minTLS\",\n    \"type\": \"Microsoft.Authorization/policyDefinitions\",\n    \"apiVersion\": \"2021-06-01\",\n    \"scope\": null,\n    \"properties\": {\n        \"policyType\": \"Custom\",\n        \"mode\": \"All\",\n        \"displayName\": \"Event Hub namespaces should use a valid TLS version\",\n        \"description\": \"Event Hub namespaces should use a valid TLS version.\",\n        \"metadata\": {\n            \"version\": \"1.0.0\",\n            \"category\": \"Event Hub\",\n            \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n            \"alzCloudEnvironments\": [\n                \"AzureCloud\",\n                \"AzureChinaCloud\",\n                \"AzureUSGovernment\"\n            ]\n        },\n        \"parameters\": {\n            \"effect\": {\n                \"type\": \"String\",\n                \"allowedValues\": [\n                    \"Audit\",\n                    \"Deny\",\n                    \"Disabled\"\n                ],\n                \"defaultValue\": \"Deny\",\n                \"metadata\": {\n                    \"displayName\": \"Effect\",\n                    \"description\": \"Enable or disable the execution of the policy\"\n                }\n            },\n            \"minTlsVersion\": {\n                \"type\": \"string\",\n                \"metadata\": {\n                    \"displayName\": \"Minimum TLS Version\",\n                    \"description\": \"Minimum TLS version to be used by Event Hub\"\n                },\n                \"defaultValue\": \"1.2\"\n            }\n        },\n        \"policyRule\": {\n            \"if\": {\n                \"allOf\": [\n                    {\n                        \"field\": \"type\",\n                        \"equals\": \"Microsoft.EventHub/namespaces\"\n                    },\n                    {\n                        \"anyOf\": [\n                            {\n                                \"field\": \"Microsoft.EventHub/namespaces/minimumTlsVersion\",\n                                \"notEquals\": \"[[parameters('minTlsVersion')]\"\n                            },\n                            {\n                                \"field\": \"Microsoft.EventHub/namespaces/minimumTlsVersion\",\n                                \"exists\": \"false\"\n                            }\n                        ]\n                    }\n                ]\n            },\n            \"then\": {\n                \"effect\": \"[[parameters('effect')]\"\n            }\n        }\n    }\n}",
    "$fxv#125": "{\n    \"name\": \"Deny-EH-Premium-CMK\",\n    \"type\": \"Microsoft.Authorization/policyDefinitions\",\n    \"apiVersion\": \"2021-06-01\",\n    \"scope\": null,\n    \"properties\": {\n        \"policyType\": \"Custom\",\n        \"mode\": \"All\",\n        \"displayName\": \"Event Hub namespaces (Premium) should use a customer-managed key for encryption\",\n        \"description\": \"Event Hub namespaces (Premium) should use a customer-managed key for encryption.\",\n        \"metadata\": {\n            \"version\": \"1.0.0\",\n            \"category\": \"Event Hub\",\n            \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n            \"alzCloudEnvironments\": [\n                \"AzureCloud\",\n                \"AzureChinaCloud\",\n                \"AzureUSGovernment\"\n            ]\n        },\n        \"parameters\": {\n            \"effect\": {\n                \"type\": \"String\",\n                \"allowedValues\": [\n                    \"Audit\",\n                    \"Deny\",\n                    \"Disabled\"\n                ],\n                \"defaultValue\": \"Deny\",\n                \"metadata\": {\n                    \"displayName\": \"Effect\",\n                    \"description\": \"Enable or disable the execution of the policy\"\n                }\n            }\n        },\n        \"policyRule\": {\n            \"if\": {\n                \"allOf\": [\n                    {\n                        \"field\": \"type\",\n                        \"equals\": \"Microsoft.EventHub/namespaces\"\n                    },\n                    {\n                        \"field\": \"Microsoft.EventHub/namespaces/sku.name\",\n                        \"equals\": \"Premium\"\n                    },\n                    {\n                        \"not\": {\n                            \"field\": \"Microsoft.EventHub/namespaces/encryption.keySource\",\n                            \"equals\": \"Microsoft.Keyvault\"\n                        }\n                    }\n                ]\n            },\n            \"then\": {\n                \"effect\": \"[[parameters('effect')]\"\n            }\n        }\n    }\n}",
    "$fxv#126": "{\n    \"name\": \"Deny-LogicApp-Public-Network\",\n    \"type\": \"Microsoft.Authorization/policyDefinitions\",\n    \"apiVersion\": \"2021-06-01\",\n    \"scope\": null,\n    \"properties\": {\n        \"policyType\": \"Custom\",\n        \"mode\": \"All\",\n        \"displayName\": \"Logic apps should disable public network access\",\n        \"description\": \"Disabling public network access improves security by ensuring that the Logic App is not exposed on the public internet. Creating private endpoints can limit exposure of a Logic App. Learn more at: https://aka.ms/app-service-private-endpoint.\",\n        \"metadata\": {\n            \"version\": \"1.0.0\",\n            \"category\": \"Logic Apps\",\n            \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n            \"alzCloudEnvironments\": [\n                \"AzureCloud\",\n                \"AzureChinaCloud\",\n                \"AzureUSGovernment\"\n            ]\n        },\n        \"parameters\": {\n            \"effect\": {\n                \"type\": \"String\",\n                \"allowedValues\": [\n                    \"Audit\",\n                    \"Deny\",\n                    \"Disabled\"\n                ],\n                \"defaultValue\": \"Deny\",\n                \"metadata\": {\n                    \"displayName\": \"Effect\",\n                    \"description\": \"Enable or disable the execution of the policy\"\n                }\n            }\n        },\n        \"policyRule\": {\n            \"if\": {\n                \"allOf\": [\n                    {\n                        \"field\": \"type\",\n                        \"equals\": \"Microsoft.Web/sites\"\n                    },\n                    {\n                        \"field\": \"kind\",\n                        \"contains\": \"workflowapp\"\n                    },\n                    {\n                        \"anyOf\": [\n                            {\n                                \"field\": \"Microsoft.Web/sites/publicNetworkAccess\",\n                                \"exists\": \"false\"\n                            },\n                            {\n                                \"field\": \"Microsoft.Web/sites/publicNetworkAccess\",\n                                \"notEquals\": \"Disabled\"\n                            }\n                        ]\n                    }\n                ]\n            },\n            \"then\": {\n                \"effect\": \"[[parameters('effect')]\"\n            }\n        }\n    }\n}",
    "$fxv#127": "{\n    \"name\": \"Deny-LogicApps-Without-Https\",\n    \"type\": \"Microsoft.Authorization/policyDefinitions\",\n    \"apiVersion\": \"2021-06-01\",\n    \"scope\": null,\n    \"properties\": {\n        \"policyType\": \"Custom\",\n        \"mode\": \"All\",\n        \"displayName\": \"Logic app should only be accessible over HTTPS\",\n        \"description\": \"Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.\",\n        \"metadata\": {\n            \"version\": \"1.0.0\",\n            \"category\": \"Logic Apps\",\n            \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n            \"alzCloudEnvironments\": [\n                \"AzureCloud\",\n                \"AzureChinaCloud\",\n                \"AzureUSGovernment\"\n            ]\n        },\n        \"parameters\": {\n            \"effect\": {\n                \"type\": \"String\",\n                \"allowedValues\": [\n                    \"Audit\",\n                    \"Deny\",\n                    \"Disabled\"\n                ],\n                \"defaultValue\": \"Deny\",\n                \"metadata\": {\n                    \"displayName\": \"Effect\",\n                    \"description\": \"Enable or disable the execution of the policy\"\n                }\n            }\n        },\n        \"policyRule\": {\n            \"if\": {\n                \"allOf\": [\n                    {\n                        \"field\": \"type\",\n                        \"equals\": \"Microsoft.Web/sites\"\n                    },\n                    {\n                        \"field\": \"kind\",\n                        \"contains\": \"workflowapp\"\n                    },\n                    {\n                        \"anyOf\": [\n                            {\n                                \"field\": \"Microsoft.Web/sites/httpsOnly\",\n                                \"exists\": \"false\"\n                            },\n                            {\n                                \"field\": \"Microsoft.Web/sites/httpsOnly\",\n                                \"equals\": \"false\"\n                            }\n                        ]\n                    }\n                ]\n            },\n            \"then\": {\n                \"effect\": \"[[parameters('effect')]\"\n            }\n        }\n    }\n}",
    "$fxv#128": "{\n    \"name\": \"Deny-Service-Endpoints\",\n    \"type\": \"Microsoft.Authorization/policyDefinitions\",\n    \"apiVersion\": \"2021-06-01\",\n    \"scope\": null,\n    \"properties\": {\n        \"policyType\": \"Custom\",\n        \"mode\": \"All\",\n        \"displayName\": \"Deny or Audit service endpoints on subnets\",\n        \"description\": \"This Policy will deny/audit Service Endpoints on subnets. Service Endpoints allows the network traffic to bypass Network appliances, such as the Azure Firewall.\",\n        \"metadata\": {\n            \"version\": \"1.0.0\",\n            \"category\": \"Network\",\n            \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n            \"alzCloudEnvironments\": [\n                \"AzureCloud\",\n                \"AzureChinaCloud\",\n                \"AzureUSGovernment\"\n            ]\n        },\n        \"parameters\": {\n            \"effect\": {\n                \"type\": \"String\",\n                \"allowedValues\": [\n                    \"Audit\",\n                    \"Deny\",\n                    \"Disabled\"\n                ],\n                \"defaultValue\": \"Deny\",\n                \"metadata\": {\n                    \"displayName\": \"Effect\",\n                    \"description\": \"Enable or disable the execution of the policy\"\n                }\n            }\n        },\n        \"policyRule\": {\n            \"if\": {\n                \"allOf\": [\n                    {\n                        \"field\": \"type\",\n                        \"equals\": \"Microsoft.Network/virtualNetworks/subnets\"\n                    },\n                    {\n                        \"count\": {\n                            \"field\": \"Microsoft.Network/virtualNetworks/subnets/serviceEndpoints[*]\",\n                            \"where\": {\n                                \"field\": \"Microsoft.Network/virtualNetworks/subnets/serviceEndpoints[*].service\",\n                                \"exists\": true\n                            }\n                        },\n                        \"greater\": 0\n                    }\n                ]\n            },\n            \"then\": {\n                \"effect\": \"[[parameters('effect')]\"\n            }\n        }\n    }\n}",
    "$fxv#129": "{\n    \"name\": \"Deny-Storage-ContainerDeleteRetentionPolicy\",\n    \"type\": \"Microsoft.Authorization/policyDefinitions\",\n    \"apiVersion\": \"2021-06-01\",\n    \"scope\": null,\n    \"properties\": {\n        \"policyType\": \"Custom\",\n        \"mode\": \"All\",\n        \"displayName\": \"Storage Accounts should use a container delete retention policy\",\n        \"description\": \"Enforce container delete retention policies larger than seven days for storage account. Enable this for increased data loss protection.\",\n        \"metadata\": {\n            \"version\": \"1.0.0\",\n            \"category\": \"Storage\",\n            \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n            \"alzCloudEnvironments\": [\n                \"AzureCloud\",\n                \"AzureChinaCloud\",\n                \"AzureUSGovernment\"\n            ]\n        },\n        \"parameters\": {\n            \"effect\": {\n                \"type\": \"String\",\n                \"allowedValues\": [\n                    \"Audit\",\n                    \"Deny\",\n                    \"Disabled\"\n                ],\n                \"defaultValue\": \"Deny\",\n                \"metadata\": {\n                    \"displayName\": \"Effect\",\n                    \"description\": \"Enable or disable the execution of the policy\"\n                }\n            },\n            \"minContainerDeleteRetentionInDays\": {\n                \"type\": \"Integer\",\n                \"metadata\": {\n                    \"displayName\": \"Minimum Container Delete Retention in Days\",\n                    \"description\": \"Specifies the minimum number of days for the container delete retention policy\"\n                },\n                \"defaultValue\": 7\n            }\n        },\n        \"policyRule\": {\n            \"if\": {\n                \"allOf\": [\n                    {\n                        \"field\": \"type\",\n                        \"equals\": \"Microsoft.Storage/storageAccounts/blobServices\"\n                    },\n                    {\n                        \"anyOf\": [\n                            {\n                                \"field\": \"Microsoft.Storage/storageAccounts/blobServices/containerDeleteRetentionPolicy.enabled\",\n                                \"exists\": false\n                            },\n                            {\n                                \"field\": \"Microsoft.Storage/storageAccounts/blobServices/containerDeleteRetentionPolicy.enabled\",\n                                \"notEquals\": true\n                            },\n                            {\n                                \"field\": \"Microsoft.Storage/storageAccounts/blobServices/containerDeleteRetentionPolicy.days\",\n                                \"less\": \"[[parameters('minContainerDeleteRetentionInDays')]\"\n                            }\n                        ]\n                    }\n                ]\n            },\n            \"then\": {\n                \"effect\": \"[[parameters('effect')]\"\n            }\n        }\n    }\n}",
    "$fxv#13": "{\n  \"name\": \"Deny-MySql-http\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"MySQL database servers enforce SSL connections.\",\n    \"description\": \"Azure Database for MySQL supports connecting your Azure Database for MySQL server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.\",\n    \"metadata\": {\n      \"version\": \"1.0.0\",\n      \"category\": \"SQL\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"Deny\",\n        \"allowedValues\": [\n          \"Audit\",\n          \"Disabled\",\n          \"Deny\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"minimalTlsVersion\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"TLS1_2\",\n        \"allowedValues\": [\n          \"TLS1_2\",\n          \"TLS1_0\",\n          \"TLS1_1\",\n          \"TLSEnforcementDisabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Select version minimum TLS for MySQL server\",\n          \"description\": \"Select version  minimum TLS version Azure Database for MySQL server to enforce\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.DBforMySQL/servers\"\n          },\n          {\n            \"anyOf\": [\n              {\n                \"field\": \"Microsoft.DBforMySQL/servers/sslEnforcement\",\n                \"exists\": \"false\"\n              },\n              {\n                \"field\": \"Microsoft.DBforMySQL/servers/sslEnforcement\",\n                \"notEquals\": \"Enabled\"\n              },\n              {\n                \"field\": \"Microsoft.DBforMySQL/servers/minimalTlsVersion\",\n                \"notequals\": \"[[parameters('minimalTlsVersion')]\"\n              }\n            ]\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\"\n      }\n    }\n  }\n}\n",
    "$fxv#130": "{\n    \"name\": \"Deny-Storage-CopyScope\",\n    \"type\": \"Microsoft.Authorization/policyDefinitions\",\n    \"apiVersion\": \"2021-06-01\",\n    \"scope\": null,\n    \"properties\": {\n        \"policyType\": \"Custom\",\n        \"mode\": \"All\",\n        \"displayName\": \"Allowed Copy scope should be restricted for Storage Accounts\",\n        \"description\": \"Azure Storage accounts should restrict the allowed copy scope. Enforce this for increased data exfiltration protection.\",\n        \"metadata\": {\n            \"version\": \"1.0.0\",\n            \"category\": \"Storage\",\n            \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n            \"alzCloudEnvironments\": [\n                \"AzureCloud\",\n                \"AzureChinaCloud\",\n                \"AzureUSGovernment\"\n            ]\n        },\n        \"parameters\": {\n            \"effect\": {\n                \"type\": \"String\",\n                \"allowedValues\": [\n                    \"Audit\",\n                    \"Deny\",\n                    \"Disabled\"\n                ],\n                \"defaultValue\": \"Deny\",\n                \"metadata\": {\n                    \"displayName\": \"Effect\",\n                    \"description\": \"Enable or disable the execution of the policy\"\n                }\n            },\n            \"allowedCopyScope\": {\n                \"type\": \"String\",\n                \"metadata\": {\n                    \"displayName\": \"Allowed Copy Scope\",\n                    \"description\": \"Specify the allowed copy scope.\"\n                },\n                \"allowedValues\": [\n                    \"AAD\",\n                    \"PrivateLink\"\n                ],\n                \"defaultValue\": \"AAD\"\n            }\n        },\n        \"policyRule\": {\n            \"if\": {\n                \"allOf\": [\n                    {\n                        \"field\": \"type\",\n                        \"equals\": \"Microsoft.Storage/storageAccounts\"\n                    },\n                    {\n                        \"anyOf\": [\n                            {\n                                \"field\": \"Microsoft.Storage/storageAccounts/allowedCopyScope\",\n                                \"exists\": \"false\"\n                            },\n                            {\n                                \"field\": \"Microsoft.Storage/storageAccounts/allowedCopyScope\",\n                                \"notEquals\": \"[[parameters('allowedCopyScope')]\"\n                            }\n                        ]\n                    }\n                ]\n            },\n            \"then\": {\n                \"effect\": \"[[parameters('effect')]\"\n            }\n        }\n    }\n}",
    "$fxv#131": "{\n    \"name\": \"Deny-Storage-CorsRules\",\n    \"type\": \"Microsoft.Authorization/policyDefinitions\",\n    \"apiVersion\": \"2021-06-01\",\n    \"scope\": null,\n    \"properties\": {\n        \"policyType\": \"Custom\",\n        \"mode\": \"All\",\n        \"displayName\": \"Storage Accounts should restrict CORS rules\",\n        \"description\": \"Deny CORS rules for storage account for increased data exfiltration protection and endpoint protection.\",\n        \"metadata\": {\n            \"version\": \"1.0.0\",\n            \"category\": \"Storage\",\n            \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n            \"alzCloudEnvironments\": [\n                \"AzureCloud\",\n                \"AzureChinaCloud\",\n                \"AzureUSGovernment\"\n            ]\n        },\n        \"parameters\": {\n            \"effect\": {\n                \"type\": \"String\",\n                \"allowedValues\": [\n                    \"Audit\",\n                    \"Deny\",\n                    \"Disabled\"\n                ],\n                \"defaultValue\": \"Deny\",\n                \"metadata\": {\n                    \"displayName\": \"Effect\",\n                    \"description\": \"Enable or disable the execution of the policy\"\n                }\n            }\n        },\n        \"policyRule\": {\n            \"if\": {\n                \"anyOf\": [\n                    {\n                        \"allOf\": [\n                            {\n                                \"field\": \"type\",\n                                \"equals\": \"Microsoft.Storage/storageAccounts/blobServices\"\n                            },\n                            {\n                                \"count\": {\n                                    \"field\": \"Microsoft.Storage/storageAccounts/blobServices/cors.corsRules[*]\"\n                                },\n                                \"greater\": 0\n                            }\n                        ]\n                    },\n                    {\n                        \"allOf\": [\n                            {\n                                \"field\": \"type\",\n                                \"equals\": \"Microsoft.Storage/storageAccounts/fileServices\"\n                            },\n                            {\n                                \"count\": {\n                                    \"field\": \"Microsoft.Storage/storageAccounts/fileServices/cors.corsRules[*]\"\n                                },\n                                \"greater\": 0\n                            }\n                        ]\n                    },\n                    {\n                        \"allOf\": [\n                            {\n                                \"field\": \"type\",\n                                \"equals\": \"Microsoft.Storage/storageAccounts/tableServices\"\n                            },\n                            {\n                                \"count\": {\n                                    \"field\": \"Microsoft.Storage/storageAccounts/tableServices/cors.corsRules[*]\"\n                                },\n                                \"greater\": 0\n                            }\n                        ]\n                    },\n                    {\n                        \"allOf\": [\n                            {\n                                \"field\": \"type\",\n                                \"equals\": \"Microsoft.Storage/storageAccounts/queueServices\"\n                            },\n                            {\n                                \"count\": {\n                                    \"field\": \"Microsoft.Storage/storageAccounts/queueServices/cors.corsRules[*]\"\n                                },\n                                \"greater\": 0\n                            }\n                        ]\n                    }\n                ]\n            },\n            \"then\": {\n                \"effect\": \"[[parameters('effect')]\"\n            }\n        }\n    }\n}",
    "$fxv#132": "{\n    \"name\": \"Deny-Storage-LocalUser\",\n    \"type\": \"Microsoft.Authorization/policyDefinitions\",\n    \"apiVersion\": \"2021-06-01\",\n    \"scope\": null,\n    \"properties\": {\n        \"policyType\": \"Custom\",\n        \"mode\": \"All\",\n        \"displayName\": \"Local users should be restricted for Storage Accounts\",\n        \"description\": \"Azure Storage accounts should disable local users for features like SFTP. Enforce this for increased data exfiltration protection.\",\n        \"metadata\": {\n            \"version\": \"1.0.0\",\n            \"category\": \"Storage\",\n            \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n            \"alzCloudEnvironments\": [\n                \"AzureCloud\",\n                \"AzureChinaCloud\",\n                \"AzureUSGovernment\"\n            ]\n        },\n        \"parameters\": {\n            \"effect\": {\n                \"type\": \"String\",\n                \"allowedValues\": [\n                    \"Audit\",\n                    \"Deny\",\n                    \"Disabled\"\n                ],\n                \"defaultValue\": \"Deny\",\n                \"metadata\": {\n                    \"displayName\": \"Effect\",\n                    \"description\": \"Enable or disable the execution of the policy\"\n                }\n            }\n        },\n        \"policyRule\": {\n            \"if\": {\n                \"allOf\": [\n                    {\n                        \"field\": \"type\",\n                        \"equals\": \"Microsoft.Storage/storageAccounts\"\n                    },\n                    {\n                        \"anyOf\": [\n                            {\n                                \"field\": \"Microsoft.Storage/storageAccounts/isLocalUserEnabled\",\n                                \"exists\": \"false\"\n                            },\n                            {\n                                \"field\": \"Microsoft.Storage/storageAccounts/isLocalUserEnabled\",\n                                \"notEquals\": false\n                            }\n                        ]\n                    }\n                ]\n            },\n            \"then\": {\n                \"effect\": \"[[parameters('effect')]\"\n            }\n        }\n    }\n}",
    "$fxv#133": "{\n    \"name\": \"Deny-Storage-NetworkAclsBypass\",\n    \"type\": \"Microsoft.Authorization/policyDefinitions\",\n    \"apiVersion\": \"2021-06-01\",\n    \"scope\": null,\n    \"properties\": {\n        \"policyType\": \"Custom\",\n        \"mode\": \"All\",\n        \"displayName\": \"Network ACL bypass option should be restricted for Storage Accounts\",\n        \"description\": \"Azure Storage accounts should restrict the bypass option for service-level network ACLs. Enforce this for increased data exfiltration protection.\",\n        \"metadata\": {\n            \"version\": \"1.0.0\",\n            \"category\": \"Storage\",\n            \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n            \"alzCloudEnvironments\": [\n                \"AzureCloud\",\n                \"AzureChinaCloud\",\n                \"AzureUSGovernment\"\n            ]\n        },\n        \"parameters\": {\n            \"effect\": {\n                \"type\": \"String\",\n                \"allowedValues\": [\n                    \"Audit\",\n                    \"Deny\",\n                    \"Disabled\"\n                ],\n                \"defaultValue\": \"Deny\",\n                \"metadata\": {\n                    \"displayName\": \"Effect\",\n                    \"description\": \"Enable or disable the execution of the policy\"\n                }\n            },\n            \"allowedBypassOptions\": {\n                \"type\": \"Array\",\n                \"metadata\": {\n                    \"displayName\": \"Allowed Bypass Options\",\n                    \"description\": \"Specifies which options are allowed to bypass the vnet configuration\"\n                },\n                \"allowedValues\": [\n                    \"None\",\n                    \"Logging\",\n                    \"Metrics\",\n                    \"AzureServices\",\n                    \"Logging, Metrics\",\n                    \"Logging, AzureServices\",\n                    \"Metrics, AzureServices\",\n                    \"Logging, Metrics, AzureServices\",\n                    \"Logging, Metrics, AzureServices\"\n                ],\n                \"defaultValue\": [\n                    \"Logging\",\n                    \"Metrics\",\n                    \"AzureServices\",\n                    \"Logging, Metrics\",\n                    \"Logging, AzureServices\",\n                    \"Metrics, AzureServices\",\n                    \"Logging, Metrics, AzureServices\",\n                    \"Logging, Metrics, AzureServices\"\n                ]\n            }\n        },\n        \"policyRule\": {\n            \"if\": {\n                \"allOf\": [\n                    {\n                        \"field\": \"type\",\n                        \"equals\": \"Microsoft.Storage/storageAccounts\"\n                    },\n                    {\n                        \"anyOf\": [\n                            {\n                                \"field\": \"Microsoft.Storage/storageAccounts/networkAcls.bypass\",\n                                \"exists\": \"false\"\n                            },\n                            {\n                                \"field\": \"Microsoft.Storage/storageAccounts/networkAcls.bypass\",\n                                \"notIn\": \"[[parameters('allowedBypassOptions')]\"\n                            }\n                        ]\n                    }\n                ]\n            },\n            \"then\": {\n                \"effect\": \"[[parameters('effect')]\"\n            }\n        }\n    }\n}",
    "$fxv#134": "{\n    \"name\": \"Deny-Storage-NetworkAclsVirtualNetworkRules\",\n    \"type\": \"Microsoft.Authorization/policyDefinitions\",\n    \"apiVersion\": \"2021-06-01\",\n    \"scope\": null,\n    \"properties\": {\n        \"policyType\": \"Custom\",\n        \"mode\": \"All\",\n        \"displayName\": \"Virtual network rules should be restricted for Storage Accounts\",\n        \"description\": \"Azure Storage accounts should restrict the virtual network service-level network ACLs. Enforce this for increased data exfiltration protection.\",\n        \"metadata\": {\n            \"version\": \"1.0.0\",\n            \"category\": \"Storage\",\n            \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n            \"alzCloudEnvironments\": [\n                \"AzureCloud\",\n                \"AzureChinaCloud\",\n                \"AzureUSGovernment\"\n            ]\n        },\n        \"parameters\": {\n            \"effect\": {\n                \"type\": \"String\",\n                \"allowedValues\": [\n                    \"Audit\",\n                    \"Deny\",\n                    \"Disabled\"\n                ],\n                \"defaultValue\": \"Deny\",\n                \"metadata\": {\n                    \"displayName\": \"Effect\",\n                    \"description\": \"Enable or disable the execution of the policy\"\n                }\n            }\n        },\n        \"policyRule\": {\n            \"if\": {\n                \"allOf\": [\n                    {\n                        \"field\": \"type\",\n                        \"equals\": \"Microsoft.Storage/storageAccounts\"\n                    },\n                    {\n                        \"count\": {\n                            \"field\": \"Microsoft.Storage/storageAccounts/networkAcls.virtualNetworkRules[*]\"\n                        },\n                        \"greater\": 0\n                    }\n                ]\n            },\n            \"then\": {\n                \"effect\": \"[[parameters('effect')]\"\n            }\n        }\n    }\n}",
    "$fxv#135": "{\n    \"name\": \"Deny-Storage-ResourceAccessRulesResourceId\",\n    \"type\": \"Microsoft.Authorization/policyDefinitions\",\n    \"apiVersion\": \"2021-06-01\",\n    \"scope\": null,\n    \"properties\": {\n        \"policyType\": \"Custom\",\n        \"mode\": \"All\",\n        \"displayName\": \"Resource Access Rules resource IDs should be restricted for Storage Accounts\",\n        \"description\": \"Azure Storage accounts should restrict the resource access rule for service-level network ACLs to services from a specific Azure subscription. Enforce this for increased data exfiltration protection.\",\n        \"metadata\": {\n            \"version\": \"1.0.0\",\n            \"category\": \"Storage\",\n            \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n            \"alzCloudEnvironments\": [\n                \"AzureCloud\",\n                \"AzureChinaCloud\",\n                \"AzureUSGovernment\"\n            ]\n        },\n        \"parameters\": {\n            \"effect\": {\n                \"type\": \"String\",\n                \"allowedValues\": [\n                    \"Audit\",\n                    \"Deny\",\n                    \"Disabled\"\n                ],\n                \"defaultValue\": \"Deny\",\n                \"metadata\": {\n                    \"displayName\": \"Effect\",\n                    \"description\": \"Enable or disable the execution of the policy\"\n                }\n            }\n        },\n        \"policyRule\": {\n            \"if\": {\n                \"allOf\": [\n                    {\n                        \"field\": \"type\",\n                        \"equals\": \"Microsoft.Storage/storageAccounts\"\n                    },\n                    {\n                        \"count\": {\n                            \"field\": \"Microsoft.Storage/storageAccounts/networkAcls.resourceAccessRules[*]\"\n                        },\n                        \"greater\": 0\n                    },\n                    {\n                        \"count\": {\n                            \"field\": \"Microsoft.Storage/storageAccounts/networkAcls.resourceAccessRules[*]\",\n                            \"where\": {\n                                \"value\": \"[[split(current('Microsoft.Storage/storageAccounts/networkAcls.resourceAccessRules[*].resourceId'), '/')[2]]\",\n                                \"equals\": \"*\"\n                            }\n                        },\n                        \"greater\": 0\n                    }\n                ]\n            },\n            \"then\": {\n                \"effect\": \"[[parameters('effect')]\"\n            }\n        }\n    }\n}",
    "$fxv#136": "{\n    \"name\": \"Deny-Storage-ResourceAccessRulesTenantId\",\n    \"type\": \"Microsoft.Authorization/policyDefinitions\",\n    \"apiVersion\": \"2021-06-01\",\n    \"scope\": null,\n    \"properties\": {\n        \"policyType\": \"Custom\",\n        \"mode\": \"All\",\n        \"displayName\": \"Resource Access Rules Tenants should be restricted for Storage Accounts\",\n        \"description\": \"Azure Storage accounts should restrict the resource access rule for service-level network ACLs to service from the same AAD tenant. Enforce this for increased data exfiltration protection.\",\n        \"metadata\": {\n            \"version\": \"1.0.0\",\n            \"category\": \"Storage\",\n            \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n            \"alzCloudEnvironments\": [\n                \"AzureCloud\",\n                \"AzureChinaCloud\",\n                \"AzureUSGovernment\"\n            ]\n        },\n        \"parameters\": {\n            \"effect\": {\n                \"type\": \"String\",\n                \"allowedValues\": [\n                    \"Audit\",\n                    \"Deny\",\n                    \"Disabled\"\n                ],\n                \"defaultValue\": \"Deny\",\n                \"metadata\": {\n                    \"displayName\": \"Effect\",\n                    \"description\": \"Enable or disable the execution of the policy\"\n                }\n            }\n        },\n        \"policyRule\": {\n            \"if\": {\n                \"allOf\": [\n                    {\n                        \"field\": \"type\",\n                        \"equals\": \"Microsoft.Storage/storageAccounts\"\n                    },\n                    {\n                        \"count\": {\n                            \"field\": \"Microsoft.Storage/storageAccounts/networkAcls.resourceAccessRules[*]\"\n                        },\n                        \"greater\": 0\n                    },\n                    {\n                        \"field\": \"Microsoft.Storage/storageAccounts/networkAcls.resourceAccessRules[*].tenantId\",\n                        \"notEquals\": \"[[subscription().tenantId]\"\n                    }\n                ]\n            },\n            \"then\": {\n                \"effect\": \"[[parameters('effect')]\"\n            }\n        }\n    }\n}",
    "$fxv#137": "{\n    \"name\": \"Deny-Storage-ServicesEncryption\",\n    \"type\": \"Microsoft.Authorization/policyDefinitions\",\n    \"apiVersion\": \"2021-06-01\",\n    \"scope\": null,\n    \"properties\": {\n        \"policyType\": \"Custom\",\n        \"mode\": \"All\",\n        \"displayName\": \"Encryption for storage services should be enforced for Storage Accounts\",\n        \"description\": \"Azure Storage accounts should enforce encryption for all storage services. Enforce this for increased encryption scope.\",\n        \"metadata\": {\n            \"version\": \"1.0.0\",\n            \"category\": \"Storage\",\n            \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n            \"alzCloudEnvironments\": [\n                \"AzureCloud\",\n                \"AzureChinaCloud\",\n                \"AzureUSGovernment\"\n            ]\n        },\n        \"parameters\": {\n            \"effect\": {\n                \"type\": \"String\",\n                \"allowedValues\": [\n                    \"Audit\",\n                    \"Deny\",\n                    \"Disabled\"\n                ],\n                \"defaultValue\": \"Deny\",\n                \"metadata\": {\n                    \"displayName\": \"Effect\",\n                    \"description\": \"Enable or disable the execution of the policy\"\n                }\n            }\n        },\n        \"policyRule\": {\n            \"if\": {\n                \"allOf\": [\n                    {\n                        \"field\": \"type\",\n                        \"equals\": \"Microsoft.Storage/storageAccounts\"\n                    },\n                    {\n                        \"anyOf\": [\n                            {\n                                \"anyOf\": [\n                                    {\n                                        \"field\": \"Microsoft.Storage/storageAccounts/encryption.services.blob.enabled\",\n                                        \"exists\": \"false\"\n                                    },\n                                    {\n                                        \"field\": \"Microsoft.Storage/storageAccounts/encryption.services.blob.enabled\",\n                                        \"notEquals\": true\n                                    }\n                                ]\n                            },\n                            {\n                                \"anyOf\": [\n                                    {\n                                        \"field\": \"Microsoft.Storage/storageAccounts/encryption.services.file.enabled\",\n                                        \"exists\": \"false\"\n                                    },\n                                    {\n                                        \"field\": \"Microsoft.Storage/storageAccounts/encryption.services.file.enabled\",\n                                        \"notEquals\": true\n                                    }\n                                ]\n                            },\n                            {\n                                \"anyOf\": [\n                                    {\n                                        \"field\": \"Microsoft.Storage/storageAccounts/encryption.services.queue.keyType\",\n                                        \"exists\": \"false\"\n                                    },\n                                    {\n                                        \"field\": \"Microsoft.Storage/storageAccounts/encryption.services.queue.keyType\",\n                                        \"notEquals\": \"Account\"\n                                    }\n                                ]\n                            },\n                            {\n                                \"anyOf\": [\n                                    {\n                                        \"field\": \"Microsoft.Storage/storageAccounts/encryption.services.table.keyType\",\n                                        \"exists\": \"false\"\n                                    },\n                                    {\n                                        \"field\": \"Microsoft.Storage/storageAccounts/encryption.services.table.keyType\",\n                                        \"notEquals\": \"Account\"\n                                    }\n                                ]\n                            }\n                        ]\n                    }\n                ]\n            },\n            \"then\": {\n                \"effect\": \"[[parameters('effect')]\"\n            }\n        }\n    }\n}",
    "$fxv#138": "{\n    \"name\": \"Deploy-LogicApp-TLS\",\n    \"type\": \"Microsoft.Authorization/policyDefinitions\",\n    \"apiVersion\": \"2021-06-01\",\n    \"scope\": null,\n    \"properties\": {\n        \"policyType\": \"Custom\",\n        \"mode\": \"Indexed\",\n        \"displayName\": \"Configure Logic apps to use the latest TLS version\",\n        \"description\": \"Periodically, newer versions are released for TLS either due to security flaws, include additional functionality, and enhance speed. Upgrade to the latest TLS version for Function apps to take advantage of security fixes, if any, and/or new functionalities of the latest version.\",\n        \"metadata\": {\n            \"version\": \"1.0.0\",\n            \"category\": \"Logic Apps\",\n            \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n            \"alzCloudEnvironments\": [\n                \"AzureCloud\",\n                \"AzureChinaCloud\",\n                \"AzureUSGovernment\"\n            ]\n        },\n        \"parameters\": {\n            \"effect\": {\n                \"type\": \"String\",\n                \"allowedValues\": [\n                    \"DeployIfNotExists\",\n                    \"Disabled\"\n                ],\n                \"defaultValue\": \"DeployIfNotExists\",\n                \"metadata\": {\n                    \"displayName\": \"Effect\",\n                    \"description\": \"Enable or disable the execution of the policy\"\n                }\n            }\n        },\n        \"policyRule\": {\n            \"if\": {\n                \"allOf\": [\n                    {\n                        \"field\": \"type\",\n                        \"equals\": \"Microsoft.Web/sites\"\n                    },\n                    {\n                        \"field\": \"kind\",\n                        \"contains\": \"workflowapp\"\n                    }\n                ]\n            },\n            \"then\": {\n                \"effect\": \"[[parameters('effect')]\",\n                \"details\": {\n                    \"type\": \"Microsoft.Web/sites/config\",\n                    \"name\": \"web\",\n                    \"existenceCondition\": {\n                        \"field\": \"Microsoft.Web/sites/config/minTlsVersion\",\n                        \"equals\": \"1.2\"\n                    },\n                    \"roleDefinitionIds\": [\n                        \"/providers/microsoft.authorization/roleDefinitions/de139f84-1756-47ae-9be6-808fbbe84772\"\n                    ],\n                    \"deployment\": {\n                        \"properties\": {\n                            \"mode\": \"incremental\",\n                            \"parameters\": {\n                                \"siteName\": {\n                                    \"value\": \"[[field('name')]\"\n                                }\n                            },\n                            \"template\": {\n                                \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n                                \"contentVersion\": \"1.0.0.0\",\n                                \"parameters\": {\n                                    \"siteName\": {\n                                        \"type\": \"string\"\n                                    }\n                                },\n                                \"variables\": {},\n                                \"resources\": [\n                                    {\n                                        \"type\": \"Microsoft.Web/sites/config\",\n                                        \"apiVersion\": \"2021-02-01\",\n                                        \"name\": \"[[concat(parameters('siteName'), '/web')]\",\n                                        \"properties\": {\n                                            \"minTlsVersion\": \"1.2\"\n                                        }\n                                    }\n                                ],\n                                \"outputs\": {}\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    }\n}",
    "$fxv#139": "{\n    \"name\": \"Modify-NSG\",\n    \"type\": \"Microsoft.Authorization/policyDefinitions\",\n    \"apiVersion\": \"2021-06-01\",\n    \"scope\": null,\n    \"properties\": {\n        \"policyType\": \"Custom\",\n        \"mode\": \"All\",\n        \"displayName\": \"Enforce specific configuration of Network Security Groups (NSG)\",\n        \"description\": \"This policy enforces the configuration of Network Security Groups (NSG).\",\n        \"metadata\": {\n            \"version\": \"1.0.0\",\n            \"category\": \"Network\",\n            \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n            \"alzCloudEnvironments\": [\n                \"AzureCloud\",\n                \"AzureChinaCloud\",\n                \"AzureUSGovernment\"\n            ]\n        },\n        \"parameters\": {\n            \"effect\": {\n                \"type\": \"String\",\n                \"allowedValues\": [\n                    \"Modify\",\n                    \"Disabled\"\n                ],\n                \"defaultValue\": \"Modify\",\n                \"metadata\": {\n                    \"displayName\": \"Effect\",\n                    \"description\": \"Enable or disable the execution of the policy\"\n                }\n            },\n            \"nsgRuleName\": {\n                \"type\": \"string\",\n                \"defaultValue\": \"DenyAnyInternetOutbound\"\n            },\n            \"nsgRulePriority\": {\n                \"type\": \"integer\",\n                \"defaultValue\": 1000\n            },\n            \"nsgRuleDirection\": {\n                \"type\": \"string\",\n                \"allowedValues\": [\n                    \"Inbound\",\n                    \"Outbound\"\n                ],\n                \"defaultValue\": \"Outbound\"\n            },\n            \"nsgRuleAccess\": {\n                \"type\": \"string\",\n                \"allowedValues\": [\n                    \"Allow\",\n                    \"Deny\"\n                ],\n                \"defaultValue\": \"Deny\"\n            },\n            \"nsgRuleProtocol\": {\n                \"type\": \"string\",\n                \"defaultValue\": \"*\"\n            },\n            \"nsgRuleSourceAddressPrefix\": {\n                \"type\": \"string\",\n                \"defaultValue\": \"*\"\n            },\n            \"nsgRuleSourcePortRange\": {\n                \"type\": \"string\",\n                \"defaultValue\": \"*\"\n            },\n            \"nsgRuleDestinationAddressPrefix\": {\n                \"type\": \"string\",\n                \"defaultValue\": \"Internet\"\n            },\n            \"nsgRuleDestinationPortRange\": {\n                \"type\": \"string\",\n                \"defaultValue\": \"*\"\n            },\n            \"nsgRuleDescription\": {\n                \"type\": \"string\",\n                \"defaultValue\": \"Deny any outbound traffic to the Internet\"\n            }\n        },\n        \"policyRule\": {\n            \"if\": {\n                \"allOf\": [\n                    {\n                        \"field\": \"type\",\n                        \"equals\": \"Microsoft.Network/networkSecurityGroups\"\n                    },\n                    {\n                        \"count\": {\n                            \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules[*]\"\n                        },\n                        \"equals\": 0\n                    }\n                ]\n            },\n            \"then\": {\n                \"effect\": \"[[parameters('effect')]\",\n                \"details\": {\n                    \"roleDefinitionIds\": [\n                        \"/providers/microsoft.authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"\n                    ],\n                    \"conflictEffect\": \"audit\",\n                    \"operations\": [\n                        {\n                            \"operation\": \"add\",\n                            \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules[*]\",\n                            \"value\": {\n                                \"name\": \"[[parameters('nsgRuleName')]\",\n                                \"properties\": {\n                                    \"description\": \"[[parameters('nsgRuleDescription')]\",\n                                    \"protocol\": \"[[parameters('nsgRuleProtocol')]\",\n                                    \"sourcePortRange\": \"[[parameters('nsgRuleSourcePortRange')]\",\n                                    \"destinationPortRange\": \"[[parameters('nsgRuleDestinationPortRange')]\",\n                                    \"sourceAddressPrefix\": \"[[parameters('nsgRuleSourceAddressPrefix')]\",\n                                    \"destinationAddressPrefix\": \"[[parameters('nsgRuleDestinationAddressPrefix')]\",\n                                    \"access\": \"[[parameters('nsgRuleAccess')]\",\n                                    \"priority\": \"[[parameters('nsgRulePriority')]\",\n                                    \"direction\": \"[[parameters('nsgRuleDirection')]\"\n                                }\n                            }\n                        }\n                    ]\n                }\n            }\n        }\n    }\n}",
    "$fxv#14": "{\n  \"name\": \"Deny-PostgreSql-http\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"PostgreSQL database servers enforce SSL connection.\",\n    \"description\": \"Azure Database for PostgreSQL supports connecting your Azure Database for PostgreSQL server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.\",\n    \"metadata\": {\n      \"version\": \"1.0.1\",\n      \"category\": \"SQL\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"Deny\",\n        \"allowedValues\": [\n          \"Audit\",\n          \"Disabled\",\n          \"Deny\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"minimalTlsVersion\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"TLS1_2\",\n        \"allowedValues\": [\n          \"TLS1_2\",\n          \"TLS1_0\",\n          \"TLS1_1\",\n          \"TLSEnforcementDisabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Select version minimum TLS for PostgreSQL server\",\n          \"description\": \"Select version  minimum TLS version Azure Database for PostgreSQL server to enforce\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.DBforPostgreSQL/servers\"\n          },\n          {\n            \"anyOf\": [\n              {\n                \"field\": \"Microsoft.DBforPostgreSQL/servers/sslEnforcement\",\n                \"exists\": \"false\"\n              },\n              {\n                \"field\": \"Microsoft.DBforPostgreSQL/servers/sslEnforcement\",\n                \"notEquals\": \"Enabled\"\n              },\n              {\n                \"field\": \"Microsoft.DBforPostgreSQL/servers/minimalTlsVersion\",\n                \"notequals\": \"[[parameters('minimalTlsVersion')]\"\n              }\n            ]\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\"\n      }\n    }\n  }\n}\n",
    "$fxv#140": "{\n    \"name\": \"Modify-UDR\",\n    \"type\": \"Microsoft.Authorization/policyDefinitions\",\n    \"apiVersion\": \"2021-06-01\",\n    \"scope\": null,\n    \"properties\": {\n        \"policyType\": \"Custom\",\n        \"mode\": \"All\",\n        \"displayName\": \"Enforce specific configuration of User-Defined Routes (UDR)\",\n        \"description\": \"This policy enforces the configuration of User-Defined Routes (UDR) within a subnet.\",\n        \"metadata\": {\n            \"version\": \"1.0.0\",\n            \"category\": \"Network\",\n            \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n            \"alzCloudEnvironments\": [\n                \"AzureCloud\",\n                \"AzureChinaCloud\",\n                \"AzureUSGovernment\"\n            ]\n        },\n        \"parameters\": {\n            \"effect\": {\n                \"type\": \"String\",\n                \"allowedValues\": [\n                    \"Modify\",\n                    \"Disabled\"\n                ],\n                \"defaultValue\": \"Modify\",\n                \"metadata\": {\n                    \"displayName\": \"Effect\",\n                    \"description\": \"Enable or disable the execution of the policy\"\n                }\n            },\n            \"addressPrefix\": {\n                \"type\": \"string\",\n                \"metadata\": {\n                    \"description\": \"The destination IP address range in CIDR notation that this Policy checks for within the UDR. Example: 0.0.0.0/0 to check for the presence of a default route.\",\n                    \"displayName\": \"Address Prefix\"\n                }\n            },\n            \"nextHopType\": {\n                \"type\": \"string\",\n                \"metadata\": {\n                    \"description\": \"The next hope type that the policy checks for within the inspected route. The value can be Virtual Network, Virtual Network Gateway, Internet, Virtual Appliance, or None.\",\n                    \"displayName\": \"Next Hop Type\"\n                },\n                \"allowedValues\": [\n                    \"VnetLocal\",\n                    \"VirtualNetworkGateway\",\n                    \"Internet\",\n                    \"VirtualAppliance\",\n                    \"None\"\n                ]\n            },\n            \"nextHopIpAddress\": {\n                \"type\": \"string\",\n                \"metadata\": {\n                    \"description\": \"The IP address packets should be forwarded to.\",\n                    \"displayName\": \"Next Hop IP Address\"\n                }\n            }\n        },\n        \"policyRule\": {\n            \"if\": {\n                \"allOf\": [\n                    {\n                        \"field\": \"type\",\n                        \"equals\": \"Microsoft.Network/routeTables\"\n                    },\n                    {\n                        \"count\": {\n                            \"field\": \"Microsoft.Network/routeTables/routes[*]\"\n                        },\n                        \"equals\": 0\n                    }\n                ]\n            },\n            \"then\": {\n                \"effect\": \"[[parameters('effect')]\",\n                \"details\": {\n                    \"roleDefinitionIds\": [\n                        \"/providers/microsoft.authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"\n                    ],\n                    \"conflictEffect\": \"audit\",\n                    \"operations\": [\n                        {\n                            \"operation\": \"add\",\n                            \"field\": \"Microsoft.Network/routeTables/routes[*]\",\n                            \"value\": {\n                                \"name\": \"default\",\n                                \"properties\": {\n                                    \"addressPrefix\": \"[[parameters('addressPrefix')]\",\n                                    \"nextHopType\": \"[[parameters('nextHopType')]\",\n                                    \"nextHopIpAddress\": \"[[parameters('nextHopIpAddress')]\"\n                                }\n                            }\n                        }\n                    ]\n                }\n            }\n        }\n    }\n}",
    "$fxv#141": "{\n    \"name\": \"Deploy-Private-DNS-Generic\",\n    \"type\": \"Microsoft.Authorization/policyDefinitions\",\n    \"apiVersion\": \"2021-06-01\",\n    \"scope\": null,\n    \"properties\": {\n        \"policyType\": \"Custom\",\n        \"mode\": \"All\",\n        \"displayName\": \"Deploy-Private-DNS-Generic\",\n        \"description\": \"Configure private DNS zone group to override the DNS resolution for PaaS services private endpoint. See https://aka.ms/pepdnszones for information on values to provide to parameters in this policy.\",\n        \"metadata\": {\n            \"version\": \"1.0.0\",\n            \"category\": \"Networking\",\n            \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n            \"alzCloudEnvironments\": [\n                \"AzureCloud\",\n        \t\"AzureChinaCloud\",\n       \t\t\"AzureUSGovernment\"\n            ]\n        },\n        \"parameters\": {\n            \"effect\": {\n                \"type\": \"String\",\n                \"metadata\": {\n                    \"displayName\": \"Effect\",\n                    \"description\": \"Enable or disable the execution of the policy\"\n                },\n                \"allowedValues\": [\n                    \"DeployIfNotExists\",\n                    \"Disabled\"\n                ],\n                \"defaultValue\": \"DeployIfNotExists\"\n            },\n            \"privateDnsZoneId\": {\n                \"type\": \"String\",\n                \"metadata\": {\n                    \"displayName\": \"Private DNS Zone ID for Paas services\",\n                    \"description\": \"The private DNS zone name required for specific Paas Services to resolve a private DNS Zone.\",\n                    \"strongType\": \"Microsoft.Network/privateDnsZones\",\n                    \"assignPermissions\": true\n                }\n            },\n            \"resourceType\": {\n                \"type\": \"String\",\n                \"metadata\": {\n                    \"displayName\": \"PaaS private endpoint resource type\",\n                    \"description\": \"The PaaS endpoint resource type.\"\n                }\n            },\n            \"groupId\": {\n                \"type\": \"String\",\n                \"metadata\": {\n                    \"displayName\": \"PaaS Private endpoint group ID (subresource)\",\n                    \"description\": \"The group ID of the PaaS private endpoint. Also referred to as subresource.\"\n                }\n            },\n            \"evaluationDelay\": {\n                \"type\": \"String\",\n                \"metadata\": {\n                    \"displayName\": \"Evaluation Delay\",\n                    \"description\": \"The delay in evaluation of the policy. Review delay options at https://learn.microsoft.com/en-us/azure/governance/policy/concepts/effect-deploy-if-not-exists\"\n                },\n                \"defaultValue\": \"PT10M\"\n            }\n        },\n        \"policyRule\": {\n            \"if\": {\n                \"allOf\": [\n                    {\n                        \"field\": \"type\",\n                        \"equals\": \"Microsoft.Network/privateEndpoints\"\n                    },\n                    {\n                        \"count\": {\n                            \"field\": \"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*]\",\n                            \"where\": {\n                                \"allOf\": [\n                                    {\n                                        \"field\": \"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId\",\n                                        \"contains\": \"[[parameters('resourceType')]\"\n                                    },\n                                    {\n                                        \"field\": \"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\n                                        \"equals\": \"[[parameters('groupId')]\"\n                                    }\n                                ]\n                            }\n                        },\n                        \"greaterOrEquals\": 1\n                    }\n                ]\n            },\n            \"then\": {\n                \"effect\": \"[[parameters('effect')]\",\n                \"details\": {\n                    \"type\": \"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\",\n                    \"evaluationDelay\": \"[[parameters('evaluationDelay')]\",\n                    \"roleDefinitionIds\": [\n                        \"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"\n                    ],\n                    \"deployment\": {\n                        \"properties\": {\n                            \"mode\": \"incremental\",\n                            \"template\": {\n                                \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n                                \"contentVersion\": \"1.0.0.0\",\n                                \"parameters\": {\n                                    \"privateDnsZoneId\": {\n                                        \"type\": \"string\"\n                                    },\n                                    \"privateEndpointName\": {\n                                        \"type\": \"string\"\n                                    },\n                                    \"location\": {\n                                        \"type\": \"string\"\n                                    }\n                                },\n                                \"resources\": [\n                                    {\n                                        \"name\": \"[[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\n                                        \"type\": \"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\",\n                                        \"apiVersion\": \"2020-03-01\",\n                                        \"location\": \"[[parameters('location')]\",\n                                        \"properties\": {\n                                            \"privateDnsZoneConfigs\": [\n                                                {\n                                                    \"name\": \"PaaS-Service-Private-DNS-Zone-Config\",\n                                                    \"properties\": {\n                                                        \"privateDnsZoneId\": \"[[parameters('privateDnsZoneId')]\"\n                                                    }\n                                                }\n                                            ]\n                                        }\n                                    }\n                                ]\n                            },\n                            \"parameters\": {\n                                \"privateDnsZoneId\": {\n                                    \"value\": \"[[parameters('privateDnsZoneId')]\"\n                                },\n                                \"privateEndpointName\": {\n                                    \"value\": \"[[field('name')]\"\n                                },\n                                \"location\": {\n                                    \"value\": \"[[field('location')]\"\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    }\n}\n",
    "$fxv#142": "{\n  \"name\": \"DenyAction-DeleteResources\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Do not allow deletion of specified resource and resource type\",\n    \"description\": \"This policy enables you to specify the resource and resource type that your organization can protect from accidentals deletion by blocking delete calls using the deny action effect.\",\n    \"metadata\": {\n      \"version\": \"1.0.0\",\n      \"category\": \"General\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n          \"AzureCloud\",\n          \"AzureChinaCloud\",\n          \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"resourceName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Resource Name\",\n          \"description\": \"Provide the name of the resource that you want to protect from accidental deletion.\"\n        }\n      },\n      \"resourceType\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Resource Type\",\n          \"description\": \"Provide the resource type that you want to protect from accidental deletion.\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        },\n        \"allowedValues\": [\n          \"DenyAction\",\n          \"Disabled\"\n        ],\n        \"defaultValue\": \"DenyAction\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"[[parameters('resourceType')]\"\n          },\n          {\n            \"field\": \"name\",\n            \"like\": \"[[parameters('resourceName')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"actionNames\": [\n            \"delete\"\n          ]\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#143": "{\n  \"name\": \"Audit-MachineLearning-PrivateEndpointId\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"Control private endpoint connections to Azure Machine Learning\",\n    \"description\": \"Audit private endpoints that are created in other subscriptions and/or tenants for Azure Machine Learning.\",\n    \"metadata\": {\n      \"version\": \"1.0.0\",\n      \"category\": \"Machine Learning\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        },\n        \"allowedValues\": [\n          \"Audit\",\n          \"Deny\",\n          \"Disabled\"\n        ],\n        \"defaultValue\": \"Audit\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.MachineLearningServices/workspaces/privateEndpointConnections\"\n          },\n          {\n            \"field\": \"Microsoft.MachineLearningServices/workspaces/privateEndpointConnections/privateLinkServiceConnectionState.status\",\n            \"equals\": \"Approved\"\n          },\n          {\n            \"anyOf\": [\n              {\n                \"field\": \"Microsoft.MachineLearningServices/workspaces/privateEndpointConnections/privateEndpoint.id\",\n                \"exists\": false\n              },\n              {\n                \"value\": \"[[split(concat(field('Microsoft.MachineLearningServices/workspaces/privateEndpointConnections/privateEndpoint.id'), '//'), '/')[2]]\",\n                \"notEquals\": \"[[subscription().subscriptionId]\"\n              }\n            ]\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\"\n      }\n    }\n  }\n}\n",
    "$fxv#144": "{\n  \"name\": \"Deny-AA-child-resources\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"No child resources in Automation Account\",\n    \"description\": \"This policy denies the creation of child resources on the Automation Account\",\n    \"metadata\": {\n      \"version\": \"1.0.0\",\n      \"category\": \"Automation\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"allowedValues\": [\n          \"Audit\",\n          \"Deny\",\n          \"Disabled\"\n        ],\n        \"defaultValue\": \"Deny\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"in\": [\n              \"Microsoft.Automation/automationAccounts/runbooks\",\n              \"Microsoft.Automation/automationAccounts/variables\",\n              \"Microsoft.Automation/automationAccounts/modules\",\n              \"Microsoft.Automation/automationAccounts/credentials\",\n              \"Microsoft.Automation/automationAccounts/connections\",\n              \"Microsoft.Automation/automationAccounts/certificates\"\n            ]\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\"\n      }\n    }\n  }\n}\n",
    "$fxv#145": "{\n  \"name\": \"Deny-Databricks-NoPublicIp\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"Deny public IPs for Databricks cluster\",\n    \"description\": \"Denies the deployment of workspaces that do not use the noPublicIp feature to host Databricks clusters without public IPs.\",\n    \"metadata\": {\n      \"version\": \"1.0.0\",\n      \"category\": \"Databricks\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        },\n        \"allowedValues\": [\n          \"Audit\",\n          \"Disabled\",\n          \"Deny\"\n        ],\n        \"defaultValue\": \"Deny\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Databricks/workspaces\"\n          },\n          {\n            \"field\": \"Microsoft.DataBricks/workspaces/parameters.enableNoPublicIp.value\",\n            \"notEquals\": true\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\"\n      }\n    }\n  }\n}\n",
    "$fxv#146": "{\n  \"name\": \"Deny-Databricks-Sku\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"Deny non-premium Databricks sku\",\n    \"description\": \"Enforces the use of Premium Databricks workspaces to make sure appropriate security features are available including Databricks Access Controls, Credential Passthrough and SCIM provisioning for Microsoft Entra ID.\",\n    \"metadata\": {\n      \"version\": \"1.0.0\",\n      \"category\": \"Databricks\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        },\n        \"allowedValues\": [\n          \"Audit\",\n          \"Disabled\",\n          \"Deny\"\n        ],\n        \"defaultValue\": \"Deny\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Databricks/workspaces\"\n          },\n          {\n            \"field\": \"Microsoft.DataBricks/workspaces/sku.name\",\n            \"notEquals\": \"premium\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\"\n      }\n    }\n  }\n}",
    "$fxv#147": "{\n  \"name\": \"Deny-Databricks-VirtualNetwork\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"Deny Databricks workspaces without Vnet injection\",\n    \"description\": \"Enforces the use of vnet injection for Databricks workspaces.\",\n    \"metadata\": {\n      \"version\": \"1.0.0\",\n      \"category\": \"Databricks\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        },\n        \"allowedValues\": [\n          \"Audit\",\n          \"Disabled\",\n          \"Deny\"\n        ],\n        \"defaultValue\": \"Deny\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Databricks/workspaces\"\n          },\n          {\n            \"anyOf\": [\n              {\n                \"field\": \"Microsoft.DataBricks/workspaces/parameters.customVirtualNetworkId.value\",\n                \"exists\": false\n              },\n              {\n                \"field\": \"Microsoft.DataBricks/workspaces/parameters.customPublicSubnetName.value\",\n                \"exists\": false\n              },\n              {\n                \"field\": \"Microsoft.DataBricks/workspaces/parameters.customPrivateSubnetName.value\",\n                \"exists\": false\n              }\n            ]\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\"\n      }\n    }\n  }\n}\n",
    "$fxv#148": "{\n  \"name\": \"Deny-MachineLearning-Aks\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"Deny AKS cluster creation in Azure Machine Learning\",\n    \"description\": \"Deny AKS cluster creation in Azure Machine Learning and enforce connecting to existing clusters.\",\n    \"metadata\": {\n      \"version\": \"1.0.0\",\n      \"category\": \"Machine Learning\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        },\n        \"allowedValues\": [\n          \"Audit\",\n          \"Disabled\",\n          \"Deny\"\n        ],\n        \"defaultValue\": \"Deny\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.MachineLearningServices/workspaces/computes\"\n          },\n          {\n            \"field\": \"Microsoft.MachineLearningServices/workspaces/computes/computeType\",\n            \"equals\": \"AKS\"\n          },\n          {\n            \"anyOf\": [\n              {\n                \"field\": \"Microsoft.MachineLearningServices/workspaces/computes/resourceId\",\n                \"exists\": false\n              },\n              {\n                \"value\": \"[[empty(field('Microsoft.MachineLearningServices/workspaces/computes/resourceId'))]\",\n                \"equals\": true\n              }\n            ]\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\"\n      }\n    }\n  }\n}\n",
    "$fxv#149": "{\n  \"name\": \"Deny-MachineLearning-Compute-SubnetId\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"Enforce subnet connectivity for Azure Machine Learning compute clusters and compute instances\",\n    \"description\": \"Enforce subnet connectivity for Azure Machine Learning compute clusters and compute instances.\",\n    \"metadata\": {\n      \"version\": \"1.0.0\",\n      \"category\": \"Machine Learning\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        },\n        \"allowedValues\": [\n          \"Audit\",\n          \"Disabled\",\n          \"Deny\"\n        ],\n        \"defaultValue\": \"Deny\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.MachineLearningServices/workspaces/computes\"\n          },\n          {\n            \"field\": \"Microsoft.MachineLearningServices/workspaces/computes/computeType\",\n            \"in\": [\n              \"AmlCompute\",\n              \"ComputeInstance\"\n            ]\n          },\n          {\n            \"anyOf\": [\n              {\n                \"field\": \"Microsoft.MachineLearningServices/workspaces/computes/subnet.id\",\n                \"exists\": false\n              },\n              {\n                \"value\": \"[[empty(field('Microsoft.MachineLearningServices/workspaces/computes/subnet.id'))]\",\n                \"equals\": true\n              }\n            ]\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\"\n      }\n    }\n  }\n}\n",
    "$fxv#15": "{\n  \"name\": \"Deny-Private-DNS-Zones\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"Deny the creation of private DNS\",\n    \"description\": \"This policy denies the creation of a private DNS in the current scope, used in combination with policies that create centralized private DNS in connectivity subscription\",\n    \"metadata\": {\n      \"version\": \"1.0.0\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"allowedValues\": [\n          \"Audit\",\n          \"Deny\",\n          \"Disabled\"\n        ],\n        \"defaultValue\": \"Deny\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.Network/privateDnsZones\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\"\n      }\n    }\n  }\n}\n",
    "$fxv#150": "{\n  \"name\": \"Deny-MachineLearning-Compute-VmSize\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"Limit allowed vm sizes for Azure Machine Learning compute clusters and compute instances\",\n    \"description\": \"Limit allowed vm sizes for Azure Machine Learning compute clusters and compute instances.\",\n    \"metadata\": {\n      \"version\": \"1.0.0\",\n      \"category\": \"Budget\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        },\n        \"allowedValues\": [\n          \"Audit\",\n          \"Disabled\",\n          \"Deny\"\n        ],\n        \"defaultValue\": \"Deny\"\n      },\n      \"allowedVmSizes\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"Allowed VM Sizes for Aml Compute Clusters and Instances\",\n          \"description\": \"Specifies the allowed VM Sizes for Aml Compute Clusters and Instances\"\n        },\n        \"defaultValue\": [\n          \"Standard_D1_v2\",\n          \"Standard_D2_v2\",\n          \"Standard_D3_v2\",\n          \"Standard_D4_v2\",\n          \"Standard_D11_v2\",\n          \"Standard_D12_v2\",\n          \"Standard_D13_v2\",\n          \"Standard_D14_v2\",\n          \"Standard_DS1_v2\",\n          \"Standard_DS2_v2\",\n          \"Standard_DS3_v2\",\n          \"Standard_DS4_v2\",\n          \"Standard_DS5_v2\",\n          \"Standard_DS11_v2\",\n          \"Standard_DS12_v2\",\n          \"Standard_DS13_v2\",\n          \"Standard_DS14_v2\",\n          \"Standard_M8-2ms\",\n          \"Standard_M8-4ms\",\n          \"Standard_M8ms\",\n          \"Standard_M16-4ms\",\n          \"Standard_M16-8ms\",\n          \"Standard_M16ms\",\n          \"Standard_M32-8ms\",\n          \"Standard_M32-16ms\",\n          \"Standard_M32ls\",\n          \"Standard_M32ms\",\n          \"Standard_M32ts\",\n          \"Standard_M64-16ms\",\n          \"Standard_M64-32ms\",\n          \"Standard_M64ls\",\n          \"Standard_M64ms\",\n          \"Standard_M64s\",\n          \"Standard_M128-32ms\",\n          \"Standard_M128-64ms\",\n          \"Standard_M128ms\",\n          \"Standard_M128s\",\n          \"Standard_M64\",\n          \"Standard_M64m\",\n          \"Standard_M128\",\n          \"Standard_M128m\",\n          \"Standard_D1\",\n          \"Standard_D2\",\n          \"Standard_D3\",\n          \"Standard_D4\",\n          \"Standard_D11\",\n          \"Standard_D12\",\n          \"Standard_D13\",\n          \"Standard_D14\",\n          \"Standard_DS15_v2\",\n          \"Standard_NV6\",\n          \"Standard_NV12\",\n          \"Standard_NV24\",\n          \"Standard_F2s_v2\",\n          \"Standard_F4s_v2\",\n          \"Standard_F8s_v2\",\n          \"Standard_F16s_v2\",\n          \"Standard_F32s_v2\",\n          \"Standard_F64s_v2\",\n          \"Standard_F72s_v2\",\n          \"Standard_NC6s_v3\",\n          \"Standard_NC12s_v3\",\n          \"Standard_NC24rs_v3\",\n          \"Standard_NC24s_v3\",\n          \"Standard_NC6\",\n          \"Standard_NC12\",\n          \"Standard_NC24\",\n          \"Standard_NC24r\",\n          \"Standard_ND6s\",\n          \"Standard_ND12s\",\n          \"Standard_ND24rs\",\n          \"Standard_ND24s\",\n          \"Standard_NC6s_v2\",\n          \"Standard_NC12s_v2\",\n          \"Standard_NC24rs_v2\",\n          \"Standard_NC24s_v2\",\n          \"Standard_ND40rs_v2\",\n          \"Standard_NV12s_v3\",\n          \"Standard_NV24s_v3\",\n          \"Standard_NV48s_v3\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.MachineLearningServices/workspaces/computes\"\n          },\n          {\n            \"field\": \"Microsoft.MachineLearningServices/workspaces/computes/computeType\",\n            \"in\": [\n              \"AmlCompute\",\n              \"ComputeInstance\"\n            ]\n          },\n          {\n            \"field\": \"Microsoft.MachineLearningServices/workspaces/computes/vmSize\",\n            \"notIn\": \"[[parameters('allowedVmSizes')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\"\n      }\n    }\n  }\n}\n",
    "$fxv#151": "{\n  \"name\": \"Deny-MachineLearning-ComputeCluster-RemoteLoginPortPublicAccess\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deny public access of Azure Machine Learning clusters via SSH\",\n    \"description\": \"Deny public access of Azure Machine Learning clusters via SSH.\",\n    \"metadata\": {\n      \"version\": \"1.1.0\",\n      \"category\": \"Machine Learning\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        },\n        \"allowedValues\": [\n          \"Audit\",\n          \"Disabled\",\n          \"Deny\"\n        ],\n        \"defaultValue\": \"Deny\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.MachineLearningServices/workspaces/computes\"\n          },\n          {\n            \"field\": \"Microsoft.MachineLearningServices/workspaces/computes/computeType\",\n            \"equals\": \"AmlCompute\"\n          },\n          {\n            \"anyOf\": [\n              {\n                \"field\": \"Microsoft.MachineLearningServices/workspaces/computes/remoteLoginPortPublicAccess\",\n                \"exists\": false\n              },\n              {\n                \"field\": \"Microsoft.MachineLearningServices/workspaces/computes/remoteLoginPortPublicAccess\",\n                \"notEquals\": \"Disabled\"\n              }\n            ]\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\"\n      }\n    }\n  }\n}\n",
    "$fxv#152": "{\n  \"name\": \"Deny-MachineLearning-ComputeCluster-Scale\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"Enforce scale settings for Azure Machine Learning compute clusters\",\n    \"description\": \"Enforce scale settings for Azure Machine Learning compute clusters.\",\n    \"metadata\": {\n      \"version\": \"1.0.0\",\n      \"category\": \"Budget\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        },\n        \"allowedValues\": [\n          \"Audit\",\n          \"Disabled\",\n          \"Deny\"\n        ],\n        \"defaultValue\": \"Deny\"\n      },\n      \"maxNodeCount\": {\n        \"type\": \"Integer\",\n        \"metadata\": {\n          \"displayName\": \"Maximum Node Count\",\n          \"description\": \"Specifies the maximum node count of AML Clusters\"\n        },\n        \"defaultValue\": 10\n      },\n      \"minNodeCount\": {\n        \"type\": \"Integer\",\n        \"metadata\": {\n          \"displayName\": \"Minimum Node Count\",\n          \"description\": \"Specifies the minimum node count of AML Clusters\"\n        },\n        \"defaultValue\": 0\n      },\n      \"maxNodeIdleTimeInSecondsBeforeScaleDown\": {\n        \"type\": \"Integer\",\n        \"metadata\": {\n          \"displayName\": \"Maximum Node Idle Time in Seconds Before Scaledown\",\n          \"description\": \"Specifies the maximum node idle time in seconds before scaledown\"\n        },\n        \"defaultValue\": 900\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.MachineLearningServices/workspaces/computes\"\n          },\n          {\n            \"field\": \"Microsoft.MachineLearningServices/workspaces/computes/computeType\",\n            \"equals\": \"AmlCompute\"\n          },\n          {\n            \"anyOf\": [\n              {\n                \"field\": \"Microsoft.MachineLearningServices/workspaces/computes/scaleSettings.maxNodeCount\",\n                \"greater\": \"[[parameters('maxNodeCount')]\"\n              },\n              {\n                \"field\": \"Microsoft.MachineLearningServices/workspaces/computes/scaleSettings.minNodeCount\",\n                \"greater\": \"[[parameters('minNodeCount')]\"\n              },\n              {\n                \"value\": \"[[int(last(split(replace(replace(replace(replace(replace(replace(replace(field('Microsoft.MachineLearningServices/workspaces/computes/scaleSettings.nodeIdleTimeBeforeScaleDown'), 'P', '/'), 'Y', '/'), 'M', '/'), 'D', '/'), 'T', '/'), 'H', '/'), 'S', ''), '/')))]\",\n                \"greater\": \"[[parameters('maxNodeIdleTimeInSecondsBeforeScaleDown')]\"\n              }\n            ]\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\"\n      }\n    }\n  }\n}\n",
    "$fxv#153": "{\n  \"name\": \"Deny-MachineLearning-HbiWorkspace\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"Enforces high business impact Azure Machine Learning Workspaces\",\n    \"description\": \"Enforces high business impact Azure Machine Learning workspaces.\",\n    \"metadata\": {\n      \"version\": \"1.0.0\",\n      \"category\": \"Machine Learning\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        },\n        \"allowedValues\": [\n          \"Audit\",\n          \"Disabled\",\n          \"Deny\"\n        ],\n        \"defaultValue\": \"Deny\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.MachineLearningServices/workspaces\"\n          },\n          {\n            \"anyOf\": [\n              {\n                \"field\": \"Microsoft.MachineLearningServices/workspaces/hbiWorkspace\",\n                \"exists\": false\n              },\n              {\n                \"field\": \"Microsoft.MachineLearningServices/workspaces/hbiWorkspace\",\n                \"notEquals\": true\n              }\n            ]\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\"\n      }\n    }\n  }\n}\n",
    "$fxv#154": "{\n  \"name\": \"Deny-MachineLearning-PublicAccessWhenBehindVnet\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"Deny public access behind vnet to Azure Machine Learning workspace\",\n    \"description\": \"Deny public access behind vnet to Azure Machine Learning workspaces.\",\n    \"metadata\": {\n      \"version\": \"1.0.1\",\n      \"category\": \"Machine Learning\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        },\n        \"allowedValues\": [\n          \"Audit\",\n          \"Disabled\",\n          \"Deny\"\n        ],\n        \"defaultValue\": \"Deny\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.MachineLearningServices/workspaces\"\n          },\n          {\n            \"anyOf\": [\n              {\n                \"field\": \"Microsoft.MachineLearningServices/workspaces/allowPublicAccessWhenBehindVnet\",\n                \"exists\": false\n              },\n              {\n                \"field\": \"Microsoft.MachineLearningServices/workspaces/allowPublicAccessWhenBehindVnet\",\n                \"notEquals\": false\n              }\n            ]\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\"\n      }\n    }\n  }\n}\n",
    "$fxv#155": "{\n  \"name\": \"Deny-MachineLearning-PublicNetworkAccess\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated] Azure Machine Learning should have disabled public network access\",\n    \"description\": \"Denies public network access for Azure Machine Learning workspaces. Superseded by https://www.azadvertizer.net/azpolicyadvertizer/438c38d2-3772-465a-a9cc-7a6666a275ce.html\",\n    \"metadata\": {\n      \"version\": \"1.0.0-deprecated\",\n      \"category\": \"Machine Learning\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"deprecated\": true,\n      \"supersededBy\": \"438c38d2-3772-465a-a9cc-7a6666a275ce\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        },\n        \"allowedValues\": [\n          \"Audit\",\n          \"Disabled\",\n          \"Deny\"\n        ],\n        \"defaultValue\": \"Deny\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.MachineLearningServices/workspaces\"\n          },\n          {\n            \"field\": \"Microsoft.MachineLearningServices/workspaces/publicNetworkAccess\",\n            \"notEquals\": \"Disabled\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\"\n      }\n    }\n  }\n}\n",
    "$fxv#156": "{\n  \"name\": \"Deploy-Budget\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy a default budget on all subscriptions under the assigned scope\",\n    \"description\": \"Deploy a default budget on all subscriptions under the assigned scope\",\n    \"metadata\": {\n      \"version\": \"1.1.0\",\n      \"category\": \"Budget\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"AuditIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"budgetName\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"budget-set-by-policy\",\n        \"metadata\": {\n          \"description\": \"The name for the budget to be created\"\n        }\n      },\n      \"amount\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"1000\",\n        \"metadata\": {\n          \"description\": \"The total amount of cost or usage to track with the budget\"\n        }\n      },\n      \"timeGrain\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"Monthly\",\n        \"allowedValues\": [\n          \"Monthly\",\n          \"Quarterly\",\n          \"Annually\",\n          \"BillingMonth\",\n          \"BillingQuarter\",\n          \"BillingAnnual\"\n        ],\n        \"metadata\": {\n          \"description\": \"The time covered by a budget. Tracking of the amount will be reset based on the time grain.\"\n        }\n      },\n      \"firstThreshold\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"90\",\n        \"metadata\": {\n          \"description\": \"Threshold value associated with a notification. Notification is sent when the cost exceeded the threshold. It is always percent and has to be between 0 and 1000.\"\n        }\n      },\n      \"secondThreshold\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"100\",\n        \"metadata\": {\n          \"description\": \"Threshold value associated with a notification. Notification is sent when the cost exceeded the threshold. It is always percent and has to be between 0 and 1000.\"\n        }\n      },\n      \"contactRoles\": {\n        \"type\": \"Array\",\n        \"defaultValue\": [\n          \"Owner\",\n          \"Contributor\"\n        ],\n        \"metadata\": {\n          \"description\": \"The list of contact RBAC roles, in an array, to send the budget notification to when the threshold is exceeded.\"\n        }\n      },\n      \"contactEmails\": {\n        \"type\": \"Array\",\n        \"defaultValue\": [],\n        \"metadata\": {\n          \"description\": \"The list of email addresses, in an array, to send the budget notification to when the threshold is exceeded.\"\n        }\n      },\n      \"contactGroups\": {\n        \"type\": \"Array\",\n        \"defaultValue\": [],\n        \"metadata\": {\n          \"description\": \"The list of action groups, in an array, to send the budget notification to when the threshold is exceeded. It accepts array of strings.\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Resources/subscriptions\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Consumption/budgets\",\n          \"deploymentScope\": \"subscription\",\n          \"existenceScope\": \"subscription\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Consumption/budgets/amount\",\n                \"equals\": \"[[parameters('amount')]\"\n              },\n              {\n                \"field\": \"Microsoft.Consumption/budgets/timeGrain\",\n                \"equals\": \"[[parameters('timeGrain')]\"\n              },\n              {\n                \"field\": \"Microsoft.Consumption/budgets/category\",\n                \"equals\": \"Cost\"\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"deployment\": {\n            \"location\": \"northeurope\",\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"parameters\": {\n                \"budgetName\": {\n                  \"value\": \"[[parameters('budgetName')]\"\n                },\n                \"amount\": {\n                  \"value\": \"[[parameters('amount')]\"\n                },\n                \"timeGrain\": {\n                  \"value\": \"[[parameters('timeGrain')]\"\n                },\n                \"firstThreshold\": {\n                  \"value\": \"[[parameters('firstThreshold')]\"\n                },\n                \"secondThreshold\": {\n                  \"value\": \"[[parameters('secondThreshold')]\"\n                },\n                \"contactEmails\": {\n                  \"value\": \"[[parameters('contactEmails')]\"\n                },\n                \"contactRoles\": {\n                  \"value\": \"[[parameters('contactRoles')]\"\n                },\n                \"contactGroups\": {\n                  \"value\": \"[[parameters('contactGroups')]\"\n                }\n              },\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"budgetName\": {\n                    \"type\": \"String\"\n                  },\n                  \"amount\": {\n                    \"type\": \"String\"\n                  },\n                  \"timeGrain\": {\n                    \"type\": \"String\"\n                  },\n                  \"firstThreshold\": {\n                    \"type\": \"String\"\n                  },\n                  \"secondThreshold\": {\n                    \"type\": \"String\"\n                  },\n                  \"contactEmails\": {\n                    \"type\": \"Array\"\n                  },\n                  \"contactRoles\": {\n                    \"type\": \"Array\"\n                  },\n                  \"contactGroups\": {\n                    \"type\": \"Array\"\n                  },\n                  \"startDate\": {\n                    \"type\": \"String\",\n                    \"defaultValue\": \"[[concat(utcNow('MM'), '/01/', utcNow('yyyy'))]\"\n                  }\n                },\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Consumption/budgets\",\n                    \"apiVersion\": \"2019-10-01\",\n                    \"name\": \"[[parameters('budgetName')]\",\n                    \"properties\": {\n                      \"timePeriod\": {\n                        \"startDate\": \"[[parameters('startDate')]\"\n                      },\n                      \"timeGrain\": \"[[parameters('timeGrain')]\",\n                      \"amount\": \"[[parameters('amount')]\",\n                      \"category\": \"Cost\",\n                      \"notifications\": {\n                        \"NotificationForExceededBudget1\": {\n                          \"enabled\": true,\n                          \"operator\": \"GreaterThan\",\n                          \"threshold\": \"[[parameters('firstThreshold')]\",\n                          \"contactEmails\": \"[[parameters('contactEmails')]\",\n                          \"contactRoles\": \"[[parameters('contactRoles')]\",\n                          \"contactGroups\": \"[[parameters('contactGroups')]\"\n                        },\n                        \"NotificationForExceededBudget2\": {\n                          \"enabled\": true,\n                          \"operator\": \"GreaterThan\",\n                          \"threshold\": \"[[parameters('secondThreshold')]\",\n                          \"contactEmails\": \"[[parameters('contactEmails')]\",\n                          \"contactRoles\": \"[[parameters('contactRoles')]\",\n                          \"contactGroups\": \"[[parameters('contactGroups')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#157": "{\n  \"name\": \"Deploy-Diagnostics-AVDScalingPlans\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated]: Deploy Diagnostic Settings for AVD Scaling Plans to Log Analytics workspace\",\n    \"description\": \"Deploys the diagnostic settings for AVD Scaling Plans to stream to a Log Analytics workspace when any Scaling Plan which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"version\": \"1.1.0-deprecated\",\n      \"category\": \"Monitoring\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ]\n    },\n    \"parameters\": {\n      \"logAnalytics\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Log Analytics workspace\",\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\n          \"strongType\": \"omsWorkspace\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"profileName\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"setbypolicy\",\n        \"metadata\": {\n          \"displayName\": \"Profile name\",\n          \"description\": \"The diagnostic settings profile name\"\n        }\n      },\n      \"logsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable logs\",\n          \"description\": \"Whether to enable logs stream to the Log Analytics workspace - True or False\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.DesktopVirtualization/scalingplans\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\n          \"name\": \"[[parameters('profileName')]\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/workspaceId\",\n                \"equals\": \"[[parameters('logAnalytics')]\"\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logAnalytics\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"profileName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logsEnabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.DesktopVirtualization/scalingplans/providers/diagnosticSettings\",\n                    \"apiVersion\": \"2017-05-01-preview\",\n                    \"name\": \"[[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"dependsOn\": [],\n                    \"properties\": {\n                      \"workspaceId\": \"[[parameters('logAnalytics')]\",\n                      \"logs\": [\n                        {\n                          \"category\": \"Autoscale\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        }\n                      ]\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"logAnalytics\": {\n                  \"value\": \"[[parameters('logAnalytics')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"profileName\": {\n                  \"value\": \"[[parameters('profileName')]\"\n                },\n                \"logsEnabled\": {\n                  \"value\": \"[[parameters('logsEnabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#158": "{\n  \"name\": \"Deny-AFSPaasPublicIP\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"Public network access should be disabled for Azure File Sync\",\n    \"description\": \"Disabling the public endpoint allows you to restrict access to your Storage Sync Service resource to requests destined to approved private endpoints on your organization's network. There is nothing inherently insecure about allowing requests to the public endpoint, however, you may wish to disable it to meet regulatory, legal, or organizational policy requirements. You can disable the public endpoint for a Storage Sync Service by setting the incomingTrafficPolicy of the resource to AllowVirtualNetworksOnly.\",\n    \"metadata\": {\n      \"version\": \"1.0.0\",\n      \"category\": \"Storage\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureChinaCloud\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        },\n        \"allowedValues\": [\n          \"Audit\",\n          \"Deny\",\n          \"Disabled\"\n        ],\n        \"defaultValue\": \"Audit\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.StorageSync/storageSyncServices\"\n          },\n          {\n            \"field\": \"Microsoft.StorageSync/storageSyncServices/incomingTrafficPolicy\",\n            \"notEquals\": \"AllowVirtualNetworksOnly\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\"\n      }\n    }\n  }\n}\n",
    "$fxv#159": "{\n  \"name\": \"Deny-KeyVaultPaasPublicIP\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"Preview: Azure Key Vault should disable public network access\",\n    \"description\": \"Disable public network access for your key vault so that it's not accessible over the public internet. This can reduce data leakage risks. Learn more at: https://aka.ms/akvprivatelink.\",\n    \"metadata\": {\n      \"version\": \"2.0.0-preview\",\n      \"category\": \"Key Vault\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"preview\": true,\n      \"alzCloudEnvironments\": [\n        \"AzureChinaCloud\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        },\n        \"allowedValues\": [\n          \"Audit\",\n          \"Deny\",\n          \"Disabled\"\n        ],\n        \"defaultValue\": \"Audit\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.KeyVault/vaults\"\n          },\n          {\n            \"not\": {\n              \"field\": \"Microsoft.KeyVault/vaults/createMode\",\n              \"equals\": \"recover\"\n            }\n          },\n          {\n            \"field\": \"Microsoft.KeyVault/vaults/networkAcls.defaultAction\",\n            \"notEquals\": \"Deny\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\"\n      }\n    }\n  }\n}\n",
    "$fxv#16": "{\n  \"name\": \"Deny-PublicEndpoint-MariaDB\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated] Public network access should be disabled for MariaDB\",\n    \"description\": \"This policy denies the creation of Maria DB accounts with exposed public endpoints. Superseded by https://www.azadvertizer.net/azpolicyadvertizer/fdccbe47-f3e3-4213-ad5d-ea459b2fa077.html\",\n    \"metadata\": {\n      \"version\": \"1.0.0-deprecated\",\n      \"category\": \"SQL\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"deprecated\": true,\n      \"supersededBy\": \"fdccbe47-f3e3-4213-ad5d-ea459b2fa077\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"allowedValues\": [\n          \"Audit\",\n          \"Deny\",\n          \"Disabled\"\n        ],\n        \"defaultValue\": \"Deny\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.DBforMariaDB/servers\"\n          },\n          {\n            \"field\": \"Microsoft.DBforMariaDB/servers/publicNetworkAccess\",\n            \"notequals\": \"Disabled\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\"\n      }\n    }\n  }\n}\n",
    "$fxv#160": "{\n  \"name\": \"Deploy-ActivityLogs-to-LA-workspace\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Configure Azure Activity logs to stream to specified Log Analytics workspace\",\n    \"description\": \"Deploys the diagnostic settings for Azure Activity to stream subscriptions audit logs to a Log Analytics workspace to monitor subscription-level events\",\n    \"metadata\": {\n      \"version\": \"1.0.0\",\n      \"category\": \"Monitoring\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureChinaCloud\"\n      ]\n    },\n    \"parameters\": {\n      \"logAnalytics\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Primary Log Analytics workspace\",\n          \"description\": \"If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\n          \"strongType\": \"omsWorkspace\",\n          \"assignPermissions\": true\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        },\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"defaultValue\": \"DeployIfNotExists\"\n      },\n      \"logsEnabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Enable logs\",\n          \"description\": \"Whether to enable logs stream to the Log Analytics workspace - True or False\"\n        },\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"defaultValue\": \"True\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.Resources/subscriptions\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\n          \"deploymentScope\": \"subscription\",\n          \"existenceScope\": \"subscription\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\n                \"equals\": \"[[parameters('logsEnabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/workspaceId\",\n                \"equals\": \"[[parameters('logAnalytics')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"location\": \"chinaeast2\",\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"logAnalytics\": {\n                    \"type\": \"string\"\n                  },\n                  \"logsEnabled\": {\n                    \"type\": \"string\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"name\": \"subscriptionToLa\",\n                    \"type\": \"Microsoft.Insights/diagnosticSettings\",\n                    \"apiVersion\": \"2017-05-01-preview\",\n                    \"location\": \"Global\",\n                    \"properties\": {\n                      \"workspaceId\": \"[[parameters('logAnalytics')]\",\n                      \"logs\": [\n                        {\n                          \"category\": \"Administrative\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"Security\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"ServiceHealth\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"Alert\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"Recommendation\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"Policy\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"Autoscale\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"ResourceHealth\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        }\n                      ]\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"logAnalytics\": {\n                  \"value\": \"[[parameters('logAnalytics')]\"\n                },\n                \"logsEnabled\": {\n                  \"value\": \"[[parameters('logsEnabled')]\"\n                }\n              }\n            }\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\n          ]\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#161": "{\n  \"name\": \"Deploy-Default-Udr\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"Deploy a user-defined route to a VNET with specific routes.\",\n    \"description\": \"Deploy a user-defined route to a VNET with routes from spoke to hub firewall. This policy must be assigned for each region you plan to use.\",\n    \"metadata\": {\n      \"version\": \"1.0.0\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureChinaCloud\"\n      ]\n    },\n    \"parameters\": {\n      \"defaultRoute\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Default route to add into UDR\",\n          \"description\": \"Policy will deploy a default route table to a vnet\"\n        }\n      },\n      \"vnetRegion\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"VNet Region\",\n          \"description\": \"Regional VNet hub location\",\n          \"strongType\": \"location\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        },\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"defaultValue\": \"DeployIfNotExists\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/virtualNetworks\"\n          },\n          {\n            \"field\": \"location\",\n            \"equals\": \"[[parameters('vnetRegion')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Network/routeTables\",\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"\n          ],\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Network/routeTables/routes[*].nextHopIpAddress\",\n                \"equals\": \"[[parameters('defaultRoute')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"parameters\": {\n                \"udrName\": {\n                  \"value\": \"[[concat(field('name'),'-udr')]\"\n                },\n                \"udrLocation\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"defaultRoute\": {\n                  \"value\": \"[[parameters('defaultRoute')]\"\n                }\n              },\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"udrName\": {\n                    \"type\": \"string\"\n                  },\n                  \"udrLocation\": {\n                    \"type\": \"string\"\n                  },\n                  \"defaultRoute\": {\n                    \"type\": \"string\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Network/routeTables\",\n                    \"name\": \"[[parameters('udrName')]\",\n                    \"apiVersion\": \"2020-08-01\",\n                    \"location\": \"[[parameters('udrLocation')]\",\n                    \"properties\": {\n                      \"routes\": [\n                        {\n                          \"name\": \"AzureFirewallRoute\",\n                          \"properties\": {\n                            \"addressPrefix\": \"0.0.0.0/0\",\n                            \"nextHopType\": \"VirtualAppliance\",\n                            \"nextHopIpAddress\": \"[[parameters('defaultRoute')]\"\n                          }\n                        }\n                      ]\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#162": "{\n  \"name\": \"Deploy-MySQLCMKEffect\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"MySQL servers should use customer-managed keys to encrypt data at rest\",\n    \"description\": \"Use customer-managed keys to manage the encryption at rest of your MySQL servers. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys are commonly required to meet regulatory compliance standards. Customer-managed keys enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management.\",\n    \"metadata\": {\n      \"version\": \"1.0.4\",\n      \"category\": \"SQL\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureChinaCloud\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        },\n        \"allowedValues\": [\n          \"AuditIfNotExists\",\n          \"Disabled\"\n        ],\n        \"defaultValue\": \"AuditIfNotExists\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.DBforMySQL/servers\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.DBforMySQL/servers/keys\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.DBforMySQL/servers/keys/serverKeyType\",\n                \"equals\": \"AzureKeyVault\"\n              },\n              {\n                \"field\": \"Microsoft.DBforMySQL/servers/keys/uri\",\n                \"notEquals\": \"\"\n              },\n              {\n                \"field\": \"Microsoft.DBforMySQL/servers/keys/uri\",\n                \"exists\": \"true\"\n              }\n            ]\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#163": "{\n  \"name\": \"Deploy-PostgreSQLCMKEffect\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"PostgreSQL servers should use customer-managed keys to encrypt data at rest\",\n    \"description\": \"Use customer-managed keys to manage the encryption at rest of your PostgreSQL servers. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys are commonly required to meet regulatory compliance standards. Customer-managed keys enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management.\",\n    \"metadata\": {\n      \"version\": \"1.0.4\",\n      \"category\": \"SQL\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureChinaCloud\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        },\n        \"allowedValues\": [\n          \"AuditIfNotExists\",\n          \"Disabled\"\n        ],\n        \"defaultValue\": \"AuditIfNotExists\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.DBforPostgreSQL/servers\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.DBforPostgreSQL/servers/keys\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.DBforPostgreSQL/servers/keys/serverKeyType\",\n                \"equals\": \"AzureKeyVault\"\n              },\n              {\n                \"field\": \"Microsoft.DBforPostgreSQL/servers/keys/uri\",\n                \"notEquals\": \"\"\n              },\n              {\n                \"field\": \"Microsoft.DBforPostgreSQL/servers/keys/uri\",\n                \"exists\": \"true\"\n              }\n            ]\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#164": "{\n  \"name\": \"Deploy-Private-DNS-Azure-File-Sync\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"Configure Azure File Sync to use private DNS zones\",\n    \"description\": \"To access the private endpoint(s) for Storage Sync Service resource interfaces from a registered server, you need to configure your DNS to resolve the correct names to your private endpoint's private IP addresses. This policy creates the requisite Azure Private DNS Zone and A records for the interfaces of your Storage Sync Service private endpoint(s).\",\n    \"metadata\": {\n      \"version\": \"1.0.0\",\n      \"category\": \"Storage\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureChinaCloud\"\n      ]\n    },\n    \"parameters\": {\n      \"privateDnsZoneId\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"privateDnsZoneId\",\n          \"strongType\": \"Microsoft.Network/privateDnsZones\",\n          \"description\": \"Private DNS Zone Identifier\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        },\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"defaultValue\": \"DeployIfNotExists\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/privateEndpoints\"\n          },\n          {\n            \"count\": {\n              \"field\": \"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\n              \"where\": {\n                \"field\": \"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\n                \"equals\": \"afs\"\n              }\n            },\n            \"greaterOrEquals\": 1\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\",\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b12aa53e-6015-4669-85d0-8515ebb3ae7f\",\n            \"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"privateDnsZoneId\": {\n                    \"type\": \"string\"\n                  },\n                  \"privateEndpointName\": {\n                    \"type\": \"string\"\n                  },\n                  \"location\": {\n                    \"type\": \"string\"\n                  }\n                },\n                \"resources\": [\n                  {\n                    \"name\": \"[[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\n                    \"type\": \"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\",\n                    \"apiVersion\": \"2020-03-01\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"properties\": {\n                      \"privateDnsZoneConfigs\": [\n                        {\n                          \"name\": \"privatelink-afs\",\n                          \"properties\": {\n                            \"privateDnsZoneId\": \"[[parameters('privateDnsZoneId')]\"\n                          }\n                        }\n                      ]\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"privateDnsZoneId\": {\n                  \"value\": \"[[parameters('privateDnsZoneId')]\"\n                },\n                \"privateEndpointName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#165": "{\n  \"name\": \"Deploy-Private-DNS-Azure-KeyVault\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"Preview: Configure Azure Key Vaults to use private DNS zones\",\n    \"description\": \"Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to key vault. Learn more at: https://aka.ms/akvprivatelink.\",\n    \"metadata\": {\n      \"version\": \"1.0.0-preview\",\n      \"category\": \"Key Vault\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"preview\": true,\n      \"alzCloudEnvironments\": [\n        \"AzureChinaCloud\"\n      ]\n    },\n    \"parameters\": {\n      \"privateDnsZoneId\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Private DNS Zone ID\",\n          \"description\": \"A private DNS zone ID to connect to the private endpoint.\",\n          \"strongType\": \"Microsoft.Network/privateDnsZones\",\n          \"assignPermissions\": true\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        },\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"defaultValue\": \"DeployIfNotExists\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/privateEndpoints\"\n          },\n          {\n            \"count\": {\n              \"field\": \"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\n              \"where\": {\n                \"field\": \"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\n                \"equals\": \"vault\"\n              }\n            },\n            \"greaterOrEquals\": 1\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\",\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"privateDnsZoneId\": {\n                    \"type\": \"string\"\n                  },\n                  \"privateEndpointName\": {\n                    \"type\": \"string\"\n                  },\n                  \"location\": {\n                    \"type\": \"string\"\n                  }\n                },\n                \"resources\": [\n                  {\n                    \"name\": \"[[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\n                    \"type\": \"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\",\n                    \"apiVersion\": \"2020-03-01\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"properties\": {\n                      \"privateDnsZoneConfigs\": [\n                        {\n                          \"name\": \"keyvault-privateDnsZone\",\n                          \"properties\": {\n                            \"privateDnsZoneId\": \"[[parameters('privateDnsZoneId')]\"\n                          }\n                        }\n                      ]\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"privateDnsZoneId\": {\n                  \"value\": \"[[parameters('privateDnsZoneId')]\"\n                },\n                \"privateEndpointName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#166": "{\n  \"name\": \"Deploy-Private-DNS-Azure-Web\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"Configure Azure Web PubSub Service to use private DNS zones\",\n    \"description\": \"Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to Azure Web PubSub service. Learn more at: https://aka.ms/awps/privatelink.\",\n    \"metadata\": {\n      \"version\": \"1.0.0\",\n      \"category\": \"Web PubSub\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureChinaCloud\"\n      ]\n    },\n    \"parameters\": {\n      \"privateDnsZoneId\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Private DNS Zone Id\",\n          \"description\": \"Private DNS zone to integrate with private endpoint.\",\n          \"strongType\": \"Microsoft.Network/privateDnsZones\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        },\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"defaultValue\": \"DeployIfNotExists\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/privateEndpoints\"\n          },\n          {\n            \"count\": {\n              \"field\": \"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\n              \"where\": {\n                \"field\": \"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\n                \"equals\": \"webpubsub\"\n              }\n            },\n            \"greaterOrEquals\": 1\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\",\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"privateDnsZoneId\": {\n                    \"type\": \"string\"\n                  },\n                  \"privateEndpointName\": {\n                    \"type\": \"string\"\n                  },\n                  \"location\": {\n                    \"type\": \"string\"\n                  }\n                },\n                \"resources\": [\n                  {\n                    \"name\": \"[[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\n                    \"type\": \"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\",\n                    \"apiVersion\": \"2020-03-01\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"properties\": {\n                      \"privateDnsZoneConfigs\": [\n                        {\n                          \"name\": \"privatelink-webpubsub-azure-com\",\n                          \"properties\": {\n                            \"privateDnsZoneId\": \"[[parameters('privateDnsZoneId')]\"\n                          }\n                        }\n                      ]\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"privateDnsZoneId\": {\n                  \"value\": \"[[parameters('privateDnsZoneId')]\"\n                },\n                \"privateEndpointName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#167": "{\n  \"name\": \"Deny-AA-child-resources\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"No child resources in Automation Account\",\n    \"description\": \"This policy denies the creation of child resources on the Automation Account\",\n    \"metadata\": {\n      \"version\": \"1.0.0\",\n      \"category\": \"Automation\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"allowedValues\": [\n          \"Audit\",\n          \"Deny\",\n          \"Disabled\"\n        ],\n        \"defaultValue\": \"Deny\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"in\": [\n              \"Microsoft.Automation/automationAccounts/runbooks\",\n              \"Microsoft.Automation/automationAccounts/variables\",\n              \"Microsoft.Automation/automationAccounts/modules\",\n              \"Microsoft.Automation/automationAccounts/credentials\",\n              \"Microsoft.Automation/automationAccounts/connections\",\n              \"Microsoft.Automation/automationAccounts/certificates\"\n            ]\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\"\n      }\n    }\n  }\n}\n",
    "$fxv#168": "{\n  \"name\": \"Deploy-Budget\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy a default budget on all subscriptions under the assigned scope\",\n    \"description\": \"Deploy a default budget on all subscriptions under the assigned scope\",\n    \"metadata\": {\n      \"version\": \"1.1.0\",\n      \"category\": \"Budget\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"AuditIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"budgetName\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"budget-set-by-policy\",\n        \"metadata\": {\n          \"description\": \"The name for the budget to be created\"\n        }\n      },\n      \"amount\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"1000\",\n        \"metadata\": {\n          \"description\": \"The total amount of cost or usage to track with the budget\"\n        }\n      },\n      \"timeGrain\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"Monthly\",\n        \"allowedValues\": [\n          \"Monthly\",\n          \"Quarterly\",\n          \"Annually\",\n          \"BillingMonth\",\n          \"BillingQuarter\",\n          \"BillingAnnual\"\n        ],\n        \"metadata\": {\n          \"description\": \"The time covered by a budget. Tracking of the amount will be reset based on the time grain.\"\n        }\n      },\n      \"firstThreshold\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"90\",\n        \"metadata\": {\n          \"description\": \"Threshold value associated with a notification. Notification is sent when the cost exceeded the threshold. It is always percent and has to be between 0 and 1000.\"\n        }\n      },\n      \"secondThreshold\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"100\",\n        \"metadata\": {\n          \"description\": \"Threshold value associated with a notification. Notification is sent when the cost exceeded the threshold. It is always percent and has to be between 0 and 1000.\"\n        }\n      },\n      \"contactRoles\": {\n        \"type\": \"Array\",\n        \"defaultValue\": [\n          \"Owner\",\n          \"Contributor\"\n        ],\n        \"metadata\": {\n          \"description\": \"The list of contact RBAC roles, in an array, to send the budget notification to when the threshold is exceeded.\"\n        }\n      },\n      \"contactEmails\": {\n        \"type\": \"Array\",\n        \"defaultValue\": [],\n        \"metadata\": {\n          \"description\": \"The list of email addresses, in an array, to send the budget notification to when the threshold is exceeded.\"\n        }\n      },\n      \"contactGroups\": {\n        \"type\": \"Array\",\n        \"defaultValue\": [],\n        \"metadata\": {\n          \"description\": \"The list of action groups, in an array, to send the budget notification to when the threshold is exceeded. It accepts array of strings.\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Resources/subscriptions\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Consumption/budgets\",\n          \"deploymentScope\": \"subscription\",\n          \"existenceScope\": \"subscription\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Consumption/budgets/amount\",\n                \"equals\": \"[[parameters('amount')]\"\n              },\n              {\n                \"field\": \"Microsoft.Consumption/budgets/timeGrain\",\n                \"equals\": \"[[parameters('timeGrain')]\"\n              },\n              {\n                \"field\": \"Microsoft.Consumption/budgets/category\",\n                \"equals\": \"Cost\"\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"deployment\": {\n            \"location\": \"northeurope\",\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"parameters\": {\n                \"budgetName\": {\n                  \"value\": \"[[parameters('budgetName')]\"\n                },\n                \"amount\": {\n                  \"value\": \"[[parameters('amount')]\"\n                },\n                \"timeGrain\": {\n                  \"value\": \"[[parameters('timeGrain')]\"\n                },\n                \"firstThreshold\": {\n                  \"value\": \"[[parameters('firstThreshold')]\"\n                },\n                \"secondThreshold\": {\n                  \"value\": \"[[parameters('secondThreshold')]\"\n                },\n                \"contactEmails\": {\n                  \"value\": \"[[parameters('contactEmails')]\"\n                },\n                \"contactRoles\": {\n                  \"value\": \"[[parameters('contactRoles')]\"\n                },\n                \"contactGroups\": {\n                  \"value\": \"[[parameters('contactGroups')]\"\n                }\n              },\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"budgetName\": {\n                    \"type\": \"String\"\n                  },\n                  \"amount\": {\n                    \"type\": \"String\"\n                  },\n                  \"timeGrain\": {\n                    \"type\": \"String\"\n                  },\n                  \"firstThreshold\": {\n                    \"type\": \"String\"\n                  },\n                  \"secondThreshold\": {\n                    \"type\": \"String\"\n                  },\n                  \"contactEmails\": {\n                    \"type\": \"Array\"\n                  },\n                  \"contactRoles\": {\n                    \"type\": \"Array\"\n                  },\n                  \"contactGroups\": {\n                    \"type\": \"Array\"\n                  },\n                  \"startDate\": {\n                    \"type\": \"String\",\n                    \"defaultValue\": \"[[concat(utcNow('MM'), '/01/', utcNow('yyyy'))]\"\n                  }\n                },\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Consumption/budgets\",\n                    \"apiVersion\": \"2019-10-01\",\n                    \"name\": \"[[parameters('budgetName')]\",\n                    \"properties\": {\n                      \"timePeriod\": {\n                        \"startDate\": \"[[parameters('startDate')]\"\n                      },\n                      \"timeGrain\": \"[[parameters('timeGrain')]\",\n                      \"amount\": \"[[parameters('amount')]\",\n                      \"category\": \"Cost\",\n                      \"notifications\": {\n                        \"NotificationForExceededBudget1\": {\n                          \"enabled\": true,\n                          \"operator\": \"GreaterThan\",\n                          \"threshold\": \"[[parameters('firstThreshold')]\",\n                          \"contactEmails\": \"[[parameters('contactEmails')]\",\n                          \"contactRoles\": \"[[parameters('contactRoles')]\",\n                          \"contactGroups\": \"[[parameters('contactGroups')]\"\n                        },\n                        \"NotificationForExceededBudget2\": {\n                          \"enabled\": true,\n                          \"operator\": \"GreaterThan\",\n                          \"threshold\": \"[[parameters('secondThreshold')]\",\n                          \"contactEmails\": \"[[parameters('contactEmails')]\",\n                          \"contactRoles\": \"[[parameters('contactRoles')]\",\n                          \"contactGroups\": \"[[parameters('contactGroups')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#169": "{\n  \"name\": \"Deploy-Default-Udr\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"Deploy a user-defined route to a VNET with specific routes.\",\n    \"description\": \"Deploy a user-defined route to a VNET with routes from spoke to hub firewall. This policy must be assigned for each region you plan to use.\",\n    \"metadata\": {\n      \"version\": \"1.0.0\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"defaultRoute\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Default route to add into UDR\",\n          \"description\": \"Policy will deploy a default route table to a vnet\"\n        }\n      },\n      \"vnetRegion\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"VNet Region\",\n          \"description\": \"Regional VNet hub location\",\n          \"strongType\": \"location\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        },\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"defaultValue\": \"DeployIfNotExists\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/virtualNetworks\"\n          },\n          {\n            \"field\": \"location\",\n            \"equals\": \"[[parameters('vnetRegion')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Network/routeTables\",\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"\n          ],\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Network/routeTables/routes[*].nextHopIpAddress\",\n                \"equals\": \"[[parameters('defaultRoute')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"parameters\": {\n                \"udrName\": {\n                  \"value\": \"[[concat(field('name'),'-udr')]\"\n                },\n                \"udrLocation\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"defaultRoute\": {\n                  \"value\": \"[[parameters('defaultRoute')]\"\n                }\n              },\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"udrName\": {\n                    \"type\": \"string\"\n                  },\n                  \"udrLocation\": {\n                    \"type\": \"string\"\n                  },\n                  \"defaultRoute\": {\n                    \"type\": \"string\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Network/routeTables\",\n                    \"name\": \"[[parameters('udrName')]\",\n                    \"apiVersion\": \"2020-08-01\",\n                    \"location\": \"[[parameters('udrLocation')]\",\n                    \"properties\": {\n                      \"routes\": [\n                        {\n                          \"name\": \"AzureFirewallRoute\",\n                          \"properties\": {\n                            \"addressPrefix\": \"0.0.0.0/0\",\n                            \"nextHopType\": \"VirtualAppliance\",\n                            \"nextHopIpAddress\": \"[[parameters('defaultRoute')]\"\n                          }\n                        }\n                      ]\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#17": "{\n  \"name\": \"Deny-PublicIP\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated] Deny the creation of public IP\",\n    \"description\": \"[Deprecated] This policy denies creation of Public IPs under the assigned scope. Superseded by https://www.azadvertizer.net/azpolicyadvertizer/6c112d4e-5bc7-47ae-a041-ea2d9dccd749.html using appropriate assignment parameters.\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"supersededBy\": \"6c112d4e-5bc7-47ae-a041-ea2d9dccd749\",\n      \"version\": \"1.0.0-deprecated\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"allowedValues\": [\n          \"Audit\",\n          \"Deny\",\n          \"Disabled\"\n        ],\n        \"defaultValue\": \"Deny\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.Network/publicIPAddresses\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\"\n      }\n    }\n  }\n}",
    "$fxv#18": "{\n  \"name\": \"Deny-RDP-From-Internet\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"[Deprecated] RDP access from the Internet should be blocked\",\n    \"description\": \"This policy denies any network security rule that allows RDP access from Internet. This policy is superseded by https://www.azadvertizer.net/azpolicyadvertizer/Deny-MgmtPorts-From-Internet.html\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"supersededBy\": \"Deny-MgmtPorts-From-Internet\",\n      \"version\": \"1.0.1-deprecated\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        },\n        \"allowedValues\": [\n          \"Audit\",\n          \"Deny\",\n          \"Disabled\"\n        ],\n        \"defaultValue\": \"Deny\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/networkSecurityGroups/securityRules\"\n          },\n          {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/access\",\n                \"equals\": \"Allow\"\n              },\n              {\n                \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/direction\",\n                \"equals\": \"Inbound\"\n              },\n              {\n                \"anyOf\": [\n                  {\n                    \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange\",\n                    \"equals\": \"*\"\n                  },\n                  {\n                    \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange\",\n                    \"equals\": \"3389\"\n                  },\n                  {\n                    \"value\": \"[[if(and(not(empty(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange'))), contains(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange'),'-')), and(lessOrEquals(int(first(split(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange'), '-'))),3389),greaterOrEquals(int(last(split(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange'), '-'))),3389)), 'false')]\",\n                    \"equals\": \"true\"\n                  },\n                  {\n                    \"count\": {\n                      \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\",\n                      \"where\": {\n                        \"value\": \"[[if(and(not(empty(first(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]')))), contains(first(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]')),'-')), and(lessOrEquals(int(first(split(first(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]')), '-'))),3389),greaterOrEquals(int(last(split(first(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]')), '-'))),3389)) , 'false')]\",\n                        \"equals\": \"true\"\n                      }\n                    },\n                    \"greater\": 0\n                  },\n                  {\n                    \"not\": {\n                      \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\",\n                      \"notEquals\": \"*\"\n                    }\n                  },\n                  {\n                    \"not\": {\n                      \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\",\n                      \"notEquals\": \"3389\"\n                    }\n                  }\n                ]\n              },\n              {\n                \"anyOf\": [\n                  {\n                    \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\",\n                    \"equals\": \"*\"\n                  },\n                  {\n                    \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\",\n                    \"equals\": \"Internet\"\n                  },\n                  {\n                    \"not\": {\n                      \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]\",\n                      \"notEquals\": \"*\"\n                    }\n                  },\n                  {\n                    \"not\": {\n                      \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]\",\n                      \"notEquals\": \"Internet\"\n                    }\n                  }\n                ]\n              }\n            ]\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\"\n      }\n    }\n  }\n}\n",
    "$fxv#19": "{\n    \"name\": \"Deny-MgmtPorts-From-Internet\",\n    \"type\": \"Microsoft.Authorization/policyDefinitions\",\n    \"apiVersion\": \"2021-06-01\",\n    \"scope\": null,\n    \"properties\": {\n        \"policyType\": \"Custom\",\n        \"mode\": \"All\",\n        \"displayName\": \"Management port access from the Internet should be blocked\",\n        \"description\": \"This policy denies any network security rule that allows management port access from the Internet, by default blocking SSH/RDP ports.\",\n        \"metadata\": {\n            \"version\": \"2.1.1\",\n            \"category\": \"Network\",\n            \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n            \"replacesPolicy\": \"Deny-RDP-From-Internet\",\n            \"alzCloudEnvironments\": [\n                \"AzureCloud\",\n                \"AzureChinaCloud\",\n                \"AzureUSGovernment\"\n            ]\n        },\n        \"parameters\": {\n            \"effect\": {\n                \"type\": \"String\",\n                \"metadata\": {\n                    \"displayName\": \"Effect\",\n                    \"description\": \"Enable or disable the execution of the policy\"\n                },\n                \"allowedValues\": [\n                    \"Audit\",\n                    \"Deny\",\n                    \"Disabled\"\n                ],\n                \"defaultValue\": \"Deny\"\n            },\n            \"ports\": {\n                \"type\": \"Array\",\n                \"metadata\": {\n                    \"displayName\": \"Ports\",\n                    \"description\": \"Ports to be blocked\"\n                },\n                \"defaultValue\": [\n                    \"22\",\n                    \"3389\"\n                ]\n            }\n        },\n        \"policyRule\": {\n            \"if\": {\n                \"anyOf\": [\n                    {\n                        \"allOf\": [\n                            {\n                                \"field\": \"type\",\n                                \"equals\": \"Microsoft.Network/networkSecurityGroups/securityRules\"\n                            },\n                            {\n                                \"allOf\": [\n                                    {\n                                        \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/access\",\n                                        \"equals\": \"Allow\"\n                                    },\n                                    {\n                                        \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/direction\",\n                                        \"equals\": \"Inbound\"\n                                    },\n                                    {\n                                        \"anyOf\": [\n                                            {\n                                                \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange\",\n                                                \"equals\": \"*\"\n                                            },\n                                            {\n                                                \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange\",\n                                                \"in\": \"[[parameters('ports')]\"\n                                            },\n                                            {\n                                                \"count\": {\n                                                    \"value\": \"[[parameters('ports')]\",\n                                                    \"where\": {\n                                                        \"value\": \"[[if(and(not(empty(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange'))), contains(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange'),'-')), and(lessOrEquals(int(first(split(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange'), '-'))),int(current())),greaterOrEquals(int(last(split(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange'), '-'))),int(current()))), 'false')]\",\n                                                        \"equals\": \"true\"\n                                                    }\n                                                },\n                                                \"greater\": 0\n                                            },\n                                            {\n                                                \"count\": {\n                                                    \"value\": \"[[parameters('ports')]\",\n                                                    \"name\": \"ports\",\n                                                    \"where\": {\n                                                        \"count\": {\n                                                            \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\",\n                                                            \"where\": {\n                                                                \"value\": \"[[if(and(not(empty(current('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]'))), contains(current('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]'),'-')), and(lessOrEquals(int(first(split(current('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]'), '-'))),int(current('ports'))),greaterOrEquals(int(last(split(current('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]'), '-'))),int(current('ports')))) , 'false')]\",\n                                                                \"equals\": \"true\"\n                                                            }\n                                                        },\n                                                        \"greater\": 0\n                                                    }\n                                                },\n                                                \"greater\": 0\n                                            },\n                                            {\n                                                \"not\": {\n                                                    \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\",\n                                                    \"notEquals\": \"*\"\n                                                }\n                                            },\n                                            {\n                                                \"not\": {\n                                                    \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\",\n                                                    \"notIn\": \"[[parameters('ports')]\"\n                                                }\n                                            }\n                                        ]\n                                    },\n                                    {\n                                        \"anyOf\": [\n                                            {\n                                                \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\",\n                                                \"equals\": \"*\"\n                                            },\n                                            {\n                                                \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\",\n                                                \"equals\": \"Internet\"\n                                            },\n                                            {\n                                                \"not\": {\n                                                    \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]\",\n                                                    \"notEquals\": \"*\"\n                                                }\n                                            },\n                                            {\n                                                \"not\": {\n                                                    \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]\",\n                                                    \"notEquals\": \"Internet\"\n                                                }\n                                            }\n                                        ]\n                                    }\n                                ]\n                            }\n                        ]\n                    },\n                    {\n                        \"allOf\": [\n                            {\n                                \"field\": \"type\",\n                                \"equals\": \"Microsoft.Network/networkSecurityGroups\"\n                            },\n                            {\n                                \"count\": {\n                                    \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules[*]\",\n                                    \"where\": {\n                                        \"allOf\": [\n                                            {\n                                                \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules[*].access\",\n                                                \"equals\": \"Allow\"\n                                            },\n                                            {\n                                                \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules[*].direction\",\n                                                \"equals\": \"Inbound\"\n                                            },\n                                            {\n                                                \"anyOf\": [\n                                                    {\n                                                        \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRange\",\n                                                        \"equals\": \"*\"\n                                                    },\n                                                    {\n                                                        \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRange\",\n                                                        \"in\": \"[[parameters('ports')]\"\n                                                    },\n                                                    {\n                                                        \"count\": {\n                                                            \"value\": \"[[parameters('ports')]\",\n                                                            \"name\": \"ports\",\n                                                            \"where\": {\n                                                                \"value\": \"[[if(and(not(empty(current('Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRange'))), contains(current('Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRange'),'-')), and(lessOrEquals(int(first(split(current('Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRange'), '-'))),int(current('ports'))),greaterOrEquals(int(last(split(current('Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRange'), '-'))),int(current('ports')))), 'false')]\",\n                                                                \"equals\": \"true\"\n                                                            }\n                                                        },\n                                                        \"greater\": 0\n                                                    },\n                                                    {\n                                                        \"count\": {\n                                                            \"value\": \"[[parameters('ports')]\",\n                                                            \"name\": \"ports\",\n                                                            \"where\": {\n                                                                \"count\": {\n                                                                    \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRanges[*]\",\n                                                                    \"where\": {\n                                                                        \"value\": \"[[if(and(not(empty(current('Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRanges[*]'))), contains(current('Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRanges[*]'),'-')), and(lessOrEquals(int(first(split(current('Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRanges[*]'), '-'))),int(current('ports'))),greaterOrEquals(int(last(split(current('Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRanges[*]'), '-'))),int(current('ports')))) , 'false')]\",\n                                                                        \"equals\": \"true\"\n                                                                    }\n                                                                },\n                                                                \"greater\": 0\n                                                            }\n                                                        },\n                                                        \"greater\": 0\n                                                    },\n                                                    {\n                                                        \"not\": {\n                                                            \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRanges[*]\",\n                                                            \"notEquals\": \"*\"\n                                                        }\n                                                    },\n                                                    {\n                                                        \"not\": {\n                                                            \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRanges[*]\",\n                                                            \"notIn\": \"[[parameters('ports')]\"\n                                                        }\n                                                    }\n                                                ]\n                                            },\n                                            {\n                                                \"anyOf\": [\n                                                    {\n                                                        \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules[*].sourceAddressPrefix\",\n                                                        \"equals\": \"*\"\n                                                    },\n                                                    {\n                                                        \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules[*].sourceAddressPrefix\",\n                                                        \"equals\": \"Internet\"\n                                                    },\n                                                    {\n                                                        \"not\": {\n                                                            \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules[*].sourceAddressPrefixes[*]\",\n                                                            \"notEquals\": \"*\"\n                                                        }\n                                                    },\n                                                    {\n                                                        \"not\": {\n                                                            \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules[*].sourceAddressPrefixes[*]\",\n                                                            \"notEquals\": \"Internet\"\n                                                        }\n                                                    }\n                                                ]\n                                            }\n                                        ]\n                                    }\n                                },\n                                \"greater\": 0\n                            }\n                        ]\n                    }\n                ]\n            },\n            \"then\": {\n                \"effect\": \"[[parameters('effect')]\"\n            }\n        }\n    }\n}\n",
    "$fxv#2": "{\n  \"name\": \"Append-KV-SoftDelete\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"KeyVault SoftDelete should be enabled\",\n    \"description\": \"This policy enables you to ensure when a Key Vault is created with out soft delete enabled it will be added.\",\n    \"metadata\": {\n      \"version\": \"1.0.0\",\n      \"category\": \"Key Vault\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {},\n    \"policyRule\": {\n      \"if\": {\n        \"anyOf\": [\n          {\n            \"allOf\": [\n              {\n                \"field\": \"type\",\n                \"equals\": \"Microsoft.KeyVault/vaults\"\n              },\n              {\n                \"field\": \"Microsoft.KeyVault/vaults/enableSoftDelete\",\n                \"notEquals\": true\n              }\n            ]\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"append\",\n        \"details\": [\n          {\n            \"field\": \"Microsoft.KeyVault/vaults/enableSoftDelete\",\n            \"value\": true\n          }\n        ]\n      }\n    }\n  }\n}\n",
    "$fxv#20": "{\n  \"name\": \"Deny-Redis-http\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"Azure Cache for Redis only secure connections should be enabled\",\n    \"description\": \"Audit enabling of only connections via SSL to Azure Cache for Redis. Validate both minimum TLS version and enableNonSslPort is disabled. Use of secure connections ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking\",\n    \"metadata\": {\n      \"version\": \"1.0.0\",\n      \"category\": \"Cache\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"Deny\",\n        \"allowedValues\": [\n          \"Audit\",\n          \"Deny\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"The effect determines what happens when the policy rule is evaluated to match\"\n        }\n      },\n      \"minimumTlsVersion\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"1.2\",\n        \"allowedValues\": [\n          \"1.2\",\n          \"1.1\",\n          \"1.0\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Select minumum TLS version for Azure Cache for Redis.\",\n          \"description\": \"Select minimum TLS version for Azure Cache for Redis.\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Cache/redis\"\n          },\n          {\n            \"anyOf\": [\n              {\n                \"field\": \"Microsoft.Cache/Redis/enableNonSslPort\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Cache/Redis/minimumTlsVersion\",\n                \"notequals\": \"[[parameters('minimumTlsVersion')]\"\n              }\n            ]\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\"\n      }\n    }\n  }\n}\n",
    "$fxv#21": "{\n  \"name\": \"Deny-Sql-minTLS\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"Azure SQL Database should have the minimal TLS version set to the highest version\",\n    \"description\": \"Setting minimal TLS version to 1.2 improves security by ensuring your Azure SQL Database can only be accessed from clients using TLS 1.2. Using versions of TLS less than 1.2 is not reccomended since they have well documented security vunerabilities.\",\n    \"metadata\": {\n      \"version\": \"1.0.0\",\n      \"category\": \"SQL\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        },\n        \"allowedValues\": [\n          \"Audit\",\n          \"Disabled\",\n          \"Deny\"\n        ],\n        \"defaultValue\": \"Audit\"\n      },\n      \"minimalTlsVersion\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"1.2\",\n        \"allowedValues\": [\n          \"1.2\",\n          \"1.1\",\n          \"1.0\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Select version for SQL server\",\n          \"description\": \"Select version minimum TLS version SQL servers to enforce\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Sql/servers\"\n          },\n          {\n            \"anyOf\": [\n              {\n                \"field\": \"Microsoft.Sql/servers/minimalTlsVersion\",\n                \"exists\": \"false\"\n              },\n              {\n                \"field\": \"Microsoft.Sql/servers/minimalTlsVersion\",\n                \"notequals\": \"[[parameters('minimalTlsVersion')]\"\n              }\n            ]\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\"\n      }\n    }\n  }\n}\n",
    "$fxv#22": "{\n  \"name\": \"Deny-SqlMi-minTLS\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"SQL Managed Instance should have the minimal TLS version set to the highest version\",\n    \"description\": \"Setting minimal TLS version to 1.2 improves security by ensuring your SQL Managed Instance can only be accessed from clients using TLS 1.2. Using versions of TLS less than 1.2 is not reccomended since they have well documented security vunerabilities.\",\n    \"metadata\": {\n      \"version\": \"1.0.0\",\n      \"category\": \"SQL\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        },\n        \"allowedValues\": [\n          \"Audit\",\n          \"Disabled\",\n          \"Deny\"\n        ],\n        \"defaultValue\": \"Audit\"\n      },\n      \"minimalTlsVersion\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"1.2\",\n        \"allowedValues\": [\n          \"1.2\",\n          \"1.1\",\n          \"1.0\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Select version for SQL server\",\n          \"description\": \"Select version minimum TLS version SQL servers to enforce\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Sql/managedInstances\"\n          },\n          {\n            \"anyOf\": [\n              {\n                \"field\": \"Microsoft.Sql/managedInstances/minimalTlsVersion\",\n                \"exists\": \"false\"\n              },\n              {\n                \"field\": \"Microsoft.Sql/managedInstances/minimalTlsVersion\",\n                \"notequals\": \"[[parameters('minimalTlsVersion')]\"\n              }\n            ]\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\"\n      }\n    }\n  }\n}\n",
    "$fxv#23": "{\n  \"name\": \"Deny-Storage-minTLS\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"[Deprecated] Storage Account set to minimum TLS and Secure transfer should be enabled\",\n    \"description\": \"Audit requirement of Secure transfer in your storage account. This policy is superseded by https://www.azadvertizer.net/azpolicyadvertizer/fe83a0eb-a853-422d-aac2-1bffd182c5d0.html and https://www.azadvertizer.net/azpolicyadvertizer/404c3081-a854-4457-ae30-26a93ef643f9.html\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"supersededBy\": \"fe83a0eb-a853-422d-aac2-1bffd182c5d0,404c3081-a854-4457-ae30-26a93ef643f9\",\n      \"version\": \"1.0.0-deprecated\",\n      \"category\": \"Storage\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"Deny\",\n        \"allowedValues\": [\n          \"Audit\",\n          \"Deny\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"The effect determines what happens when the policy rule is evaluated to match\"\n        }\n      },\n      \"minimumTlsVersion\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"TLS1_2\",\n        \"allowedValues\": [\n          \"TLS1_2\",\n          \"TLS1_1\",\n          \"TLS1_0\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Storage Account select minimum TLS version\",\n          \"description\": \"Select version  minimum TLS version on Azure Storage Account to enforce\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Storage/storageAccounts\"\n          },\n          {\n            \"anyOf\": [\n              {\n                \"allOf\": [\n                  {\n                    \"value\": \"[[requestContext().apiVersion]\",\n                    \"less\": \"2019-04-01\"\n                  },\n                  {\n                    \"field\": \"Microsoft.Storage/storageAccounts/supportsHttpsTrafficOnly\",\n                    \"exists\": \"false\"\n                  }\n                ]\n              },\n              {\n                \"field\": \"Microsoft.Storage/storageAccounts/supportsHttpsTrafficOnly\",\n                \"equals\": \"false\"\n              },\n              {\n                \"field\": \"Microsoft.Storage/storageAccounts/minimumTlsVersion\",\n                \"notequals\": \"[[parameters('minimumTlsVersion')]\"\n              },\n              {\n                \"field\": \"Microsoft.Storage/storageAccounts/minimumTlsVersion\",\n                \"exists\": \"false\"\n              }\n            ]\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\"\n      }\n    }\n  }\n}\n",
    "$fxv#24": "{\n  \"name\": \"Deny-Storage-SFTP\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"Storage Accounts with SFTP enabled should be denied\",\n    \"description\": \"This policy denies the creation of Storage Accounts with SFTP enabled for Blob Storage.\",\n    \"metadata\": {\n      \"version\": \"1.0.0\",\n      \"category\": \"Storage\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"Deny\",\n        \"allowedValues\": [\n          \"Audit\",\n          \"Deny\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"The effect determines what happens when the policy rule is evaluated to match\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Storage/storageAccounts\"\n          },\n          {\n            \"field\": \"Microsoft.Storage/storageAccounts/isSftpEnabled\",\n            \"equals\": \"true\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\"\n      }\n    }\n  }\n}\n",
    "$fxv#25": "{\n  \"name\": \"Deny-Subnet-Without-Nsg\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Subnets should have a Network Security Group\",\n    \"description\": \"This policy denies the creation of a subnet without a Network Security Group. NSG help to protect traffic across subnet-level.\",\n    \"metadata\": {\n      \"version\": \"2.0.0\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"allowedValues\": [\n          \"Audit\",\n          \"Deny\",\n          \"Disabled\"\n        ],\n        \"defaultValue\": \"Deny\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"excludedSubnets\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"Excluded Subnets\",\n          \"description\": \"Array of subnet names that are excluded from this policy\"\n        },\n        \"defaultValue\": [\n          \"GatewaySubnet\",\n          \"AzureFirewallSubnet\",\n          \"AzureFirewallManagementSubnet\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"anyOf\": [\n          {\n            \"allOf\": [\n              {\n                \"equals\": \"Microsoft.Network/virtualNetworks\",\n                \"field\": \"type\"\n              },\n              {\n                \"count\": {\n                  \"field\": \"Microsoft.Network/virtualNetworks/subnets[*]\",\n                  \"where\": {\n                    \"allOf\": [\n                      {\n                        \"exists\": \"false\",\n                        \"field\": \"Microsoft.Network/virtualNetworks/subnets[*].networkSecurityGroup.id\"\n                      },\n                      {\n                        \"field\": \"Microsoft.Network/virtualNetworks/subnets[*].name\",\n                        \"notIn\": \"[[parameters('excludedSubnets')]\"\n                      }\n                    ]\n                  }\n                },\n                \"notEquals\": 0\n              }\n            ]\n          },\n          {\n            \"allOf\": [\n              {\n                \"field\": \"type\",\n                \"equals\": \"Microsoft.Network/virtualNetworks/subnets\"\n              },\n              {\n                \"field\": \"name\",\n                \"notIn\": \"[[parameters('excludedSubnets')]\"\n              },\n              {\n                \"field\": \"Microsoft.Network/virtualNetworks/subnets/networkSecurityGroup.id\",\n                \"exists\": \"false\"\n              }\n            ]\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\"\n      }\n    }\n  }\n}\n",
    "$fxv#26": "{\n  \"name\": \"Deny-Subnet-Without-Penp\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Subnets without Private Endpoint Network Policies enabled should be denied\",\n    \"description\": \"This policy denies the creation of a subnet without Private Endpoint Netwotk Policies enabled. This policy is intended for 'workload' subnets, not 'central infrastructure' (aka, 'hub') subnets.\",\n    \"metadata\": {\n      \"version\": \"1.0.0\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"allowedValues\": [\n          \"Audit\",\n          \"Deny\",\n          \"Disabled\"\n        ],\n        \"defaultValue\": \"Deny\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"The effect determines what happens when the policy rule is evaluated to match\"\n        }\n      },\n      \"excludedSubnets\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"Excluded Subnets\",\n          \"description\": \"Array of subnet names that are excluded from this policy\"\n        },\n        \"defaultValue\": [\n          \"GatewaySubnet\",\n          \"AzureFirewallSubnet\",\n          \"AzureFirewallManagementSubnet\",\n          \"AzureBastionSubnet\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"anyOf\": [\n          {\n            \"allOf\": [\n              {\n                \"equals\": \"Microsoft.Network/virtualNetworks\",\n                \"field\": \"type\"\n              },\n              {\n                \"count\": {\n                  \"field\": \"Microsoft.Network/virtualNetworks/subnets[*]\",\n                  \"where\": {\n                    \"allOf\": [\n                      {\n                        \"field\": \"Microsoft.Network/virtualNetworks/subnets[*].privateEndpointNetworkPolicies\",\n                        \"notEquals\": \"Enabled\"\n                      },\n                      {\n                        \"field\": \"Microsoft.Network/virtualNetworks/subnets[*].name\",\n                        \"notIn\": \"[[parameters('excludedSubnets')]\"\n                      }\n                    ]\n                  }\n                },\n                \"notEquals\": 0\n              }\n            ]\n          },\n          {\n            \"allOf\": [\n              {\n                \"field\": \"type\",\n                \"equals\": \"Microsoft.Network/virtualNetworks/subnets\"\n              },\n              {\n                \"field\": \"name\",\n                \"notIn\": \"[[parameters('excludedSubnets')]\"\n              },\n              {\n                \"field\": \"Microsoft.Network/virtualNetworks/subnets/privateEndpointNetworkPolicies\",\n                \"notEquals\": \"Enabled\"\n              }\n            ]\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\"\n      }\n    }\n  }\n}\n",
    "$fxv#27": "{\n  \"name\": \"Deny-Subnet-Without-Udr\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Subnets should have a User Defined Route\",\n    \"description\": \"This policy denies the creation of a subnet without a User Defined Route (UDR).\",\n    \"metadata\": {\n      \"version\": \"2.0.0\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        },\n        \"allowedValues\": [\n          \"Audit\",\n          \"Deny\",\n          \"Disabled\"\n        ],\n        \"defaultValue\": \"Deny\"\n      },\n      \"excludedSubnets\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"Excluded Subnets\",\n          \"description\": \"Array of subnet names that are excluded from this policy\"\n        },\n        \"defaultValue\": [\n          \"AzureBastionSubnet\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"anyOf\": [\n          {\n            \"allOf\": [\n              {\n                \"equals\": \"Microsoft.Network/virtualNetworks\",\n                \"field\": \"type\"\n              },\n              {\n                \"count\": {\n                  \"field\": \"Microsoft.Network/virtualNetworks/subnets[*]\",\n                  \"where\": {\n                    \"allOf\": [\n                      {\n                        \"exists\": \"false\",\n                        \"field\": \"Microsoft.Network/virtualNetworks/subnets[*].routeTable.id\"\n                      },\n                      {\n                        \"field\": \"Microsoft.Network/virtualNetworks/subnets[*].name\",\n                        \"notIn\": \"[[parameters('excludedSubnets')]\"\n                      }\n                    ]\n                  }\n                },\n                \"notEquals\": 0\n              }\n            ]\n          },\n          {\n            \"allOf\": [\n              {\n                \"field\": \"type\",\n                \"equals\": \"Microsoft.Network/virtualNetworks/subnets\"\n              },\n              {\n                \"field\": \"name\",\n                \"notIn\": \"[[parameters('excludedSubnets')]\"\n              },\n              {\n                \"field\": \"Microsoft.Network/virtualNetworks/subnets/routeTable.id\",\n                \"exists\": \"false\"\n              }\n            ]\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\"\n      }\n    }\n  }\n}\n",
    "$fxv#28": "{\n  \"name\": \"Deny-UDR-With-Specific-NextHop\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"User Defined Routes with 'Next Hop Type' set to 'Internet' or 'VirtualNetworkGateway' should be denied\",\n    \"description\": \"This policy denies the creation of a User Defined Route with 'Next Hop Type' set to 'Internet' or 'VirtualNetworkGateway'.\",\n    \"metadata\": {\n      \"version\": \"1.0.0\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"The effect determines what happens when the policy rule is evaluated to match\"\n        },\n        \"allowedValues\": [\n          \"Audit\",\n          \"Deny\",\n          \"Disabled\"\n        ],\n        \"defaultValue\": \"Deny\"\n      },\n      \"excludedDestinations\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"Excluded Destinations\",\n          \"description\": \"Array of route destinations that are to be denied\"\n        },\n        \"defaultValue\": [\n          \"Internet\", \n          \"VirtualNetworkGateway\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"anyOf\": [\n          {\n            \"allOf\": [\n              {\n                \"equals\": \"Microsoft.Network/routeTables\",\n                \"field\": \"type\"\n              },\n              {\n                \"count\": {\n                  \"field\": \"Microsoft.Network/routeTables/routes[*]\",\n                  \"where\": {\n                        \"field\": \"Microsoft.Network/routeTables/routes[*].nextHopType\",\n                        \"in\": \"[[parameters('excludedDestinations')]\"\n                  }\n                },\n                \"notEquals\": 0\n              }\n            ]\n          },\n          {\n            \"allOf\": [\n              {\n              \"field\": \"type\",\n              \"equals\": \"Microsoft.Network/routeTables/routes\"\n              },\n              {\n              \"field\": \"Microsoft.Network/routeTables/routes/nextHopType\",\n              \"in\": \"[[parameters('excludedDestinations')]\"\n              }\n            ]\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\"\n      }\n    }\n  }\n}\n",
    "$fxv#29": "{\n  \"name\": \"Deny-VNET-Peer-Cross-Sub\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deny vNet peering cross subscription.\",\n    \"description\": \"This policy denies the creation of vNet Peerings outside of the same subscriptions under the assigned scope.\",\n    \"metadata\": {\n      \"version\": \"1.0.1\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        },\n        \"allowedValues\": [\n          \"Audit\",\n          \"Deny\",\n          \"Disabled\"\n        ],\n        \"defaultValue\": \"Deny\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/virtualNetworks/virtualNetworkPeerings\"\n          },\n          {\n            \"field\": \"Microsoft.Network/virtualNetworks/virtualNetworkPeerings/remoteVirtualNetwork.id\",\n            \"notcontains\": \"[[subscription().id]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\"\n      }\n    }\n  }\n}\n",
    "$fxv#3": "{\n  \"name\": \"Append-Redis-disableNonSslPort\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"Azure Cache for Redis Append and the enforcement that enableNonSslPort is disabled.\",\n    \"description\": \"Azure Cache for Redis Append and the enforcement that enableNonSslPort is disabled. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.\",\n    \"metadata\": {\n      \"version\": \"1.0.1\",\n      \"category\": \"Cache\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"Append\",\n        \"allowedValues\": [\n          \"Append\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect Azure Cache for Redis\",\n          \"description\": \"Enable or disable the execution of the policy minimum TLS version Azure Cache for Redis\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Cache/redis\"\n          },\n          {\n            \"anyOf\": [\n              {\n                \"field\": \"Microsoft.Cache/Redis/enableNonSslPort\",\n                \"equals\": \"true\"\n              }\n            ]\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": [\n          {\n            \"field\": \"Microsoft.Cache/Redis/enableNonSslPort\",\n            \"value\": false\n          }\n        ]\n      }\n    }\n  }\n}\n",
    "$fxv#30": "{\n  \"name\": \"Deny-VNET-Peering-To-Non-Approved-VNETs\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deny vNet peering to non-approved vNets\",\n    \"description\": \"This policy denies the creation of vNet Peerings to non-approved vNets under the assigned scope.\",\n    \"metadata\": {\n      \"version\": \"1.0.0\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        },\n        \"allowedValues\": [\n          \"Audit\",\n          \"Deny\",\n          \"Disabled\"\n        ],\n        \"defaultValue\": \"Deny\"\n      },\n      \"allowedVnets\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"Allowed vNets to peer with\",\n          \"description\": \"Array of allowed vNets that can be peered with. Must be entered using their resource ID. Example: /subscriptions/{subId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Network/virtualNetworks/{vnetName}\"\n        },\n        \"defaultValue\": []\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"anyOf\": [\n          {\n            \"allOf\": [\n              {\n                \"field\": \"type\",\n                \"equals\": \"Microsoft.Network/virtualNetworks/virtualNetworkPeerings\"\n              },\n              {\n                \"not\": {\n                  \"field\": \"Microsoft.Network/virtualNetworks/virtualNetworkPeerings/remoteVirtualNetwork.id\",\n                  \"in\": \"[[parameters('allowedVnets')]\"\n                }\n              }\n            ]\n          },\n          {\n            \"allOf\": [\n              {\n                \"field\": \"type\",\n                \"equals\": \"Microsoft.Network/virtualNetworks\"\n              },\n              {\n                \"not\": {\n                  \"field\": \"Microsoft.Network/virtualNetworks/virtualNetworkPeerings[*].remoteVirtualNetwork.id\",\n                  \"in\": \"[[parameters('allowedVnets')]\"\n                }\n              },\n              {\n                \"not\": {\n                  \"field\": \"Microsoft.Network/virtualNetworks/virtualNetworkPeerings[*].remoteVirtualNetwork.id\",\n                  \"exists\": false\n                }\n              }\n            ]\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\"\n      }\n    }\n  }\n}\n",
    "$fxv#31": "{\n  \"name\": \"Deny-VNet-Peering\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deny vNet peering \",\n    \"description\": \"This policy denies the creation of vNet Peerings under the assigned scope.\",\n    \"metadata\": {\n      \"version\": \"1.0.1\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"allowedValues\": [\n          \"Audit\",\n          \"Deny\",\n          \"Disabled\"\n        ],\n        \"defaultValue\": \"Deny\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.Network/virtualNetworks/virtualNetworkPeerings\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\"\n      }\n    }\n  }\n}\n",
    "$fxv#32": "{\n    \"name\": \"Deny-StorageAccount-CustomDomain\",\n    \"type\": \"Microsoft.Authorization/policyDefinitions\",\n    \"apiVersion\": \"2021-06-01\",\n    \"scope\": null,\n    \"properties\": {\n      \"policyType\": \"Custom\",\n      \"mode\": \"All\",\n      \"displayName\": \"Storage Accounts with custom domains assigned should be denied\",\n      \"description\": \"This policy denies the creation of Storage Accounts with custom domains assigned as communication cannot be encrypted, and always uses HTTP.\",\n      \"metadata\": {\n        \"version\": \"1.0.0\",\n        \"category\": \"Storage\",\n        \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n        \"alzCloudEnvironments\": [\n          \"AzureCloud\",\n          \"AzureChinaCloud\",\n          \"AzureUSGovernment\"\n        ]\n      },\n      \"parameters\": {\n        \"effect\": {\n          \"type\": \"String\",\n          \"defaultValue\": \"Deny\",\n          \"allowedValues\": [\n            \"Audit\",\n            \"Deny\",\n            \"Disabled\"\n          ],\n          \"metadata\": {\n            \"displayName\": \"Effect\",\n            \"description\": \"The effect determines what happens when the policy rule is evaluated to match\"\n          }\n        }\n      },\n      \"policyRule\": {\n        \"if\": {\n            \"allOf\": [\n              {\n                \"field\": \"type\",\n                \"equals\": \"Microsoft.Storage/storageAccounts\"\n              },\n              {\n                \"anyOf\": [\n                  {\n                    \"field\": \"Microsoft.Storage/storageAccounts/customDomain\",\n                    \"exists\": \"true\"\n                  },\n                  {\n                    \"field\": \"Microsoft.Storage/storageAccounts/customDomain.useSubDomainName\",\n                    \"equals\": \"true\"\n                  }\n                ]\n              }\n            ]\n        },\n        \"then\": {\n          \"effect\": \"[[parameters('effect')]\"\n        }\n      }\n    }\n  }",
    "$fxv#33": "{\n    \"name\": \"Deny-FileServices-InsecureKerberos\",\n    \"type\": \"Microsoft.Authorization/policyDefinitions\",\n    \"apiVersion\": \"2021-06-01\",\n    \"scope\": null,\n    \"properties\": {\n      \"policyType\": \"Custom\",\n      \"mode\": \"All\",\n      \"displayName\": \"File Services with insecure Kerberos ticket encryption should be denied\",\n      \"description\": \"This policy denies the use of insecure Kerberos ticket encryption (RC4-HMAC) when using File Services on a storage account.\",\n      \"metadata\": {\n        \"version\": \"1.0.0\",\n        \"category\": \"Storage\",\n        \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n        \"alzCloudEnvironments\": [\n          \"AzureCloud\",\n          \"AzureChinaCloud\",\n          \"AzureUSGovernment\"\n        ]\n      },\n      \"parameters\": {\n        \"effect\": {\n          \"type\": \"String\",\n          \"defaultValue\": \"Deny\",\n          \"allowedValues\": [\n            \"Audit\",\n            \"Deny\",\n            \"Disabled\"\n          ],\n          \"metadata\": {\n            \"displayName\": \"Effect\",\n            \"description\": \"The effect determines what happens when the policy rule is evaluated to match\"\n          }\n        },\n        \"notAllowedKerberosTicketEncryption\": {\n          \"type\": \"String\",\n          \"defaultValue\": \"RC4-HMAC\",\n          \"allowedValues\": [\n            \"RC4-HMAC\",\n            \"AES-256\"\n          ],\n          \"metadata\": {\n            \"displayName\": \"Kerberos ticket encryption supported by server. Valid values are RC4-HMAC, AES-256.\",\n            \"description\": \"The list of kerberosTicketEncryption not allowed.\"\n          }\n        }\n      },\n      \"policyRule\": {\n        \"if\": {\n          \"allOf\": [\n            {\n              \"field\": \"type\",\n              \"equals\": \"Microsoft.Storage/storageAccounts/fileServices\"\n            },\n            {\n              \"field\": \"Microsoft.Storage/storageAccounts/fileServices/protocolSettings.smb.kerberosTicketEncryption\",\n              \"contains\": \"[[parameters('notAllowedKerberosTicketEncryption')]\"\n            }\n          ]\n        },\n        \"then\": {\n          \"effect\": \"[[parameters('effect')]\"\n        }\n      }\n    }\n  }",
    "$fxv#34": "{\n    \"name\": \"Deny-FileServices-InsecureSmbChannel\",\n    \"type\": \"Microsoft.Authorization/policyDefinitions\",\n    \"apiVersion\": \"2021-06-01\",\n    \"scope\": null,\n    \"properties\": {\n      \"policyType\": \"Custom\",\n      \"mode\": \"All\",\n      \"displayName\": \"File Services with insecure SMB channel encryption should be denied\",\n      \"description\": \"This policy denies the use of insecure channel encryption (AES-128-CCM) when using File Services on a storage account.\",\n      \"metadata\": {\n        \"version\": \"1.0.0\",\n        \"category\": \"Storage\",\n        \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n        \"alzCloudEnvironments\": [\n          \"AzureCloud\",\n          \"AzureChinaCloud\",\n          \"AzureUSGovernment\"\n        ]\n      },\n      \"parameters\": {\n        \"effect\": {\n          \"type\": \"String\",\n          \"defaultValue\": \"Deny\",\n          \"allowedValues\": [\n            \"Audit\",\n            \"Deny\",\n            \"Disabled\"\n          ],\n          \"metadata\": {\n            \"displayName\": \"Effect\",\n            \"description\": \"The effect determines what happens when the policy rule is evaluated to match\"\n          }\n        },\n        \"notAllowedChannelEncryption\": {\n          \"type\": \"String\",\n          \"defaultValue\": \"AES-128-CCM\",\n          \"allowedValues\": [\n            \"AES-128-CCM\",\n            \"AES-128-GCM\",\n            \"AES-256-GCM\"\n          ],\n          \"metadata\": {\n            \"displayName\": \"SMB channel encryption supported by server. Valid values are AES-128-CCM, AES-128-GCM, AES-256-GCM.\",\n            \"description\": \"The list of channelEncryption not allowed.\"\n          }\n         }\n      },\n      \"policyRule\": {\n        \"if\": {\n          \"allOf\": [\n            {\n              \"field\": \"type\",\n              \"equals\": \"Microsoft.Storage/storageAccounts/fileServices\"\n            },\n            {\n              \"field\": \"Microsoft.Storage/storageAccounts/fileServices/protocolSettings.smb.channelEncryption\",\n              \"contains\": \"[[parameters('notAllowedChannelEncryption')]\"\n            }\n          ]\n        },\n        \"then\": {\n          \"effect\": \"[[parameters('effect')]\"\n        }\n      }\n    }\n  }",
    "$fxv#35": "{\n    \"name\": \"Deny-FileServices-InsecureSmbVersions\",\n    \"type\": \"Microsoft.Authorization/policyDefinitions\",\n    \"apiVersion\": \"2021-06-01\",\n    \"scope\": null,\n    \"properties\": {\n      \"policyType\": \"Custom\",\n      \"mode\": \"All\",\n      \"displayName\": \"File Services with insecure SMB versions should be denied\",\n      \"description\": \"This policy denies the use of insecure versions of SMB (2.1 & 3.0) when using File Services on a storage account.\",\n      \"metadata\": {\n        \"version\": \"1.0.0\",\n        \"category\": \"Storage\",\n        \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n        \"alzCloudEnvironments\": [\n          \"AzureCloud\",\n          \"AzureChinaCloud\",\n          \"AzureUSGovernment\"\n        ]\n      },\n      \"parameters\": {\n        \"effect\": {\n          \"type\": \"String\",\n          \"defaultValue\": \"Deny\",\n          \"allowedValues\": [\n            \"Audit\",\n            \"Deny\",\n            \"Disabled\"\n          ],\n          \"metadata\": {\n            \"displayName\": \"Effect\",\n            \"description\": \"The effect determines what happens when the policy rule is evaluated to match\"\n          }\n        },\n        \"allowedSmbVersion\": {\n          \"type\": \"String\",\n          \"defaultValue\": \"SMB3.1.1\",\n          \"allowedValues\": [\n            \"SMB2.1\",\n            \"SMB3.0\",\n            \"SMB3.1.1\"\n          ],\n          \"metadata\": {\n            \"displayName\": \"Allowed SMB Version\",\n            \"description\": \"The allowed SMB version for maximum security\"\n          }\n        }\n      },\n      \"policyRule\": {\n        \"if\": {\n          \"allOf\": [\n            {\n              \"field\": \"type\",\n              \"equals\": \"Microsoft.Storage/storageAccounts/fileServices\"\n            },\n            {\n              \"not\":\n                {\n                  \"field\": \"Microsoft.Storage/storageAccounts/fileServices/protocolSettings.smb.versions\",\n                  \"contains\": \"[[parameters('allowedSmbVersion')]\"\n                }\n            }\n          ]\n        },\n        \"then\": {\n          \"effect\": \"[[parameters('effect')]\"\n        }\n      }\n    }\n  }",
    "$fxv#36": "{\n    \"name\": \"Deny-FileServices-InsecureAuth\",\n    \"type\": \"Microsoft.Authorization/policyDefinitions\",\n    \"apiVersion\": \"2021-06-01\",\n    \"scope\": null,\n    \"properties\": {\n      \"policyType\": \"Custom\",\n      \"mode\": \"All\",\n      \"displayName\": \"File Services with insecure authentication methods should be denied\",\n      \"description\": \"This policy denies the use of insecure authentication methods (NTLMv2) when using File Services on a storage account.\",\n      \"metadata\": {\n        \"version\": \"1.0.0\",\n        \"category\": \"Storage\",\n        \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n        \"alzCloudEnvironments\": [\n          \"AzureCloud\",\n          \"AzureChinaCloud\",\n          \"AzureUSGovernment\"\n        ]\n      },\n      \"parameters\": {\n        \"effect\": {\n          \"type\": \"String\",\n          \"defaultValue\": \"Deny\",\n          \"allowedValues\": [\n            \"Audit\",\n            \"Deny\",\n            \"Disabled\"\n          ],\n          \"metadata\": {\n            \"displayName\": \"Effect\",\n            \"description\": \"The effect determines what happens when the policy rule is evaluated to match\"\n          }\n        },\n        \"notAllowedAuthMethods\": {\n          \"type\": \"String\",\n          \"defaultValue\": \"NTLMv2\",\n          \"allowedValues\": [\n            \"NTLMv2\",\n            \"Kerberos\"\n          ],\n          \"metadata\": {\n            \"displayName\": \"Authentication methods supported by server. Valid values are NTLMv2, Kerberos.\",\n            \"description\": \"The list of channelEncryption not allowed.\"\n          }\n         }\n      },\n      \"policyRule\": {\n        \"if\": {\n          \"allOf\": [\n            {\n              \"field\": \"Microsoft.Storage/storageAccounts/fileServices/protocolSettings.smb.authenticationMethods\",\n              \"contains\": \"[[parameters('notAllowedAuthMethods')]\"\n            },\n            {\n              \"field\": \"type\",\n              \"equals\": \"Microsoft.Storage/storageAccounts/fileServices\"\n            }\n          ]\n        },\n        \"then\": {\n          \"effect\": \"[[parameters('effect')]\"\n        }\n      }\n    }\n  }",
    "$fxv#37": "{\n  \"name\": \"Deploy-ASC-SecurityContacts\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Microsoft Defender for Cloud Security Contacts\",\n    \"description\": \"Deploy Microsoft Defender for Cloud Security Contacts\",\n    \"metadata\": {\n      \"version\": \"1.1.0\",\n      \"category\": \"Security Center\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"emailSecurityContact\": {\n        \"type\": \"string\",\n        \"metadata\": {\n          \"displayName\": \"Security contacts email address\",\n          \"description\": \"Provide email address for Azure Security Center contact details\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"string\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"minimalSeverity\": {\n        \"type\": \"string\",\n        \"defaultValue\": \"High\",\n        \"allowedValues\": [\n          \"High\",\n          \"Medium\",\n          \"Low\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Minimal severity\",\n          \"description\": \"Defines the minimal alert severity which will be sent as email notifications\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Resources/subscriptions\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Security/securityContacts\",\n          \"deploymentScope\": \"subscription\",\n          \"existenceScope\": \"subscription\",\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd\"\n          ],\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Security/securityContacts/email\",\n                \"contains\": \"[[parameters('emailSecurityContact')]\"\n              },\n              {\n                \"field\": \"Microsoft.Security/securityContacts/alertNotifications.minimalSeverity\",\n                \"contains\": \"[[parameters('minimalSeverity')]\"\n              },\n              {\n                \"field\": \"type\",\n                \"equals\": \"Microsoft.Security/securityContacts\"\n              },\n              {\n                \"field\": \"Microsoft.Security/securityContacts/alertNotifications\",\n                \"equals\": \"On\"\n              },\n              {\n                \"field\": \"Microsoft.Security/securityContacts/alertsToAdmins\",\n                \"equals\": \"On\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"location\": \"northeurope\",\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"parameters\": {\n                \"emailSecurityContact\": {\n                  \"value\": \"[[parameters('emailSecurityContact')]\"\n                },\n                \"minimalSeverity\": {\n                  \"value\": \"[[parameters('minimalSeverity')]\"\n                }\n              },\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"emailSecurityContact\": {\n                    \"type\": \"string\",\n                    \"metadata\": {\n                      \"description\": \"Security contacts email address\"\n                    }\n                  },\n                  \"minimalSeverity\": {\n                    \"type\": \"string\",\n                    \"metadata\": {\n                      \"description\": \"Minimal severity level reported\"\n                    }\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Security/securityContacts\",\n                    \"name\": \"default\",\n                    \"apiVersion\": \"2020-01-01-preview\",\n                    \"properties\": {\n                      \"emails\": \"[[parameters('emailSecurityContact')]\",\n                      \"notificationsByRole\": {\n                        \"state\": \"On\",\n                        \"roles\": [\n                          \"Owner\"\n                        ]\n                      },\n                      \"alertNotifications\": {\n                        \"state\": \"On\",\n                        \"minimalSeverity\": \"[[parameters('minimalSeverity')]\"\n                      }\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#38": "{\n  \"name\": \"Deploy-Custom-Route-Table\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"Deploy a route table with specific user defined routes\",\n    \"description\": \"Deploys a route table with specific user defined routes when one does not exist. The route table deployed by the policy must be manually associated to subnet(s)\",\n    \"metadata\": {\n      \"version\": \"1.0.0\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        },\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"defaultValue\": \"DeployIfNotExists\"\n      },\n      \"requiredRoutes\": {\n        \"type\": \"Array\",\n        \"metadata\": {\n          \"displayName\": \"requiredRoutes\",\n          \"description\": \"Routes that must exist in compliant route tables deployed by this policy\"\n        }\n      },\n      \"vnetRegion\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"vnetRegion\",\n          \"description\": \"Only VNets in this region will be evaluated against this policy\"\n        }\n      },\n      \"routeTableName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"routeTableName\",\n          \"description\": \"Name of the route table automatically deployed by this policy\"\n        }\n      },\n      \"disableBgpPropagation\": {\n        \"type\": \"Boolean\",\n        \"metadata\": {\n          \"displayName\": \"DisableBgpPropagation\",\n          \"description\": \"Disable BGP Propagation\"\n        },\n        \"defaultValue\": false\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/virtualNetworks\"\n          },\n          {\n            \"field\": \"location\",\n            \"equals\": \"[[parameters('vnetRegion')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Network/routeTables\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"name\",\n                \"equals\": \"[[parameters('routeTableName')]\"\n              },\n              {\n                \"count\": {\n                  \"field\": \"Microsoft.Network/routeTables/routes[*]\",\n                  \"where\": {\n                    \"value\": \"[[concat(current('Microsoft.Network/routeTables/routes[*].addressPrefix'), ';', current('Microsoft.Network/routeTables/routes[*].nextHopType'), if(equals(toLower(current('Microsoft.Network/routeTables/routes[*].nextHopType')),'virtualappliance'), concat(';', current('Microsoft.Network/routeTables/routes[*].nextHopIpAddress')), ''))]\",\n                    \"in\": \"[[parameters('requiredRoutes')]\"\n                  }\n                },\n                \"equals\": \"[[length(parameters('requiredRoutes'))]\"\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/subscriptions/e867a45d-e513-44ac-931e-4741cef80b24/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"routeTableName\": {\n                    \"type\": \"string\"\n                  },\n                  \"vnetRegion\": {\n                    \"type\": \"string\"\n                  },\n                  \"requiredRoutes\": {\n                    \"type\": \"array\"\n                  },\n                  \"disableBgpPropagation\": {\n                    \"type\": \"bool\"\n                  }\n                },\n                \"variables\": {\n                  \"copyLoop\": [\n                    {\n                      \"name\": \"routes\",\n                      \"count\": \"[[[length(parameters('requiredRoutes'))]\",\n                      \"input\": {\n                        \"name\": \"[[[concat('route-',copyIndex('routes'))]\",\n                        \"properties\": {\n                          \"addressPrefix\": \"[[[split(parameters('requiredRoutes')[copyIndex('routes')], ';')[0]]\",\n                          \"nextHopType\": \"[[[split(parameters('requiredRoutes')[copyIndex('routes')], ';')[1]]\",\n                          \"nextHopIpAddress\": \"[[[if(equals(toLower(split(parameters('requiredRoutes')[copyIndex('routes')], ';')[1]),'virtualappliance'),split(parameters('requiredRoutes')[copyIndex('routes')], ';')[2], null())]\"\n                        }\n                      }\n                    }\n                  ]\n                },\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Resources/deployments\",\n                    \"apiVersion\": \"2021-04-01\",\n                    \"name\": \"routeTableDepl\",\n                    \"properties\": {\n                      \"mode\": \"Incremental\",\n                      \"template\": {\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                        \"contentVersion\": \"1.0.0.0\",\n                        \"parameters\": {\n                          \"routeTableName\": {\n                            \"type\": \"string\"\n                          },\n                          \"vnetRegion\": {\n                            \"type\": \"string\"\n                          },\n                          \"requiredRoutes\": {\n                            \"type\": \"array\"\n                          },\n                          \"disableBgpPropagation\": {\n                            \"type\": \"bool\"\n                          }\n                        },\n                        \"resources\": [\n                          {\n                            \"type\": \"Microsoft.Network/routeTables\",\n                            \"apiVersion\": \"2021-02-01\",\n                            \"name\": \"[[[parameters('routeTableName')]\",\n                            \"location\": \"[[[parameters('vnetRegion')]\",\n                            \"properties\": {\n                              \"disableBgpRoutePropagation\": \"[[[parameters('disableBgpPropagation')]\",\n                              \"copy\": \"[[variables('copyLoop')]\"\n                            }\n                          }\n                        ]\n                      },\n                      \"parameters\": {\n                        \"routeTableName\": {\n                          \"value\": \"[[parameters('routeTableName')]\"\n                        },\n                        \"vnetRegion\": {\n                          \"value\": \"[[parameters('vnetRegion')]\"\n                        },\n                        \"requiredRoutes\": {\n                          \"value\": \"[[parameters('requiredRoutes')]\"\n                        },\n                        \"disableBgpPropagation\": {\n                          \"value\": \"[[parameters('disableBgpPropagation')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"routeTableName\": {\n                  \"value\": \"[[parameters('routeTableName')]\"\n                },\n                \"vnetRegion\": {\n                  \"value\": \"[[parameters('vnetRegion')]\"\n                },\n                \"requiredRoutes\": {\n                  \"value\": \"[[parameters('requiredRoutes')]\"\n                },\n                \"disableBgpPropagation\": {\n                  \"value\": \"[[parameters('disableBgpPropagation')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#39": "{\n  \"name\": \"Deploy-DDoSProtection\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy an Azure DDoS Network Protection\",\n    \"description\": \"Deploys an Azure DDoS Network Protection\",\n    \"metadata\": {\n      \"version\": \"1.0.1\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"ddosName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ddosName\",\n          \"description\": \"DDoSVnet\"\n        }\n      },\n      \"ddosRegion\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"ddosRegion\",\n          \"description\": \"DDoSVnet location\",\n          \"strongType\": \"location\"\n        }\n      },\n      \"rgName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"rgName\",\n          \"description\": \"Provide name for resource group.\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Resources/subscriptions\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Network/ddosProtectionPlans\",\n          \"deploymentScope\": \"subscription\",\n          \"existenceScope\": \"resourceGroup\",\n          \"resourceGroupName\": \"[[parameters('rgName')]\",\n          \"name\": \"[[parameters('ddosName')]\",\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"\n          ],\n          \"deployment\": {\n            \"location\": \"northeurope\",\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"parameters\": {\n                \"rgName\": {\n                  \"value\": \"[[parameters('rgName')]\"\n                },\n                \"ddosname\": {\n                  \"value\": \"[[parameters('ddosname')]\"\n                },\n                \"ddosregion\": {\n                  \"value\": \"[[parameters('ddosRegion')]\"\n                }\n              },\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"rgName\": {\n                    \"type\": \"String\"\n                  },\n                  \"ddosname\": {\n                    \"type\": \"String\"\n                  },\n                  \"ddosRegion\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\n                    \"apiVersion\": \"2018-05-01\",\n                    \"name\": \"[[parameters('rgName')]\",\n                    \"location\": \"[[deployment().location]\",\n                    \"properties\": {}\n                  },\n                  {\n                    \"type\": \"Microsoft.Resources/deployments\",\n                    \"apiVersion\": \"2018-05-01\",\n                    \"name\": \"ddosprotection\",\n                    \"resourceGroup\": \"[[parameters('rgName')]\",\n                    \"dependsOn\": [\n                      \"[[resourceId('Microsoft.Resources/resourceGroups/', parameters('rgName'))]\"\n                    ],\n                    \"properties\": {\n                      \"mode\": \"Incremental\",\n                      \"template\": {\n                        \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json\",\n                        \"contentVersion\": \"1.0.0.0\",\n                        \"parameters\": {},\n                        \"resources\": [\n                          {\n                            \"type\": \"Microsoft.Network/ddosProtectionPlans\",\n                            \"apiVersion\": \"2019-12-01\",\n                            \"name\": \"[[parameters('ddosName')]\",\n                            \"location\": \"[[parameters('ddosRegion')]\",\n                            \"properties\": {}\n                          }\n                        ],\n                        \"outputs\": {}\n                      }\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#4": "{\n  \"name\": \"Append-Redis-sslEnforcement\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"Azure Cache for Redis Append a specific min TLS version requirement and enforce TLS.\",\n    \"description\": \"Append a specific min TLS version requirement and enforce SSL on Azure Cache for Redis. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.\",\n    \"metadata\": {\n      \"version\": \"1.0.0\",\n      \"category\": \"Cache\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"Append\",\n        \"allowedValues\": [\n          \"Append\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect Azure Cache for Redis\",\n          \"description\": \"Enable or disable the execution of the policy minimum TLS version Azure Cache for Redis\"\n        }\n      },\n      \"minimumTlsVersion\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"1.2\",\n        \"allowedValues\": [\n          \"1.2\",\n          \"1.1\",\n          \"1.0\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Select version for Redis server\",\n          \"description\": \"Select version minimum TLS version Azure Cache for Redis to enforce\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Cache/redis\"\n          },\n          {\n            \"anyOf\": [\n              {\n                \"field\": \"Microsoft.Cache/Redis/minimumTlsVersion\",\n                \"notequals\": \"[[parameters('minimumTlsVersion')]\"\n              }\n            ]\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": [\n          {\n            \"field\": \"Microsoft.Cache/Redis/minimumTlsVersion\",\n            \"value\": \"[[parameters('minimumTlsVersion')]\"\n          }\n        ]\n      }\n    }\n  }\n}\n",
    "$fxv#40": "{\n  \"name\": \"Deploy-Diagnostics-AA\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated]: Deploy Diagnostic Settings for Automation to Log Analytics workspace\",\n    \"description\": \"Deploys the diagnostic settings for Automation to stream to a Log Analytics workspace when any Automation which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"version\": \"1.1.0-deprecated\",\n      \"category\": \"Monitoring\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"logAnalytics\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Log Analytics workspace\",\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\n          \"strongType\": \"omsWorkspace\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"profileName\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"setbypolicy\",\n        \"metadata\": {\n          \"displayName\": \"Profile name\",\n          \"description\": \"The diagnostic settings profile name\"\n        }\n      },\n      \"metricsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable metrics\",\n          \"description\": \"Whether to enable metrics stream to the Log Analytics workspace - True or False\"\n        }\n      },\n      \"logsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable logs\",\n          \"description\": \"Whether to enable logs stream to the Log Analytics workspace - True or False\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.Automation/automationAccounts\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\n          \"name\": \"[[parameters('profileName')]\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/workspaceId\",\n                \"equals\": \"[[parameters('logAnalytics')]\"\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logAnalytics\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"profileName\": {\n                    \"type\": \"String\"\n                  },\n                  \"metricsEnabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"logsEnabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Automation/automationAccounts/providers/diagnosticSettings\",\n                    \"apiVersion\": \"2017-05-01-preview\",\n                    \"name\": \"[[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"dependsOn\": [],\n                    \"properties\": {\n                      \"workspaceId\": \"[[parameters('logAnalytics')]\",\n                      \"metrics\": [\n                        {\n                          \"category\": \"AllMetrics\",\n                          \"timeGrain\": null,\n                          \"enabled\": \"[[parameters('metricsEnabled')]\",\n                          \"retentionPolicy\": {\n                            \"enabled\": false,\n                            \"days\": 0\n                          }\n                        }\n                      ],\n                      \"logs\": [\n                        {\n                          \"category\": \"JobLogs\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"JobStreams\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"DscNodeStatus\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"AuditEvent\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        }\n                      ]\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"logAnalytics\": {\n                  \"value\": \"[[parameters('logAnalytics')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"profileName\": {\n                  \"value\": \"[[parameters('profileName')]\"\n                },\n                \"metricsEnabled\": {\n                  \"value\": \"[[parameters('metricsEnabled')]\"\n                },\n                \"logsEnabled\": {\n                  \"value\": \"[[parameters('logsEnabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#41": "{\n  \"name\": \"Deploy-Diagnostics-ACI\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated]: Deploy Diagnostic Settings for Container Instances to Log Analytics workspace\",\n    \"description\": \"Deploys the diagnostic settings for Container Instances to stream to a Log Analytics workspace when any ACR which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"version\": \"1.1.0-deprecated\",\n      \"category\": \"Monitoring\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"logAnalytics\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Log Analytics workspace\",\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\n          \"strongType\": \"omsWorkspace\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"profileName\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"setbypolicy\",\n        \"metadata\": {\n          \"displayName\": \"Profile name\",\n          \"description\": \"The diagnostic settings profile name\"\n        }\n      },\n      \"metricsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable metrics\",\n          \"description\": \"Whether to enable metrics stream to the Log Analytics workspace - True or False\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.ContainerInstance/containerGroups\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\n          \"name\": \"[[parameters('profileName')]\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/workspaceId\",\n                \"equals\": \"[[parameters('logAnalytics')]\"\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logAnalytics\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"profileName\": {\n                    \"type\": \"String\"\n                  },\n                  \"metricsEnabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.ContainerInstance/containerGroups/providers/diagnosticSettings\",\n                    \"apiVersion\": \"2017-05-01-preview\",\n                    \"name\": \"[[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"dependsOn\": [],\n                    \"properties\": {\n                      \"workspaceId\": \"[[parameters('logAnalytics')]\",\n                      \"metrics\": [\n                        {\n                          \"category\": \"AllMetrics\",\n                          \"enabled\": \"[[parameters('metricsEnabled')]\",\n                          \"retentionPolicy\": {\n                            \"days\": 0,\n                            \"enabled\": false\n                          },\n                          \"timeGrain\": null\n                        }\n                      ],\n                      \"logs\": []\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"logAnalytics\": {\n                  \"value\": \"[[parameters('logAnalytics')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"profileName\": {\n                  \"value\": \"[[parameters('profileName')]\"\n                },\n                \"metricsEnabled\": {\n                  \"value\": \"[[parameters('metricsEnabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#42": "{\n  \"name\": \"Deploy-Diagnostics-ACR\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated]: Deploy Diagnostic Settings for Container Registry to Log Analytics workspace\",\n    \"description\": \"Deploys the diagnostic settings for Container Registry to stream to a Log Analytics workspace when any ACR which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"version\": \"1.1.0-deprecated\",\n      \"category\": \"Monitoring\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"logAnalytics\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Log Analytics workspace\",\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\n          \"strongType\": \"omsWorkspace\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"profileName\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"setbypolicy\",\n        \"metadata\": {\n          \"displayName\": \"Profile name\",\n          \"description\": \"The diagnostic settings profile name\"\n        }\n      },\n      \"metricsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable metrics\",\n          \"description\": \"Whether to enable metrics stream to the Log Analytics workspace - True or False\"\n        }\n      },\n      \"logsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable logs\",\n          \"description\": \"Whether to enable logs stream to the Log Analytics workspace - True or False\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.ContainerRegistry/registries\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\n          \"name\": \"[[parameters('profileName')]\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/workspaceId\",\n                \"equals\": \"[[parameters('logAnalytics')]\"\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logAnalytics\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"profileName\": {\n                    \"type\": \"String\"\n                  },\n                  \"metricsEnabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"logsEnabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.ContainerRegistry/registries/providers/diagnosticSettings\",\n                    \"apiVersion\": \"2017-05-01-preview\",\n                    \"name\": \"[[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"dependsOn\": [],\n                    \"properties\": {\n                      \"workspaceId\": \"[[parameters('logAnalytics')]\",\n                      \"metrics\": [\n                        {\n                          \"category\": \"AllMetrics\",\n                          \"enabled\": \"[[parameters('metricsEnabled')]\",\n                          \"retentionPolicy\": {\n                            \"days\": 0,\n                            \"enabled\": false\n                          },\n                          \"timeGrain\": null\n                        }\n                      ],\n                      \"logs\": [\n                        {\n                          \"category\": \"ContainerRegistryLoginEvents\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"ContainerRegistryRepositoryEvents\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        }\n                      ]\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"logAnalytics\": {\n                  \"value\": \"[[parameters('logAnalytics')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"profileName\": {\n                  \"value\": \"[[parameters('profileName')]\"\n                },\n                \"metricsEnabled\": {\n                  \"value\": \"[[parameters('metricsEnabled')]\"\n                },\n                \"logsEnabled\": {\n                  \"value\": \"[[parameters('logsEnabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#43": "{\n  \"name\": \"Deploy-Diagnostics-AnalysisService\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated]: Deploy Diagnostic Settings for Analysis Services to Log Analytics workspace\",\n    \"description\": \"Deploys the diagnostic settings for Analysis Services to stream to a Log Analytics workspace when any Analysis Services which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"version\": \"1.1.0-deprecated\",\n      \"category\": \"Monitoring\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"logAnalytics\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Log Analytics workspace\",\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\n          \"strongType\": \"omsWorkspace\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"profileName\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"setbypolicy\",\n        \"metadata\": {\n          \"displayName\": \"Profile name\",\n          \"description\": \"The diagnostic settings profile name\"\n        }\n      },\n      \"metricsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable metrics\",\n          \"description\": \"Whether to enable metrics stream to the Log Analytics workspace - True or False\"\n        }\n      },\n      \"logsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable logs\",\n          \"description\": \"Whether to enable logs stream to the Log Analytics workspace - True or False\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.AnalysisServices/servers\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\n          \"name\": \"[[parameters('profileName')]\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/workspaceId\",\n                \"equals\": \"[[parameters('logAnalytics')]\"\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logAnalytics\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"profileName\": {\n                    \"type\": \"String\"\n                  },\n                  \"metricsEnabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"logsEnabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.AnalysisServices/servers/providers/diagnosticSettings\",\n                    \"apiVersion\": \"2017-05-01-preview\",\n                    \"name\": \"[[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"dependsOn\": [],\n                    \"properties\": {\n                      \"workspaceId\": \"[[parameters('logAnalytics')]\",\n                      \"metrics\": [\n                        {\n                          \"category\": \"AllMetrics\",\n                          \"enabled\": \"[[parameters('metricsEnabled')]\",\n                          \"retentionPolicy\": {\n                            \"days\": 0,\n                            \"enabled\": false\n                          },\n                          \"timeGrain\": null\n                        }\n                      ],\n                      \"logs\": [\n                        {\n                          \"category\": \"Engine\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"Service\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        }\n                      ]\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"logAnalytics\": {\n                  \"value\": \"[[parameters('logAnalytics')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"profileName\": {\n                  \"value\": \"[[parameters('profileName')]\"\n                },\n                \"metricsEnabled\": {\n                  \"value\": \"[[parameters('metricsEnabled')]\"\n                },\n                \"logsEnabled\": {\n                  \"value\": \"[[parameters('logsEnabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#44": "{\n  \"name\": \"Deploy-Diagnostics-ApiForFHIR\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated]: Deploy Diagnostic Settings for Azure API for FHIR to Log Analytics workspace\",\n    \"description\": \"Deploys the diagnostic settings for Azure API for FHIR to stream to a Log Analytics workspace when any Azure API for FHIR which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"version\": \"1.1.0-deprecated\",\n      \"category\": \"Monitoring\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"logAnalytics\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Log Analytics workspace\",\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\n          \"strongType\": \"omsWorkspace\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"profileName\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"setbypolicy\",\n        \"metadata\": {\n          \"displayName\": \"Profile name\",\n          \"description\": \"The diagnostic settings profile name\"\n        }\n      },\n      \"metricsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable metrics\",\n          \"description\": \"Whether to enable metrics stream to the Log Analytics workspace - True or False\"\n        }\n      },\n      \"logsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable logs\",\n          \"description\": \"Whether to enable logs stream to the Log Analytics workspace - True or False\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.HealthcareApis/services\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\n          \"name\": \"[[parameters('profileName')]\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/workspaceId\",\n                \"equals\": \"[[parameters('logAnalytics')]\"\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logAnalytics\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"profileName\": {\n                    \"type\": \"String\"\n                  },\n                  \"metricsEnabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"logsEnabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.HealthcareApis/services/providers/diagnosticSettings\",\n                    \"apiVersion\": \"2017-05-01-preview\",\n                    \"name\": \"[[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"dependsOn\": [],\n                    \"properties\": {\n                      \"workspaceId\": \"[[parameters('logAnalytics')]\",\n                      \"metrics\": [\n                        {\n                          \"category\": \"AllMetrics\",\n                          \"enabled\": \"[[parameters('metricsEnabled')]\",\n                          \"retentionPolicy\": {\n                            \"days\": 0,\n                            \"enabled\": false\n                          },\n                          \"timeGrain\": null\n                        }\n                      ],\n                      \"logs\": [\n                        {\n                          \"category\": \"AuditLogs\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        }\n                      ]\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"logAnalytics\": {\n                  \"value\": \"[[parameters('logAnalytics')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"profileName\": {\n                  \"value\": \"[[parameters('profileName')]\"\n                },\n                \"metricsEnabled\": {\n                  \"value\": \"[[parameters('metricsEnabled')]\"\n                },\n                \"logsEnabled\": {\n                  \"value\": \"[[parameters('logsEnabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#45": "{\n  \"name\": \"Deploy-Diagnostics-APIMgmt\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated]: Deploy Diagnostic Settings for API Management to Log Analytics workspace\",\n    \"description\": \"Deploys the diagnostic settings for API Management to stream to a Log Analytics workspace when any API Management which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"version\": \"1.2.0-deprecated\",\n      \"category\": \"Monitoring\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"logAnalytics\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Log Analytics workspace\",\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\n          \"strongType\": \"omsWorkspace\"\n        }\n      },\n      \"logAnalyticsDestinationType\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Log Analytics destination type\",\n          \"description\": \"Select destination type for Log Analytics. Allowed values are 'Dedicated' (resource specific) and 'AzureDiagnostics'. Default is 'AzureDiagnostics'\"\n        },\n        \"defaultValue\": \"AzureDiagnostics\",\n        \"allowedValues\": [\n          \"AzureDiagnostics\",\n          \"Dedicated\"\n        ]\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"profileName\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"setbypolicy\",\n        \"metadata\": {\n          \"displayName\": \"Profile name\",\n          \"description\": \"The diagnostic settings profile name\"\n        }\n      },\n      \"metricsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable metrics\",\n          \"description\": \"Whether to enable metrics stream to the Log Analytics workspace - True or False\"\n        }\n      },\n      \"logsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable logs\",\n          \"description\": \"Whether to enable logs stream to the Log Analytics workspace - True or False\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.ApiManagement/service\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\n          \"name\": \"[[parameters('profileName')]\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/workspaceId\",\n                \"equals\": \"[[parameters('logAnalytics')]\"\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logAnalytics\": {\n                    \"type\": \"String\"\n                  },\n                  \"logAnalyticsDestinationType\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"profileName\": {\n                    \"type\": \"String\"\n                  },\n                  \"metricsEnabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"logsEnabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.ApiManagement/service/providers/diagnosticSettings\",\n                    \"apiVersion\": \"2017-05-01-preview\",\n                    \"name\": \"[[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"dependsOn\": [],\n                    \"properties\": {\n                      \"workspaceId\": \"[[parameters('logAnalytics')]\",\n                      \"metrics\": [\n                        {\n                          \"category\": \"AllMetrics\",\n                          \"enabled\": \"[[parameters('metricsEnabled')]\",\n                          \"retentionPolicy\": {\n                            \"days\": 0,\n                            \"enabled\": false\n                          },\n                          \"timeGrain\": null\n                        }\n                      ],\n                      \"logs\": [\n                        {\n                          \"category\": \"GatewayLogs\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"WebSocketConnectionLogs\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        }\n                      ],\n                      \"logAnalyticsDestinationType\": \"[[parameters('logAnalyticsDestinationType')]\"\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"logAnalytics\": {\n                  \"value\": \"[[parameters('logAnalytics')]\"\n                },\n                \"logAnalyticsDestinationType\": {\n                  \"value\": \"[[parameters('logAnalyticsDestinationType')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"profileName\": {\n                  \"value\": \"[[parameters('profileName')]\"\n                },\n                \"metricsEnabled\": {\n                  \"value\": \"[[parameters('metricsEnabled')]\"\n                },\n                \"logsEnabled\": {\n                  \"value\": \"[[parameters('logsEnabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#46": "{\n  \"name\": \"Deploy-Diagnostics-ApplicationGateway\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated]: Deploy Diagnostic Settings for Application Gateway to Log Analytics workspace\",\n    \"description\": \"Deploys the diagnostic settings for Application Gateway to stream to a Log Analytics workspace when any Application Gateway which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"version\": \"1.1.0-deprecated\",\n      \"category\": \"Monitoring\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"logAnalytics\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Log Analytics workspace\",\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\n          \"strongType\": \"omsWorkspace\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"profileName\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"setbypolicy\",\n        \"metadata\": {\n          \"displayName\": \"Profile name\",\n          \"description\": \"The diagnostic settings profile name\"\n        }\n      },\n      \"metricsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable metrics\",\n          \"description\": \"Whether to enable metrics stream to the Log Analytics workspace - True or False\"\n        }\n      },\n      \"logsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable logs\",\n          \"description\": \"Whether to enable logs stream to the Log Analytics workspace - True or False\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.Network/applicationGateways\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\n          \"name\": \"[[parameters('profileName')]\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/workspaceId\",\n                \"equals\": \"[[parameters('logAnalytics')]\"\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logAnalytics\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"profileName\": {\n                    \"type\": \"String\"\n                  },\n                  \"metricsEnabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"logsEnabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Network/applicationGateways/providers/diagnosticSettings\",\n                    \"apiVersion\": \"2017-05-01-preview\",\n                    \"name\": \"[[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"dependsOn\": [],\n                    \"properties\": {\n                      \"workspaceId\": \"[[parameters('logAnalytics')]\",\n                      \"metrics\": [\n                        {\n                          \"category\": \"AllMetrics\",\n                          \"enabled\": \"[[parameters('metricsEnabled')]\",\n                          \"retentionPolicy\": {\n                            \"days\": 0,\n                            \"enabled\": false\n                          },\n                          \"timeGrain\": null\n                        }\n                      ],\n                      \"logs\": [\n                        {\n                          \"category\": \"ApplicationGatewayAccessLog\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"ApplicationGatewayPerformanceLog\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"ApplicationGatewayFirewallLog\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        }\n                      ]\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"logAnalytics\": {\n                  \"value\": \"[[parameters('logAnalytics')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"profileName\": {\n                  \"value\": \"[[parameters('profileName')]\"\n                },\n                \"metricsEnabled\": {\n                  \"value\": \"[[parameters('metricsEnabled')]\"\n                },\n                \"logsEnabled\": {\n                  \"value\": \"[[parameters('logsEnabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#47": "{\n  \"name\": \"Deploy-Diagnostics-Bastion\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated]: Deploy Diagnostic Settings for Azure Bastion to Log Analytics workspace\",\n    \"description\": \"Deploys the diagnostic settings for Azure Bastion to stream to a Log Analytics workspace when any Azure Bastion which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"version\": \"1.1.0-deprecated\",\n      \"category\": \"Monitoring\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"logAnalytics\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Log Analytics workspace\",\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\n          \"strongType\": \"omsWorkspace\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"profileName\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"setbypolicy\",\n        \"metadata\": {\n          \"displayName\": \"Profile name\",\n          \"description\": \"The diagnostic settings profile name\"\n        }\n      },\n      \"metricsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable metrics\",\n          \"description\": \"Whether to enable metrics stream to the Log Analytics workspace - True or False\"\n        }\n      },\n      \"logsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable logs\",\n          \"description\": \"Whether to enable logs stream to the Log Analytics workspace - True or False\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.Network/bastionHosts\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\n          \"name\": \"[[parameters('profileName')]\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/workspaceId\",\n                \"equals\": \"[[parameters('logAnalytics')]\"\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logAnalytics\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"profileName\": {\n                    \"type\": \"String\"\n                  },\n                  \"metricsEnabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"logsEnabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Network/bastionHosts/providers/diagnosticSettings\",\n                    \"apiVersion\": \"2017-05-01-preview\",\n                    \"name\": \"[[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"dependsOn\": [],\n                    \"properties\": {\n                      \"workspaceId\": \"[[parameters('logAnalytics')]\",\n                      \"metrics\": [\n                        {\n                          \"category\": \"AllMetrics\",\n                          \"enabled\": \"[[parameters('metricsEnabled')]\",\n                          \"retentionPolicy\": {\n                            \"days\": 0,\n                            \"enabled\": false\n                          },\n                          \"timeGrain\": null\n                        }\n                      ],\n                      \"logs\": [\n                        {\n                          \"category\": \"BastionAuditLogs\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        }\n                      ]\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"logAnalytics\": {\n                  \"value\": \"[[parameters('logAnalytics')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"profileName\": {\n                  \"value\": \"[[parameters('profileName')]\"\n                },\n                \"metricsEnabled\": {\n                  \"value\": \"[[parameters('metricsEnabled')]\"\n                },\n                \"logsEnabled\": {\n                  \"value\": \"[[parameters('logsEnabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#48": "{\n  \"name\": \"Deploy-Diagnostics-CDNEndpoints\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated]: Deploy Diagnostic Settings for CDN Endpoint to Log Analytics workspace\",\n    \"description\": \"Deploys the diagnostic settings for CDN Endpoint to stream to a Log Analytics workspace when any CDN Endpoint which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"version\": \"1.1.0-deprecated\",\n      \"category\": \"Monitoring\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"logAnalytics\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Log Analytics workspace\",\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\n          \"strongType\": \"omsWorkspace\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"profileName\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"setbypolicy\",\n        \"metadata\": {\n          \"displayName\": \"Profile name\",\n          \"description\": \"The diagnostic settings profile name\"\n        }\n      },\n      \"logsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable logs\",\n          \"description\": \"Whether to enable logs stream to the Log Analytics workspace - True or False\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.Cdn/profiles/endpoints\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\n          \"name\": \"[[parameters('profileName')]\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/workspaceId\",\n                \"equals\": \"[[parameters('logAnalytics')]\"\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logAnalytics\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"profileName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logsEnabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Cdn/profiles/endpoints/providers/diagnosticSettings\",\n                    \"apiVersion\": \"2017-05-01-preview\",\n                    \"name\": \"[[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"dependsOn\": [],\n                    \"properties\": {\n                      \"workspaceId\": \"[[parameters('logAnalytics')]\",\n                      \"metrics\": [],\n                      \"logs\": [\n                        {\n                          \"category\": \"CoreAnalytics\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        }\n                      ]\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"logAnalytics\": {\n                  \"value\": \"[[parameters('logAnalytics')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"resourceName\": {\n                  \"value\": \"[[field('fullName')]\"\n                },\n                \"profileName\": {\n                  \"value\": \"[[parameters('profileName')]\"\n                },\n                \"logsEnabled\": {\n                  \"value\": \"[[parameters('logsEnabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#49": "{\n  \"name\": \"Deploy-Diagnostics-CognitiveServices\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated]: Deploy Diagnostic Settings for Cognitive Services to Log Analytics workspace\",\n    \"description\": \"Deploys the diagnostic settings for Cognitive Services to stream to a Log Analytics workspace when any Cognitive Services which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"version\": \"1.1.0-deprecated\",\n      \"category\": \"Monitoring\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"logAnalytics\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Log Analytics workspace\",\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\n          \"strongType\": \"omsWorkspace\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"profileName\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"setbypolicy\",\n        \"metadata\": {\n          \"displayName\": \"Profile name\",\n          \"description\": \"The diagnostic settings profile name\"\n        }\n      },\n      \"metricsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable metrics\",\n          \"description\": \"Whether to enable metrics stream to the Log Analytics workspace - True or False\"\n        }\n      },\n      \"logsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable logs\",\n          \"description\": \"Whether to enable logs stream to the Log Analytics workspace - True or False\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.CognitiveServices/accounts\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\n          \"name\": \"[[parameters('profileName')]\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/workspaceId\",\n                \"equals\": \"[[parameters('logAnalytics')]\"\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logAnalytics\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"profileName\": {\n                    \"type\": \"String\"\n                  },\n                  \"metricsEnabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"logsEnabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.CognitiveServices/accounts/providers/diagnosticSettings\",\n                    \"apiVersion\": \"2017-05-01-preview\",\n                    \"name\": \"[[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"dependsOn\": [],\n                    \"properties\": {\n                      \"workspaceId\": \"[[parameters('logAnalytics')]\",\n                      \"metrics\": [\n                        {\n                          \"category\": \"AllMetrics\",\n                          \"enabled\": \"[[parameters('metricsEnabled')]\",\n                          \"retentionPolicy\": {\n                            \"days\": 0,\n                            \"enabled\": false\n                          },\n                          \"timeGrain\": null\n                        }\n                      ],\n                      \"logs\": [\n                        {\n                          \"category\": \"Audit\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"RequestResponse\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"Trace\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        }\n                      ]\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"logAnalytics\": {\n                  \"value\": \"[[parameters('logAnalytics')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"profileName\": {\n                  \"value\": \"[[parameters('profileName')]\"\n                },\n                \"metricsEnabled\": {\n                  \"value\": \"[[parameters('metricsEnabled')]\"\n                },\n                \"logsEnabled\": {\n                  \"value\": \"[[parameters('logsEnabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#5": "{\n    \"name\": \"Audit-Disks-UnusedResourcesCostOptimization\",\n    \"type\": \"Microsoft.Authorization/policyDefinitions\",\n    \"apiVersion\": \"2021-06-01\",\n    \"scope\": null,\n    \"properties\": {\n        \"policyType\": \"Custom\",\n        \"displayName\": \"Unused Disks driving cost should be avoided\",\n        \"mode\": \"All\",\n        \"description\": \"Optimize cost by detecting unused but chargeable resources. Leverage this Policy definition as a cost control to reveal orphaned Disks that are driving cost.\",\n        \"metadata\": {\n            \"version\": \"1.0.0\",\n            \"category\": \"Cost Optimization\",\n            \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n            \"alzCloudEnvironments\": [\n                \"AzureCloud\",\n                \"AzureChinaCloud\",\n                \"AzureUSGovernment\"\n            ]\n        },\n        \"parameters\": {\n            \"effect\": {\n                \"type\": \"String\",\n                \"metadata\": {\n                    \"displayName\": \"Effect\",\n                    \"description\": \"Enable or disable the execution of the policy\"\n                },\n                \"allowedValues\": [\n                    \"Audit\",\n                    \"Disabled\"\n                ],\n                \"defaultValue\": \"Audit\"\n            }\n        },\n        \"policyRule\": {\n            \"if\": {\n                \"allOf\": [\n                    {\n                        \"field\": \"type\",\n                        \"equals\": \"Microsoft.Compute/disks\"\n                    },\n                    {\n                        \"field\": \"Microsoft.Compute/disks/diskState\",\n                        \"equals\": \"Unattached\"\n                    },\n                    {\n                        \"allof\": [\n                            {\n                                \"field\": \"name\",\n                                \"notlike\": \"*-ASRReplica\"\n                            },\n                            {\n                                \"field\": \"name\",\n                                \"notlike\": \"ms-asr-*\"\n                            },\n                            {\n                                \"field\": \"name\",\n                                \"notlike\": \"asrseeddisk-*\"\n                            }\n                        ]\n                    }\n                ]\n            },\n            \"then\": {\n                \"effect\": \"[[parameters('effect')]\"\n            }\n        }\n    }\n}",
    "$fxv#50": "{\n  \"name\": \"Deploy-Diagnostics-CosmosDB\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated]: Deploy Diagnostic Settings for Cosmos DB to Log Analytics workspace\",\n    \"description\": \"Deploys the diagnostic settings for Cosmos DB to stream to a Log Analytics workspace when any Cosmos DB which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"version\": \"1.2.0-deprecated\",\n      \"category\": \"Monitoring\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"logAnalytics\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Log Analytics workspace\",\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\n          \"strongType\": \"omsWorkspace\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"profileName\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"setbypolicy\",\n        \"metadata\": {\n          \"displayName\": \"Profile name\",\n          \"description\": \"The diagnostic settings profile name\"\n        }\n      },\n      \"metricsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable metrics\",\n          \"description\": \"Whether to enable metrics stream to the Log Analytics workspace - True or False\"\n        }\n      },\n      \"logsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable logs\",\n          \"description\": \"Whether to enable logs stream to the Log Analytics workspace - True or False\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.DocumentDB/databaseAccounts\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\n          \"name\": \"[[parameters('profileName')]\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/workspaceId\",\n                \"equals\": \"[[parameters('logAnalytics')]\"\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logAnalytics\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"profileName\": {\n                    \"type\": \"String\"\n                  },\n                  \"metricsEnabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"logsEnabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.DocumentDB/databaseAccounts/providers/diagnosticSettings\",\n                    \"apiVersion\": \"2017-05-01-preview\",\n                    \"name\": \"[[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"dependsOn\": [],\n                    \"properties\": {\n                      \"workspaceId\": \"[[parameters('logAnalytics')]\",\n                      \"metrics\": [\n                        {\n                          \"category\": \"Requests\",\n                          \"enabled\": \"[[parameters('metricsEnabled')]\",\n                          \"retentionPolicy\": {\n                            \"days\": 0,\n                            \"enabled\": false\n                          },\n                          \"timeGrain\": null\n                        }\n                      ],\n                      \"logs\": [\n                        {\n                          \"category\": \"DataPlaneRequests\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"MongoRequests\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"QueryRuntimeStatistics\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"PartitionKeyStatistics\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"PartitionKeyRUConsumption\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"ControlPlaneRequests\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"CassandraRequests\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"GremlinRequests\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"TableApiRequests\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        }\n                      ]\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"logAnalytics\": {\n                  \"value\": \"[[parameters('logAnalytics')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"profileName\": {\n                  \"value\": \"[[parameters('profileName')]\"\n                },\n                \"metricsEnabled\": {\n                  \"value\": \"[[parameters('metricsEnabled')]\"\n                },\n                \"logsEnabled\": {\n                  \"value\": \"[[parameters('logsEnabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#51": "{\n  \"name\": \"Deploy-Diagnostics-Databricks\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated]: Deploy Diagnostic Settings for Databricks to Log Analytics workspace\",\n    \"description\": \"Deploys the diagnostic settings for Databricks to stream to a Log Analytics workspace when any Databricks which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"version\": \"1.3.0-deprecated\",\n      \"category\": \"Monitoring\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"logAnalytics\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Log Analytics workspace\",\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\n          \"strongType\": \"omsWorkspace\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"profileName\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"setbypolicy\",\n        \"metadata\": {\n          \"displayName\": \"Profile name\",\n          \"description\": \"The diagnostic settings profile name\"\n        }\n      },\n      \"logsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable logs\",\n          \"description\": \"Whether to enable logs stream to the Log Analytics workspace - True or False\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.Databricks/workspaces\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\n          \"name\": \"[[parameters('profileName')]\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/workspaceId\",\n                \"equals\": \"[[parameters('logAnalytics')]\"\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logAnalytics\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"profileName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logsEnabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Databricks/workspaces/providers/diagnosticSettings\",\n                    \"apiVersion\": \"2017-05-01-preview\",\n                    \"name\": \"[[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"dependsOn\": [],\n                    \"properties\": {\n                      \"workspaceId\": \"[[parameters('logAnalytics')]\",\n                      \"logs\": [\n                        {\n                          \"category\": \"dbfs\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"clusters\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"accounts\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"jobs\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"notebook\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"ssh\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"workspace\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"secrets\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"sqlPermissions\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"instancePools\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"sqlanalytics\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"genie\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"globalInitScripts\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"iamRole\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"mlflowExperiment\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"featureStore\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"RemoteHistoryService\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"mlflowAcledArtifact\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"databrickssql\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"deltaPipelines\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"modelRegistry\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"repos\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"unityCatalog\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"gitCredentials\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"webTerminal\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"serverlessRealTimeInference\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"clusterLibraries\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"partnerHub\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"clamAVScan\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"capsule8Dataplane\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        }\n                      ]\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"logAnalytics\": {\n                  \"value\": \"[[parameters('logAnalytics')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"profileName\": {\n                  \"value\": \"[[parameters('profileName')]\"\n                },\n                \"logsEnabled\": {\n                  \"value\": \"[[parameters('logsEnabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#52": "{\n  \"name\": \"Deploy-Diagnostics-DataExplorerCluster\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated]: Deploy Diagnostic Settings for Azure Data Explorer Cluster to Log Analytics workspace\",\n    \"description\": \"Deploys the diagnostic settings for Azure Data Explorer Cluster to stream to a Log Analytics workspace when any Azure Data Explorer Cluster which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"version\": \"1.1.0-deprecated\",\n      \"category\": \"Monitoring\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"logAnalytics\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Log Analytics workspace\",\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\n          \"strongType\": \"omsWorkspace\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"profileName\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"setbypolicy\",\n        \"metadata\": {\n          \"displayName\": \"Profile name\",\n          \"description\": \"The diagnostic settings profile name\"\n        }\n      },\n      \"metricsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable metrics\",\n          \"description\": \"Whether to enable metrics stream to the Log Analytics workspace - True or False\"\n        }\n      },\n      \"logsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable logs\",\n          \"description\": \"Whether to enable logs stream to the Log Analytics workspace - True or False\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.Kusto/Clusters\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\n          \"name\": \"[[parameters('profileName')]\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/workspaceId\",\n                \"equals\": \"[[parameters('logAnalytics')]\"\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logAnalytics\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"profileName\": {\n                    \"type\": \"String\"\n                  },\n                  \"metricsEnabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"logsEnabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Kusto/Clusters/providers/diagnosticSettings\",\n                    \"apiVersion\": \"2017-05-01-preview\",\n                    \"name\": \"[[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"dependsOn\": [],\n                    \"properties\": {\n                      \"workspaceId\": \"[[parameters('logAnalytics')]\",\n                      \"metrics\": [\n                        {\n                          \"category\": \"AllMetrics\",\n                          \"enabled\": \"[[parameters('metricsEnabled')]\",\n                          \"retentionPolicy\": {\n                            \"days\": 0,\n                            \"enabled\": false\n                          },\n                          \"timeGrain\": null\n                        }\n                      ],\n                      \"logs\": [\n                        {\n                          \"category\": \"SucceededIngestion\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"FailedIngestion\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"IngestionBatching\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"Command\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"Query\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"TableUsageStatistics\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"TableDetails\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        }\n                      ]\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"logAnalytics\": {\n                  \"value\": \"[[parameters('logAnalytics')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"profileName\": {\n                  \"value\": \"[[parameters('profileName')]\"\n                },\n                \"metricsEnabled\": {\n                  \"value\": \"[[parameters('metricsEnabled')]\"\n                },\n                \"logsEnabled\": {\n                  \"value\": \"[[parameters('logsEnabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#53": "{\n  \"name\": \"Deploy-Diagnostics-DataFactory\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated]: Deploy Diagnostic Settings for Data Factory to Log Analytics workspace\",\n    \"description\": \"Deploys the diagnostic settings for Data Factory to stream to a Log Analytics workspace when any Data Factory which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"version\": \"1.2.0-deprecated\",\n      \"category\": \"Monitoring\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"logAnalytics\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Log Analytics workspace\",\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\n          \"strongType\": \"omsWorkspace\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"profileName\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"setbypolicy\",\n        \"metadata\": {\n          \"displayName\": \"Profile name\",\n          \"description\": \"The diagnostic settings profile name\"\n        }\n      },\n      \"metricsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable metrics\",\n          \"description\": \"Whether to enable metrics stream to the Log Analytics workspace - True or False\"\n        }\n      },\n      \"logsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable logs\",\n          \"description\": \"Whether to enable logs stream to the Log Analytics workspace - True or False\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.DataFactory/factories\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\n          \"name\": \"[[parameters('profileName')]\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/workspaceId\",\n                \"equals\": \"[[parameters('logAnalytics')]\"\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logAnalytics\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"profileName\": {\n                    \"type\": \"String\"\n                  },\n                  \"metricsEnabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"logsEnabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.DataFactory/factories/providers/diagnosticSettings\",\n                    \"apiVersion\": \"2017-05-01-preview\",\n                    \"name\": \"[[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"dependsOn\": [],\n                    \"properties\": {\n                      \"workspaceId\": \"[[parameters('logAnalytics')]\",\n                      \"metrics\": [\n                        {\n                          \"category\": \"AllMetrics\",\n                          \"enabled\": \"[[parameters('metricsEnabled')]\",\n                          \"retentionPolicy\": {\n                            \"days\": 0,\n                            \"enabled\": false\n                          },\n                          \"timeGrain\": null\n                        }\n                      ],\n                      \"logs\": [\n                        {\n                          \"category\": \"ActivityRuns\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"PipelineRuns\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"TriggerRuns\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"SSISPackageEventMessages\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"SSISPackageExecutableStatistics\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"SSISPackageEventMessageContext\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"SSISPackageExecutionComponentPhases\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"SSISPackageExecutionDataStatistics\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"SSISIntegrationRuntimeLogs\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"SandboxPipelineRuns\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"SandboxActivityRuns\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        }\n                      ]\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"logAnalytics\": {\n                  \"value\": \"[[parameters('logAnalytics')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"profileName\": {\n                  \"value\": \"[[parameters('profileName')]\"\n                },\n                \"metricsEnabled\": {\n                  \"value\": \"[[parameters('metricsEnabled')]\"\n                },\n                \"logsEnabled\": {\n                  \"value\": \"[[parameters('logsEnabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#54": "{\n  \"name\": \"Deploy-Diagnostics-DLAnalytics\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated]: Deploy Diagnostic Settings for Data Lake Analytics to Log Analytics workspace\",\n    \"description\": \"Deploys the diagnostic settings for Data Lake Analytics to stream to a Log Analytics workspace when any Data Lake Analytics which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"version\": \"1.1.0-deprecated\",\n      \"category\": \"Monitoring\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"logAnalytics\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Log Analytics workspace\",\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\n          \"strongType\": \"omsWorkspace\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"profileName\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"setbypolicy\",\n        \"metadata\": {\n          \"displayName\": \"Profile name\",\n          \"description\": \"The diagnostic settings profile name\"\n        }\n      },\n      \"metricsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable metrics\",\n          \"description\": \"Whether to enable metrics stream to the Log Analytics workspace - True or False\"\n        }\n      },\n      \"logsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable logs\",\n          \"description\": \"Whether to enable logs stream to the Log Analytics workspace - True or False\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.DataLakeAnalytics/accounts\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\n          \"name\": \"[[parameters('profileName')]\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/workspaceId\",\n                \"equals\": \"[[parameters('logAnalytics')]\"\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logAnalytics\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"profileName\": {\n                    \"type\": \"String\"\n                  },\n                  \"metricsEnabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"logsEnabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.DataLakeAnalytics/accounts/providers/diagnosticSettings\",\n                    \"apiVersion\": \"2017-05-01-preview\",\n                    \"name\": \"[[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"dependsOn\": [],\n                    \"properties\": {\n                      \"workspaceId\": \"[[parameters('logAnalytics')]\",\n                      \"metrics\": [\n                        {\n                          \"category\": \"AllMetrics\",\n                          \"enabled\": \"[[parameters('metricsEnabled')]\",\n                          \"retentionPolicy\": {\n                            \"days\": 0,\n                            \"enabled\": false\n                          },\n                          \"timeGrain\": null\n                        }\n                      ],\n                      \"logs\": [\n                        {\n                          \"category\": \"Audit\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"Requests\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        }\n                      ]\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"logAnalytics\": {\n                  \"value\": \"[[parameters('logAnalytics')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"profileName\": {\n                  \"value\": \"[[parameters('profileName')]\"\n                },\n                \"metricsEnabled\": {\n                  \"value\": \"[[parameters('metricsEnabled')]\"\n                },\n                \"logsEnabled\": {\n                  \"value\": \"[[parameters('logsEnabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#55": "{\n  \"name\": \"Deploy-Diagnostics-EventGridSub\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated]: Deploy Diagnostic Settings for Event Grid subscriptions to Log Analytics workspace\",\n    \"description\": \"Deploys the diagnostic settings for Event Grid subscriptions to stream to a Log Analytics workspace when any Event Grid subscriptions which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"version\": \"1.1.0-deprecated\",\n      \"category\": \"Monitoring\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"logAnalytics\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Log Analytics workspace\",\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\n          \"strongType\": \"omsWorkspace\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"profileName\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"setbypolicy\",\n        \"metadata\": {\n          \"displayName\": \"Profile name\",\n          \"description\": \"The diagnostic settings profile name\"\n        }\n      },\n      \"metricsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable metrics\",\n          \"description\": \"Whether to enable metrics stream to the Log Analytics workspace - True or False\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.EventGrid/eventSubscriptions\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\n          \"name\": \"[[parameters('profileName')]\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/workspaceId\",\n                \"equals\": \"[[parameters('logAnalytics')]\"\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logAnalytics\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"profileName\": {\n                    \"type\": \"String\"\n                  },\n                  \"metricsEnabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.EventGrid/eventSubscriptions/providers/diagnosticSettings\",\n                    \"apiVersion\": \"2017-05-01-preview\",\n                    \"name\": \"[[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"dependsOn\": [],\n                    \"properties\": {\n                      \"workspaceId\": \"[[parameters('logAnalytics')]\",\n                      \"metrics\": [\n                        {\n                          \"category\": \"AllMetrics\",\n                          \"enabled\": \"[[parameters('metricsEnabled')]\",\n                          \"retentionPolicy\": {\n                            \"days\": 0,\n                            \"enabled\": false\n                          },\n                          \"timeGrain\": null\n                        }\n                      ],\n                      \"logs\": []\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"logAnalytics\": {\n                  \"value\": \"[[parameters('logAnalytics')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"profileName\": {\n                  \"value\": \"[[parameters('profileName')]\"\n                },\n                \"metricsEnabled\": {\n                  \"value\": \"[[parameters('metricsEnabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#56": "{\n  \"name\": \"Deploy-Diagnostics-EventGridSystemTopic\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated]: Deploy Diagnostic Settings for Event Grid System Topic to Log Analytics workspace\",\n    \"description\": \"Deploys the diagnostic settings for Event Grid System Topic to stream to a Log Analytics workspace when any Event Grid System Topic which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"version\": \"1.1.0-deprecated\",\n      \"category\": \"Monitoring\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"logAnalytics\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Log Analytics workspace\",\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\n          \"strongType\": \"omsWorkspace\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"profileName\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"setbypolicy\",\n        \"metadata\": {\n          \"displayName\": \"Profile name\",\n          \"description\": \"The diagnostic settings profile name\"\n        }\n      },\n      \"metricsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable metrics\",\n          \"description\": \"Whether to enable metrics stream to the Log Analytics workspace - True or False\"\n        }\n      },\n      \"logsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable logs\",\n          \"description\": \"Whether to enable logs stream to the Log Analytics workspace - True or False\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.EventGrid/systemTopics\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\n          \"name\": \"[[parameters('profileName')]\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/workspaceId\",\n                \"equals\": \"[[parameters('logAnalytics')]\"\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logAnalytics\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"profileName\": {\n                    \"type\": \"String\"\n                  },\n                  \"metricsEnabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"logsEnabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.EventGrid/systemTopics/providers/diagnosticSettings\",\n                    \"apiVersion\": \"2017-05-01-preview\",\n                    \"name\": \"[[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"dependsOn\": [],\n                    \"properties\": {\n                      \"workspaceId\": \"[[parameters('logAnalytics')]\",\n                      \"metrics\": [\n                        {\n                          \"category\": \"AllMetrics\",\n                          \"enabled\": \"[[parameters('metricsEnabled')]\",\n                          \"retentionPolicy\": {\n                            \"days\": 0,\n                            \"enabled\": false\n                          },\n                          \"timeGrain\": null\n                        }\n                      ],\n                      \"logs\": [\n                        {\n                          \"category\": \"DeliveryFailures\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        }\n                      ]\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"logAnalytics\": {\n                  \"value\": \"[[parameters('logAnalytics')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"profileName\": {\n                  \"value\": \"[[parameters('profileName')]\"\n                },\n                \"metricsEnabled\": {\n                  \"value\": \"[[parameters('metricsEnabled')]\"\n                },\n                \"logsEnabled\": {\n                  \"value\": \"[[parameters('logsEnabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#57": "{\n  \"name\": \"Deploy-Diagnostics-EventGridTopic\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated]: Deploy Diagnostic Settings for Event Grid Topic to Log Analytics workspace\",\n    \"description\": \"Deploys the diagnostic settings for Event Grid Topic to stream to a Log Analytics workspace when any Event Grid Topic which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"version\": \"1.2.0-deprecated\",\n      \"category\": \"Monitoring\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"logAnalytics\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Log Analytics workspace\",\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\n          \"strongType\": \"omsWorkspace\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"profileName\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"setbypolicy\",\n        \"metadata\": {\n          \"displayName\": \"Profile name\",\n          \"description\": \"The diagnostic settings profile name\"\n        }\n      },\n      \"metricsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable metrics\",\n          \"description\": \"Whether to enable metrics stream to the Log Analytics workspace - True or False\"\n        }\n      },\n      \"logsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable logs\",\n          \"description\": \"Whether to enable logs stream to the Log Analytics workspace - True or False\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.EventGrid/topics\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\n          \"name\": \"[[parameters('profileName')]\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/workspaceId\",\n                \"equals\": \"[[parameters('logAnalytics')]\"\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logAnalytics\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"profileName\": {\n                    \"type\": \"String\"\n                  },\n                  \"metricsEnabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"logsEnabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.EventGrid/topics/providers/diagnosticSettings\",\n                    \"apiVersion\": \"2017-05-01-preview\",\n                    \"name\": \"[[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"dependsOn\": [],\n                    \"properties\": {\n                      \"workspaceId\": \"[[parameters('logAnalytics')]\",\n                      \"metrics\": [\n                        {\n                          \"category\": \"AllMetrics\",\n                          \"enabled\": \"[[parameters('metricsEnabled')]\",\n                          \"retentionPolicy\": {\n                            \"days\": 0,\n                            \"enabled\": false\n                          },\n                          \"timeGrain\": null\n                        }\n                      ],\n                      \"logs\": [\n                        {\n                          \"category\": \"DeliveryFailures\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"PublishFailures\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"DataPlaneRequests\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        }\n                      ]\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"logAnalytics\": {\n                  \"value\": \"[[parameters('logAnalytics')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"profileName\": {\n                  \"value\": \"[[parameters('profileName')]\"\n                },\n                \"metricsEnabled\": {\n                  \"value\": \"[[parameters('metricsEnabled')]\"\n                },\n                \"logsEnabled\": {\n                  \"value\": \"[[parameters('logsEnabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#58": "{\n  \"name\": \"Deploy-Diagnostics-ExpressRoute\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated]: Deploy Diagnostic Settings for ExpressRoute to Log Analytics workspace\",\n    \"description\": \"Deploys the diagnostic settings for ExpressRoute to stream to a Log Analytics workspace when any ExpressRoute which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"version\": \"1.1.0-deprecated\",\n      \"category\": \"Monitoring\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"logAnalytics\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Log Analytics workspace\",\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\n          \"strongType\": \"omsWorkspace\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"profileName\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"setbypolicy\",\n        \"metadata\": {\n          \"displayName\": \"Profile name\",\n          \"description\": \"The diagnostic settings profile name\"\n        }\n      },\n      \"metricsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable metrics\",\n          \"description\": \"Whether to enable metrics stream to the Log Analytics workspace - True or False\"\n        }\n      },\n      \"logsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable logs\",\n          \"description\": \"Whether to enable logs stream to the Log Analytics workspace - True or False\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.Network/expressRouteCircuits\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\n          \"name\": \"[[parameters('profileName')]\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/workspaceId\",\n                \"equals\": \"[[parameters('logAnalytics')]\"\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logAnalytics\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"profileName\": {\n                    \"type\": \"String\"\n                  },\n                  \"metricsEnabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"logsEnabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Network/expressRouteCircuits/providers/diagnosticSettings\",\n                    \"apiVersion\": \"2017-05-01-preview\",\n                    \"name\": \"[[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"dependsOn\": [],\n                    \"properties\": {\n                      \"workspaceId\": \"[[parameters('logAnalytics')]\",\n                      \"metrics\": [\n                        {\n                          \"category\": \"AllMetrics\",\n                          \"enabled\": \"[[parameters('metricsEnabled')]\",\n                          \"retentionPolicy\": {\n                            \"days\": 0,\n                            \"enabled\": false\n                          },\n                          \"timeGrain\": null\n                        }\n                      ],\n                      \"logs\": [\n                        {\n                          \"category\": \"PeeringRouteLog\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        }\n                      ]\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"logAnalytics\": {\n                  \"value\": \"[[parameters('logAnalytics')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"profileName\": {\n                  \"value\": \"[[parameters('profileName')]\"\n                },\n                \"metricsEnabled\": {\n                  \"value\": \"[[parameters('metricsEnabled')]\"\n                },\n                \"logsEnabled\": {\n                  \"value\": \"[[parameters('logsEnabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#59": "{\n  \"name\": \"Deploy-Diagnostics-Firewall\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated]: Deploy Diagnostic Settings for Firewall to Log Analytics workspace\",\n    \"description\": \"Deploys the diagnostic settings for Firewall to stream to a Log Analytics workspace when any Firewall which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"version\": \"1.2.0-deprecated\",\n      \"category\": \"Monitoring\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"logAnalytics\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Log Analytics workspace\",\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\n          \"strongType\": \"omsWorkspace\"\n        }\n      },\n      \"logAnalyticsDestinationType\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Log Analytics destination type\",\n          \"description\": \"Select destination type for Log Analytics. Allowed values are 'Dedicated' (resource specific) and 'AzureDiagnostics'. Default is 'AzureDiagnostics'\"\n        },\n        \"defaultValue\": \"AzureDiagnostics\",\n        \"allowedValues\": [\n          \"AzureDiagnostics\",\n          \"Dedicated\"\n        ]\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"profileName\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"setbypolicy\",\n        \"metadata\": {\n          \"displayName\": \"Profile name\",\n          \"description\": \"The diagnostic settings profile name\"\n        }\n      },\n      \"metricsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable metrics\",\n          \"description\": \"Whether to enable metrics stream to the Log Analytics workspace - True or False\"\n        }\n      },\n      \"logsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable logs\",\n          \"description\": \"Whether to enable logs stream to the Log Analytics workspace - True or False\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.Network/azureFirewalls\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\n          \"name\": \"[[parameters('profileName')]\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/workspaceId\",\n                \"equals\": \"[[parameters('logAnalytics')]\"\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logAnalytics\": {\n                    \"type\": \"String\"\n                  },\n                  \"logAnalyticsDestinationType\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"profileName\": {\n                    \"type\": \"String\"\n                  },\n                  \"metricsEnabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"logsEnabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Network/azureFirewalls/providers/diagnosticSettings\",\n                    \"apiVersion\": \"2017-05-01-preview\",\n                    \"name\": \"[[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"dependsOn\": [],\n                    \"properties\": {\n                      \"workspaceId\": \"[[parameters('logAnalytics')]\",\n                      \"logAnalyticsDestinationType\": \"[[parameters('logAnalyticsDestinationType')]\",\n                      \"metrics\": [\n                        {\n                          \"category\": \"AllMetrics\",\n                          \"enabled\": \"[[parameters('metricsEnabled')]\",\n                          \"retentionPolicy\": {\n                            \"days\": 0,\n                            \"enabled\": false\n                          },\n                          \"timeGrain\": null\n                        }\n                      ],\n                      \"logs\": [\n                        {\n                          \"category\": \"AzureFirewallApplicationRule\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"AzureFirewallNetworkRule\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"AzureFirewallDnsProxy\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"AZFWNetworkRule\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"AZFWApplicationRule\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"AZFWNatRule\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"AZFWThreatIntel\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"AZFWIdpsSignature\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"AZFWDnsQuery\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"AZFWFqdnResolveFailure\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"AZFWApplicationRuleAggregation\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"AZFWNetworkRuleAggregation\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"AZFWNatRuleAggregation\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"AZFWFatFlow\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"AZFWFlowTrace\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        }\n                      ]\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"logAnalytics\": {\n                  \"value\": \"[[parameters('logAnalytics')]\"\n                },\n                \"logAnalyticsDestinationType\": {\n                  \"value\": \"[[parameters('logAnalyticsDestinationType')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"profileName\": {\n                  \"value\": \"[[parameters('profileName')]\"\n                },\n                \"metricsEnabled\": {\n                  \"value\": \"[[parameters('metricsEnabled')]\"\n                },\n                \"logsEnabled\": {\n                  \"value\": \"[[parameters('logsEnabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#6": "{\n    \"name\": \"Audit-PublicIpAddresses-UnusedResourcesCostOptimization\",\n    \"type\": \"Microsoft.Authorization/policyDefinitions\",\n    \"apiVersion\": \"2021-06-01\",\n    \"scope\": null,\n    \"properties\": {\n        \"policyType\": \"Custom\",\n        \"displayName\": \"Unused Public IP addresses driving cost should be avoided\",\n        \"mode\": \"All\",\n        \"description\": \"Optimize cost by detecting unused but chargeable resources. Leverage this Policy definition as a cost control to reveal orphaned Public IP addresses that are driving cost.\",\n        \"metadata\": {\n            \"version\": \"1.1.0\",\n            \"category\": \"Cost Optimization\",\n            \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n            \"alzCloudEnvironments\": [\n                \"AzureCloud\",\n                \"AzureChinaCloud\",\n                \"AzureUSGovernment\"\n            ]\n        },\n        \"parameters\": {\n            \"effect\": {\n                \"type\": \"String\",\n                \"metadata\": {\n                    \"displayName\": \"Effect\",\n                    \"description\": \"Enable or disable the execution of the policy\"\n                },\n                \"allowedValues\": [\n                    \"Audit\",\n                    \"Disabled\"\n                ],\n                \"defaultValue\": \"Audit\"\n            }\n        },\n        \"policyRule\": {\n            \"if\": {\n                \"allOf\": [\n                    {\n                        \"field\": \"type\",\n                        \"equals\": \"microsoft.network/publicIpAddresses\"\n                    },\n                    {\n                        \"field\": \"Microsoft.Network/publicIPAddresses/publicIPAllocationMethod\",\n                        \"equals\": \"Static\"\n                    },\n                    {\n                        \"anyOf\": [\n                            {\n                                \"field\": \"Microsoft.Network/publicIPAddresses/natGateway\",\n                                \"exists\": false\n                            },\n                            {\n                                \"value\": \"[[equals(length(field('Microsoft.Network/publicIPAddresses/natGateway')), 0)]\",\n                                \"equals\": true\n                            }\n                        ]\n                    },\n                    {\n                        \"anyOf\": [\n                            {\n                                \"field\": \"Microsoft.Network/publicIPAddresses/ipConfiguration\",\n                                \"exists\": false\n                            },\n                            {\n                                \"value\": \"[[equals(length(field('Microsoft.Network/publicIPAddresses/ipConfiguration')), 0)]\",\n                                \"equals\": true\n                            }\n                        ]\n                    },\n                    {\n                        \"anyOf\": [\n                            {\n                                \"field\": \"Microsoft.Network/publicIPAddresses/publicIPPrefix\",\n                                \"exists\": false\n                            },\n                            {\n                                \"value\": \"[[equals(length(field('Microsoft.Network/publicIPAddresses/publicIPPrefix')), 0)]\",\n                                \"equals\": true\n                            }\n                        ]\n                    }\n                ]\n            },\n            \"then\": {\n                \"effect\": \"[[parameters('effect')]\"\n            }\n        }\n    }\n}",
    "$fxv#60": "{\n  \"name\": \"Deploy-Diagnostics-FrontDoor\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated]: Deploy Diagnostic Settings for Front Door to Log Analytics workspace\",\n    \"description\": \"Deploys the diagnostic settings for Front Door to stream to a Log Analytics workspace when any Front Door which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"version\": \"1.1.0-deprecated\",\n      \"category\": \"Monitoring\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"logAnalytics\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Log Analytics workspace\",\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\n          \"strongType\": \"omsWorkspace\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"profileName\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"setbypolicy\",\n        \"metadata\": {\n          \"displayName\": \"Profile name\",\n          \"description\": \"The diagnostic settings profile name\"\n        }\n      },\n      \"metricsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable metrics\",\n          \"description\": \"Whether to enable metrics stream to the Log Analytics workspace - True or False\"\n        }\n      },\n      \"logsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable logs\",\n          \"description\": \"Whether to enable logs stream to the Log Analytics workspace - True or False\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.Network/frontDoors\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\n          \"name\": \"[[parameters('profileName')]\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/workspaceId\",\n                \"equals\": \"[[parameters('logAnalytics')]\"\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logAnalytics\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"profileName\": {\n                    \"type\": \"String\"\n                  },\n                  \"metricsEnabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"logsEnabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Network/frontDoors/providers/diagnosticSettings\",\n                    \"apiVersion\": \"2017-05-01-preview\",\n                    \"name\": \"[[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"dependsOn\": [],\n                    \"properties\": {\n                      \"workspaceId\": \"[[parameters('logAnalytics')]\",\n                      \"metrics\": [\n                        {\n                          \"category\": \"AllMetrics\",\n                          \"enabled\": \"[[parameters('metricsEnabled')]\",\n                          \"retentionPolicy\": {\n                            \"days\": 0,\n                            \"enabled\": false\n                          },\n                          \"timeGrain\": null\n                        }\n                      ],\n                      \"logs\": [\n                        {\n                          \"category\": \"FrontdoorAccessLog\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"FrontdoorWebApplicationFirewallLog\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        }\n                      ]\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"logAnalytics\": {\n                  \"value\": \"[[parameters('logAnalytics')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"profileName\": {\n                  \"value\": \"[[parameters('profileName')]\"\n                },\n                \"metricsEnabled\": {\n                  \"value\": \"[[parameters('metricsEnabled')]\"\n                },\n                \"logsEnabled\": {\n                  \"value\": \"[[parameters('logsEnabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#61": "{\n  \"name\": \"Deploy-Diagnostics-Function\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated]: Deploy Diagnostic Settings for Azure Function App to Log Analytics workspace\",\n    \"description\": \"Deploys the diagnostic settings for Azure Function App to stream to a Log Analytics workspace when any function app which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"version\": \"1.1.0-deprecated\",\n      \"category\": \"Monitoring\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"logAnalytics\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Log Analytics workspace\",\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\n          \"strongType\": \"omsWorkspace\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"profileName\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"setbypolicy\",\n        \"metadata\": {\n          \"displayName\": \"Profile name\",\n          \"description\": \"The diagnostic settings profile name\"\n        }\n      },\n      \"metricsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable metrics\",\n          \"description\": \"Whether to enable metrics stream to the Log Analytics workspace - True or False\"\n        }\n      },\n      \"logsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable logs\",\n          \"description\": \"Whether to enable logs stream to the Log Analytics workspace - True or False\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Web/sites\"\n          },\n          {\n            \"value\": \"[[field('kind')]\",\n            \"contains\": \"functionapp\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\n          \"name\": \"[[parameters('profileName')]\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/workspaceId\",\n                \"equals\": \"[[parameters('logAnalytics')]\"\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logAnalytics\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"profileName\": {\n                    \"type\": \"String\"\n                  },\n                  \"metricsEnabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"logsEnabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Web/sites/providers/diagnosticSettings\",\n                    \"apiVersion\": \"2017-05-01-preview\",\n                    \"name\": \"[[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"dependsOn\": [],\n                    \"properties\": {\n                      \"workspaceId\": \"[[parameters('logAnalytics')]\",\n                      \"metrics\": [\n                        {\n                          \"category\": \"AllMetrics\",\n                          \"enabled\": \"[[parameters('metricsEnabled')]\",\n                          \"retentionPolicy\": {\n                            \"days\": 0,\n                            \"enabled\": false\n                          },\n                          \"timeGrain\": null\n                        }\n                      ],\n                      \"logs\": [\n                        {\n                          \"category\": \"FunctionAppLogs\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        }\n                      ]\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"logAnalytics\": {\n                  \"value\": \"[[parameters('logAnalytics')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"profileName\": {\n                  \"value\": \"[[parameters('profileName')]\"\n                },\n                \"metricsEnabled\": {\n                  \"value\": \"[[parameters('metricsEnabled')]\"\n                },\n                \"logsEnabled\": {\n                  \"value\": \"[[parameters('logsEnabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#62": "{\n  \"name\": \"Deploy-Diagnostics-HDInsight\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated]: Deploy Diagnostic Settings for HDInsight to Log Analytics workspace\",\n    \"description\": \"Deploys the diagnostic settings for HDInsight to stream to a Log Analytics workspace when any HDInsight which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"version\": \"1.1.0-deprecated\",\n      \"category\": \"Monitoring\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"logAnalytics\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Log Analytics workspace\",\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\n          \"strongType\": \"omsWorkspace\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"profileName\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"setbypolicy\",\n        \"metadata\": {\n          \"displayName\": \"Profile name\",\n          \"description\": \"The diagnostic settings profile name\"\n        }\n      },\n      \"metricsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable metrics\",\n          \"description\": \"Whether to enable metrics stream to the Log Analytics workspace - True or False\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.HDInsight/clusters\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\n          \"name\": \"[[parameters('profileName')]\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/workspaceId\",\n                \"equals\": \"[[parameters('logAnalytics')]\"\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logAnalytics\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"profileName\": {\n                    \"type\": \"String\"\n                  },\n                  \"metricsEnabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.HDInsight/clusters/providers/diagnosticSettings\",\n                    \"apiVersion\": \"2017-05-01-preview\",\n                    \"name\": \"[[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"dependsOn\": [],\n                    \"properties\": {\n                      \"workspaceId\": \"[[parameters('logAnalytics')]\",\n                      \"metrics\": [\n                        {\n                          \"category\": \"AllMetrics\",\n                          \"enabled\": \"[[parameters('metricsEnabled')]\",\n                          \"retentionPolicy\": {\n                            \"days\": 0,\n                            \"enabled\": false\n                          },\n                          \"timeGrain\": null\n                        }\n                      ],\n                      \"logs\": []\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"logAnalytics\": {\n                  \"value\": \"[[parameters('logAnalytics')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"profileName\": {\n                  \"value\": \"[[parameters('profileName')]\"\n                },\n                \"metricsEnabled\": {\n                  \"value\": \"[[parameters('metricsEnabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#63": "{\n  \"name\": \"Deploy-Diagnostics-iotHub\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated]: Deploy Diagnostic Settings for IoT Hub to Log Analytics workspace\",\n    \"description\": \"Deploys the diagnostic settings for IoT Hub to stream to a Log Analytics workspace when any IoT Hub which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"version\": \"1.1.0-deprecated\",\n      \"category\": \"Monitoring\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"logAnalytics\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Log Analytics workspace\",\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\n          \"strongType\": \"omsWorkspace\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"profileName\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"setbypolicy\",\n        \"metadata\": {\n          \"displayName\": \"Profile name\",\n          \"description\": \"The diagnostic settings profile name\"\n        }\n      },\n      \"metricsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable metrics\",\n          \"description\": \"Whether to enable metrics stream to the Log Analytics workspace - True or False\"\n        }\n      },\n      \"logsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable logs\",\n          \"description\": \"Whether to enable logs stream to the Log Analytics workspace - True or False\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.Devices/IotHubs\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\n          \"name\": \"[[parameters('profileName')]\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/workspaceId\",\n                \"equals\": \"[[parameters('logAnalytics')]\"\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logAnalytics\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"profileName\": {\n                    \"type\": \"String\"\n                  },\n                  \"metricsEnabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"logsEnabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Devices/IotHubs/providers/diagnosticSettings\",\n                    \"apiVersion\": \"2017-05-01-preview\",\n                    \"name\": \"[[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"dependsOn\": [],\n                    \"properties\": {\n                      \"workspaceId\": \"[[parameters('logAnalytics')]\",\n                      \"metrics\": [\n                        {\n                          \"category\": \"AllMetrics\",\n                          \"enabled\": \"[[parameters('metricsEnabled')]\",\n                          \"retentionPolicy\": {\n                            \"days\": 0,\n                            \"enabled\": false\n                          },\n                          \"timeGrain\": null\n                        }\n                      ],\n                      \"logs\": [\n                        {\n                          \"category\": \"Connections\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"DeviceTelemetry\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"C2DCommands\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"DeviceIdentityOperations\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"FileUploadOperations\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"Routes\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"D2CTwinOperations\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"C2DTwinOperations\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"TwinQueries\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"JobsOperations\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"DirectMethods\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"DistributedTracing\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"Configurations\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"DeviceStreams\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        }\n                      ]\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"logAnalytics\": {\n                  \"value\": \"[[parameters('logAnalytics')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"profileName\": {\n                  \"value\": \"[[parameters('profileName')]\"\n                },\n                \"metricsEnabled\": {\n                  \"value\": \"[[parameters('metricsEnabled')]\"\n                },\n                \"logsEnabled\": {\n                  \"value\": \"[[parameters('logsEnabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#64": "{\n  \"name\": \"Deploy-Diagnostics-LoadBalancer\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated]: Deploy Diagnostic Settings for Load Balancer to Log Analytics workspace\",\n    \"description\": \"Deploys the diagnostic settings for Load Balancer to stream to a Log Analytics workspace when any Load Balancer which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"version\": \"1.1.0-deprecated\",\n      \"category\": \"Monitoring\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"logAnalytics\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Log Analytics workspace\",\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\n          \"strongType\": \"omsWorkspace\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"profileName\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"setbypolicy\",\n        \"metadata\": {\n          \"displayName\": \"Profile name\",\n          \"description\": \"The diagnostic settings profile name\"\n        }\n      },\n      \"metricsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable metrics\",\n          \"description\": \"Whether to enable metrics stream to the Log Analytics workspace - True or False\"\n        }\n      },\n      \"logsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable logs\",\n          \"description\": \"Whether to enable logs stream to the Log Analytics workspace - True or False\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.Network/loadBalancers\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\n          \"name\": \"[[parameters('profileName')]\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/workspaceId\",\n                \"equals\": \"[[parameters('logAnalytics')]\"\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logAnalytics\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"profileName\": {\n                    \"type\": \"String\"\n                  },\n                  \"metricsEnabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"logsEnabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Network/loadBalancers/providers/diagnosticSettings\",\n                    \"apiVersion\": \"2017-05-01-preview\",\n                    \"name\": \"[[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"dependsOn\": [],\n                    \"properties\": {\n                      \"workspaceId\": \"[[parameters('logAnalytics')]\",\n                      \"metrics\": [\n                        {\n                          \"category\": \"AllMetrics\",\n                          \"timeGrain\": null,\n                          \"enabled\": \"[[parameters('metricsEnabled')]\",\n                          \"retentionPolicy\": {\n                            \"enabled\": false,\n                            \"days\": 0\n                          }\n                        }\n                      ],\n                      \"logs\": [\n                        {\n                          \"category\": \"LoadBalancerAlertEvent\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"LoadBalancerProbeHealthStatus\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        }\n                      ]\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"logAnalytics\": {\n                  \"value\": \"[[parameters('logAnalytics')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"profileName\": {\n                  \"value\": \"[[parameters('profileName')]\"\n                },\n                \"metricsEnabled\": {\n                  \"value\": \"[[parameters('metricsEnabled')]\"\n                },\n                \"logsEnabled\": {\n                  \"value\": \"[[parameters('logsEnabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#65": "{\n  \"name\": \"Deploy-Diagnostics-LogAnalytics\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated]: Deploy Diagnostic Settings for Log Analytics to Log Analytics workspace\",\n    \"description\": \"Deploys the diagnostic settings for Log Analytics workspaces to stream to a Log Analytics workspace when any Log Analytics workspace which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"version\": \"1.1.0-deprecated\",\n      \"category\": \"Monitoring\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"logAnalytics\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Log Analytics workspace\",\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\n          \"strongType\": \"omsWorkspace\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"profileName\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"setbypolicy\",\n        \"metadata\": {\n          \"displayName\": \"Profile name\",\n          \"description\": \"The diagnostic settings profile name\"\n        }\n      },\n      \"metricsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable metrics\",\n          \"description\": \"Whether to enable metrics stream to the Log Analytics workspace - True or False\"\n        }\n      },\n      \"logsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable logs\",\n          \"description\": \"Whether to enable logs stream to the Log Analytics workspace - True or False\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"microsoft.operationalinsights/workspaces\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\n          \"name\": \"[[parameters('profileName')]\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/workspaceId\",\n                \"equals\": \"[[parameters('logAnalytics')]\"\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logAnalytics\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"profileName\": {\n                    \"type\": \"String\"\n                  },\n                  \"metricsEnabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"logsEnabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"microsoft.operationalinsights/workspaces/providers/diagnosticSettings\",\n                    \"apiVersion\": \"2017-05-01-preview\",\n                    \"name\": \"[[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"dependsOn\": [],\n                    \"properties\": {\n                      \"workspaceId\": \"[[parameters('logAnalytics')]\",\n                      \"metrics\": [\n                        {\n                          \"category\": \"AllMetrics\",\n                          \"enabled\": \"[[parameters('metricsEnabled')]\",\n                          \"retentionPolicy\": {\n                            \"days\": 0,\n                            \"enabled\": false\n                          },\n                          \"timeGrain\": null\n                        }\n                      ],\n                      \"logs\": [\n                        {\n                          \"category\": \"Audit\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        }\n                      ]\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"logAnalytics\": {\n                  \"value\": \"[[parameters('logAnalytics')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"profileName\": {\n                  \"value\": \"[[parameters('profileName')]\"\n                },\n                \"metricsEnabled\": {\n                  \"value\": \"[[parameters('metricsEnabled')]\"\n                },\n                \"logsEnabled\": {\n                  \"value\": \"[[parameters('logsEnabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#66": "{\n  \"name\": \"Deploy-Diagnostics-LogicAppsISE\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated]: Deploy Diagnostic Settings for Logic Apps integration service environment to Log Analytics workspace\",\n    \"description\": \"Deploys the diagnostic settings for Logic Apps integration service environment to stream to a Log Analytics workspace when any Logic Apps integration service environment which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"version\": \"1.1.0-deprecated\",\n      \"category\": \"Monitoring\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"logAnalytics\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Log Analytics workspace\",\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\n          \"strongType\": \"omsWorkspace\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"profileName\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"setbypolicy\",\n        \"metadata\": {\n          \"displayName\": \"Profile name\",\n          \"description\": \"The diagnostic settings profile name\"\n        }\n      },\n      \"logsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable logs\",\n          \"description\": \"Whether to enable logs stream to the Log Analytics workspace - True or False\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.Logic/integrationAccounts\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\n          \"name\": \"[[parameters('profileName')]\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/workspaceId\",\n                \"equals\": \"[[parameters('logAnalytics')]\"\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logAnalytics\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"profileName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logsEnabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Logic/integrationAccounts/providers/diagnosticSettings\",\n                    \"apiVersion\": \"2017-05-01-preview\",\n                    \"name\": \"[[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"dependsOn\": [],\n                    \"properties\": {\n                      \"workspaceId\": \"[[parameters('logAnalytics')]\",\n                      \"metrics\": [],\n                      \"logs\": [\n                        {\n                          \"category\": \"IntegrationAccountTrackingEvents\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        }\n                      ]\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"logAnalytics\": {\n                  \"value\": \"[[parameters('logAnalytics')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"profileName\": {\n                  \"value\": \"[[parameters('profileName')]\"\n                },\n                \"logsEnabled\": {\n                  \"value\": \"[[parameters('logsEnabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#67": "{\n  \"name\": \"Deploy-Diagnostics-MariaDB\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated] Diagnostic Settings for MariaDB to Log Analytics Workspace\",\n    \"description\": \"Deploys the diagnostic settings for MariaDB to stream to a Log Analytics workspace when any MariaDB  which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled. Deprecating due to service retirement, https://learn.microsoft.com/en-us/azure/mariadb/whats-happening-to-mariadb\",\n    \"metadata\": {\n      \"version\": \"1.1.0-deprecated\",\n      \"category\": \"Monitoring\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"deprecated\": true,\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"logAnalytics\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Log Analytics workspace\",\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\n          \"strongType\": \"omsWorkspace\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"profileName\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"setbypolicy\",\n        \"metadata\": {\n          \"displayName\": \"Profile name\",\n          \"description\": \"The diagnostic settings profile name\"\n        }\n      },\n      \"metricsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable metrics\",\n          \"description\": \"Whether to enable metrics stream to the Log Analytics workspace - True or False\"\n        }\n      },\n      \"logsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable logs\",\n          \"description\": \"Whether to enable logs stream to the Log Analytics workspace - True or False\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.DBforMariaDB/servers\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\n          \"name\": \"[[parameters('profileName')]\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/workspaceId\",\n                \"equals\": \"[[parameters('logAnalytics')]\"\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logAnalytics\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"profileName\": {\n                    \"type\": \"String\"\n                  },\n                  \"metricsEnabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"logsEnabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.DBforMariaDB/servers/providers/diagnosticSettings\",\n                    \"apiVersion\": \"2017-05-01-preview\",\n                    \"name\": \"[[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"dependsOn\": [],\n                    \"properties\": {\n                      \"workspaceId\": \"[[parameters('logAnalytics')]\",\n                      \"metrics\": [\n                        {\n                          \"category\": \"AllMetrics\",\n                          \"enabled\": \"[[parameters('metricsEnabled')]\",\n                          \"retentionPolicy\": {\n                            \"days\": 0,\n                            \"enabled\": false\n                          },\n                          \"timeGrain\": null\n                        }\n                      ],\n                      \"logs\": [\n                        {\n                          \"category\": \"MySqlSlowLogs\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"MySqlAuditLogs\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        }\n                      ]\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"logAnalytics\": {\n                  \"value\": \"[[parameters('logAnalytics')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"profileName\": {\n                  \"value\": \"[[parameters('profileName')]\"\n                },\n                \"metricsEnabled\": {\n                  \"value\": \"[[parameters('metricsEnabled')]\"\n                },\n                \"logsEnabled\": {\n                  \"value\": \"[[parameters('logsEnabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#68": "{\n  \"name\": \"Deploy-Diagnostics-MediaService\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated]: Deploy Diagnostic Settings for Azure Media Service to Log Analytics workspace\",\n    \"description\": \"Deploys the diagnostic settings for Azure Media Service to stream to a Log Analytics workspace when any Azure Media Service which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"version\": \"1.1.0-deprecated\",\n      \"category\": \"Monitoring\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"logAnalytics\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Log Analytics workspace\",\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\n          \"strongType\": \"omsWorkspace\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"profileName\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"setbypolicy\",\n        \"metadata\": {\n          \"displayName\": \"Profile name\",\n          \"description\": \"The diagnostic settings profile name\"\n        }\n      },\n      \"metricsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable metrics\",\n          \"description\": \"Whether to enable metrics stream to the Log Analytics workspace - True or False\"\n        }\n      },\n      \"logsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable logs\",\n          \"description\": \"Whether to enable logs stream to the Log Analytics workspace - True or False\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.Media/mediaServices\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\n          \"name\": \"[[parameters('profileName')]\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/workspaceId\",\n                \"equals\": \"[[parameters('logAnalytics')]\"\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logAnalytics\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"profileName\": {\n                    \"type\": \"String\"\n                  },\n                  \"metricsEnabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"logsEnabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Media/mediaServices/providers/diagnosticSettings\",\n                    \"apiVersion\": \"2017-05-01-preview\",\n                    \"name\": \"[[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"dependsOn\": [],\n                    \"properties\": {\n                      \"workspaceId\": \"[[parameters('logAnalytics')]\",\n                      \"metrics\": [\n                        {\n                          \"category\": \"AllMetrics\",\n                          \"enabled\": \"[[parameters('metricsEnabled')]\",\n                          \"retentionPolicy\": {\n                            \"days\": 0,\n                            \"enabled\": false\n                          },\n                          \"timeGrain\": null\n                        }\n                      ],\n                      \"logs\": [\n                        {\n                          \"category\": \"KeyDeliveryRequests\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        }\n                      ]\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"logAnalytics\": {\n                  \"value\": \"[[parameters('logAnalytics')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"profileName\": {\n                  \"value\": \"[[parameters('profileName')]\"\n                },\n                \"metricsEnabled\": {\n                  \"value\": \"[[parameters('metricsEnabled')]\"\n                },\n                \"logsEnabled\": {\n                  \"value\": \"[[parameters('logsEnabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#69": "{\n  \"name\": \"Deploy-Diagnostics-MlWorkspace\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated]: Deploy Diagnostic Settings for Machine Learning workspace to Log Analytics workspace\",\n    \"description\": \"Deploys the diagnostic settings for Machine Learning workspace to stream to a Log Analytics workspace when any Machine Learning workspace which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"version\": \"1.2.0-deprecated\",\n      \"category\": \"Monitoring\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"logAnalytics\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Log Analytics workspace\",\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\n          \"strongType\": \"omsWorkspace\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"profileName\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"setbypolicy\",\n        \"metadata\": {\n          \"displayName\": \"Profile name\",\n          \"description\": \"The diagnostic settings profile name\"\n        }\n      },\n      \"metricsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable metrics\",\n          \"description\": \"Whether to enable metrics stream to the Log Analytics workspace - True or False\"\n        }\n      },\n      \"logsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable logs\",\n          \"description\": \"Whether to enable logs stream to the Log Analytics workspace - True or False\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.MachineLearningServices/workspaces\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\n          \"name\": \"[[parameters('profileName')]\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/workspaceId\",\n                \"equals\": \"[[parameters('logAnalytics')]\"\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logAnalytics\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"profileName\": {\n                    \"type\": \"String\"\n                  },\n                  \"metricsEnabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"logsEnabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.MachineLearningServices/workspaces/providers/diagnosticSettings\",\n                    \"apiVersion\": \"2017-05-01-preview\",\n                    \"name\": \"[[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"dependsOn\": [],\n                    \"properties\": {\n                      \"workspaceId\": \"[[parameters('logAnalytics')]\",\n                      \"metrics\": [\n                        {\n                          \"category\": \"AllMetrics\",\n                          \"enabled\": \"[[parameters('metricsEnabled')]\",\n                          \"retentionPolicy\": {\n                            \"enabled\": false,\n                            \"days\": 0\n                          }\n                        }\n                      ],\n                      \"logs\": [\n                        {\n                          \"category\": \"AmlComputeClusterEvent\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"AmlComputeClusterNodeEvent\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"AmlComputeJobEvent\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"AmlComputeCpuGpuUtilization\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"AmlRunStatusChangedEvent\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"ModelsChangeEvent\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"ModelsReadEvent\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"ModelsActionEvent\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"DeploymentReadEvent\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"DeploymentEventACI\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"DeploymentEventAKS\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"InferencingOperationAKS\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"InferencingOperationACI\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"DataLabelChangeEvent\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"DataLabelReadEvent\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"ComputeInstanceEvent\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"DataStoreChangeEvent\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"DataStoreReadEvent\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"DataSetChangeEvent\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"DataSetReadEvent\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"PipelineChangeEvent\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"PipelineReadEvent\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"RunEvent\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"RunReadEvent\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"EnvironmentChangeEvent\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"EnvironmentReadEvent\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        }\n                      ]\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"logAnalytics\": {\n                  \"value\": \"[[parameters('logAnalytics')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"profileName\": {\n                  \"value\": \"[[parameters('profileName')]\"\n                },\n                \"metricsEnabled\": {\n                  \"value\": \"[[parameters('metricsEnabled')]\"\n                },\n                \"logsEnabled\": {\n                  \"value\": \"[[parameters('logsEnabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#7": "{\n    \"name\": \"Audit-ServerFarms-UnusedResourcesCostOptimization\",\n    \"type\": \"Microsoft.Authorization/policyDefinitions\",\n    \"apiVersion\": \"2021-06-01\",\n    \"scope\": null,\n    \"properties\": {\n        \"policyType\": \"Custom\",\n        \"displayName\": \"Unused App Service plans driving cost should be avoided\",\n        \"mode\": \"All\",\n        \"description\": \"Optimize cost by detecting unused but chargeable resources. Leverage this Policy definition as a cost control to reveal orphaned App Service plans that are driving cost.\",\n        \"metadata\": {\n            \"version\": \"1.0.0\",\n            \"category\": \"Cost Optimization\",\n            \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n            \"alzCloudEnvironments\": [\n                \"AzureCloud\",\n                \"AzureChinaCloud\",\n                \"AzureUSGovernment\"\n            ]\n        },\n        \"parameters\": {\n            \"effect\": {\n                \"type\": \"String\",\n                \"metadata\": {\n                    \"displayName\": \"Effect\",\n                    \"description\": \"Enable or disable the execution of the policy\"\n                },\n                \"allowedValues\": [\n                    \"Audit\",\n                    \"Disabled\"\n                ],\n                \"defaultValue\": \"Audit\"\n            }\n        },\n        \"policyRule\": {\n            \"if\": {\n                \"allOf\": [\n                    {\n                        \"field\": \"type\",\n                        \"equals\": \"Microsoft.Web/serverfarms\"\n                    },\n                    {\n                        \"field\": \"Microsoft.Web/serverFarms/sku.tier\",\n                        \"notEquals\": \"Free\"\n                    },\n                    {\n                        \"field\": \"Microsoft.Web/serverFarms/numberOfSites\",\n                        \"equals\": 0\n                    }\n                ]\n            },\n            \"then\": {\n                \"effect\": \"[[parameters('effect')]\"\n            }\n        }\n    }\n}",
    "$fxv#70": "{\n  \"name\": \"Deploy-Diagnostics-MySQL\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated]: Deploy Diagnostic Settings for Database for MySQL to Log Analytics workspace\",\n    \"description\": \"Deploys the diagnostic settings for Database for MySQL to stream to a Log Analytics workspace when any Database for MySQL which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"version\": \"1.1.0-deprecated\",\n      \"category\": \"Monitoring\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"logAnalytics\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Log Analytics workspace\",\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\n          \"strongType\": \"omsWorkspace\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"profileName\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"setbypolicy\",\n        \"metadata\": {\n          \"displayName\": \"Profile name\",\n          \"description\": \"The diagnostic settings profile name\"\n        }\n      },\n      \"metricsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable metrics\",\n          \"description\": \"Whether to enable metrics stream to the Log Analytics workspace - True or False\"\n        }\n      },\n      \"logsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable logs\",\n          \"description\": \"Whether to enable logs stream to the Log Analytics workspace - True or False\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.DBforMySQL/servers\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\n          \"name\": \"[[parameters('profileName')]\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/workspaceId\",\n                \"equals\": \"[[parameters('logAnalytics')]\"\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logAnalytics\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"profileName\": {\n                    \"type\": \"String\"\n                  },\n                  \"metricsEnabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"logsEnabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.DBforMySQL/servers/providers/diagnosticSettings\",\n                    \"apiVersion\": \"2017-05-01-preview\",\n                    \"name\": \"[[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"dependsOn\": [],\n                    \"properties\": {\n                      \"workspaceId\": \"[[parameters('logAnalytics')]\",\n                      \"metrics\": [\n                        {\n                          \"category\": \"AllMetrics\",\n                          \"enabled\": \"[[parameters('metricsEnabled')]\",\n                          \"retentionPolicy\": {\n                            \"days\": 0,\n                            \"enabled\": false\n                          },\n                          \"timeGrain\": null\n                        }\n                      ],\n                      \"logs\": [\n                        {\n                          \"category\": \"MySqlSlowLogs\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"MySqlAuditLogs\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        }\n                      ]\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"logAnalytics\": {\n                  \"value\": \"[[parameters('logAnalytics')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"profileName\": {\n                  \"value\": \"[[parameters('profileName')]\"\n                },\n                \"metricsEnabled\": {\n                  \"value\": \"[[parameters('metricsEnabled')]\"\n                },\n                \"logsEnabled\": {\n                  \"value\": \"[[parameters('logsEnabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#71": "{\n  \"name\": \"Deploy-Diagnostics-NetworkSecurityGroups\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated]: Deploy Diagnostic Settings for Network Security Groups to Log Analytics workspace\",\n    \"description\": \"Deploys the diagnostic settings for Network Security Groups to stream to a Log Analytics workspace when any Network Security Groups which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"version\": \"1.1.0-deprecated\",\n      \"category\": \"Monitoring\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"logAnalytics\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Log Analytics workspace\",\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\n          \"strongType\": \"omsWorkspace\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"profileName\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"setbypolicy\",\n        \"metadata\": {\n          \"displayName\": \"Profile name\",\n          \"description\": \"The diagnostic settings profile name\"\n        }\n      },\n      \"logsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable logs\",\n          \"description\": \"Whether to enable logs stream to the Log Analytics workspace - True or False\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.Network/networkSecurityGroups\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\n          \"name\": \"[[parameters('profileName')]\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/workspaceId\",\n                \"equals\": \"[[parameters('logAnalytics')]\"\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logAnalytics\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"profileName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logsEnabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Network/networkSecurityGroups/providers/diagnosticSettings\",\n                    \"apiVersion\": \"2017-05-01-preview\",\n                    \"name\": \"[[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"dependsOn\": [],\n                    \"properties\": {\n                      \"workspaceId\": \"[[parameters('logAnalytics')]\",\n                      \"metrics\": [],\n                      \"logs\": [\n                        {\n                          \"category\": \"NetworkSecurityGroupEvent\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"NetworkSecurityGroupRuleCounter\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        }\n                      ]\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"logAnalytics\": {\n                  \"value\": \"[[parameters('logAnalytics')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"profileName\": {\n                  \"value\": \"[[parameters('profileName')]\"\n                },\n                \"logsEnabled\": {\n                  \"value\": \"[[parameters('logsEnabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#72": "{\n  \"name\": \"Deploy-Diagnostics-NIC\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated]: Deploy Diagnostic Settings for Network Interfaces to Log Analytics workspace\",\n    \"description\": \"Deploys the diagnostic settings for Network Interfaces to stream to a Log Analytics workspace when any Network Interfaces which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"version\": \"1.1.0-deprecated\",\n      \"category\": \"Monitoring\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"logAnalytics\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Log Analytics workspace\",\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\n          \"strongType\": \"omsWorkspace\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"profileName\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"setbypolicy\",\n        \"metadata\": {\n          \"displayName\": \"Profile name\",\n          \"description\": \"The diagnostic settings profile name\"\n        }\n      },\n      \"metricsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable metrics\",\n          \"description\": \"Whether to enable metrics stream to the Log Analytics workspace - True or False\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.Network/networkInterfaces\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\n          \"name\": \"[[parameters('profileName')]\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/workspaceId\",\n                \"equals\": \"[[parameters('logAnalytics')]\"\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logAnalytics\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"profileName\": {\n                    \"type\": \"String\"\n                  },\n                  \"metricsEnabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Network/networkInterfaces/providers/diagnosticSettings\",\n                    \"apiVersion\": \"2017-05-01-preview\",\n                    \"name\": \"[[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"dependsOn\": [],\n                    \"properties\": {\n                      \"workspaceId\": \"[[parameters('logAnalytics')]\",\n                      \"metrics\": [\n                        {\n                          \"category\": \"AllMetrics\",\n                          \"timeGrain\": null,\n                          \"enabled\": \"[[parameters('metricsEnabled')]\",\n                          \"retentionPolicy\": {\n                            \"enabled\": false,\n                            \"days\": 0\n                          }\n                        }\n                      ]\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"logAnalytics\": {\n                  \"value\": \"[[parameters('logAnalytics')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"profileName\": {\n                  \"value\": \"[[parameters('profileName')]\"\n                },\n                \"metricsEnabled\": {\n                  \"value\": \"[[parameters('metricsEnabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#73": "{\n  \"name\": \"Deploy-Diagnostics-PostgreSQL\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated]: Deploy Diagnostic Settings for Database for PostgreSQL to Log Analytics workspace\",\n    \"description\": \"Deploys the diagnostic settings for Database for PostgreSQL to stream to a Log Analytics workspace when any Database for PostgreSQL which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"version\": \"2.0.0-deprecated\",\n      \"category\": \"Monitoring\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"logAnalytics\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Log Analytics workspace\",\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\n          \"strongType\": \"omsWorkspace\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"profileName\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"setbypolicy\",\n        \"metadata\": {\n          \"displayName\": \"Profile name\",\n          \"description\": \"The diagnostic settings profile name\"\n        }\n      },\n      \"metricsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable metrics\",\n          \"description\": \"Whether to enable metrics stream to the Log Analytics workspace - True or False\"\n        }\n      },\n      \"logsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable logs\",\n          \"description\": \"Whether to enable logs stream to the Log Analytics workspace - True or False\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"anyOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.DBforPostgreSQL/flexibleServers\"\n          },\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.DBforPostgreSQL/servers\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\n          \"name\": \"[[parameters('profileName')]\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/workspaceId\",\n                \"equals\": \"[[parameters('logAnalytics')]\"\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"resourceType\": {\n                    \"type\": \"String\"\n                  },\n                  \"logAnalytics\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"profileName\": {\n                    \"type\": \"String\"\n                  },\n                  \"metricsEnabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"logsEnabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"condition\": \"[[startsWith(parameters('resourceType'),'Microsoft.DBforPostgreSQL/flexibleServers')]\",\n                    \"type\": \"Microsoft.DBforPostgreSQL/flexibleServers/providers/diagnosticSettings\",\n                    \"apiVersion\": \"2021-05-01-preview\",\n                    \"name\": \"[[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"dependsOn\": [],\n                    \"properties\": {\n                      \"workspaceId\": \"[[parameters('logAnalytics')]\",\n                      \"metrics\": [\n                        {\n                          \"category\": \"AllMetrics\",\n                          \"enabled\": \"[[parameters('metricsEnabled')]\",\n                          \"retentionPolicy\": {\n                            \"days\": 0,\n                            \"enabled\": false\n                          },\n                          \"timeGrain\": null\n                        }\n                      ],\n                      \"logs\": [\n                        {\n                          \"category\": \"PostgreSQLLogs\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        }\n                      ]\n                    }\n                  },\n                  {\n                    \"condition\": \"[[startsWith(parameters('resourceType'),'Microsoft.DBforPostgreSQL/servers')]\",\n                    \"type\": \"Microsoft.DBforPostgreSQL/servers/providers/diagnosticSettings\",\n                    \"apiVersion\": \"2021-05-01-preview\",\n                    \"name\": \"[[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"dependsOn\": [],\n                    \"properties\": {\n                      \"workspaceId\": \"[[parameters('logAnalytics')]\",\n                      \"metrics\": [\n                        {\n                          \"category\": \"AllMetrics\",\n                          \"enabled\": \"[[parameters('metricsEnabled')]\",\n                          \"retentionPolicy\": {\n                            \"days\": 0,\n                            \"enabled\": false\n                          },\n                          \"timeGrain\": null\n                        }\n                      ],\n                      \"logs\": [\n                        {\n                          \"category\": \"PostgreSQLLogs\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"QueryStoreRuntimeStatistics\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"QueryStoreWaitStatistics\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        }\n                      ]\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"logAnalytics\": {\n                  \"value\": \"[[parameters('logAnalytics')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceType\": {\n                  \"value\": \"[[field('type')]\"\n                },\n                \"profileName\": {\n                  \"value\": \"[[parameters('profileName')]\"\n                },\n                \"metricsEnabled\": {\n                  \"value\": \"[[parameters('metricsEnabled')]\"\n                },\n                \"logsEnabled\": {\n                  \"value\": \"[[parameters('logsEnabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#74": "{\n  \"name\": \"Deploy-Diagnostics-PowerBIEmbedded\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated]: Deploy Diagnostic Settings for Power BI Embedded to Log Analytics workspace\",\n    \"description\": \"Deploys the diagnostic settings for Power BI Embedded to stream to a Log Analytics workspace when any Power BI Embedded which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"version\": \"1.1.0-deprecated\",\n      \"category\": \"Monitoring\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"logAnalytics\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Log Analytics workspace\",\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\n          \"strongType\": \"omsWorkspace\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"profileName\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"setbypolicy\",\n        \"metadata\": {\n          \"displayName\": \"Profile name\",\n          \"description\": \"The diagnostic settings profile name\"\n        }\n      },\n      \"metricsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable metrics\",\n          \"description\": \"Whether to enable metrics stream to the Log Analytics workspace - True or False\"\n        }\n      },\n      \"logsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable logs\",\n          \"description\": \"Whether to enable logs stream to the Log Analytics workspace - True or False\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.PowerBIDedicated/capacities\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\n          \"name\": \"[[parameters('profileName')]\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/workspaceId\",\n                \"equals\": \"[[parameters('logAnalytics')]\"\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logAnalytics\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"profileName\": {\n                    \"type\": \"String\"\n                  },\n                  \"metricsEnabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"logsEnabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.PowerBIDedicated/capacities/providers/diagnosticSettings\",\n                    \"apiVersion\": \"2017-05-01-preview\",\n                    \"name\": \"[[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"dependsOn\": [],\n                    \"properties\": {\n                      \"workspaceId\": \"[[parameters('logAnalytics')]\",\n                      \"metrics\": [\n                        {\n                          \"category\": \"AllMetrics\",\n                          \"enabled\": \"[[parameters('metricsEnabled')]\",\n                          \"retentionPolicy\": {\n                            \"days\": 0,\n                            \"enabled\": false\n                          },\n                          \"timeGrain\": null\n                        }\n                      ],\n                      \"logs\": [\n                        {\n                          \"category\": \"Engine\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        }\n                      ]\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"logAnalytics\": {\n                  \"value\": \"[[parameters('logAnalytics')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"profileName\": {\n                  \"value\": \"[[parameters('profileName')]\"\n                },\n                \"metricsEnabled\": {\n                  \"value\": \"[[parameters('metricsEnabled')]\"\n                },\n                \"logsEnabled\": {\n                  \"value\": \"[[parameters('logsEnabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#75": "{\n  \"name\": \"Deploy-Diagnostics-RedisCache\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated]: Deploy Diagnostic Settings for Redis Cache to Log Analytics workspace\",\n    \"description\": \"Deploys the diagnostic settings for Redis Cache to stream to a Log Analytics workspace when any Redis Cache which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"version\": \"1.1.0-deprecated\",\n      \"category\": \"Monitoring\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"logAnalytics\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Log Analytics workspace\",\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\n          \"strongType\": \"omsWorkspace\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"profileName\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"setbypolicy\",\n        \"metadata\": {\n          \"displayName\": \"Profile name\",\n          \"description\": \"The diagnostic settings profile name\"\n        }\n      },\n      \"metricsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable metrics\",\n          \"description\": \"Whether to enable metrics stream to the Log Analytics workspace - True or False\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.Cache/redis\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\n          \"name\": \"[[parameters('profileName')]\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/workspaceId\",\n                \"equals\": \"[[parameters('logAnalytics')]\"\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logAnalytics\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"profileName\": {\n                    \"type\": \"String\"\n                  },\n                  \"metricsEnabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Cache/redis/providers/diagnosticSettings\",\n                    \"apiVersion\": \"2017-05-01-preview\",\n                    \"name\": \"[[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"dependsOn\": [],\n                    \"properties\": {\n                      \"workspaceId\": \"[[parameters('logAnalytics')]\",\n                      \"metrics\": [\n                        {\n                          \"category\": \"AllMetrics\",\n                          \"enabled\": \"[[parameters('metricsEnabled')]\",\n                          \"retentionPolicy\": {\n                            \"days\": 0,\n                            \"enabled\": false\n                          },\n                          \"timeGrain\": null\n                        }\n                      ],\n                      \"logs\": []\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"logAnalytics\": {\n                  \"value\": \"[[parameters('logAnalytics')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"profileName\": {\n                  \"value\": \"[[parameters('profileName')]\"\n                },\n                \"metricsEnabled\": {\n                  \"value\": \"[[parameters('metricsEnabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#76": "{\n  \"name\": \"Deploy-Diagnostics-Relay\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated]: Deploy Diagnostic Settings for Relay to Log Analytics workspace\",\n    \"description\": \"Deploys the diagnostic settings for Relay to stream to a Log Analytics workspace when any Relay which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"version\": \"1.1.0-deprecated\",\n      \"category\": \"Monitoring\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"logAnalytics\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Log Analytics workspace\",\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\n          \"strongType\": \"omsWorkspace\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"profileName\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"setbypolicy\",\n        \"metadata\": {\n          \"displayName\": \"Profile name\",\n          \"description\": \"The diagnostic settings profile name\"\n        }\n      },\n      \"metricsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable metrics\",\n          \"description\": \"Whether to enable metrics stream to the Log Analytics workspace - True or False\"\n        }\n      },\n      \"logsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable logs\",\n          \"description\": \"Whether to enable logs stream to the Log Analytics workspace - True or False\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.Relay/namespaces\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\n          \"name\": \"[[parameters('profileName')]\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/workspaceId\",\n                \"equals\": \"[[parameters('logAnalytics')]\"\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logAnalytics\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"profileName\": {\n                    \"type\": \"String\"\n                  },\n                  \"metricsEnabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"logsEnabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Relay/namespaces/providers/diagnosticSettings\",\n                    \"apiVersion\": \"2017-05-01-preview\",\n                    \"name\": \"[[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"dependsOn\": [],\n                    \"properties\": {\n                      \"workspaceId\": \"[[parameters('logAnalytics')]\",\n                      \"metrics\": [\n                        {\n                          \"category\": \"AllMetrics\",\n                          \"enabled\": \"[[parameters('metricsEnabled')]\",\n                          \"retentionPolicy\": {\n                            \"days\": 0,\n                            \"enabled\": false\n                          },\n                          \"timeGrain\": null\n                        }\n                      ],\n                      \"logs\": [\n                        {\n                          \"category\": \"HybridConnectionsEvent\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        }\n                      ]\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"logAnalytics\": {\n                  \"value\": \"[[parameters('logAnalytics')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"profileName\": {\n                  \"value\": \"[[parameters('profileName')]\"\n                },\n                \"metricsEnabled\": {\n                  \"value\": \"[[parameters('metricsEnabled')]\"\n                },\n                \"logsEnabled\": {\n                  \"value\": \"[[parameters('logsEnabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#77": "{\n  \"name\": \"Deploy-Diagnostics-SignalR\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated]: Deploy Diagnostic Settings for SignalR to Log Analytics workspace\",\n    \"description\": \"Deploys the diagnostic settings for SignalR to stream to a Log Analytics workspace when any SignalR which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"version\": \"1.1.0-deprecated\",\n      \"category\": \"Monitoring\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"logAnalytics\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Log Analytics workspace\",\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\n          \"strongType\": \"omsWorkspace\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"profileName\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"setbypolicy\",\n        \"metadata\": {\n          \"displayName\": \"Profile name\",\n          \"description\": \"The diagnostic settings profile name\"\n        }\n      },\n      \"metricsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable metrics\",\n          \"description\": \"Whether to enable metrics stream to the Log Analytics workspace - True or False\"\n        }\n      },\n      \"logsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable logs\",\n          \"description\": \"Whether to enable logs stream to the Log Analytics workspace - True or False\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.SignalRService/SignalR\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\n          \"name\": \"[[parameters('profileName')]\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/workspaceId\",\n                \"equals\": \"[[parameters('logAnalytics')]\"\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logAnalytics\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"profileName\": {\n                    \"type\": \"String\"\n                  },\n                  \"metricsEnabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"logsEnabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.SignalRService/SignalR/providers/diagnosticSettings\",\n                    \"apiVersion\": \"2017-05-01-preview\",\n                    \"name\": \"[[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"dependsOn\": [],\n                    \"properties\": {\n                      \"workspaceId\": \"[[parameters('logAnalytics')]\",\n                      \"metrics\": [\n                        {\n                          \"category\": \"AllMetrics\",\n                          \"enabled\": \"[[parameters('metricsEnabled')]\",\n                          \"retentionPolicy\": {\n                            \"days\": 0,\n                            \"enabled\": false\n                          },\n                          \"timeGrain\": null\n                        }\n                      ],\n                      \"logs\": [\n                        {\n                          \"category\": \"AllLogs\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        }\n                      ]\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"logAnalytics\": {\n                  \"value\": \"[[parameters('logAnalytics')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"profileName\": {\n                  \"value\": \"[[parameters('profileName')]\"\n                },\n                \"metricsEnabled\": {\n                  \"value\": \"[[parameters('metricsEnabled')]\"\n                },\n                \"logsEnabled\": {\n                  \"value\": \"[[parameters('logsEnabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#78": "{\n  \"name\": \"Deploy-Diagnostics-SQLElasticPools\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated]: Deploy Diagnostic Settings for SQL Elastic Pools to Log Analytics workspace\",\n    \"description\": \"Deploys the diagnostic settings for SQL Elastic Pools to stream to a Log Analytics workspace when any SQL Elastic Pools which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"version\": \"1.1.0-deprecated\",\n      \"category\": \"Monitoring\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"logAnalytics\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Log Analytics workspace\",\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\n          \"strongType\": \"omsWorkspace\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"profileName\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"setbypolicy\",\n        \"metadata\": {\n          \"displayName\": \"Profile name\",\n          \"description\": \"The diagnostic settings profile name\"\n        }\n      },\n      \"metricsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable metrics\",\n          \"description\": \"Whether to enable metrics stream to the Log Analytics workspace - True or False\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.Sql/servers/elasticPools\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\n          \"name\": \"[[parameters('profileName')]\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/workspaceId\",\n                \"equals\": \"[[parameters('logAnalytics')]\"\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logAnalytics\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"profileName\": {\n                    \"type\": \"String\"\n                  },\n                  \"metricsEnabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Sql/servers/elasticPools/providers/diagnosticSettings\",\n                    \"apiVersion\": \"2017-05-01-preview\",\n                    \"name\": \"[[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"dependsOn\": [],\n                    \"properties\": {\n                      \"workspaceId\": \"[[parameters('logAnalytics')]\",\n                      \"metrics\": [\n                        {\n                          \"category\": \"AllMetrics\",\n                          \"enabled\": \"[[parameters('metricsEnabled')]\",\n                          \"retentionPolicy\": {\n                            \"days\": 0,\n                            \"enabled\": false\n                          },\n                          \"timeGrain\": null\n                        }\n                      ],\n                      \"logs\": []\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"logAnalytics\": {\n                  \"value\": \"[[parameters('logAnalytics')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"resourceName\": {\n                  \"value\": \"[[field('fullName')]\"\n                },\n                \"profileName\": {\n                  \"value\": \"[[parameters('profileName')]\"\n                },\n                \"metricsEnabled\": {\n                  \"value\": \"[[parameters('metricsEnabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#79": "{\n  \"name\": \"Deploy-Diagnostics-SQLMI\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated]: Deploy Diagnostic Settings for SQL Managed Instances to Log Analytics workspace\",\n    \"description\": \"Deploys the diagnostic settings for SQL Managed Instances to stream to a Log Analytics workspace when any SQL Managed Instances which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"version\": \"1.1.0-deprecated\",\n      \"category\": \"Monitoring\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"logAnalytics\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Log Analytics workspace\",\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\n          \"strongType\": \"omsWorkspace\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"profileName\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"setbypolicy\",\n        \"metadata\": {\n          \"displayName\": \"Profile name\",\n          \"description\": \"The diagnostic settings profile name\"\n        }\n      },\n      \"logsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable logs\",\n          \"description\": \"Whether to enable logs stream to the Log Analytics workspace - True or False\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.Sql/managedInstances\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\n          \"name\": \"[[parameters('profileName')]\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/workspaceId\",\n                \"equals\": \"[[parameters('logAnalytics')]\"\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logAnalytics\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"profileName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logsEnabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Sql/managedInstances/providers/diagnosticSettings\",\n                    \"apiVersion\": \"2017-05-01-preview\",\n                    \"name\": \"[[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"dependsOn\": [],\n                    \"properties\": {\n                      \"workspaceId\": \"[[parameters('logAnalytics')]\",\n                      \"logs\": [\n                        {\n                          \"category\": \"ResourceUsageStats\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"SQLSecurityAuditEvents\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"DevOpsOperationsAudit\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        }\n                      ]\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"logAnalytics\": {\n                  \"value\": \"[[parameters('logAnalytics')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"profileName\": {\n                  \"value\": \"[[parameters('profileName')]\"\n                },\n                \"logsEnabled\": {\n                  \"value\": \"[[parameters('logsEnabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#8": "{\n  \"name\": \"Audit-AzureHybridBenefit\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"displayName\": \"Audit AHUB for eligible VMs\",\n    \"mode\": \"All\",\n    \"description\": \"Optimize cost by enabling Azure Hybrid Benefit. Leverage this Policy definition as a cost control to reveal Virtual Machines not using AHUB.\",\n    \"metadata\": {\n      \"version\": \"1.0.0\",\n      \"category\": \"Cost Optimization\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        },\n        \"allowedValues\": [\n          \"Audit\",\n          \"Disabled\"\n        ],\n        \"defaultValue\": \"Audit\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"in\": [\n              \"Microsoft.Compute/virtualMachines\",\n              \"Microsoft.Compute/virtualMachineScaleSets\"\n            ]\n          },\n          {\n            \"equals\": \"MicrosoftWindowsServer\",\n            \"field\": \"Microsoft.Compute/imagePublisher\"\n          },\n          {\n            \"equals\": \"WindowsServer\",\n            \"field\": \"Microsoft.Compute/imageOffer\"\n          },\n          {\n            \"anyOf\": [\n              {\n                \"field\": \"Microsoft.Compute/imageSKU\",\n                \"like\": \"2008-R2-SP1*\"\n              },\n              {\n                \"field\": \"Microsoft.Compute/imageSKU\",\n                \"like\": \"2012-*\"\n              },\n              {\n                \"field\": \"Microsoft.Compute/imageSKU\",\n                \"like\": \"2016-*\"\n              },\n              {\n                \"field\": \"Microsoft.Compute/imageSKU\",\n                \"like\": \"2019-*\"\n              },\n              {\n                \"field\": \"Microsoft.Compute/imageSKU\",\n                \"like\": \"2022-*\"\n              }\n            ]\n          },\n          {\n            \"field\": \"Microsoft.Compute/licenseType\",\n            \"notEquals\": \"Windows_Server\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\"\n      }\n    }\n  }\n}",
    "$fxv#80": "{\n  \"name\": \"Deploy-Diagnostics-TimeSeriesInsights\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated]: Deploy Diagnostic Settings for Time Series Insights to Log Analytics workspace\",\n    \"description\": \"Deploys the diagnostic settings for Time Series Insights to stream to a Log Analytics workspace when any Time Series Insights which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"version\": \"1.1.0-deprecated\",\n      \"category\": \"Monitoring\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"logAnalytics\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Log Analytics workspace\",\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\n          \"strongType\": \"omsWorkspace\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"profileName\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"setbypolicy\",\n        \"metadata\": {\n          \"displayName\": \"Profile name\",\n          \"description\": \"The diagnostic settings profile name\"\n        }\n      },\n      \"metricsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable metrics\",\n          \"description\": \"Whether to enable metrics stream to the Log Analytics workspace - True or False\"\n        }\n      },\n      \"logsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable logs\",\n          \"description\": \"Whether to enable logs stream to the Log Analytics workspace - True or False\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.TimeSeriesInsights/environments\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\n          \"name\": \"[[parameters('profileName')]\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/workspaceId\",\n                \"equals\": \"[[parameters('logAnalytics')]\"\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logAnalytics\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"profileName\": {\n                    \"type\": \"String\"\n                  },\n                  \"metricsEnabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"logsEnabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.TimeSeriesInsights/environments/providers/diagnosticSettings\",\n                    \"apiVersion\": \"2017-05-01-preview\",\n                    \"name\": \"[[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"dependsOn\": [],\n                    \"properties\": {\n                      \"workspaceId\": \"[[parameters('logAnalytics')]\",\n                      \"metrics\": [\n                        {\n                          \"category\": \"AllMetrics\",\n                          \"enabled\": \"[[parameters('metricsEnabled')]\",\n                          \"retentionPolicy\": {\n                            \"days\": 0,\n                            \"enabled\": false\n                          },\n                          \"timeGrain\": null\n                        }\n                      ],\n                      \"logs\": [\n                        {\n                          \"category\": \"Ingress\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"Management\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        }\n                      ]\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"logAnalytics\": {\n                  \"value\": \"[[parameters('logAnalytics')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"profileName\": {\n                  \"value\": \"[[parameters('profileName')]\"\n                },\n                \"metricsEnabled\": {\n                  \"value\": \"[[parameters('metricsEnabled')]\"\n                },\n                \"logsEnabled\": {\n                  \"value\": \"[[parameters('logsEnabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#81": "{\n  \"name\": \"Deploy-Diagnostics-TrafficManager\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated]: Deploy Diagnostic Settings for Traffic Manager to Log Analytics workspace\",\n    \"description\": \"Deploys the diagnostic settings for Traffic Manager to stream to a Log Analytics workspace when any Traffic Manager which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"version\": \"1.1.0-deprecated\",\n      \"category\": \"Monitoring\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"logAnalytics\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Log Analytics workspace\",\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\n          \"strongType\": \"omsWorkspace\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"profileName\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"setbypolicy\",\n        \"metadata\": {\n          \"displayName\": \"Profile name\",\n          \"description\": \"The diagnostic settings profile name\"\n        }\n      },\n      \"metricsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable metrics\",\n          \"description\": \"Whether to enable metrics stream to the Log Analytics workspace - True or False\"\n        }\n      },\n      \"logsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable logs\",\n          \"description\": \"Whether to enable logs stream to the Log Analytics workspace - True or False\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.Network/trafficManagerProfiles\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\n          \"name\": \"[[parameters('profileName')]\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/workspaceId\",\n                \"equals\": \"[[parameters('logAnalytics')]\"\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logAnalytics\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"profileName\": {\n                    \"type\": \"String\"\n                  },\n                  \"metricsEnabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"logsEnabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Network/trafficManagerProfiles/providers/diagnosticSettings\",\n                    \"apiVersion\": \"2017-05-01-preview\",\n                    \"name\": \"[[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"dependsOn\": [],\n                    \"properties\": {\n                      \"workspaceId\": \"[[parameters('logAnalytics')]\",\n                      \"metrics\": [\n                        {\n                          \"category\": \"AllMetrics\",\n                          \"enabled\": \"[[parameters('metricsEnabled')]\",\n                          \"retentionPolicy\": {\n                            \"days\": 0,\n                            \"enabled\": false\n                          },\n                          \"timeGrain\": null\n                        }\n                      ],\n                      \"logs\": [\n                        {\n                          \"category\": \"ProbeHealthStatusEvents\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        }\n                      ]\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"logAnalytics\": {\n                  \"value\": \"[[parameters('logAnalytics')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"profileName\": {\n                  \"value\": \"[[parameters('profileName')]\"\n                },\n                \"metricsEnabled\": {\n                  \"value\": \"[[parameters('metricsEnabled')]\"\n                },\n                \"logsEnabled\": {\n                  \"value\": \"[[parameters('logsEnabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#82": "{\n  \"name\": \"Deploy-Diagnostics-VirtualNetwork\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated]: Deploy Diagnostic Settings for Virtual Network to Log Analytics workspace\",\n    \"description\": \"Deploys the diagnostic settings for Virtual Network to stream to a Log Analytics workspace when any Virtual Network which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"version\": \"1.1.0-deprecated\",\n      \"category\": \"Monitoring\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"logAnalytics\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Log Analytics workspace\",\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\n          \"strongType\": \"omsWorkspace\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"profileName\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"setbypolicy\",\n        \"metadata\": {\n          \"displayName\": \"Profile name\",\n          \"description\": \"The diagnostic settings profile name\"\n        }\n      },\n      \"metricsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable metrics\",\n          \"description\": \"Whether to enable metrics stream to the Log Analytics workspace - True or False\"\n        }\n      },\n      \"logsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable logs\",\n          \"description\": \"Whether to enable logs stream to the Log Analytics workspace - True or False\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.Network/virtualNetworks\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\n          \"name\": \"[[parameters('profileName')]\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/workspaceId\",\n                \"equals\": \"[[parameters('logAnalytics')]\"\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logAnalytics\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"profileName\": {\n                    \"type\": \"String\"\n                  },\n                  \"metricsEnabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"logsEnabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Network/virtualNetworks/providers/diagnosticSettings\",\n                    \"apiVersion\": \"2017-05-01-preview\",\n                    \"name\": \"[[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"dependsOn\": [],\n                    \"properties\": {\n                      \"workspaceId\": \"[[parameters('logAnalytics')]\",\n                      \"metrics\": [\n                        {\n                          \"category\": \"AllMetrics\",\n                          \"enabled\": \"[[parameters('metricsEnabled')]\",\n                          \"retentionPolicy\": {\n                            \"enabled\": false,\n                            \"days\": 0\n                          }\n                        }\n                      ],\n                      \"logs\": [\n                        {\n                          \"category\": \"VMProtectionAlerts\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        }\n                      ]\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"logAnalytics\": {\n                  \"value\": \"[[parameters('logAnalytics')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"profileName\": {\n                  \"value\": \"[[parameters('profileName')]\"\n                },\n                \"metricsEnabled\": {\n                  \"value\": \"[[parameters('metricsEnabled')]\"\n                },\n                \"logsEnabled\": {\n                  \"value\": \"[[parameters('logsEnabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#83": "{\n  \"name\": \"Deploy-Diagnostics-VM\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated]: Deploy Diagnostic Settings for Virtual Machines to Log Analytics workspace\",\n    \"description\": \"Deploys the diagnostic settings for Virtual Machines to stream to a Log Analytics workspace when any Virtual Machines which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"version\": \"1.1.0-deprecated\",\n      \"category\": \"Monitoring\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"logAnalytics\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Log Analytics workspace\",\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\n          \"strongType\": \"omsWorkspace\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"profileName\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"setbypolicy\",\n        \"metadata\": {\n          \"displayName\": \"Profile name\",\n          \"description\": \"The diagnostic settings profile name\"\n        }\n      },\n      \"metricsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable metrics\",\n          \"description\": \"Whether to enable metrics stream to the Log Analytics workspace - True or False\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.Compute/virtualMachines\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\n          \"name\": \"[[parameters('profileName')]\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/workspaceId\",\n                \"equals\": \"[[parameters('logAnalytics')]\"\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logAnalytics\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"profileName\": {\n                    \"type\": \"String\"\n                  },\n                  \"metricsEnabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Compute/virtualMachines/providers/diagnosticSettings\",\n                    \"apiVersion\": \"2017-05-01-preview\",\n                    \"name\": \"[[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"dependsOn\": [],\n                    \"properties\": {\n                      \"workspaceId\": \"[[parameters('logAnalytics')]\",\n                      \"metrics\": [\n                        {\n                          \"category\": \"AllMetrics\",\n                          \"enabled\": \"[[parameters('metricsEnabled')]\",\n                          \"retentionPolicy\": {\n                            \"enabled\": false,\n                            \"days\": 0\n                          }\n                        }\n                      ],\n                      \"logs\": []\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"logAnalytics\": {\n                  \"value\": \"[[parameters('logAnalytics')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"profileName\": {\n                  \"value\": \"[[parameters('profileName')]\"\n                },\n                \"metricsEnabled\": {\n                  \"value\": \"[[parameters('metricsEnabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#84": "{\n  \"name\": \"Deploy-Diagnostics-VMSS\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated]: Deploy Diagnostic Settings for Virtual Machine Scale Sets to Log Analytics workspace\",\n    \"description\": \"Deploys the diagnostic settings for Virtual Machine Scale Sets  to stream to a Log Analytics workspace when any Virtual Machine Scale Sets  which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"version\": \"1.1.0-deprecated\",\n      \"category\": \"Monitoring\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"logAnalytics\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Log Analytics workspace\",\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\n          \"strongType\": \"omsWorkspace\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"profileName\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"setbypolicy\",\n        \"metadata\": {\n          \"displayName\": \"Profile name\",\n          \"description\": \"The diagnostic settings profile name\"\n        }\n      },\n      \"metricsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable metrics\",\n          \"description\": \"Whether to enable metrics stream to the Log Analytics workspace - True or False\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.Compute/virtualMachineScaleSets\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\n          \"name\": \"[[parameters('profileName')]\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/workspaceId\",\n                \"equals\": \"[[parameters('logAnalytics')]\"\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logAnalytics\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"profileName\": {\n                    \"type\": \"String\"\n                  },\n                  \"metricsEnabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Compute/virtualMachineScaleSets/providers/diagnosticSettings\",\n                    \"apiVersion\": \"2017-05-01-preview\",\n                    \"name\": \"[[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"dependsOn\": [],\n                    \"properties\": {\n                      \"workspaceId\": \"[[parameters('logAnalytics')]\",\n                      \"metrics\": [\n                        {\n                          \"category\": \"AllMetrics\",\n                          \"enabled\": \"[[parameters('metricsEnabled')]\",\n                          \"retentionPolicy\": {\n                            \"enabled\": false,\n                            \"days\": 0\n                          }\n                        }\n                      ],\n                      \"logs\": []\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"logAnalytics\": {\n                  \"value\": \"[[parameters('logAnalytics')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"profileName\": {\n                  \"value\": \"[[parameters('profileName')]\"\n                },\n                \"metricsEnabled\": {\n                  \"value\": \"[[parameters('metricsEnabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#85": "{\n  \"name\": \"Deploy-Diagnostics-VNetGW\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated]: Deploy Diagnostic Settings for VPN Gateway to Log Analytics workspace\",\n    \"description\": \"Deploys the diagnostic settings for VPN Gateway to stream to a Log Analytics workspace when any VPN Gateway which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"version\": \"1.1.1-deprecated\",\n      \"category\": \"Monitoring\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"logAnalytics\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Log Analytics workspace\",\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\n          \"strongType\": \"omsWorkspace\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"profileName\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"setbypolicy\",\n        \"metadata\": {\n          \"displayName\": \"Profile name\",\n          \"description\": \"The diagnostic settings profile name\"\n        }\n      },\n      \"metricsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable metrics\",\n          \"description\": \"Whether to enable metrics stream to the Log Analytics workspace - True or False\"\n        }\n      },\n      \"logsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable logs\",\n          \"description\": \"Whether to enable logs stream to the Log Analytics workspace - True or False\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.Network/virtualNetworkGateways\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\n          \"name\": \"[[parameters('profileName')]\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/workspaceId\",\n                \"equals\": \"[[parameters('logAnalytics')]\"\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logAnalytics\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"profileName\": {\n                    \"type\": \"String\"\n                  },\n                  \"metricsEnabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"logsEnabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Network/virtualNetworkGateways/providers/diagnosticSettings\",\n                    \"apiVersion\": \"2017-05-01-preview\",\n                    \"name\": \"[[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"dependsOn\": [],\n                    \"properties\": {\n                      \"workspaceId\": \"[[parameters('logAnalytics')]\",\n                      \"metrics\": [\n                        {\n                          \"category\": \"AllMetrics\",\n                          \"enabled\": \"[[parameters('metricsEnabled')]\",\n                          \"retentionPolicy\": {\n                            \"days\": 0,\n                            \"enabled\": false\n                          },\n                          \"timeGrain\": null\n                        }\n                      ],\n                      \"logs\": [\n                        {\n                          \"category\": \"GatewayDiagnosticLog\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"IKEDiagnosticLog\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"P2SDiagnosticLog\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"RouteDiagnosticLog\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"TunnelDiagnosticLog\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        }\n                      ]\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"logAnalytics\": {\n                  \"value\": \"[[parameters('logAnalytics')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"profileName\": {\n                  \"value\": \"[[parameters('profileName')]\"\n                },\n                \"metricsEnabled\": {\n                  \"value\": \"[[parameters('metricsEnabled')]\"\n                },\n                \"logsEnabled\": {\n                  \"value\": \"[[parameters('logsEnabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#86": "{\n  \"name\": \"Deploy-Diagnostics-WebServerFarm\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated]: Deploy Diagnostic Settings for App Service Plan to Log Analytics workspace\",\n    \"description\": \"Deploys the diagnostic settings for App Service Plan to stream to a Log Analytics workspace when any App Service Plan which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"version\": \"1.1.0-deprecated\",\n      \"category\": \"Monitoring\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"logAnalytics\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Log Analytics workspace\",\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\n          \"strongType\": \"omsWorkspace\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"profileName\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"setbypolicy\",\n        \"metadata\": {\n          \"displayName\": \"Profile name\",\n          \"description\": \"The diagnostic settings profile name\"\n        }\n      },\n      \"metricsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable metrics\",\n          \"description\": \"Whether to enable metrics stream to the Log Analytics workspace - True or False\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.Web/serverfarms\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\n          \"name\": \"[[parameters('profileName')]\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/workspaceId\",\n                \"equals\": \"[[parameters('logAnalytics')]\"\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logAnalytics\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"profileName\": {\n                    \"type\": \"String\"\n                  },\n                  \"metricsEnabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Web/serverfarms/providers/diagnosticSettings\",\n                    \"apiVersion\": \"2017-05-01-preview\",\n                    \"name\": \"[[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"dependsOn\": [],\n                    \"properties\": {\n                      \"workspaceId\": \"[[parameters('logAnalytics')]\",\n                      \"metrics\": [\n                        {\n                          \"category\": \"AllMetrics\",\n                          \"enabled\": \"[[parameters('metricsEnabled')]\",\n                          \"retentionPolicy\": {\n                            \"days\": 0,\n                            \"enabled\": false\n                          },\n                          \"timeGrain\": null\n                        }\n                      ],\n                      \"logs\": []\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"logAnalytics\": {\n                  \"value\": \"[[parameters('logAnalytics')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"profileName\": {\n                  \"value\": \"[[parameters('profileName')]\"\n                },\n                \"metricsEnabled\": {\n                  \"value\": \"[[parameters('metricsEnabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#87": "{\n  \"name\": \"Deploy-Diagnostics-Website\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated]: Deploy Diagnostic Settings for App Service to Log Analytics workspace\",\n    \"description\": \"Deploys the diagnostic settings for Web App to stream to a Log Analytics workspace when any Web App which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"version\": \"1.2.0-deprecated\",\n      \"category\": \"Monitoring\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"logAnalytics\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Log Analytics workspace\",\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\n          \"strongType\": \"omsWorkspace\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"profileName\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"setbypolicy\",\n        \"metadata\": {\n          \"displayName\": \"Profile name\",\n          \"description\": \"The diagnostic settings profile name\"\n        }\n      },\n      \"metricsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable metrics\",\n          \"description\": \"Whether to enable metrics stream to the Log Analytics workspace - True or False\"\n        }\n      },\n      \"logsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable logs\",\n          \"description\": \"Whether to enable logs stream to the Log Analytics workspace - True or False\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Web/sites\"\n          },\n          {\n            \"value\": \"[[field('kind')]\",\n            \"notContains\": \"functionapp\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\n          \"name\": \"[[parameters('profileName')]\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\n                \"equals\": \"[[parameters('logsEnabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\n                \"equals\": \"[[parameters('metricsEnabled')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/workspaceId\",\n                \"equals\": \"[[parameters('logAnalytics')]\"\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logAnalytics\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"profileName\": {\n                    \"type\": \"String\"\n                  },\n                  \"metricsEnabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"logsEnabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"serverFarmId\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {\n                  \"logs\": {\n                    \"premiumTierLogs\": [\n                      {\n                        \"category\": \"AppServiceAntivirusScanAuditLogs\",\n                        \"enabled\": \"[[parameters('logsEnabled')]\"\n                      },\n                      {\n                        \"category\": \"AppServiceHTTPLogs\",\n                        \"enabled\": \"[[parameters('logsEnabled')]\"\n                      },\n                      {\n                        \"category\": \"AppServiceConsoleLogs\",\n                        \"enabled\": \"[[parameters('logsEnabled')]\"\n                      },\n                      {\n                        \"category\": \"AppServiceAppLogs\",\n                        \"enabled\": \"[[parameters('logsEnabled')]\"\n                      },\n                      {\n                        \"category\": \"AppServiceFileAuditLogs\",\n                        \"enabled\": \"[[parameters('logsEnabled')]\"\n                      },\n                      {\n                        \"category\": \"AppServiceAuditLogs\",\n                        \"enabled\": \"[[parameters('logsEnabled')]\"\n                      },\n                      {\n                        \"category\": \"AppServiceIPSecAuditLogs\",\n                        \"enabled\": \"[[parameters('logsEnabled')]\"\n                      },\n                      {\n                        \"category\": \"AppServicePlatformLogs\",\n                        \"enabled\": \"[[parameters('logsEnabled')]\"\n                      }\n                    ],\n                    \"otherTierLogs\": [                                \n                      {\n                        \"category\": \"AppServiceHTTPLogs\",\n                        \"enabled\": \"[[parameters('logsEnabled')]\"\n                      },\n                      {\n                        \"category\": \"AppServiceConsoleLogs\",\n                        \"enabled\": \"[[parameters('logsEnabled')]\"\n                      },\n                      {\n                        \"category\": \"AppServiceAppLogs\",\n                        \"enabled\": \"[[parameters('logsEnabled')]\"\n                      },\n                      {\n                        \"category\": \"AppServiceAuditLogs\",\n                        \"enabled\": \"[[parameters('logsEnabled')]\"\n                      },\n                      {\n                        \"category\": \"AppServiceIPSecAuditLogs\",\n                        \"enabled\": \"[[parameters('logsEnabled')]\"\n                      },\n                      {\n                        \"category\": \"AppServicePlatformLogs\",\n                        \"enabled\": \"[[parameters('logsEnabled')]\"\n                      }\n                    ]\n                  }\n                },\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Web/sites/providers/diagnosticSettings\",\n                    \"apiVersion\": \"2017-05-01-preview\",\n                    \"name\": \"[[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"dependsOn\": [],\n                    \"properties\": {\n                      \"workspaceId\": \"[[parameters('logAnalytics')]\",\n                      \"metrics\": [\n                        {\n                          \"category\": \"AllMetrics\",\n                          \"enabled\": \"[[parameters('metricsEnabled')]\",\n                          \"retentionPolicy\": {\n                            \"days\": 0,\n                            \"enabled\": false\n                          },\n                          \"timeGrain\": null\n                        }\n                      ],\n                      \"logs\": \"[[if(startsWith(reference(parameters('serverFarmId'), '2021-03-01', 'Full').sku.tier, 'Premium'), variables('logs').premiumTierLogs, variables('logs').otherTierLogs)]\"\n                    }\n                  }\n                ],\n                \"outputs\": {\n                  \"policy\": {\n                    \"type\": \"string\",\n                    \"value\": \"[[concat(parameters('logAnalytics'), 'configured for diagnostic logs for ', ': ', parameters('resourceName'))]\"\n                  }\n                }\n              },\n              \"parameters\": {\n                \"logAnalytics\": {\n                  \"value\": \"[[parameters('logAnalytics')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"profileName\": {\n                  \"value\": \"[[parameters('profileName')]\"\n                },\n                \"metricsEnabled\": {\n                  \"value\": \"[[parameters('metricsEnabled')]\"\n                },\n                \"logsEnabled\": {\n                  \"value\": \"[[parameters('logsEnabled')]\"\n                },\n                \"serverFarmId\": {\n                  \"value\": \"[[field('Microsoft.Web/sites/serverFarmId')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#88": "{\n  \"name\": \"Deploy-Diagnostics-WVDAppGroup\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated]: Deploy Diagnostic Settings for AVD Application group to Log Analytics workspace\",\n    \"description\": \"Deploys the diagnostic settings for AVD Application group to stream to a Log Analytics workspace when any application group which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"version\": \"1.1.1-deprecated\",\n      \"category\": \"Monitoring\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"logAnalytics\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Log Analytics workspace\",\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\n          \"strongType\": \"omsWorkspace\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"profileName\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"setbypolicy\",\n        \"metadata\": {\n          \"displayName\": \"Profile name\",\n          \"description\": \"The diagnostic settings profile name\"\n        }\n      },\n      \"logsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable logs\",\n          \"description\": \"Whether to enable logs stream to the Log Analytics workspace - True or False\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.DesktopVirtualization/applicationGroups\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\n          \"name\": \"[[parameters('profileName')]\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/workspaceId\",\n                \"equals\": \"[[parameters('logAnalytics')]\"\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logAnalytics\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"profileName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logsEnabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.DesktopVirtualization/applicationGroups/providers/diagnosticSettings\",\n                    \"apiVersion\": \"2017-05-01-preview\",\n                    \"name\": \"[[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"dependsOn\": [],\n                    \"properties\": {\n                      \"workspaceId\": \"[[parameters('logAnalytics')]\",\n                      \"logs\": [\n                        {\n                          \"category\": \"Checkpoint\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"Error\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"Management\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        }\n                      ]\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"logAnalytics\": {\n                  \"value\": \"[[parameters('logAnalytics')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"profileName\": {\n                  \"value\": \"[[parameters('profileName')]\"\n                },\n                \"logsEnabled\": {\n                  \"value\": \"[[parameters('logsEnabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#89": "{\n  \"name\": \"Deploy-Diagnostics-WVDHostPools\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated]: Deploy Diagnostic Settings for AVD Host Pools to Log Analytics workspace\",\n    \"description\": \"Deploys the diagnostic settings for AVD Host Pools to stream to a Log Analytics workspace when any Host Pools which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"version\": \"1.3.0-deprecated\",\n      \"category\": \"Monitoring\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"logAnalytics\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Log Analytics workspace\",\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\n          \"strongType\": \"omsWorkspace\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"profileName\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"setbypolicy\",\n        \"metadata\": {\n          \"displayName\": \"Profile name\",\n          \"description\": \"The diagnostic settings profile name\"\n        }\n      },\n      \"logsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable logs\",\n          \"description\": \"Whether to enable logs stream to the Log Analytics workspace - True or False\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.DesktopVirtualization/hostpools\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\n          \"name\": \"[[parameters('profileName')]\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/workspaceId\",\n                \"equals\": \"[[parameters('logAnalytics')]\"\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logAnalytics\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"profileName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logsEnabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.DesktopVirtualization/hostpools/providers/diagnosticSettings\",\n                    \"apiVersion\": \"2017-05-01-preview\",\n                    \"name\": \"[[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"dependsOn\": [],\n                    \"properties\": {\n                      \"workspaceId\": \"[[parameters('logAnalytics')]\",\n                      \"logs\": [\n                        {\n                          \"category\": \"Checkpoint\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"Error\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"Management\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"Connection\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"HostRegistration\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"AgentHealthStatus\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"NetworkData\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"SessionHostManagement\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"ConnectionGraphicsData\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        }\n                      ]\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"logAnalytics\": {\n                  \"value\": \"[[parameters('logAnalytics')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"profileName\": {\n                  \"value\": \"[[parameters('profileName')]\"\n                },\n                \"logsEnabled\": {\n                  \"value\": \"[[parameters('logsEnabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#9": "{\n  \"name\": \"Deny-AppGW-Without-WAF\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"Application Gateway should be deployed with WAF enabled\",\n    \"description\": \"This policy enables you to restrict that Application Gateways is always deployed with WAF enabled\",\n    \"metadata\": {\n      \"version\": \"1.0.0\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"allowedValues\": [\n          \"Audit\",\n          \"Deny\",\n          \"Disabled\"\n        ],\n        \"defaultValue\": \"Deny\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/applicationGateways\"\n          },\n          {\n            \"field\": \"Microsoft.Network/applicationGateways/sku.name\",\n            \"notequals\": \"WAF_v2\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\"\n      }\n    }\n  }\n}\n",
    "$fxv#90": "{\n  \"name\": \"Deploy-Diagnostics-WVDWorkspace\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated]: Deploy Diagnostic Settings for AVD Workspace to Log Analytics workspace\",\n    \"description\": \"Deploys the diagnostic settings for AVD Workspace to stream to a Log Analytics workspace when any Workspace which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"version\": \"1.1.1-deprecated\",\n      \"category\": \"Monitoring\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"logAnalytics\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Log Analytics workspace\",\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\n          \"strongType\": \"omsWorkspace\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"profileName\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"setbypolicy\",\n        \"metadata\": {\n          \"displayName\": \"Profile name\",\n          \"description\": \"The diagnostic settings profile name\"\n        }\n      },\n      \"logsEnabled\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"True\",\n        \"allowedValues\": [\n          \"True\",\n          \"False\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Enable logs\",\n          \"description\": \"Whether to enable logs stream to the Log Analytics workspace - True or False\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.DesktopVirtualization/workspaces\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\n          \"name\": \"[[parameters('profileName')]\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/diagnosticSettings/workspaceId\",\n                \"equals\": \"[[parameters('logAnalytics')]\"\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logAnalytics\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"profileName\": {\n                    \"type\": \"String\"\n                  },\n                  \"logsEnabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.DesktopVirtualization/workspaces/providers/diagnosticSettings\",\n                    \"apiVersion\": \"2017-05-01-preview\",\n                    \"name\": \"[[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"dependsOn\": [],\n                    \"properties\": {\n                      \"workspaceId\": \"[[parameters('logAnalytics')]\",\n                      \"logs\": [\n                        {\n                          \"category\": \"Checkpoint\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"Error\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"Management\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        },\n                        {\n                          \"category\": \"Feed\",\n                          \"enabled\": \"[[parameters('logsEnabled')]\"\n                        }\n                      ]\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"logAnalytics\": {\n                  \"value\": \"[[parameters('logAnalytics')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"profileName\": {\n                  \"value\": \"[[parameters('profileName')]\"\n                },\n                \"logsEnabled\": {\n                  \"value\": \"[[parameters('logsEnabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#91": "{\n  \"name\": \"Deploy-FirewallPolicy\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Azure Firewall Manager policy in the subscription\",\n    \"description\": \"Deploys Azure Firewall Manager policy in subscription where the policy is assigned.\",\n    \"metadata\": {\n      \"version\": \"1.0.0\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"fwpolicy\": {\n        \"type\": \"Object\",\n        \"metadata\": {\n          \"displayName\": \"fwpolicy\",\n          \"description\": \"Object describing Azure Firewall Policy\"\n        },\n        \"defaultValue\": {}\n      },\n      \"fwPolicyRegion\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"fwPolicyRegion\",\n          \"description\": \"Select Azure region for Azure Firewall Policy\",\n          \"strongType\": \"location\"\n        }\n      },\n      \"rgName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"rgName\",\n          \"description\": \"Provide name for resource group.\"\n        }\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Resources/subscriptions\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Network/firewallPolicies\",\n          \"deploymentScope\": \"subscription\",\n          \"existenceScope\": \"resourceGroup\",\n          \"resourceGroupName\": \"[[parameters('rgName')]\",\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"deployment\": {\n            \"location\": \"northeurope\",\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"parameters\": {\n                \"rgName\": {\n                  \"value\": \"[[parameters('rgName')]\"\n                },\n                \"fwPolicy\": {\n                  \"value\": \"[[parameters('fwPolicy')]\"\n                },\n                \"fwPolicyRegion\": {\n                  \"value\": \"[[parameters('fwPolicyRegion')]\"\n                }\n              },\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"rgName\": {\n                    \"type\": \"String\"\n                  },\n                  \"fwPolicy\": {\n                    \"type\": \"object\"\n                  },\n                  \"fwPolicyRegion\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\n                    \"apiVersion\": \"2018-05-01\",\n                    \"name\": \"[[parameters('rgName')]\",\n                    \"location\": \"[[deployment().location]\",\n                    \"properties\": {}\n                  },\n                  {\n                    \"type\": \"Microsoft.Resources/deployments\",\n                    \"apiVersion\": \"2018-05-01\",\n                    \"name\": \"fwpolicies\",\n                    \"resourceGroup\": \"[[parameters('rgName')]\",\n                    \"dependsOn\": [\n                      \"[[resourceId('Microsoft.Resources/resourceGroups/', parameters('rgName'))]\"\n                    ],\n                    \"properties\": {\n                      \"mode\": \"Incremental\",\n                      \"template\": {\n                        \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json\",\n                        \"contentVersion\": \"1.0.0.0\",\n                        \"parameters\": {},\n                        \"variables\": {},\n                        \"resources\": [\n                          {\n                            \"type\": \"Microsoft.Network/firewallPolicies\",\n                            \"apiVersion\": \"2019-09-01\",\n                            \"name\": \"[[parameters('fwpolicy').firewallPolicyName]\",\n                            \"location\": \"[[parameters('fwpolicy').location]\",\n                            \"dependsOn\": [],\n                            \"tags\": {},\n                            \"properties\": {},\n                            \"resources\": [\n                              {\n                                \"type\": \"ruleGroups\",\n                                \"apiVersion\": \"2019-09-01\",\n                                \"name\": \"[[parameters('fwpolicy').ruleGroups.name]\",\n                                \"dependsOn\": [\n                                  \"[[resourceId('Microsoft.Network/firewallPolicies',parameters('fwpolicy').firewallPolicyName)]\"\n                                ],\n                                \"properties\": {\n                                  \"priority\": \"[[parameters('fwpolicy').ruleGroups.properties.priority]\",\n                                  \"rules\": \"[[parameters('fwpolicy').ruleGroups.properties.rules]\"\n                                }\n                              }\n                            ]\n                          }\n                        ],\n                        \"outputs\": {}\n                      }\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#92": "{\n  \"name\": \"Deploy-MySQL-sslEnforcement\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"Azure Database for MySQL server deploy a specific min TLS version and enforce SSL.\",\n    \"description\": \"Deploy a specific min TLS version requirement and enforce SSL on Azure Database for MySQL server. Enforce the Server to client applications using minimum version of Tls to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.\",\n    \"metadata\": {\n      \"version\": \"1.1.0\",\n      \"category\": \"SQL\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect minimum TLS version Azure Database for MySQL server\",\n          \"description\": \"Enable or disable the execution of the policy minimum TLS version Azure Database for MySQL server\"\n        }\n      },\n      \"minimalTlsVersion\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"TLS1_2\",\n        \"allowedValues\": [\n          \"TLS1_2\",\n          \"TLS1_0\",\n          \"TLS1_1\",\n          \"TLSEnforcementDisabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Select version minimum TLS for MySQL server\",\n          \"description\": \"Select version  minimum TLS version Azure Database for MySQL server to enforce\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.DBforMySQL/servers\"\n          },\n          {\n            \"anyOf\": [\n              {\n                \"field\": \"Microsoft.DBforMySQL/servers/sslEnforcement\",\n                \"notEquals\": \"Enabled\"\n              },\n              {\n                \"field\": \"Microsoft.DBforMySQL/servers/minimalTlsVersion\",\n                \"notequals\": \"[[parameters('minimalTlsVersion')]\"\n              }\n            ]\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.DBforMySQL/servers\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.DBforMySQL/servers/sslEnforcement\",\n                \"equals\": \"Enabled\"\n              },\n              {\n                \"field\": \"Microsoft.DBforMySQL/servers/minimalTlsVersion\",\n                \"equals\": \"[[parameters('minimalTlsVersion')]\"\n              }\n            ]\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"minimalTlsVersion\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.DBforMySQL/servers\",\n                    \"apiVersion\": \"2017-12-01\",\n                    \"name\": \"[[concat(parameters('resourceName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"properties\": {\n                      \"sslEnforcement\": \"[[if(equals(parameters('minimalTlsVersion'), 'TLSEnforcementDisabled'),'Disabled', 'Enabled')]\",\n                      \"minimalTlsVersion\": \"[[parameters('minimalTlsVersion')]\"\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"minimalTlsVersion\": {\n                  \"value\": \"[[parameters('minimalTlsVersion')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#93": "{\n  \"name\": \"Deploy-Nsg-FlowLogs-to-LA\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated] Deploys NSG flow logs and traffic analytics to Log Analytics\",\n    \"description\": \"[Deprecated] Deprecated by built-in policy. Deploys NSG flow logs and traffic analytics to Log Analytics with a specified retention period. Superseded by https://www.azadvertizer.net/azpolicyadvertizer/e920df7f-9a64-4066-9b58-52684c02a091.html\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"supersededBy\": \"e920df7f-9a64-4066-9b58-52684c02a091\",\n      \"version\": \"1.1.0-deprecated\",\n      \"category\": \"Monitoring\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"retention\": {\n        \"type\": \"Integer\",\n        \"metadata\": {\n          \"displayName\": \"Retention\"\n        },\n        \"defaultValue\": 5\n      },\n      \"interval\": {\n        \"type\": \"Integer\",\n        \"metadata\": {\n          \"displayName\": \"Traffic Analytics processing interval mins (10/60)\"\n        },\n        \"defaultValue\": 60\n      },\n      \"workspace\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"strongType\": \"omsWorkspace\",\n          \"displayName\": \"Resource ID of Log Analytics workspace\",\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\"\n        },\n        \"defaultValue\": \"<workspace resource ID>\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/networkSecurityGroups\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Network/networkWatchers/flowlogs\",\n          \"name\": \"[[if(empty(coalesce(field('Microsoft.Network/networkSecurityGroups/flowLogs[*].id'))), 'null/null', concat(split(first(field('Microsoft.Network/networkSecurityGroups/flowLogs[*].id')), '/')[8], '/', split(first(field('Microsoft.Network/networkSecurityGroups/flowLogs[*].id')), '/')[10]))]\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Network/networkWatchers/flowLogs/enabled\",\n                \"equals\": \"true\"\n              }\n            ]\n          },\n          \"existenceScope\": \"resourceGroup\",\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\",\n            \"/providers/Microsoft.Authorization/roleDefinitions/81a9662b-bebf-436f-a333-f67b29880f12\",\n            \"/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\",\n            \"/providers/Microsoft.Authorization/roleDefinitions/17d1049b-9a84-46fb-8f53-869881c3d3ab\",\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"resourceGroupName\": \"[[if(empty(coalesce(field('Microsoft.Network/networkSecurityGroups/flowLogs'))), 'NetworkWatcherRG', split(first(field('Microsoft.Network/networkSecurityGroups/flowLogs[*].id')), '/')[4])]\",\n          \"deploymentScope\": \"subscription\",\n          \"deployment\": {\n            \"location\": \"northeurope\",\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"parameters\": {\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"networkSecurityGroup\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"workspace\": {\n                  \"value\": \"[[parameters('workspace')]\"\n                },\n                \"retention\": {\n                  \"value\": \"[[parameters('retention')]\"\n                },\n                \"interval\": {\n                  \"value\": \"[[parameters('interval')]\"\n                }\n              },\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"networkSecurityGroup\": {\n                    \"type\": \"String\"\n                  },\n                  \"workspace\": {\n                    \"type\": \"String\"\n                  },\n                  \"retention\": {\n                    \"type\": \"int\"\n                  },\n                  \"interval\": {\n                    \"type\": \"int\"\n                  },\n                  \"time\": {\n                    \"type\": \"String\",\n                    \"defaultValue\": \"[[utcNow()]\"\n                  }\n                },\n                \"variables\": {\n                  \"resourceGroupName\": \"[[split(parameters('networkSecurityGroup'), '/')[4]]\",\n                  \"securityGroupName\": \"[[split(parameters('networkSecurityGroup'), '/')[8]]\",\n                  \"storageAccountName\": \"[[concat('es', uniqueString(variables('securityGroupName'), parameters('time')))]\"\n                },\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Resources/deployments\",\n                    \"apiVersion\": \"2019-10-01\",\n                    \"name\": \"[[concat(variables('resourceGroupName'), '.', variables('securityGroupName'))]\",\n                    \"resourceGroup\": \"[[variables('resourceGroupName')]\",\n                    \"properties\": {\n                      \"mode\": \"Incremental\",\n                      \"template\": {\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n                        \"contentVersion\": \"1.0.0.0\",\n                        \"resources\": [\n                          {\n                            \"type\": \"Microsoft.Storage/storageAccounts\",\n                            \"apiVersion\": \"2019-06-01\",\n                            \"name\": \"[[variables('storageAccountName')]\",\n                            \"location\": \"[[parameters('location')]\",\n                            \"properties\": {},\n                            \"kind\": \"StorageV2\",\n                            \"sku\": {\n                              \"name\": \"Standard_LRS\",\n                              \"tier\": \"Standard\"\n                            }\n                          }\n                        ]\n                      }\n                    }\n                  },\n                  {\n                    \"type\": \"Microsoft.Resources/deployments\",\n                    \"apiVersion\": \"2019-10-01\",\n                    \"name\": \"[[concat('NetworkWatcherRG', '.', variables('securityGroupName'))]\",\n                    \"resourceGroup\": \"NetworkWatcherRG\",\n                    \"properties\": {\n                      \"mode\": \"Incremental\",\n                      \"template\": {\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n                        \"contentVersion\": \"1.0.0.0\",\n                        \"resources\": [\n                          {\n                            \"type\": \"Microsoft.Network/networkWatchers\",\n                            \"apiVersion\": \"2020-05-01\",\n                            \"name\": \"[[concat('NetworkWatcher_', toLower(parameters('location')))]\",\n                            \"location\": \"[[parameters('location')]\",\n                            \"properties\": {},\n                            \"resources\": [\n                              {\n                                \"type\": \"flowLogs\",\n                                \"apiVersion\": \"2019-11-01\",\n                                \"name\": \"[[concat(variables('securityGroupName'), '-Network-flowlog')]\",\n                                \"location\": \"[[parameters('location')]\",\n                                \"properties\": {\n                                  \"enabled\": true,\n                                  \"format\": {\n                                    \"type\": \"JSON\",\n                                    \"version\": 2\n                                  },\n                                  \"retentionPolicy\": {\n                                    \"days\": \"[[parameters('retention')]\",\n                                    \"enabled\": true\n                                  },\n                                  \"flowAnalyticsConfiguration\": {\n                                    \"networkWatcherFlowAnalyticsConfiguration\": {\n                                      \"enabled\": true,\n                                      \"trafficAnalyticsInterval\": \"[[parameters('interval')]\",\n                                      \"workspaceResourceId\": \"[[parameters('workspace')]\"\n                                    }\n                                  },\n                                  \"storageId\": \"[[concat(subscription().id, '/resourceGroups/', variables('resourceGroupName'), '/providers/Microsoft.Storage/storageAccounts/', variables('storageAccountName'))]\",\n                                  \"targetResourceId\": \"[[parameters('networkSecurityGroup')]\"\n                                },\n                                \"dependsOn\": [\n                                  \"[[concat('NetworkWatcher_', toLower(parameters('location')))]\"\n                                ]\n                              }\n                            ]\n                          }\n                        ]\n                      }\n                    },\n                    \"dependsOn\": [\n                      \"[[concat(variables('resourceGroupName'), '.', variables('securityGroupName'))]\"\n                    ]\n                  }\n                ],\n                \"outputs\": {}\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#94": "{\n  \"name\": \"Deploy-Nsg-FlowLogs\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated] Deploys NSG flow logs and traffic analytics\",\n    \"description\": \"[Deprecated] Deprecated by built-in policy. Deploys NSG flow logs and traffic analytics to a storageaccountid with a specified retention period. Superseded by https://www.azadvertizer.net/azpolicyadvertizer/e920df7f-9a64-4066-9b58-52684c02a091.html\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"supersededBy\": \"e920df7f-9a64-4066-9b58-52684c02a091\",\n      \"version\": \"1.0.0-deprecated\",\n      \"category\": \"Monitoring\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"retention\": {\n        \"type\": \"Integer\",\n        \"metadata\": {\n          \"displayName\": \"Retention\"\n        },\n        \"defaultValue\": 5\n      },\n      \"storageAccountResourceId\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Storage Account Resource Id\",\n          \"strongType\": \"Microsoft.Storage/storageAccounts\"\n        }\n      },\n      \"trafficAnalyticsInterval\": {\n        \"type\": \"Integer\",\n        \"metadata\": {\n          \"displayName\": \"Traffic Analytics processing interval mins (10/60)\"\n        },\n        \"defaultValue\": 60\n      },\n      \"flowAnalyticsEnabled\": {\n        \"type\": \"Boolean\",\n        \"metadata\": {\n          \"displayName\": \"Enable Traffic Analytics\"\n        },\n        \"defaultValue\": false\n      },\n      \"logAnalytics\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"strongType\": \"omsWorkspace\",\n          \"displayName\": \"Resource ID of Log Analytics workspace\",\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\"\n        },\n        \"defaultValue\": \"\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.Network/networkSecurityGroups\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Network/networkWatchers/flowLogs\",\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\n          ],\n          \"resourceGroupName\": \"NetworkWatcherRG\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Network/networkWatchers/flowLogs/enabled\",\n                \"equals\": \"true\"\n              },\n              {\n                \"field\": \"Microsoft.Network/networkWatchers/flowLogs/flowAnalyticsConfiguration.networkWatcherFlowAnalyticsConfiguration.enabled\",\n                \"equals\": \"[[parameters('flowAnalyticsEnabled')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"parameters\": {\n                \"networkSecurityGroupName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceGroupName\": {\n                  \"value\": \"[[resourceGroup().name]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"storageAccountResourceId\": {\n                  \"value\": \"[[parameters('storageAccountResourceId')]\"\n                },\n                \"retention\": {\n                  \"value\": \"[[parameters('retention')]\"\n                },\n                \"flowAnalyticsEnabled\": {\n                  \"value\": \"[[parameters('flowAnalyticsEnabled')]\"\n                },\n                \"trafficAnalyticsInterval\": {\n                  \"value\": \"[[parameters('trafficAnalyticsInterval')]\"\n                },\n                \"logAnalytics\": {\n                  \"value\": \"[[parameters('logAnalytics')]\"\n                }\n              },\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"networkSecurityGroupName\": {\n                    \"type\": \"String\"\n                  },\n                  \"resourceGroupName\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"storageAccountResourceId\": {\n                    \"type\": \"String\"\n                  },\n                  \"retention\": {\n                    \"type\": \"int\"\n                  },\n                  \"flowAnalyticsEnabled\": {\n                    \"type\": \"bool\"\n                  },\n                  \"trafficAnalyticsInterval\": {\n                    \"type\": \"int\"\n                  },\n                  \"logAnalytics\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Network/networkWatchers/flowLogs\",\n                    \"apiVersion\": \"2020-05-01\",\n                    \"name\": \"[[take(concat('NetworkWatcher_', toLower(parameters('location')),  '/', parameters('networkSecurityGroupName'), '-', parameters('resourceGroupName'), '-flowlog' ), 80)]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"properties\": {\n                      \"targetResourceId\": \"[[resourceId(parameters('resourceGroupName'), 'Microsoft.Network/networkSecurityGroups', parameters('networkSecurityGroupName'))]\",\n                      \"storageId\": \"[[parameters('storageAccountResourceId')]\",\n                      \"enabled\": true,\n                      \"retentionPolicy\": {\n                        \"enabled\": true,\n                        \"days\": \"[[parameters('retention')]\"\n                      },\n                      \"format\": {\n                        \"type\": \"JSON\",\n                        \"version\": 2\n                      },\n                      \"flowAnalyticsConfiguration\": {\n                        \"networkWatcherFlowAnalyticsConfiguration\": {\n                          \"enabled\": \"[[bool(parameters('flowAnalyticsEnabled'))]\",\n                          \"trafficAnalyticsInterval\": \"[[parameters('trafficAnalyticsInterval')]\",\n                          \"workspaceId\": \"[[if(not(empty(parameters('logAnalytics'))), reference(parameters('logAnalytics'), '2020-03-01-preview', 'Full').properties.customerId, json('null')) ]\",\n                          \"workspaceRegion\": \"[[if(not(empty(parameters('logAnalytics'))), reference(parameters('logAnalytics'), '2020-03-01-preview', 'Full').location, json('null')) ]\",\n                          \"workspaceResourceId\": \"[[if(not(empty(parameters('logAnalytics'))), parameters('logAnalytics'), json('null'))]\"\n                        }\n                      }\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#95": "{\n  \"name\": \"Deploy-PostgreSQL-sslEnforcement\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"Azure Database for PostgreSQL server deploy a specific min TLS version requirement and enforce SSL \",\n    \"description\": \"Deploy a specific min TLS version requirement and enforce SSL on Azure Database for PostgreSQL server. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.\",\n    \"metadata\": {\n      \"version\": \"1.1.0\",\n      \"category\": \"SQL\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect Azure Database for PostgreSQL server\",\n          \"description\": \"Enable or disable the execution of the policy minimum TLS version Azure Database for PostgreSQL server\"\n        }\n      },\n      \"minimalTlsVersion\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"TLS1_2\",\n        \"allowedValues\": [\n          \"TLS1_2\",\n          \"TLS1_0\",\n          \"TLS1_1\",\n          \"TLSEnforcementDisabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Select version for PostgreSQL server\",\n          \"description\": \"Select version minimum TLS version Azure Database for PostgreSQL server to enforce\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.DBforPostgreSQL/servers\"\n          },\n          {\n            \"anyOf\": [\n              {\n                \"field\": \"Microsoft.DBforPostgreSQL/servers/sslEnforcement\",\n                \"notEquals\": \"Enabled\"\n              },\n              {\n                \"field\": \"Microsoft.DBforPostgreSQL/servers/minimalTlsVersion\",\n                \"notEquals\": \"[[parameters('minimalTlsVersion')]\"\n              }\n            ]\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.DBforPostgreSQL/servers\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.DBforPostgreSQL/servers/sslEnforcement\",\n                \"equals\": \"Enabled\"\n              },\n              {\n                \"field\": \"Microsoft.DBforPostgreSQL/servers/minimalTlsVersion\",\n                \"equals\": \"[[parameters('minimalTlsVersion')]\"\n              }\n            ]\n          },\n          \"name\": \"current\",\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"minimalTlsVersion\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.DBforPostgreSQL/servers\",\n                    \"apiVersion\": \"2017-12-01\",\n                    \"name\": \"[[concat(parameters('resourceName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"properties\": {\n                      \"sslEnforcement\": \"[[if(equals(parameters('minimalTlsVersion'), 'TLSEnforcementDisabled'),'Disabled', 'Enabled')]\",\n                      \"minimalTlsVersion\": \"[[parameters('minimalTlsVersion')]\"\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"minimalTlsVersion\": {\n                  \"value\": \"[[parameters('minimalTlsVersion')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#96": "{\n  \"name\": \"Deploy-Sql-AuditingSettings\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"Deploy SQL database auditing settings\",\n    \"description\": \"Deploy auditing settings to SQL Database when it not exist in the deployment\",\n    \"metadata\": {\n      \"version\": \"1.0.0\",\n      \"category\": \"SQL\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.Sql/servers/databases\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Sql/servers/databases/auditingSettings\",\n          \"name\": \"default\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Sql/servers/databases/auditingSettings/state\",\n                \"equals\": \"enabled\"\n              },\n              {\n                \"field\": \"Microsoft.Sql/servers/databases/auditingSettings/isAzureMonitorTargetEnabled\",\n                \"equals\": \"true\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"sqlServerName\": {\n                    \"type\": \"String\"\n                  },\n                  \"sqlServerDataBaseName\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"name\": \"[[concat( parameters('sqlServerName'),'/',parameters('sqlServerDataBaseName'),'/default')]\",\n                    \"type\": \"Microsoft.Sql/servers/databases/auditingSettings\",\n                    \"apiVersion\": \"2017-03-01-preview\",\n                    \"properties\": {\n                      \"state\": \"enabled\",\n                      \"auditActionsAndGroups\": [\n                        \"BATCH_COMPLETED_GROUP\",\n                        \"DATABASE_OBJECT_CHANGE_GROUP\",\n                        \"SCHEMA_OBJECT_CHANGE_GROUP\",\n                        \"BACKUP_RESTORE_GROUP\",\n                        \"APPLICATION_ROLE_CHANGE_PASSWORD_GROUP\",\n                        \"DATABASE_PRINCIPAL_CHANGE_GROUP\",\n                        \"DATABASE_PRINCIPAL_IMPERSONATION_GROUP\",\n                        \"DATABASE_ROLE_MEMBER_CHANGE_GROUP\",\n                        \"USER_CHANGE_PASSWORD_GROUP\",\n                        \"DATABASE_OBJECT_OWNERSHIP_CHANGE_GROUP\",\n                        \"DATABASE_OBJECT_PERMISSION_CHANGE_GROUP\",\n                        \"DATABASE_PERMISSION_CHANGE_GROUP\",\n                        \"SCHEMA_OBJECT_PERMISSION_CHANGE_GROUP\",\n                        \"SUCCESSFUL_DATABASE_AUTHENTICATION_GROUP\",\n                        \"FAILED_DATABASE_AUTHENTICATION_GROUP\"\n                      ],\n                      \"isAzureMonitorTargetEnabled\": true\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"sqlServerName\": {\n                  \"value\": \"[[first(split(field('fullname'),'/'))]\"\n                },\n                \"sqlServerDataBaseName\": {\n                  \"value\": \"[[field('name')]\"\n                }\n              }\n            }\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3\"\n          ]\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#97": "{\n  \"name\": \"Deploy-SQL-minTLS\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"SQL servers deploys a specific min TLS version requirement.\",\n    \"description\": \"Deploys a specific min TLS version requirement and enforce SSL on SQL servers. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.\",\n    \"metadata\": {\n      \"version\": \"1.1.0\",\n      \"category\": \"SQL\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect SQL servers\",\n          \"description\": \"Enable or disable the execution of the policy minimum TLS version SQL servers\"\n        }\n      },\n      \"minimalTlsVersion\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"1.2\",\n        \"allowedValues\": [\n          \"1.2\",\n          \"1.1\",\n          \"1.0\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Select version for SQL server\",\n          \"description\": \"Select version minimum TLS version SQL servers to enforce\"\n        }\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Sql/servers\"\n          },\n          {\n            \"field\": \"Microsoft.Sql/servers/minimalTlsVersion\",\n            \"notequals\": \"[[parameters('minimalTlsVersion')]\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Sql/servers\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Sql/servers/minimalTlsVersion\",\n                \"equals\": \"[[parameters('minimalTlsVersion')]\"\n              }\n            ]\n          },\n          \"name\": \"current\",\n          \"roleDefinitionIds\": [\n            \"/providers/microsoft.authorization/roleDefinitions/6d8ee4ec-f05a-4a1d-8b00-a9b17e38b437\"\n          ],\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\"\n                  },\n                  \"minimalTlsVersion\": {\n                    \"type\": \"String\"\n                  },\n                  \"location\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Sql/servers\",\n                    \"apiVersion\": \"2019-06-01-preview\",\n                    \"name\": \"[[concat(parameters('resourceName'))]\",\n                    \"location\": \"[[parameters('location')]\",\n                    \"properties\": {\n                      \"minimalTlsVersion\": \"[[parameters('minimalTlsVersion')]\"\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"minimalTlsVersion\": {\n                  \"value\": \"[[parameters('minimalTlsVersion')]\"\n                },\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#98": "{\n  \"name\": \"Deploy-Sql-SecurityAlertPolicies\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"Deploy SQL Database security Alert Policies configuration with email admin accounts\",\n    \"description\": \"Deploy the security Alert Policies configuration with email admin accounts when it not exist in current configuration\",\n    \"metadata\": {\n      \"version\": \"1.1.1\",\n      \"category\": \"SQL\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"emailAddresses\":{\n        \"type\":\"Array\",\n        \"defaultValue\":[\n          \"admin@contoso.com\",\n          \"admin@fabrikam.com\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"field\": \"type\",\n        \"equals\": \"Microsoft.Sql/servers/databases\"\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Sql/servers/databases/securityAlertPolicies\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Sql/servers/databases/securityAlertPolicies/state\",\n                \"equals\": \"Enabled\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"sqlServerName\": {\n                    \"type\": \"String\"\n                  },\n                  \"sqlServerDataBaseName\": {\n                    \"type\": \"String\"\n                  },\n                  \"emailAddresses\": {\n                    \"type\": \"Array\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"name\": \"[[concat(parameters('sqlServerName'),'/',parameters('sqlServerDataBaseName'),'/default')]\",\n                    \"type\": \"Microsoft.Sql/servers/databases/securityAlertPolicies\",\n                    \"apiVersion\": \"2018-06-01-preview\",\n                    \"properties\": {\n                      \"state\": \"Enabled\",\n                      \"disabledAlerts\": [\n                        \"\"\n                      ],\n                      \"emailAddresses\": \"[[parameters('emailAddresses')]\",\n                      \"emailAccountAdmins\": true,\n                      \"storageEndpoint\": null,\n                      \"storageAccountAccessKey\": \"\",\n                      \"retentionDays\": 0\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"sqlServerName\": {\n                  \"value\": \"[[first(split(field('fullname'),'/'))]\"\n                },\n                \"sqlServerDataBaseName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"emailAddresses\":{\n                  \"value\": \"[[parameters('emailAddresses')]\"\n                }\n              }\n            }\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3\"\n          ]\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#99": "{\n  \"name\": \"Deploy-Sql-Tde\",\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"scope\": null,\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"Indexed\",\n    \"displayName\": \"[Deprecated] Deploy SQL Database Transparent Data Encryption\",\n    \"description\": \"Deploy the Transparent Data Encryption when it is not enabled in the deployment. Please use this policy instead https://www.azadvertizer.net/azpolicyadvertizer/86a912f6-9a06-4e26-b447-11b16ba8659f.html\",\n    \"metadata\": {\n      \"deprecated\": true,\n      \"supersededBy\": \"86a912f6-9a06-4e26-b447-11b16ba8659f\",\n      \"version\": \"1.1.1-deprecated\",\n      \"category\": \"SQL\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\",\n        \"AzureChinaCloud\",\n        \"AzureUSGovernment\"\n      ]\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"defaultValue\": \"DeployIfNotExists\",\n        \"allowedValues\": [\n          \"DeployIfNotExists\",\n          \"Disabled\"\n        ],\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Enable or disable the execution of the policy\"\n        }\n      },\n      \"excludedDatabases\": {\n        \"type\": \"Array\",\n        \"metadata\":{\n          \"displayName\": \"Excluded Databases\",\n          \"description\": \"Array of databases that are excluded from this policy\"\n        },\n        \"defaultValue\": [\n          \"master\",\n          \"model\",\n          \"tempdb\",\n          \"msdb\",\n          \"resource\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Sql/servers/databases\"\n          },\n          {\n            \"field\": \"name\",\n            \"notIn\": \"[[parameters('excludedDatabases')]\"\n\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"type\": \"Microsoft.Sql/servers/databases/transparentDataEncryption\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Sql/transparentDataEncryption.status\",\n                \"equals\": \"Enabled\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"Incremental\",\n              \"template\": {\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"location\": {\n                    \"type\": \"String\"\n                  },\n                  \"sqlServerName\": {\n                    \"type\": \"String\"\n                  },\n                  \"sqlServerDataBaseName\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"name\": \"[[concat( parameters('sqlServerName'),'/',parameters('sqlServerDataBaseName'),'/current')]\",\n                    \"type\": \"Microsoft.Sql/servers/databases/transparentDataEncryption\",\n                    \"apiVersion\": \"2014-04-01\",\n                    \"properties\": {\n                      \"status\": \"Enabled\"\n                    }\n                  }\n                ],\n                \"outputs\": {}\n              },\n              \"parameters\": {\n                \"location\": {\n                  \"value\": \"[[field('location')]\"\n                },\n                \"sqlServerName\": {\n                  \"value\": \"[[first(split(field('fullname'),'/'))]\"\n                },\n                \"sqlServerDataBaseName\": {\n                  \"value\": \"[[field('name')]\"\n                }\n              }\n            }\n          },\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3\"\n          ]\n        }\n      }\n    }\n  }\n}",
    "cloudEnv": "[environment().name]",
    "defaultDeploymentLocationByCloudType": {
      "AzureCloud": "northeurope",
      "AzureChinaCloud": "chinaeast2",
      "AzureUSGovernment": "usgovvirginia"
    },
    "templateVars": {
      "scope": "/providers/Microsoft.Management/managementGroups/contoso",
      "defaultDeploymentLocation": "\"location\": \"northeurope\"",
      "localizedDeploymentLocation": "[format('\"location\": \"{0}\"', variables('defaultDeploymentLocationByCloudType')[variables('cloudEnv')])]"
    },
    "targetDeploymentLocationByCloudType": {
      "AzureCloud": "[coalesce(parameters('location'), 'northeurope')]",
      "AzureChinaCloud": "[coalesce(parameters('location'), 'chinaeast2')]",
      "AzureUSGovernment": "[coalesce(parameters('location'), 'usgovvirginia')]"
    },
    "deploymentLocation": "[format('\"location\": \"{0}\"', variables('targetDeploymentLocationByCloudType')[variables('cloudEnv')])]",
    "loadPolicyDefinitions": {
      "All": [
        "[variables('$fxv#0')]",
        "[variables('$fxv#1')]",
        "[variables('$fxv#2')]",
        "[variables('$fxv#3')]",
        "[variables('$fxv#4')]",
        "[variables('$fxv#5')]",
        "[variables('$fxv#6')]",
        "[variables('$fxv#7')]",
        "[variables('$fxv#8')]",
        "[variables('$fxv#9')]",
        "[variables('$fxv#10')]",
        "[variables('$fxv#11')]",
        "[variables('$fxv#12')]",
        "[variables('$fxv#13')]",
        "[variables('$fxv#14')]",
        "[variables('$fxv#15')]",
        "[variables('$fxv#16')]",
        "[variables('$fxv#17')]",
        "[variables('$fxv#18')]",
        "[variables('$fxv#19')]",
        "[variables('$fxv#20')]",
        "[variables('$fxv#21')]",
        "[variables('$fxv#22')]",
        "[variables('$fxv#23')]",
        "[variables('$fxv#24')]",
        "[variables('$fxv#25')]",
        "[variables('$fxv#26')]",
        "[variables('$fxv#27')]",
        "[variables('$fxv#28')]",
        "[variables('$fxv#29')]",
        "[variables('$fxv#30')]",
        "[variables('$fxv#31')]",
        "[variables('$fxv#32')]",
        "[variables('$fxv#33')]",
        "[variables('$fxv#34')]",
        "[variables('$fxv#35')]",
        "[variables('$fxv#36')]",
        "[variables('$fxv#37')]",
        "[variables('$fxv#38')]",
        "[variables('$fxv#39')]",
        "[variables('$fxv#40')]",
        "[variables('$fxv#41')]",
        "[variables('$fxv#42')]",
        "[variables('$fxv#43')]",
        "[variables('$fxv#44')]",
        "[variables('$fxv#45')]",
        "[variables('$fxv#46')]",
        "[variables('$fxv#47')]",
        "[variables('$fxv#48')]",
        "[variables('$fxv#49')]",
        "[variables('$fxv#50')]",
        "[variables('$fxv#51')]",
        "[variables('$fxv#52')]",
        "[variables('$fxv#53')]",
        "[variables('$fxv#54')]",
        "[variables('$fxv#55')]",
        "[variables('$fxv#56')]",
        "[variables('$fxv#57')]",
        "[variables('$fxv#58')]",
        "[variables('$fxv#59')]",
        "[variables('$fxv#60')]",
        "[variables('$fxv#61')]",
        "[variables('$fxv#62')]",
        "[variables('$fxv#63')]",
        "[variables('$fxv#64')]",
        "[variables('$fxv#65')]",
        "[variables('$fxv#66')]",
        "[variables('$fxv#67')]",
        "[variables('$fxv#68')]",
        "[variables('$fxv#69')]",
        "[variables('$fxv#70')]",
        "[variables('$fxv#71')]",
        "[variables('$fxv#72')]",
        "[variables('$fxv#73')]",
        "[variables('$fxv#74')]",
        "[variables('$fxv#75')]",
        "[variables('$fxv#76')]",
        "[variables('$fxv#77')]",
        "[variables('$fxv#78')]",
        "[variables('$fxv#79')]",
        "[variables('$fxv#80')]",
        "[variables('$fxv#81')]",
        "[variables('$fxv#82')]",
        "[variables('$fxv#83')]",
        "[variables('$fxv#84')]",
        "[variables('$fxv#85')]",
        "[variables('$fxv#86')]",
        "[variables('$fxv#87')]",
        "[variables('$fxv#88')]",
        "[variables('$fxv#89')]",
        "[variables('$fxv#90')]",
        "[variables('$fxv#91')]",
        "[variables('$fxv#92')]",
        "[variables('$fxv#93')]",
        "[variables('$fxv#94')]",
        "[variables('$fxv#95')]",
        "[variables('$fxv#96')]",
        "[variables('$fxv#97')]",
        "[variables('$fxv#98')]",
        "[variables('$fxv#99')]",
        "[variables('$fxv#100')]",
        "[variables('$fxv#101')]",
        "[variables('$fxv#102')]",
        "[variables('$fxv#103')]",
        "[variables('$fxv#104')]",
        "[variables('$fxv#105')]",
        "[variables('$fxv#106')]",
        "[variables('$fxv#107')]",
        "[variables('$fxv#108')]",
        "[variables('$fxv#109')]",
        "[variables('$fxv#110')]",
        "[variables('$fxv#111')]",
        "[variables('$fxv#112')]",
        "[variables('$fxv#113')]",
        "[variables('$fxv#114')]",
        "[variables('$fxv#115')]",
        "[variables('$fxv#116')]",
        "[variables('$fxv#117')]",
        "[variables('$fxv#118')]",
        "[variables('$fxv#119')]",
        "[variables('$fxv#120')]",
        "[variables('$fxv#121')]",
        "[variables('$fxv#122')]",
        "[variables('$fxv#123')]",
        "[variables('$fxv#124')]",
        "[variables('$fxv#125')]",
        "[variables('$fxv#126')]",
        "[variables('$fxv#127')]",
        "[variables('$fxv#128')]",
        "[variables('$fxv#129')]",
        "[variables('$fxv#130')]",
        "[variables('$fxv#131')]",
        "[variables('$fxv#132')]",
        "[variables('$fxv#133')]",
        "[variables('$fxv#134')]",
        "[variables('$fxv#135')]",
        "[variables('$fxv#136')]",
        "[variables('$fxv#137')]",
        "[variables('$fxv#138')]",
        "[variables('$fxv#139')]",
        "[variables('$fxv#140')]",
        "[variables('$fxv#141')]",
        "[variables('$fxv#142')]"
      ],
      "AzureCloud": [
        "[variables('$fxv#143')]",
        "[variables('$fxv#144')]",
        "[variables('$fxv#145')]",
        "[variables('$fxv#146')]",
        "[variables('$fxv#147')]",
        "[variables('$fxv#148')]",
        "[variables('$fxv#149')]",
        "[variables('$fxv#150')]",
        "[variables('$fxv#151')]",
        "[variables('$fxv#152')]",
        "[variables('$fxv#153')]",
        "[variables('$fxv#154')]",
        "[variables('$fxv#155')]",
        "[variables('$fxv#156')]",
        "[variables('$fxv#157')]"
      ],
      "AzureChinaCloud": [
        "[variables('$fxv#158')]",
        "[variables('$fxv#159')]",
        "[variables('$fxv#160')]",
        "[variables('$fxv#161')]",
        "[variables('$fxv#162')]",
        "[variables('$fxv#163')]",
        "[variables('$fxv#164')]",
        "[variables('$fxv#165')]",
        "[variables('$fxv#166')]"
      ],
      "AzureUSGovernment": [
        "[variables('$fxv#167')]",
        "[variables('$fxv#168')]",
        "[variables('$fxv#169')]"
      ]
    },
    "policyDefinitionsByCloudType": {
      "All": "[variables('policyDefinitionsAll')]",
      "AzureCloud": "[variables('policyDefinitionsAzureCloud')]",
      "AzureChinaCloud": "[variables('policyDefinitionsAzureChinaCloud')]",
      "AzureUSGovernment": "[variables('policyDefinitionsAzureUSGovernment')]"
    },
    "policyDefinitions": "[concat(variables('policyDefinitionsByCloudType').All, variables('policyDefinitionsByCloudType')[variables('cloudEnv')])]"
  },
  "resources": [
    {
      "copy": {
        "name": "PolicyDefinitions",
        "count": "[length(variables('policyDefinitions'))]"
      },
      "type": "Microsoft.Authorization/policyDefinitions",
      "apiVersion": "2020-09-01",
      "name": "[variables('policyDefinitions')[copyIndex()].name]",
      "properties": {
        "description": "[variables('policyDefinitions')[copyIndex()].properties.description]",
        "displayName": "[variables('policyDefinitions')[copyIndex()].properties.displayName]",
        "metadata": "[variables('policyDefinitions')[copyIndex()].properties.metadata]",
        "mode": "[variables('policyDefinitions')[copyIndex()].properties.mode]",
        "parameters": "[variables('policyDefinitions')[copyIndex()].properties.parameters]",
        "policyType": "[variables('policyDefinitions')[copyIndex()].properties.policyType]",
        "policyRule": "[variables('policyDefinitions')[copyIndex()].properties.policyRule]"
      }
    }
  ],
  "outputs": {
    "policyDefinitionNames": {
      "type": "array",
      "copy": {
        "count": "[length(variables('policyDefinitions'))]",
        "input": "[variables('policyDefinitions')[copyIndex()].name]"
      }
    }
  }
}