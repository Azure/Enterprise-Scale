{
  "$schema": "https://schema.management.azure.com/schemas/2019-08-01/managementGroupDeploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "metadata": {
    "_generator": {
      "name": "bicep",
      "version": "0.18.4.5664",
      "templateHash": "13456983410606299220"
    }
  },
  "parameters": {
    "topLevelManagementGroupPrefix": {
      "type": "string",
      "defaultValue": "alz",
      "maxLength": 10,
      "metadata": {
        "description": "Provide a prefix (max 10 characters, unique at tenant-scope) for the Management Group hierarchy and other resources created as part of an Azure landing zone. DEFAULT VALUE = \"alz\"",
        "message": "The JSON version of this file is programatically generated from Bicep. PLEASE DO NOT UPDATE MANUALLY!!"
      }
    },
    "location": {
      "type": "string",
      "defaultValue": "[deployment().location]",
      "metadata": {
        "description": "Optionally set the deployment location for policies with Deploy If Not Exists effect. DEFAULT VALUE = \"deployment().location\""
      }
    },
    "scope": {
      "type": "string",
      "defaultValue": "[tenantResourceId('Microsoft.Management/managementGroups', parameters('topLevelManagementGroupPrefix'))]",
      "metadata": {
        "description": "Optionally set the scope for custom Policy Definitions used in Policy Set Definitions (Initiatives). Must be one of '/', '/subscriptions/id' or '/providers/Microsoft.Management/managementGroups/id'. DEFAULT VALUE = '/providers/Microsoft.Management/managementGroups/${topLevelManagementGroupPrefix}'"
      }
    }
  },
  "variables": {
    "copy": [
      {
        "name": "processPolicyDefinitionsAll",
        "count": "[length(variables('loadPolicyDefinitions').All)]",
        "input": "[replace(replace(variables('loadPolicyDefinitions').All[copyIndex('processPolicyDefinitionsAll')], variables('templateVars').defaultDeploymentLocation, variables('deploymentLocation')), variables('templateVars').localizedDeploymentLocation, variables('deploymentLocation'))]"
      },
      {
        "name": "processPolicyDefinitionsAzureCloud",
        "count": "[length(variables('loadPolicyDefinitions').AzureCloud)]",
        "input": "[replace(replace(variables('loadPolicyDefinitions').AzureCloud[copyIndex('processPolicyDefinitionsAzureCloud')], variables('templateVars').defaultDeploymentLocation, variables('deploymentLocation')), variables('templateVars').localizedDeploymentLocation, variables('deploymentLocation'))]"
      },
      {
        "name": "processPolicyDefinitionsAzureChinaCloud",
        "count": "[length(variables('loadPolicyDefinitions').AzureChinaCloud)]",
        "input": "[replace(replace(variables('loadPolicyDefinitions').AzureChinaCloud[copyIndex('processPolicyDefinitionsAzureChinaCloud')], variables('templateVars').defaultDeploymentLocation, variables('deploymentLocation')), variables('templateVars').localizedDeploymentLocation, variables('deploymentLocation'))]"
      },
      {
        "name": "processPolicyDefinitionsAzureUSGovernment",
        "count": "[length(variables('loadPolicyDefinitions').AzureUSGovernment)]",
        "input": "[replace(replace(variables('loadPolicyDefinitions').AzureUSGovernment[copyIndex('processPolicyDefinitionsAzureUSGovernment')], variables('templateVars').defaultDeploymentLocation, variables('deploymentLocation')), variables('templateVars').localizedDeploymentLocation, variables('deploymentLocation'))]"
      },
      {
        "name": "processPolicySetDefinitionsAll",
        "count": "[length(variables('loadPolicySetDefinitions').All)]",
        "input": "[replace(variables('loadPolicySetDefinitions').All[copyIndex('processPolicySetDefinitionsAll')], variables('templateVars').scope, parameters('scope'))]"
      },
      {
        "name": "processPolicySetDefinitionsAzureCloud",
        "count": "[length(variables('loadPolicySetDefinitions').AzureCloud)]",
        "input": "[replace(variables('loadPolicySetDefinitions').AzureCloud[copyIndex('processPolicySetDefinitionsAzureCloud')], variables('templateVars').scope, parameters('scope'))]"
      },
      {
        "name": "processPolicySetDefinitionsAzureChinaCloud",
        "count": "[length(variables('loadPolicySetDefinitions').AzureChinaCloud)]",
        "input": "[replace(variables('loadPolicySetDefinitions').AzureChinaCloud[copyIndex('processPolicySetDefinitionsAzureChinaCloud')], variables('templateVars').scope, parameters('scope'))]"
      },
      {
        "name": "processPolicySetDefinitionsAzureUSGovernment",
        "count": "[length(variables('loadPolicySetDefinitions').AzureUSGovernment)]",
        "input": "[replace(variables('loadPolicySetDefinitions').AzureUSGovernment[copyIndex('processPolicySetDefinitionsAzureUSGovernment')], variables('templateVars').scope, parameters('scope'))]"
      },
      {
        "name": "policyDefinitionsAll",
        "count": "[length(variables('processPolicyDefinitionsAll'))]",
        "input": "[json(variables('processPolicyDefinitionsAll')[copyIndex('policyDefinitionsAll')])]"
      },
      {
        "name": "policyDefinitionsAzureCloud",
        "count": "[length(variables('processPolicyDefinitionsAzureCloud'))]",
        "input": "[json(variables('processPolicyDefinitionsAzureCloud')[copyIndex('policyDefinitionsAzureCloud')])]"
      },
      {
        "name": "policyDefinitionsAzureChinaCloud",
        "count": "[length(variables('processPolicyDefinitionsAzureChinaCloud'))]",
        "input": "[json(variables('processPolicyDefinitionsAzureChinaCloud')[copyIndex('policyDefinitionsAzureChinaCloud')])]"
      },
      {
        "name": "policyDefinitionsAzureUSGovernment",
        "count": "[length(variables('processPolicyDefinitionsAzureUSGovernment'))]",
        "input": "[json(variables('processPolicyDefinitionsAzureUSGovernment')[copyIndex('policyDefinitionsAzureUSGovernment')])]"
      },
      {
        "name": "policySetDefinitionsAll",
        "count": "[length(variables('processPolicySetDefinitionsAll'))]",
        "input": "[json(variables('processPolicySetDefinitionsAll')[copyIndex('policySetDefinitionsAll')])]"
      },
      {
        "name": "policySetDefinitionsAzureCloud",
        "count": "[length(variables('processPolicySetDefinitionsAzureCloud'))]",
        "input": "[json(variables('processPolicySetDefinitionsAzureCloud')[copyIndex('policySetDefinitionsAzureCloud')])]"
      },
      {
        "name": "policySetDefinitionsAzureChinaCloud",
        "count": "[length(variables('processPolicySetDefinitionsAzureChinaCloud'))]",
        "input": "[json(variables('processPolicySetDefinitionsAzureChinaCloud')[copyIndex('policySetDefinitionsAzureChinaCloud')])]"
      },
      {
        "name": "policySetDefinitionsAzureUSGovernment",
        "count": "[length(variables('processPolicySetDefinitionsAzureUSGovernment'))]",
        "input": "[json(variables('processPolicySetDefinitionsAzureUSGovernment')[copyIndex('policySetDefinitionsAzureUSGovernment')])]"
      }
    ],
    "$fxv#0": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_AA_TotalJob_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Automation Account TotalJob Alert\",\n    \"description\": \"Policy to audit/deploy Automation Account TotalJob Alert\",\n    \"metadata\": {\n      \"version\": \"1.0.1\",\n      \"category\": \"Automation\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_alz_monitor\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"2\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT1M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"0\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisable\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Tag name to disable monitoring on resource. Set to true if monitoring should be disabled\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Automation/automationAccounts\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\n            \"notEquals\": \"true\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Automation/automationAccounts\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"TotalJob\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Automation/automationAccounts/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-TotalJob')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_alz_monitor\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for Automation Account TotalJob Alert\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"TotalJob\",\n                            \"metricNamespace\": \"Microsoft.Automation/automationAccounts\",\n                            \"metricName\": \"TotalJob\",\n                            \"dimensions\": [\n                              {\n                                \"name\": \"Status\",\n                                \"operator\": \"Exclude\",\n                                \"values\": [\n                                  \"Completed\"\n                                ]\n                              }\n                            ],\n                            \"operator\": \"GreaterThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[parameters('threshold')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#1": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_activitylog_Firewall_Delete\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy Activity Log Azure FireWall Delete Alert\",\r\n    \"description\": \"Policy to Deploy Activity Log Azure Firewall Delete Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Network\",\r\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_alz_monitor\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"alertResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Name\",\r\n          \"description\": \"Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"AlzMonitoring-rg\"\r\n      },\r\n      \"alertResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Tags\",\r\n          \"description\": \"Tags on the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": {\r\n          \"environment\": \"test\",\r\n          \"_deployed_by_alz_monitor\": true\r\n        }\r\n      },\r\n      \"alertResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Location\",\r\n          \"description\": \"Location of the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"centralus\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring on resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/azureFirewalls\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/activityLogAlerts\",\r\n          \"name\": \"ActivityAzureFirewallDelete\",\r\n          \"existenceScope\": \"resourceGroup\",\r\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\r\n          \"deploymentScope\": \"subscription\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/ActivityLogAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              },\r\n              {\r\n                \"count\": {\r\n                  \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*]\",\r\n                  \"where\": {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].field\",\r\n                            \"equals\": \"category\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].equals\",\r\n                            \"equals\": \"Administrative\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].field\",\r\n                            \"equals\": \"operationName\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].equals\",\r\n                            \"equals\": \"Microsoft.Network/azureFirewalls/delete\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                },\r\n                \"equals\": 2\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"location\": \"[[deployment().location]\",\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"alertResourceGroupName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"alertResourceGroupTags\": {\r\n                    \"type\": \"object\"\r\n                  },\r\n                  \"alertResourceGroupLocation\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\r\n                    \"apiVersion\": \"2020-10-01\",\r\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\r\n                  },\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/deployments\",\r\n                    \"apiVersion\": \"2019-10-01\",\r\n                    \"name\": \"ActivityAzureFirewallDelete\",\r\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"dependsOn\": [\r\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\r\n                    ],\r\n                    \"properties\": {\r\n                      \"mode\": \"Incremental\",\r\n                      \"template\": {\r\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                        \"contentVersion\": \"1.0.0.0\",\r\n                        \"parameters\": {\r\n                          \"enabled\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupName\": {\r\n                            \"type\": \"string\"\r\n                          }\r\n                        },\r\n                        \"variables\": {},\r\n                        \"resources\": [\r\n                          {\r\n                            \"type\": \"microsoft.insights/activityLogAlerts\",\r\n                            \"apiVersion\": \"2020-10-01\",\r\n                            \"name\": \"ActivityAzureFirewallDelete\",\r\n                            \"location\": \"global\",\r\n                            \"tags\": {\r\n                              \"_deployed_by_alz_monitor\": true\r\n                            },\r\n                            \"properties\": {\r\n                              \"description\": \"Activity Log Firewall Delete\",\r\n                              \"enabled\": \"[[parameters('enabled')]\",\r\n                              \"scopes\": [\r\n                                \"[[subscription().id]\"\r\n                              ],\r\n                              \"condition\": {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"category\",\r\n                                    \"equals\": \"Administrative\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"operationName\",\r\n                                    \"equals\": \"Microsoft.Network/azurefirewalls/delete\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"status\",\r\n                                    \"containsAny\": [\r\n                                      \"succeeded\"\r\n                                    ]\r\n                                  }\r\n                                ]\r\n                              },\r\n                              \"parameters\": {\r\n                                \"enabled\": {\r\n                                  \"value\": \"[[parameters('enabled')]\"\r\n                                }\r\n                              }\r\n                            }\r\n                          }\r\n                        ]\r\n                      },\r\n                      \"parameters\": {\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"alertResourceGroupName\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"alertResourceGroupName\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                },\r\n                \"alertResourceGroupTags\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\r\n                },\r\n                \"alertResourceGroupLocation\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#10": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_activitylog_ServiceHealth_Maintenance\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy Service Health Maintenance Alert\",\r\n    \"description\": \"Policy to Deploy Service Health Maintenance Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.1.0\",\r\n      \"category\": \"Monitoring\",\r\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_alz_monitor\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"alertResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Name\",\r\n          \"description\": \"Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"AlzMonitoring-rg\"\r\n      },\r\n      \"alertResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Tags\",\r\n          \"description\": \"Tags on the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": {\r\n          \"environment\": \"test\",\r\n          \"_deployed_by_alz_monitor\": true\r\n        }\r\n      },\r\n      \"alertResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Location\",\r\n          \"description\": \"Location of the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"centralus\"\r\n      },\r\n      \"ALZMonitorActionGroupEmail\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Action Group Email\",\r\n          \"description\": \"Email address to send alerts to\"\r\n        },\r\n        \"defaultValue\": \"action@mail.com\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring  Subscription level alerts. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/activityLogAlerts\",\r\n          \"existenceScope\": \"resourcegroup\",\r\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\r\n          \"deploymentScope\": \"subscription\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/ActivityLogAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              },\r\n              {\r\n                \"count\": {\r\n                  \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*]\",\r\n                  \"where\": {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].field\",\r\n                            \"equals\": \"category\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].equals\",\r\n                            \"equals\": \"ServiceHealth\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"microsoft.insights/activityLogAlerts/condition.allOf[*].field\",\r\n                            \"equals\": \"properties.incidentType\"\r\n                          },\r\n                          {\r\n                            \"field\": \"microsoft.insights/activityLogAlerts/condition.allOf[*].equals\",\r\n                            \"equals\": \"Maintenance\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                },\r\n                \"equals\": 2\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"location\": \"[[deployment().location]\",\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"alertResourceGroupName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"alertResourceGroupTags\": {\r\n                    \"type\": \"object\"\r\n                  },\r\n                  \"alertResourceGroupLocation\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"ALZMonitorActionGroupEmail\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\r\n                    \"apiVersion\": \"2021-04-01\",\r\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\r\n                  },\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/deployments\",\r\n                    \"apiVersion\": \"2019-10-01\",\r\n                    \"name\": \"ServiceHealthMaintenance\",\r\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"dependsOn\": [\r\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\r\n                    ],\r\n                    \"properties\": {\r\n                      \"mode\": \"Incremental\",\r\n                      \"template\": {\r\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                        \"contentVersion\": \"1.0.0.0\",\r\n                        \"parameters\": {\r\n                          \"enabled\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupName\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"ALZMonitorActionGroupEmail\": {\r\n                            \"type\": \"string\"\r\n                          }\r\n                        },\r\n                        \"variables\": {},\r\n                        \"resources\": [\r\n                          {\r\n                            \"type\": \"microsoft.insights/activityLogAlerts\",\r\n                            \"apiVersion\": \"2020-10-01\",\r\n                            \"name\": \"ServiceHealthPlannedMaintenance\",\r\n                            \"location\": \"global\",\r\n                            \"dependsOn\": [\r\n                              \"[[concat(subscription().Id, '/resourceGroups/', parameters('alertResourceGroupName'), '/providers/Microsoft.Insights/actionGroups/AlzActionGrp')]\"\r\n                            ],\r\n                            \"tags\": {\r\n                              \"_deployed_by_alz_monitor\": true\r\n                            },\r\n                            \"properties\": {\r\n                              \"actions\": {\r\n                                \"actionGroups\": [\r\n                                  {\r\n                                    \"actionGroupId\": \"[[concat(subscription().Id, '/resourceGroups/', parameters('alertResourceGroupName'), '/providers/Microsoft.Insights/actionGroups/AlzActionGrp')]\"\r\n                                  }\r\n                                ]\r\n                              },\r\n                              \"description\": \"ServiceHealthPlannedMaintenance Alert\",\r\n                              \"enabled\": \"[[parameters('enabled')]\",\r\n                              \"scopes\": [\r\n                                \"[[subscription().id]\"\r\n                              ],\r\n                              \"condition\": {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"category\",\r\n                                    \"equals\": \"ServiceHealth\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"properties.incidentType\",\r\n                                    \"equals\": \"Maintenance\"\r\n                                  }\r\n                                ]\r\n                              },\r\n                              \"parameters\": {\r\n                                \"enabled\": {\r\n                                  \"value\": \"[[parameters('enabled')]\"\r\n                                }\r\n                              }\r\n                            }\r\n                          },\r\n                          {\r\n                            \"type\": \"Microsoft.Insights/actionGroups\",\r\n                            \"apiVersion\": \"2022-04-01\",\r\n                            \"name\": \"AlzActionGrp\",\r\n                            \"location\": \"global\",\r\n                            \"tags\": {\r\n                              \"_deployed_by_alz_monitor\": true\r\n                            },\r\n                            \"properties\": {\r\n                              \"groupShortName\": \"AlzActionGrp\",\r\n                              \"enabled\": true,\r\n                              \"emailReceivers\": [\r\n                                {\r\n                                  \"name\": \"AlzMail\",\r\n                                  \"emailAddress\": \"[[parameters('ALZMonitorActionGroupEmail')]\",\r\n                                  \"useCommonAlertSchema\": true\r\n                                }\r\n                              ]\r\n                            }\r\n                          }\r\n                        ]\r\n                      },\r\n                      \"parameters\": {\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"alertResourceGroupName\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                        },\r\n                        \"ALZMonitorActionGroupEmail\": {\r\n                          \"value\": \"[[parameters('ALZMonitorActionGroupEmail')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"alertResourceGroupName\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                },\r\n                \"alertResourceGroupTags\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\r\n                },\r\n                \"alertResourceGroupLocation\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                },\r\n                \"ALZMonitorActionGroupEmail\": {\r\n                  \"value\": \"[[parameters('ALZMonitorActionGroupEmail')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#11": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_activitylog_ServiceHealth_SecurityAdvisory\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy Service Health Security Advisory Alert\",\r\n    \"description\": \"Policy to Deploy Service Health Security Advisory Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.1.0\",\r\n      \"category\": \"Monitoring\",\r\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_alz_monitor\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"alertResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Name\",\r\n          \"description\": \"Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"AlzMonitoring-rg\"\r\n      },\r\n      \"alertResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Tags\",\r\n          \"description\": \"Tags on the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": {\r\n          \"environment\": \"test\",\r\n          \"_deployed_by_alz_monitor\": true\r\n        }\r\n      },\r\n      \"alertResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Location\",\r\n          \"description\": \"Location of the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"centralus\"\r\n      },\r\n      \"ALZMonitorActionGroupEmail\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Action Group Email\",\r\n          \"description\": \"Email address to send alerts to\"\r\n        },\r\n        \"defaultValue\": \"action@mail.com\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring  Subscription level alerts. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/activityLogAlerts\",\r\n          \"existenceScope\": \"resourcegroup\",\r\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\r\n          \"deploymentScope\": \"subscription\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/ActivityLogAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              },\r\n              {\r\n                \"count\": {\r\n                  \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*]\",\r\n                  \"where\": {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].field\",\r\n                            \"equals\": \"category\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].equals\",\r\n                            \"equals\": \"ServiceHealth\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"microsoft.insights/activityLogAlerts/condition.allOf[*].field\",\r\n                            \"equals\": \"properties.incidentType\"\r\n                          },\r\n                          {\r\n                            \"field\": \"microsoft.insights/activityLogAlerts/condition.allOf[*].equals\",\r\n                            \"equals\": \"Security\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                },\r\n                \"equals\": 2\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"location\": \"[[deployment().location]\",\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"alertResourceGroupName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"alertResourceGroupTags\": {\r\n                    \"type\": \"object\"\r\n                  },\r\n                  \"alertResourceGroupLocation\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"ALZMonitorActionGroupEmail\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\r\n                    \"apiVersion\": \"2021-04-01\",\r\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\r\n                  },\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/deployments\",\r\n                    \"apiVersion\": \"2019-10-01\",\r\n                    \"name\": \"ServiceSecurityIncident\",\r\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"dependsOn\": [\r\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\r\n                    ],\r\n                    \"properties\": {\r\n                      \"mode\": \"Incremental\",\r\n                      \"template\": {\r\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                        \"contentVersion\": \"1.0.0.0\",\r\n                        \"parameters\": {\r\n                          \"enabled\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupName\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"ALZMonitorActionGroupEmail\": {\r\n                            \"type\": \"string\"\r\n                          }\r\n                        },\r\n                        \"variables\": {},\r\n                        \"resources\": [\r\n                          {\r\n                            \"type\": \"microsoft.insights/activityLogAlerts\",\r\n                            \"apiVersion\": \"2020-10-01\",\r\n                            \"name\": \"ServiceHealthSecurityIncident\",\r\n                            \"location\": \"global\",\r\n                            \"dependsOn\": [\r\n                              \"[[concat(subscription().Id, '/resourceGroups/', parameters('alertResourceGroupName'), '/providers/Microsoft.Insights/actionGroups/AlzActionGrp')]\"\r\n                            ],\r\n                            \"tags\": {\r\n                              \"_deployed_by_alz_monitor\": true\r\n                            },\r\n                            \"properties\": {\r\n                              \"actions\": {\r\n                                \"actionGroups\": [\r\n                                  {\r\n                                    \"actionGroupId\": \"[[concat(subscription().Id, '/resourceGroups/', parameters('alertResourceGroupName'), '/providers/Microsoft.Insights/actionGroups/AlzActionGrp')]\"\r\n                                  }\r\n                                ]\r\n                              },\r\n                              \"description\": \"Service Health Security Alert\",\r\n                              \"enabled\": \"[[parameters('enabled')]\",\r\n                              \"scopes\": [\r\n                                \"[[subscription().id]\"\r\n                              ],\r\n                              \"condition\": {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"category\",\r\n                                    \"equals\": \"ServiceHealth\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"properties.incidentType\",\r\n                                    \"equals\": \"Security\"\r\n                                  }\r\n                                ]\r\n                              },\r\n                              \"parameters\": {\r\n                                \"enabled\": {\r\n                                  \"value\": \"[[parameters('enabled')]\"\r\n                                }\r\n                              }\r\n                            }\r\n                          },\r\n                          {\r\n                            \"type\": \"Microsoft.Insights/actionGroups\",\r\n                            \"apiVersion\": \"2022-04-01\",\r\n                            \"name\": \"AlzActionGrp\",\r\n                            \"location\": \"global\",\r\n                            \"tags\": {\r\n                              \"_deployed_by_alz_monitor\": true\r\n                            },\r\n                            \"properties\": {\r\n                              \"groupShortName\": \"AlzActionGrp\",\r\n                              \"enabled\": true,\r\n                              \"emailReceivers\": [\r\n                                {\r\n                                  \"name\": \"AlzMail\",\r\n                                  \"emailAddress\": \"[[parameters('ALZMonitorActionGroupEmail')]\",\r\n                                  \"useCommonAlertSchema\": true\r\n                                }\r\n                              ]\r\n                            }\r\n                          }\r\n                        ]\r\n                      },\r\n                      \"parameters\": {\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"alertResourceGroupName\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                        },\r\n                        \"ALZMonitorActionGroupEmail\": {\r\n                          \"value\": \"[[parameters('ALZMonitorActionGroupEmail')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"alertResourceGroupName\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                },\r\n                \"alertResourceGroupTags\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\r\n                },\r\n                \"ALZMonitorActionGroupEmail\": {\r\n                  \"value\": \"[[parameters('ALZMonitorActionGroupEmail')]\"\r\n                },\r\n                \"alertResourceGroupLocation\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#12": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_activitylog_VPNGateway_Delete\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Activity Log VPN Gateway Delete Alert\",\n    \"description\": \"Policy to Deploy Activity Log VPN Gateway Delete Alert\",\n    \"metadata\": {\n      \"version\": \"1.0.1\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_alz_monitor\": \"True\"\n    },\n    \"parameters\": {\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"alertResourceGroupName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Resource Group Name\",\n          \"description\": \"Resource group the alert is placed in\"\n        },\n        \"defaultValue\": \"AlzMonitoring-rg\"\n      },\n      \"alertResourceGroupTags\": {\n        \"type\": \"Object\",\n        \"metadata\": {\n          \"displayName\": \"Resource Group Tags\",\n          \"description\": \"Tags on the Resource group the alert is placed in\"\n        },\n        \"defaultValue\": {\n          \"environment\": \"test\",\n          \"_deployed_by_alz_monitor\": true\n        }\n      },\n      \"alertResourceGroupLocation\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Resource Group Location\",\n          \"description\": \"Location of the Resource group the alert is placed in\"\n        },\n        \"defaultValue\": \"centralus\"\n      },\n      \"MonitorDisable\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/vpnGateways\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\n            \"notEquals\": \"true\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"deployIfNotExists\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"type\": \"Microsoft.Insights/activityLogAlerts\",\n          \"existenceScope\": \"resourcegroup\",\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\n          \"deploymentScope\": \"subscription\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/ActivityLogAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"count\": {\n                  \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*]\",\n                  \"where\": {\n                    \"anyOf\": [\n                      {\n                        \"allOf\": [\n                          {\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].field\",\n                            \"equals\": \"category\"\n                          },\n                          {\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].equals\",\n                            \"equals\": \"Administrative\"\n                          }\n                        ]\n                      },\n                      {\n                        \"allOf\": [\n                          {\n                            \"field\": \"microsoft.insights/activityLogAlerts/condition.allOf[*].field\",\n                            \"equals\": \"operationName\"\n                          },\n                          {\n                            \"field\": \"microsoft.insights/activityLogAlerts/condition.allOf[*].equals\",\n                            \"equals\": \"Microsoft.Network/vpnGateways/delete\"\n                          }\n                        ]\n                      }\n                    ]\n                  }\n                },\n                \"equals\": 2\n              }\n            ]\n          },\n          \"deployment\": {\n            \"location\": \"[[deployment().location]\",\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"alertResourceGroupName\": {\n                    \"type\": \"string\"\n                  },\n                  \"alertResourceGroupTags\": {\n                    \"type\": \"object\"\n                  },\n                  \"alertResourceGroupLocation\": {\n                    \"type\": \"string\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"string\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\n                    \"apiVersion\": \"2021-04-01\",\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\n                  },\n                  {\n                    \"type\": \"Microsoft.Resources/deployments\",\n                    \"apiVersion\": \"2019-10-01\",\n                    \"name\": \"ActivityVPNGatewayDelete\",\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\n                    \"dependsOn\": [\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\n                    ],\n                    \"properties\": {\n                      \"mode\": \"Incremental\",\n                      \"template\": {\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                        \"contentVersion\": \"1.0.0.0\",\n                        \"parameters\": {\n                          \"enabled\": {\n                            \"type\": \"string\"\n                          },\n                          \"alertResourceGroupName\": {\n                            \"type\": \"string\"\n                          }\n                        },\n                        \"variables\": {},\n                        \"resources\": [\n                          {\n                            \"type\": \"microsoft.insights/activityLogAlerts\",\n                            \"apiVersion\": \"2020-10-01\",\n                            \"name\": \"ActivityVPNGatewayDelete\",\n                            \"location\": \"global\",\n                            \"tags\": {\n                              \"_deployed_by_alz_monitor\": true\n                            },\n                            \"properties\": {\n                              \"description\": \"Activity Log VPN Gateway Delete\",\n                              \"enabled\": \"[[parameters('enabled')]\",\n                              \"scopes\": [\n                                \"[[subscription().id]\"\n                              ],\n                              \"condition\": {\n                                \"allOf\": [\n                                  {\n                                    \"field\": \"category\",\n                                    \"equals\": \"Administrative\"\n                                  },\n                                  {\n                                    \"field\": \"operationName\",\n                                    \"equals\": \"Microsoft.Network/vpnGateways/delete\"\n                                  },\n                                  {\n                                    \"field\": \"status\",\n                                    \"containsAny\": [\n                                      \"succeeded\"\n                                    ]\n                                  }\n                                ]\n                              },\n                              \"parameters\": {\n                                \"enabled\": {\n                                  \"value\": \"[[parameters('enabled')]\"\n                                }\n                              }\n                            }\n                          }\n                        ]\n                      },\n                      \"parameters\": {\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"alertResourceGroupName\": {\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"alertResourceGroupName\": {\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\n                },\n                \"alertResourceGroupTags\": {\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\n                },\n                \"alertResourceGroupLocation\": {\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#13": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_AFW_FirewallHealth_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy AFW FirewallHealth Alert\",\n    \"description\": \"Policy to audit/deploy Azure Firewall FirewallHealth Alert\",\n    \"metadata\": {\n      \"version\": \"1.0.1\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_alz_monitor\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"0\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT1M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"90\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisable\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/azureFirewalls\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\n            \"notEquals\": \"true\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/azureFirewalls\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"FirewallHealth\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/azureFirewalls/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-FirewallHealth')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_alz_monitor\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for AFW FirewallHealth\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"FirewallHealth\",\n                            \"metricNamespace\": \"Microsoft.Network/azureFirewalls\",\n                            \"metricName\": \"FirewallHealth\",\n                            \"operator\": \"LessThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[parameters('threshold')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#14": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_AFW_SNATPortUtilization_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy AFW SNATPortUtilization Alert\",\n    \"description\": \"Policy to audit/deploy Azure Firewall SNATPortUtilization Alert\",\n    \"metadata\": {\n      \"version\": \"1.0.1\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_alz_monitor\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"1\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT1M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"80\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisable\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/azureFirewalls\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\n            \"notEquals\": \"true\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/azureFirewalls\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"SNATPortUtilization\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/azureFirewalls/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-SNATPortUtilization')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_alz_monitor\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for AFW SNATPortUtilization\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"SNATPortUtilization\",\n                            \"metricNamespace\": \"Microsoft.Network/azureFirewalls\",\n                            \"metricName\": \"SNATPortUtilization\",\n                            \"operator\": \"GreaterThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[parameters('threshold')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#15": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_AlertProcessing_Rule\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy Alert Processing Rule\",\r\n    \"description\": \"Policy to Deploy Deploy Alert Processing Rule with Action Group\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Monitoring\",\r\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_alz_monitor\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"ALZMonitorResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Name\",\r\n          \"description\": \"Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"AlzMonitoring-rg\"\r\n      },\r\n      \"ALZMonitorResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Tags\",\r\n          \"description\": \"Tags on the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": {\r\n          \"environment\": \"test\"\r\n        }\r\n      },\r\n      \"ALZMonitorResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Location\",\r\n          \"description\": \"Location of the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"centralus\"\r\n      },\r\n      \"ALZMonitorActionGroupEmail\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Action Group Email\",\r\n          \"description\": \"Email address to send alerts to\"\r\n        },\r\n        \"defaultValue\": \"action@mail.com\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring at subscription. Set to true if monitoring process rule should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.AlertsManagement/actionRules\",\r\n          \"existenceScope\": \"resourcegroup\",\r\n          \"resourceGroupName\": \"[[parameters('ALZMonitorResourceGroupName')]\",\r\n          \"deploymentScope\": \"subscription\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.AlertsManagement/actionRules/description\",\r\n                \"equals\": \"Alz Alert Processing Rule for Subscription\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"location\": \"[[deployment().location]\",\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"ALZMonitorResourceGroupName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"ALZMonitorResourceGroupTags\": {\r\n                    \"type\": \"object\"\r\n                  },\r\n                  \"ALZMonitorResourceGroupLocation\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"ALZMonitorActionGroupEmail\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\r\n                    \"apiVersion\": \"2021-04-01\",\r\n                    \"name\": \"[[parameters('ALZMonitorResourceGroupName')]\",\r\n                    \"location\": \"[[parameters('ALZMonitorResourceGroupLocation')]\",\r\n                    \"tags\": \"[[parameters('ALZMonitorResourceGroupTags')]\"\r\n                  },\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/deployments\",\r\n                    \"apiVersion\": \"2019-10-01\",\r\n                    \"name\": \"ActionGroupDeployment\",\r\n                    \"resourceGroup\": \"[[parameters('ALZMonitorResourceGroupName')]\",\r\n                    \"dependsOn\": [\r\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('ALZMonitorResourceGroupName'))]\"\r\n                    ],\r\n                    \"properties\": {\r\n                      \"mode\": \"Incremental\",\r\n                      \"template\": {\r\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                        \"contentVersion\": \"1.0.0.0\",\r\n                        \"parameters\": {\r\n                          \"ALZMonitorResourceGroupName\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"ALZMonitorActionGroupEmail\": {\r\n                            \"type\": \"string\"\r\n                          }\r\n                        },\r\n                        \"variables\": {},\r\n                        \"resources\": [\r\n                          {\r\n                            \"type\": \"Microsoft.Insights/actionGroups\",\r\n                            \"apiVersion\": \"2022-04-01\",\r\n                            \"name\": \"AlzActionGrp\",\r\n                            \"location\": \"global\",\r\n                            \"tags\": {\r\n                              \"_deployed_by_alz_monitor\": true\r\n                            },\r\n                            \"properties\": {\r\n                              \"groupShortName\": \"AlzActionGrp\",\r\n                              \"enabled\": true,\r\n                              \"emailReceivers\": [\r\n                                {\r\n                                  \"name\": \"AlzMail\",\r\n                                  \"emailAddress\": \"[[parameters('ALZMonitorActionGroupEmail')]\",\r\n                                  \"useCommonAlertSchema\": true\r\n                                }\r\n                              ]\r\n                            }\r\n                          },\r\n                          {\r\n                            \"type\": \"Microsoft.AlertsManagement/actionRules\",\r\n                            \"apiVersion\": \"2021-08-08\",\r\n                            \"name\": \"Alz Alert Processing Rule\",\r\n                            \"location\": \"global\",\r\n                            \"dependsOn\": [\r\n                              \"[[concat('Microsoft.Insights/actionGroups/', 'AlzActionGrp')]\"\r\n                            ],\r\n                            \"tags\": {\r\n                              \"_deployed_by_alz_monitor\": true\r\n                            },\r\n                            \"properties\": {\r\n                              \"scopes\": [\r\n                                \"[[subscription().Id]\"\r\n                              ],\r\n                              \"description\": \"Alz Alert Processing Rule for Subscription\",\r\n                              \"enabled\": true,\r\n                              \"actions\": [\r\n                                {\r\n                                  \"actiongroupIds\": [\r\n                                    \"[[concat(subscription().Id, '/resourceGroups/', parameters('ALZMonitorResourceGroupName'), '/providers/Microsoft.Insights/actionGroups/AlzActionGrp')]\"\r\n                                  ],\r\n                                  \"actionType\": \"AddActionGroups\"\r\n                                }\r\n                              ]\r\n                            }\r\n                          }\r\n                        ]\r\n                      },\r\n                      \"parameters\": {\r\n                        \"ALZMonitorResourceGroupName\": {\r\n                          \"value\": \"[[parameters('ALZMonitorResourceGroupName')]\"\r\n                        },\r\n                        \"ALZMonitorActionGroupEmail\": {\r\n                          \"value\": \"[[parameters('ALZMonitorActionGroupEmail')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"ALZMonitorResourceGroupName\": {\r\n                  \"value\": \"[[parameters('ALZMonitorResourceGroupName')]\"\r\n                },\r\n                \"ALZMonitorResourceGroupTags\": {\r\n                  \"value\": \"[[parameters('ALZMonitorResourceGroupTags')]\"\r\n                },\r\n                \"ALZMonitorResourceGroupLocation\": {\r\n                  \"value\": \"[[parameters('ALZMonitorResourceGroupLocation')]\"\r\n                },\r\n                \"ALZMonitorActionGroupEmail\": {\r\n                  \"value\": \"[[parameters('ALZMonitorActionGroupEmail')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#16": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_ERCIR_ArpAvailability_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy ExpressRoute Circuits Arp Availability Alert\",\n    \"description\": \"Policy to audit/deploy ExpressRoute Circuits Arp Availability Alert\",\n    \"metadata\": {\n      \"version\": \"1.0.1\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_alz_monitor\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"0\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT1M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"90\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisable\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/expressRouteCircuits\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\n            \"notEquals\": \"true\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/expressRouteCircuits\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"ArpAvailability\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/expressRouteCircuits/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-ArpAvailability')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_alz_monitor\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for ExpressRoute Circuit Arp Availability\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"ArpAvailability\",\n                            \"metricNamespace\": \"Microsoft.Network/expressRouteCircuits\",\n                            \"metricName\": \"ArpAvailability\",\n                            \"operator\": \"LessThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[parameters('threshold')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#17": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_ERCIR_BgpAvailability_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy ExpressRoute Circuits Bgp Availability Alert\",\n    \"description\": \"Policy to audit/deploy ExpressRoute Circuits Bgp Availability Alert\",\n    \"metadata\": {\n      \"version\": \"1.0.1\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_alz_monitor\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"0\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT1M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"90\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisable\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/expressRouteCircuits\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\n            \"notEquals\": \"true\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/expressRouteCircuits\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"BgpAvailability\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/expressRouteCircuits/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-BgpAvailability')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_alz_monitor\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for ExpressRoute Circuit Bgp Availability\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"BgpAvailability\",\n                            \"metricNamespace\": \"Microsoft.Network/expressRouteCircuits\",\n                            \"metricName\": \"BgpAvailability\",\n                            \"operator\": \"LessThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[parameters('threshold')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#18": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_ERCIR_QosDropBitsInPerSecond_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy ExpressRoute Circuits QosDropBitsInPerSecond Alert\",\n    \"description\": \"Policy to audit/deploy ExpressRoute Circuits QosDropBitsInPerSecond Alert\",\n    \"metadata\": {\n      \"version\": \"1.0.1\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_alz_monitor\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"2\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisable\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/expressRouteCircuits\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\n            \"notEquals\": \"true\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/expressRouteCircuits\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"QosDropBitsInPerSecond\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/expressRouteCircuits/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-QosDropBitsInPerSecond')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_alz_monitor\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for ExpressRoute Circuit QosDropBitsInPerSecond\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"alertSensitivity\": \"Medium\",\n                            \"failingPeriods\": {\n                              \"numberOfEvaluationPeriods\": 4,\n                              \"minFailingPeriodsToAlert\": 4\n                            },\n                            \"name\": \"QosDropBitsInPerSecond\",\n                            \"metricNamespace\": \"Microsoft.Network/expressRouteCircuits\",\n                            \"metricName\": \"QosDropBitsInPerSecond\",\n                            \"operator\": \"GreaterThan\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"DynamicThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#19": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_ERCIR_QosDropBitsOutPerSecond_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy ExpressRoute Circuits QosDropBitsOutPerSecond Alert\",\n    \"description\": \"Policy to audit/deploy ExpressRoute Circuits QosDropBitsOutPerSecond Alert\",\n    \"metadata\": {\n      \"version\": \"1.0.1\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_alz_monitor\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"2\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisable\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/expressRouteCircuits\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\n            \"notEquals\": \"true\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/expressRouteCircuits\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"QosDropBitsOutPerSecond\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/expressRouteCircuits/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-QosDropBitsOutPerSecond')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_alz_monitor\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for ExpressRoute Circuit QosDropBitsOutPerSecond\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"alertSensitivity\": \"Medium\",\n                            \"failingPeriods\": {\n                              \"numberOfEvaluationPeriods\": 4,\n                              \"minFailingPeriodsToAlert\": 4\n                            },\n                            \"name\": \"QosDropBitsOutPerSecond\",\n                            \"metricNamespace\": \"Microsoft.Network/expressRouteCircuits\",\n                            \"metricName\": \"QosDropBitsOutPerSecond\",\n                            \"operator\": \"GreaterThan\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"DynamicThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#2": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_activitylog_KeyVault_Delete\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy Activity Log Key Vault Delete Alert\",\r\n    \"description\": \"Policy to Deploy Activity Log Key Vault Delete Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Key Vault\",\r\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_alz_monitor\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"alertResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Name\",\r\n          \"description\": \"Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"AlzMonitoring-rg\"\r\n      },\r\n      \"alertResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Tags\",\r\n          \"description\": \"Tags on the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": {\r\n          \"environment\": \"test\",\r\n          \"_deployed_by_alz_monitor\": true\r\n        }\r\n      },\r\n      \"alertResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Location\",\r\n          \"description\": \"Location of the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"centralus\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring on resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"microsoft.keyvault/vaults\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/activityLogAlerts\",\r\n          \"name\": \"ActivityKeyVaultDelete\",\r\n          \"existenceScope\": \"resourcegroup\",\r\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\r\n          \"deploymentScope\": \"subscription\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/ActivityLogAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              },\r\n              {\r\n                \"count\": {\r\n                  \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*]\",\r\n                  \"where\": {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].field\",\r\n                            \"equals\": \"category\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].equals\",\r\n                            \"equals\": \"Administrative\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"microsoft.insights/activityLogAlerts/condition.allOf[*].field\",\r\n                            \"equals\": \"operationName\"\r\n                          },\r\n                          {\r\n                            \"field\": \"microsoft.insights/activityLogAlerts/condition.allOf[*].equals\",\r\n                            \"equals\": \"Microsoft.KeyVault/vaults/delete\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                },\r\n                \"equals\": 2\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"location\": \"[[deployment().location]\",\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"alertResourceGroupName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"alertResourceGroupTags\": {\r\n                    \"type\": \"object\"\r\n                  },\r\n                  \"alertResourceGroupLocation\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\r\n                    \"apiVersion\": \"2021-04-01\",\r\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\r\n                  },\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/deployments\",\r\n                    \"apiVersion\": \"2019-10-01\",\r\n                    \"name\": \"ActivityKeyVaultDelete\",\r\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"dependsOn\": [\r\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\r\n                    ],\r\n                    \"properties\": {\r\n                      \"mode\": \"Incremental\",\r\n                      \"template\": {\r\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                        \"contentVersion\": \"1.0.0.0\",\r\n                        \"parameters\": {\r\n                          \"enabled\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupName\": {\r\n                            \"type\": \"string\"\r\n                          }\r\n                        },\r\n                        \"variables\": {},\r\n                        \"resources\": [\r\n                          {\r\n                            \"type\": \"microsoft.insights/activityLogAlerts\",\r\n                            \"apiVersion\": \"2020-10-01\",\r\n                            \"name\": \"ActivityKeyVaultDelete\",\r\n                            \"location\": \"global\",\r\n                            \"tags\": {\r\n                              \"_deployed_by_alz_monitor\": true\r\n                            },\r\n                            \"properties\": {\r\n                              \"description\": \"Activity Log Key Vault Delete\",\r\n                              \"enabled\": \"[[parameters('enabled')]\",\r\n                              \"scopes\": [\r\n                                \"[[subscription().id]\"\r\n                              ],\r\n                              \"condition\": {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"category\",\r\n                                    \"equals\": \"Administrative\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"operationName\",\r\n                                    \"equals\": \"Microsoft.KeyVault/vaults/delete\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"status\",\r\n                                    \"containsAny\": [\r\n                                      \"succeeded\"\r\n                                    ]\r\n                                  }\r\n                                ]\r\n                              },\r\n                              \"parameters\": {\r\n                                \"enabled\": {\r\n                                  \"value\": \"[[parameters('enabled')]\"\r\n                                }\r\n                              }\r\n                            }\r\n                          }\r\n                        ]\r\n                      },\r\n                      \"parameters\": {\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"alertResourceGroupName\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"alertResourceGroupName\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                },\r\n                \"alertResourceGroupTags\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\r\n                },\r\n                \"alertResourceGroupLocation\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#20": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_ERGw_ExpressRouteBitsIn_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy ERG ExpressRoute Bits In Alert\",\n    \"description\": \"Policy to audit/deploy ER Gateway Connection BitsInPerSecond Alert\",\n    \"metadata\": {\n      \"version\": \"1.0.1\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_alz_monitor\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"0\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"1\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"disabled\"\n      },\n      \"MonitorDisable\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/expressroutegateways\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\n            \"notEquals\": \"true\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/expressroutegateways\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"ERGatewayConnectionBitsInPerSecond\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/expressroutegateways/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-GatewayERBitsInAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_alz_monitor\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for ER Gateway Connection BitsInPerSecond\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"ERGatewayConnectionBitsInPerSecond\",\n                            \"metricNamespace\": \"Microsoft.Network/expressroutegateways\",\n                            \"metricName\": \"ERGatewayConnectionBitsInPerSecond\",\n                            \"operator\": \"LessThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[parameters('threshold')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#21": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_ERGw_ExpressRouteBitsOut_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy ERG ExpressRoute Bits Out Alert\",\n    \"description\": \"Policy to audit/deploy ER Gateway Connection BitsOutPerSecond Alert\",\n    \"metadata\": {\n      \"version\": \"1.0.1\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_alz_monitor\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"0\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"1\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"disabled\"\n      },\n      \"MonitorDisable\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/expressroutegateways\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\n            \"notEquals\": \"true\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/expressroutegateways\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"ERGatewayConnectionBitsOutPerSecond\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/expressroutegateways/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-GatewayERBitsOutAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_alz_monitor\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for ER Gateway Connection BitsOutPerSecond\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"ERGatewayConnectionBitsOutPerSecond\",\n                            \"metricNamespace\": \"Microsoft.Network/expressroutegateways\",\n                            \"metricName\": \"ERGatewayConnectionBitsOutPerSecond\",\n                            \"operator\": \"LessThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[parameters('threshold')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#22": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_ERGw_ExpressRouteCpuUtil_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy ERG ExpressRoute CPU Utilization Alert\",\n    \"description\": \"Policy to audit/deploy ER Gateway Express Route CPU Utilization Alert\",\n    \"metadata\": {\n      \"version\": \"1.0.1\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_alz_monitor\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"1\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT1M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"80\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisable\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/expressroutegateways\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\n            \"notEquals\": \"true\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/expressroutegateways\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"ExpressRouteGatewayCpuUtilization\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/expressroutegateways/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-GatewayERCPUAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_alz_monitor\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for ER Gateway Express Route CPU Utilization\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"ExpressRouteGatewayCpuUtilization\",\n                            \"metricNamespace\": \"Microsoft.Network/expressroutegateways\",\n                            \"metricName\": \"ExpressRouteGatewayCpuUtilization\",\n                            \"operator\": \"GreaterThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[parameters('threshold')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#23": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_KeyVault_Availability_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy KeyVault Availability Alert\",\n    \"description\": \"Policy to audit/deploy KeyVault Availability Alert\",\n    \"metadata\": {\n      \"version\": \"1.0.1\",\n      \"category\": \"Key Vault\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_alz_monitor\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"1\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT1M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"90\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"disabled\"\n      },\n      \"MonitorDisable\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"microsoft.keyvault/vaults\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\n            \"notEquals\": \"true\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"microsoft.keyvault/vaults\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"Availability\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/microsoft.keyvault/vaults/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-Availability')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_alz_monitor\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for KeyVault Availability\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"Availability\",\n                            \"metricNamespace\": \"microsoft.keyvault/vaults\",\n                            \"metricName\": \"Availability\",\n                            \"operator\": \"LessThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[parameters('threshold')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#24": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_KeyVault_Capacity_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy KeyVault Capacity Alert\",\n    \"description\": \"Policy to audit/deploy KeyVault Capacity Alert\",\n    \"metadata\": {\n      \"version\": \"1.0.1\",\n      \"category\": \"Key Vault\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_alz_monitor\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"1\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT1M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"75\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"disabled\"\n      },\n      \"MonitorDisable\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"microsoft.keyvault/vaults\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\n            \"notEquals\": \"true\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"microsoft.keyvault/vaults\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"SaturationShoebox\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/microsoft.keyvault/vaults/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-CapacityAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_alz_monitor\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for KeyVault Capacity\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"SaturationShoebox\",\n                            \"metricNamespace\": \"microsoft.keyvault/vaults\",\n                            \"metricName\": \"SaturationShoebox\",\n                            \"operator\": \"GreaterThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[parameters('threshold')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#25": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_KeyVault_Latency_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy KeyVault Latency Alert\",\n    \"description\": \"Policy to audit/deploy KeyVault Latency Alert\",\n    \"metadata\": {\n      \"version\": \"1.0.1\",\n      \"category\": \"Key Vault\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_alz_monitor\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"3\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"1000\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"disabled\"\n      },\n      \"MonitorDisable\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"microsoft.keyvault/vaults\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\n            \"notEquals\": \"true\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"microsoft.keyvault/vaults\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"ServiceApiLatency\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/microsoft.keyvault/vaults/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-LatencyAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_alz_monitor\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for KeyVault Latency\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"ServiceApiLatency\",\n                            \"metricNamespace\": \"microsoft.keyvault/vaults\",\n                            \"metricName\": \"ServiceApiLatency\",\n                            \"operator\": \"GreaterThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[parameters('threshold')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#26": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_KeyVault_Requests_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy KeyVault Requests Alert\",\n    \"description\": \"Policy to audit/deploy KeyVault Requests Alert\",\n    \"metadata\": {\n      \"version\": \"1.0.1\",\n      \"category\": \"Key Vault\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_alz_monitor\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"2\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"disabled\"\n      },\n      \"MonitorDisable\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"microsoft.keyvault/vaults\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\n            \"notEquals\": \"true\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"microsoft.keyvault/vaults\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"ServiceApiResult\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/microsoft.keyvault/vaults/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-RequestsAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_alz_monitor\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for KeyVault Requests\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"alertSensitivity\": \"Medium\",\n                            \"failingPeriods\": {\n                              \"numberOfEvaluationPeriods\": 4,\n                              \"minFailingPeriodsToAlert\": 4\n                            },\n                            \"name\": \"ServiceApiResult\",\n                            \"metricNamespace\": \"microsoft.keyvault/vaults\",\n                            \"metricName\": \"ServiceApiResult\",\n                            \"operator\": \"GreaterThan\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"DynamicThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#27": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_PDNSZ_CapacityUtil_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy PDNSZ Capacity Utilization Alert\",\n    \"description\": \"Policy to audit/deploy Private DNS Zone Capacity Utilization Alert\",\n    \"metadata\": {\n      \"version\": \"1.0.1\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_alz_monitor\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"2\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT1H\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT1H\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"80\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisable\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/privateDnsZones\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\n            \"notEquals\": \"true\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/privateDnsZones\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"VirtualNetworkLinkCapacityUtilization\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/privateDnsZones/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-CapacityUtilizationAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_alz_monitor\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for Private DNS Zone Virtual Network Link Capacity Utilization\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"VirtualNetworkLinkCapacityUtilization\",\n                            \"metricNamespace\": \"Microsoft.Network/privateDnsZones\",\n                            \"metricName\": \"VirtualNetworkLinkCapacityUtilization\",\n                            \"operator\": \"GreaterThanOrEqual\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Maximum\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[parameters('threshold')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#28": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_PDNSZ_QueryVolume_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy PDNSZ Query Volume Alert\",\n    \"description\": \"Policy to audit/deploy Private DNS Zone Query Volume Alert\",\n    \"metadata\": {\n      \"version\": \"1.0.1\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_alz_monitor\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"4\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT1H\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT1H\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"500\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"disabled\"\n      },\n      \"MonitorDisable\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/privateDnsZones\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\n            \"notEquals\": \"true\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/privateDnsZones\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"QueryVolume\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/privateDnsZones/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-QueryVolumeAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_alz_monitor\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for Private DNS Query Volume\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"QueryVolume\",\n                            \"metricNamespace\": \"Microsoft.Network/privateDnsZones\",\n                            \"metricName\": \"QueryVolume\",\n                            \"operator\": \"GreaterThanOrEqual\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Total\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[parameters('threshold')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#29": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_PDNSZ_RecordSetCapacity_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy PDNSZ Record Set Capacity Alert\",\n    \"description\": \"Policy to audit/deploy Private DNS Zone Record Set Capacity Alert\",\n    \"metadata\": {\n      \"version\": \"1.0.1\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_alz_monitor\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"2\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT1H\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT1H\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"80\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisable\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/privateDnsZones\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\n            \"notEquals\": \"true\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/privateDnsZones\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"RecordSetCapacityUtilization\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/privateDnsZones/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-RecordSet_Capacity_Utilization')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_alz_monitor\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for Private DNS Zone Record Set Capacity Utilization\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"RecordSetCapacityUtilization\",\n                            \"metricNamespace\": \"Microsoft.Network/privateDnsZones\",\n                            \"metricName\": \"RecordSetCapacityUtilization\",\n                            \"operator\": \"GreaterThanOrEqual\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Maximum\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[parameters('threshold')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#3": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_activitylog_LAWorkspace_Delete\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy Activity Log LA Workspace Delete Alert\",\r\n    \"description\": \"Policy to Deploy Activity Log LA Workspace Delete Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Monitoring\",\r\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_alz_monitor\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"alertResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Name\",\r\n          \"description\": \"Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"AlzMonitoring-rg\"\r\n      },\r\n      \"alertResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Tags\",\r\n          \"description\": \"Tags on the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": {\r\n          \"environment\": \"test\",\r\n          \"_deployed_by_alz_monitor\": true\r\n        }\r\n      },\r\n      \"alertResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Location\",\r\n          \"description\": \"Location of the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"centralus\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring on resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.OperationalInsights/workspaces\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/activityLogAlerts\",\r\n          \"name\": \"ActivityLAWorkspaceDelete\",\r\n          \"existenceScope\": \"resourcegroup\",\r\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\r\n          \"deploymentScope\": \"subscription\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/ActivityLogAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              },\r\n              {\r\n                \"count\": {\r\n                  \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*]\",\r\n                  \"where\": {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].field\",\r\n                            \"equals\": \"category\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].equals\",\r\n                            \"equals\": \"Administrative\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"microsoft.insights/activityLogAlerts/condition.allOf[*].field\",\r\n                            \"equals\": \"operationName\"\r\n                          },\r\n                          {\r\n                            \"field\": \"microsoft.insights/activityLogAlerts/condition.allOf[*].equals\",\r\n                            \"equals\": \"Microsoft.OperationalInsights/workspaces/delete\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                },\r\n                \"equals\": 2\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"location\": \"[[deployment().location]\",\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"alertResourceGroupName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"alertResourceGroupTags\": {\r\n                    \"type\": \"object\"\r\n                  },\r\n                  \"alertResourceGroupLocation\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\r\n                    \"apiVersion\": \"2021-04-01\",\r\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\r\n                  },\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/deployments\",\r\n                    \"apiVersion\": \"2019-10-01\",\r\n                    \"name\": \"ActivityLAWorkspaceDelete\",\r\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"dependsOn\": [\r\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\r\n                    ],\r\n                    \"properties\": {\r\n                      \"mode\": \"Incremental\",\r\n                      \"template\": {\r\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                        \"contentVersion\": \"1.0.0.0\",\r\n                        \"parameters\": {\r\n                          \"enabled\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupName\": {\r\n                            \"type\": \"string\"\r\n                          }\r\n                        },\r\n                        \"variables\": {},\r\n                        \"resources\": [\r\n                          {\r\n                            \"type\": \"microsoft.insights/activityLogAlerts\",\r\n                            \"apiVersion\": \"2020-10-01\",\r\n                            \"name\": \"ActivityLAWorkspaceDelete\",\r\n                            \"location\": \"global\",\r\n                            \"tags\": {\r\n                              \"_deployed_by_alz_monitor\": true\r\n                            },\r\n                            \"properties\": {\r\n                              \"description\": \"Activity Log LA Workspace Delete\",\r\n                              \"enabled\": \"[[parameters('enabled')]\",\r\n                              \"scopes\": [\r\n                                \"[[subscription().id]\"\r\n                              ],\r\n                              \"condition\": {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"category\",\r\n                                    \"equals\": \"Administrative\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"operationName\",\r\n                                    \"equals\": \"Microsoft.OperationalInsights/workspaces/delete\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"status\",\r\n                                    \"containsAny\": [\r\n                                      \"succeeded\"\r\n                                    ]\r\n                                  }\r\n                                ]\r\n                              },\r\n                              \"parameters\": {\r\n                                \"enabled\": {\r\n                                  \"value\": \"[[parameters('enabled')]\"\r\n                                }\r\n                              }\r\n                            }\r\n                          }\r\n                        ]\r\n                      },\r\n                      \"parameters\": {\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"alertResourceGroupName\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"alertResourceGroupName\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                },\r\n                \"alertResourceGroupTags\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\r\n                },\r\n                \"alertResourceGroupLocation\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#30": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_DNSZ_RegistrationCapacityUtil_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy PDNSZ Registration Capacity Utilization Alert\",\n    \"description\": \"Policy to audit/deploy Private DNS Zone Registration Capacity Utilization Alert\",\n    \"metadata\": {\n      \"version\": \"1.0.1\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_alz_monitor\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"2\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT1H\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT1H\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"80\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisable\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/privateDnsZones\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\n            \"notEquals\": \"true\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/privateDnsZones\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"VirtualNetworkWithRegistrationCapacityUtilization\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/privateDnsZones/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-RequestsAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_alz_monitor\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for Private DNS Zone Registration Capacity Utilization\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"VirtualNetworkWithRegistrationCapacityUtilization\",\n                            \"metricNamespace\": \"Microsoft.Network/privateDnsZones\",\n                            \"metricName\": \"VirtualNetworkWithRegistrationCapacityUtilization\",\n                            \"operator\": \"GreaterThanOrEqual\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Maximum\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[parameters('threshold')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#31": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_PublicIp_BytesInDDoSAttack_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy PIP Bytes in DDoS Attack Alert\",\n    \"description\": \"Policy to audit/deploy PIP Bytes in DDoS Attack Alert\",\n    \"metadata\": {\n      \"version\": \"1.0.1\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_alz_monitor\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"4\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"8000000\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"disabled\"\n      },\n      \"MonitorDisable\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/publicIPAddresses\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\n            \"notEquals\": \"true\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/publicIPAddresses\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"bytesinddos\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/publicIPAddresses/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-BytesInDDOSAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_alz_monitor\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for Public IP Address Bytes IN DDOS\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"bytesinddos\",\n                            \"metricNamespace\": \"Microsoft.Network/publicIPAddresses\",\n                            \"metricName\": \"bytesinddos\",\n                            \"operator\": \"GreaterThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Maximum\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[parameters('threshold')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#32": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_PublicIp_DDoSAttack_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy PIP DDoS Attack Alert\",\n    \"description\": \"Policy to audit/deploy PIP DDoS Attack Alert\",\n    \"metadata\": {\n      \"version\": \"1.0.1\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_alz_monitor\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"1\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"0\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisable\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/publicIPAddresses\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\n            \"notEquals\": \"true\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/publicIPAddresses\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"ifunderddosattack\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/publicIPAddresses/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-DDOS_Attack')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_alz_monitor\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for Public IP Address Under Attack\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"ifunderddosattack\",\n                            \"metricNamespace\": \"Microsoft.Network/publicIPAddresses\",\n                            \"metricName\": \"ifunderddosattack\",\n                            \"operator\": \"GreaterThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Maximum\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[parameters('threshold')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#33": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_PublicIp_PacketsInDDoSAttack_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy PIP Packets in DDoS Attack Alert\",\n    \"description\": \"Policy to audit/deploy PIP Packets in DDoS Attack Alert\",\n    \"metadata\": {\n      \"version\": \"1.0.1\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_alz_monitor\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"4\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"40000\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"disabled\"\n      },\n      \"MonitorDisable\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/publicIPAddresses\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\n            \"notEquals\": \"true\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/publicIPAddresses\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"PacketsInDDoS\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/publicIPAddresses/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-PacketsInDDosAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_alz_monitor\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for Public IP Address Packets IN DDOS\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"PacketsInDDoS\",\n                            \"metricNamespace\": \"Microsoft.Network/publicIPAddresses\",\n                            \"metricName\": \"PacketsInDDoS\",\n                            \"operator\": \"GreaterThanOrEqual\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Total\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[parameters('threshold')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#34": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_PublicIp_VIPAvailability_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy PIP VIP Availability Alert\",\n    \"description\": \"Policy to audit/deploy PIP VIP Availability Alert\",\n    \"metadata\": {\n      \"version\": \"1.0.1\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_alz_monitor\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"1\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT1M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"90\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisable\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/publicIPAddresses\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\n            \"notEquals\": \"true\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/publicIPAddresses\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"VipAvailability\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/publicIPAddresses/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-VIPAvailabityAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_alz_monitor\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for Public IP Address VIP Availability\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"VipAvailability\",\n                            \"metricNamespace\": \"Microsoft.Network/publicIPAddresses\",\n                            \"metricName\": \"VipAvailability\",\n                            \"operator\": \"LessThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[parameters('threshold')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#35": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_RecoveryVault_BackupHealthMonitor_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy RV Backup Health Monitoring Alerts\",\n    \"description\": \"Policy to audit/update Recovery Vault Backup Health Alerting to Azure monitor alerts\",\n    \"metadata\": {\n      \"version\": \"1.0.0\",\n      \"category\": \"Site Recovery\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_alz_monitor\": \"True\"\n    },\n    \"parameters\": {\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"modify\",\n          \"audit\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"modify\"\n      },\n      \"MonitorDisable\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.RecoveryServices/Vaults\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\n            \"notEquals\": \"true\"\n          },\n          {\n            \"field\": \"Microsoft.RecoveryServices/vaults/monitoringSettings.azureMonitorAlertSettings.alertsForAllJobFailures\",\n            \"notEquals\": \"Enabled\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"conflictEffect\": \"audit\",\n          \"operations\": [\n            {\n              \"operation\": \"addOrReplace\",\n              \"field\": \"Microsoft.RecoveryServices/vaults/monitoringSettings.classicAlertSettings.alertsForCriticalOperations\",\n              \"value\": \"Disabled\"\n            },\n            {\n              \"operation\": \"addOrReplace\",\n              \"field\": \"Microsoft.RecoveryServices/vaults/monitoringSettings.azureMonitorAlertSettings.alertsForAllJobFailures\",\n              \"value\": \"Enabled\"\n            }\n          ]\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#36": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_StorageAccount_Availability_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy SA Availability Alert\",\n    \"description\": \"Policy to audit/deploy SA Availability Alert\",\n    \"metadata\": {\n      \"version\": \"1.0.1\",\n      \"category\": \"Storage\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_alz_monitor\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"1\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"90\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisable\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Storage/storageAccounts\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\n            \"notEquals\": \"true\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Storage/storageAccounts\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"Availability\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Storage/storageAccounts/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-AvailabilityAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_alz_monitor\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for Storage Account Availability\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"Availability\",\n                            \"metricNamespace\": \"Microsoft.Storage/storageAccounts\",\n                            \"metricName\": \"Availability\",\n                            \"operator\": \"LessThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[parameters('threshold')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#37": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_VM_AvailableMemory_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy VM Available Memory Alert\",\n    \"description\": \"Policy to audit/deploy VM Available Memory Alert\",\n    \"metadata\": {\n      \"version\": \"1.0.1\",\n      \"category\": \"Compute\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_alz_monitor\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"2\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"1000\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"disabled\"\n      },\n      \"MonitorDisable\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\n            \"notEquals\": \"true\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"Available Memory Bytes\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Compute/virtualMachines/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-AvailableMemoryAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_alz_monitor\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for Virtual Machine Available Memory (MBytes)\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"Average_AvailableMBytes\",\n                            \"metricNamespace\": \"Microsoft.Compute/virtualMachines\",\n                            \"metricName\": \"Available Memory Bytes\",\n                            \"operator\": \"LessThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[parameters('threshold')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#38": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_VM_dataDiskReadLatency_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy VM Data Disk Read Latency Alert\",\n    \"description\": \"Policy to audit/deploy VM dataDiskReadLatency Alert\",\n    \"metadata\": {\n      \"version\": \"1.0.0\",\n      \"category\": \"Compute\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_alz_monitor\": \"True\"\n    },\n    \"parameters\": {\n      \"alertResourceGroupName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Resource Group Name\",\n          \"description\": \"Resource group the alert is placed in\"\n        },\n        \"defaultValue\": \"AlzMonitoring-rg\"\n      },\n      \"alertResourceGroupTags\": {\n        \"type\": \"Object\",\n        \"metadata\": {\n          \"displayName\": \"Resource Group Tags\",\n          \"description\": \"Tags on the Resource group the alert is placed in\"\n        },\n        \"defaultValue\": {\n          \"environment\": \"test\"\n        }\n      },\n      \"alertResourceGroupLocation\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Resource Group Location\",\n          \"description\": \"Location of the Resource group the alert is placed in\"\n        },\n        \"defaultValue\": \"centralus\"\n      },\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"2\"\n      },\n      \"operator\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Operator\"\n        },\n        \"allowedvalues\": [\n          \"Equals\",\n          \"GreaterThan\",\n          \"GreaterThanOrEqual\",\n          \"LessThan\",\n          \"LessThanOrEqual\"\n        ],\n        \"defaultvalue\": \"GreaterThan\"\n      },\n      \"timeAggregation\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"TimeAggregation\"\n        },\n        \"allowedValues\": [\n          \"Average\",\n          \"Count\",\n          \"Maximum\",\n          \"Minimum\",\n          \"Total\"\n        ],\n        \"defaultvalue\": \"Average\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"PT24H\"\n        ],\n        \"defaultValue\": \"PT15M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"autoResolve\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Resolve\",\n          \"description\": \"Auto Resolve for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"autoResolveTime\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Resolve\",\n          \"description\": \"Auto Resolve time for the alert in ISO 8601 format\"\n        },\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"30\"\n      },\n      \"failingPeriods\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"disaplayname\": \"Failing Periods\",\n          \"description\": \"Number of failing periods before alert is fired\"\n        },\n        \"defaultValue\": \"1\"\n      },\n      \"evaluationPeriods\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayname\": \"Evaluation Periods\",\n          \"description\": \"The number of aggregated lookback points.\"\n        },\n        \"defaultValue\": \"1\"\n      },\n      \"computersToInclude\": {\n        \"type\": \"array\",\n        \"metadata\": {\n          \"displayname\": \"Disks to be included to be monitored\",\n          \"description\": \"Array of Computer to be monitored\"\n        },\n        \"defaultValue\": [\n          \"*\"\n        ]\n      },\n      \"disksToInclude\": {\n        \"type\": \"array\",\n        \"metadata\": {\n          \"displayname\": \"Disks to be included to be monitored\",\n          \"description\": \"Array of disk to be monitored for disk both windows and linux\"\n        },\n        \"defaultValue\": [\n          \"*\"\n        ]\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"type\": \"Microsoft.Insights/scheduledQueryRules\",\n          \"existenceScope\": \"resourcegroup\",\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\n          \"deploymentScope\": \"subscription\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/displayName\",\n                \"equals\": \"[[concat(subscription().displayName, '-VMLowdataDiskReadLatencyAlert')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/scopes[*]\",\n                \"equals\": \"[[subscription().id]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"location\": \"[[deployment().location]\",\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"alertResourceGroupName\": {\n                    \"type\": \"string\"\n                  },\n                  \"alertResourceGroupTags\": {\n                    \"type\": \"object\"\n                  },\n                  \"alertResourceGroupLocation\": {\n                    \"type\": \"string\"\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoResolve\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoResolveTime\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  },\n                  \"operator\": {\n                    \"type\": \"String\"\n                  },\n                  \"timeAggregation\": {\n                    \"type\": \"String\"\n                  },\n                  \"failingPeriods\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationPeriods\": {\n                    \"type\": \"String\"\n                  },\n                  \"disksToInclude\": {\n                    \"type\": \"array\"\n                  },\n                  \"computersToInclude\": {\n                    \"type\": \"array\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\n                    \"apiVersion\": \"2021-04-01\",\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\n                  },\n                  {\n                    \"type\": \"Microsoft.Resources/deployments\",\n                    \"apiVersion\": \"2019-10-01\",\n                    \"name\": \"VMdataDiskReadLatencyAlert\",\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\n                    \"dependsOn\": [\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\n                    ],\n                    \"properties\": {\n                      \"mode\": \"Incremental\",\n                      \"template\": {\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                        \"contentVersion\": \"1.0.0.0\",\n                        \"parameters\": {\n                          \"enabled\": {\n                            \"type\": \"string\"\n                          },\n                          \"alertResourceGroupName\": {\n                            \"type\": \"string\"\n                          },\n                          \"alertResourceGroupLocation\": {\n                            \"type\": \"string\"\n                          }\n                        },\n                        \"variables\": {},\n                        \"resources\": [\n                          {\n                            \"type\": \"Microsoft.Insights/scheduledQueryRules\",\n                            \"apiVersion\": \"2022-08-01-preview\",\n                            \"name\": \"[[concat(subscription().displayName, '-VMHighdataDiskReadLatencyAlert')]\",\n                            \"location\": \"[[parameters('alertResourceGroupLocation')]\",\n                            \"properties\": {\n                              \"displayName\": \"[[concat(subscription().displayName, '-VMHighdataDiskReadLatencyAlert')]\",\n                              \"description\": \"Log Alert for Virtual Machine dataDiskReadLatency\",\n                              \"severity\": \"[[parameters('severity')]\",\n                              \"enabled\": \"[[parameters('enabled')]\",\n                              \"scopes\": [\n                                \"[[subscription().Id]\"\n                              ],\n                              \"targetResourceTypes\": [\n                                \"Microsoft.Compute/virtualMachines\"\n                              ],\n                              \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                              \"windowSize\": \"[[parameters('windowSize')]\",\n                              \"criteria\": {\n                                \"allOf\": [\n                                  {\n                                    \"query\": \"InsightsMetrics| where Origin == \\\"vm.azm.ms\\\"| where Namespace == \\\"LogicalDisk\\\" and Name == \\\"ReadLatencyMs\\\"| extend Disk=tostring(todynamic(Tags)[\\\"vm.azm.ms/mountId\\\"])|where Disk !in ('C:','/')| summarize AggregatedValue = avg(Val) by bin(TimeGenerated, 15m), Computer, _ResourceId, Disk\",\n                                    \"metricMeasureColumn\": \"AggregatedValue\",\n                                    \"threshold\": \"[[parameters('threshold')]\",\n                                    \"operator\": \"[[parameters('operator')]\",\n                                    \"resourceIdColumn\": \"_ResourceId\",\n                                    \"timeAggregation\": \"[[parameters('timeAggregation')]\",\n                                    \"dimensions\": [\n                                      {\n                                        \"name\": \"Computer\",\n                                        \"operator\": \"Include\",\n                                        \"values\": \"[[parameters('computersToInclude')]\"\n                                      },\n                                      {\n                                        \"name\": \"Disk\",\n                                        \"operator\": \"Include\",\n                                        \"values\": \"[[parameters('disksToInclude')]\"\n                                      }\n                                    ],\n                                    \"failingPeriods\": {\n                                      \"numberOfEvaluationPeriods\": \"[[parameters('evaluationPeriods')]\",\n                                      \"minFailingPeriodsToAlert\": \"[[parameters('failingPeriods')]\"\n                                    }\n                                  }\n                                ]\n                              },\n                              \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                              \"ruleResolveConfiguration\": {\n                                \"autoResolved\": \"[[parameters('autoResolve')]\",\n                                \"timeToResolve\": \"[[parameters('autoResolveTime')]\"\n                              },\n                              \"parameters\": {\n                                \"alertResourceGroupName\": {\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\n                                },\n                                \"alertResourceGroupLocation\": {\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\n                                },\n                                \"severity\": {\n                                  \"value\": \"[[parameters('severity')]\"\n                                },\n                                \"windowSize\": {\n                                  \"value\": \"[[parameters('windowSize')]\"\n                                },\n                                \"evaluationFrequency\": {\n                                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                                },\n                                \"autoMitigate\": {\n                                  \"value\": \"[[parameters('autoMitigate')]\"\n                                },\n                                \"autoResolve\": {\n                                  \"value\": \"[[parameters('autoResolve')]\"\n                                },\n                                \"autoResolveTime\": {\n                                  \"value\": \"[[parameters('autoResolveTime')]\"\n                                },\n                                \"enabled\": {\n                                  \"value\": \"[[parameters('enabled')]\"\n                                },\n                                \"threshold\": {\n                                  \"value\": \"[[parameters('threshold')]\"\n                                },\n                                \"failingPeriods\": {\n                                  \"value\": \"[[parameters('failingPeriods')]\"\n                                },\n                                \"evaluationPeriods\": {\n                                  \"value\": \"[[parameters('evaluationPeriods')]\"\n                                },\n                                \"disksToInclude\": {\n                                  \"value\": \"[[parameters('disksToInclude')]\"\n                                },\n                                \"computersToInclude\": {\n                                  \"value\": \"[[parameters('computersToInclude')]\"\n                                }\n                              }\n                            }\n                          }\n                        ]\n                      },\n                      \"parameters\": {\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"alertResourceGroupName\": {\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\n                        },\n                        \"alertResourceGroupLocation\": {\n                          \"value\": \"[[parameters('alertResourceGroupLocation')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"alertResourceGroupName\": {\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\n                },\n                \"alertResourceGroupTags\": {\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\n                },\n                \"alertResourceGroupLocation\": {\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"autoResolve\": {\n                  \"value\": \"[[parameters('autoResolve')]\"\n                },\n                \"autoResolveTime\": {\n                  \"value\": \"[[parameters('autoResolveTime')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[parameters('threshold')]\"\n                },\n                \"operator\": {\n                  \"value\": \"[[parameters('operator')]\"\n                },\n                \"timeAggregation\": {\n                  \"value\": \"[[parameters('timeAggregation')]\"\n                },\n                \"failingPeriods\": {\n                  \"value\": \"[[parameters('failingPeriods')]\"\n                },\n                \"evaluationPeriods\": {\n                  \"value\": \"[[parameters('evaluationPeriods')]\"\n                },\n                \"disksToInclude\": {\n                  \"value\": \"[[parameters('disksToInclude')]\"\n                },\n                \"computersToInclude\": {\n                  \"value\": \"[[parameters('computersToInclude')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#39": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_VM_dataDiskSpace_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy VM Data Disk Space Alert\",\n    \"description\": \"Policy to audit/deploy VM data Disk Space Alert\",\n    \"metadata\": {\n      \"version\": \"1.0.0\",\n      \"category\": \"Compute\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_alz_monitor\": \"True\"\n    },\n    \"parameters\": {\n      \"alertResourceGroupName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Resource Group Name\",\n          \"description\": \"Resource group the alert is placed in\"\n        },\n        \"defaultValue\": \"AlzMonitoring-rg\"\n      },\n      \"alertResourceGroupTags\": {\n        \"type\": \"Object\",\n        \"metadata\": {\n          \"displayName\": \"Resource Group Tags\",\n          \"description\": \"Tags on the Resource group the alert is placed in\"\n        },\n        \"defaultValue\": {\n          \"environment\": \"test\"\n        }\n      },\n      \"alertResourceGroupLocation\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Resource Group Location\",\n          \"description\": \"Location of the Resource group the alert is placed in\"\n        },\n        \"defaultValue\": \"centralus\"\n      },\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"2\"\n      },\n      \"operator\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Operator\"\n        },\n        \"allowedvalues\": [\n          \"Equals\",\n          \"GreaterThan\",\n          \"GreaterThanOrEqual\",\n          \"LessThan\",\n          \"LessThanOrEqual\"\n        ],\n        \"defaultvalue\": \"LessThan\"\n      },\n      \"timeAggregation\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"TimeAggregation\"\n        },\n        \"allowedValues\": [\n          \"Average\",\n          \"Count\",\n          \"Maximum\",\n          \"Minimum\",\n          \"Total\"\n        ],\n        \"defaultvalue\": \"Average\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"PT24H\"\n        ],\n        \"defaultValue\": \"PT15M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"autoResolve\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Resolve\",\n          \"description\": \"Auto Resolve for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"autoResolveTime\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Resolve\",\n          \"description\": \"Auto Resolve time for the alert in ISO 8601 format\"\n        },\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"10\"\n      },\n      \"failingPeriods\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"disaplayname\": \"Failing Periods\",\n          \"description\": \"Number of failing periods before alert is fired\"\n        },\n        \"defaultValue\": \"1\"\n      },\n      \"evaluationPeriods\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"disaplayname\": \"Evaluation Periods\",\n          \"description\": \"The number of aggregated lookback points.\"\n        },\n        \"defaultValue\": \"1\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"disksToInclude\": {\n        \"type\": \"array\",\n        \"metadata\": {\n          \"displayname\": \"Disks to be included to be monitored\",\n          \"description\": \"Array of disk to be monitored for disk both Windows and Linux\"\n        },\n        \"defaultValue\": [\n          \"*\"\n        ]\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"type\": \"Microsoft.Insights/scheduledQueryRules\",\n          \"existenceScope\": \"resourcegroup\",\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\n          \"deploymentScope\": \"subscription\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/displayName\",\n                \"equals\": \"[[concat(subscription().displayName, '-VMLowdataDiskSpaceAlert')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/scopes[*]\",\n                \"equals\": \"[[subscription().id]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"location\": \"[[deployment().location]\",\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"alertResourceGroupName\": {\n                    \"type\": \"string\"\n                  },\n                  \"alertResourceGroupTags\": {\n                    \"type\": \"object\"\n                  },\n                  \"alertResourceGroupLocation\": {\n                    \"type\": \"string\"\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoResolve\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoResolveTime\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  },\n                  \"operator\": {\n                    \"type\": \"String\"\n                  },\n                  \"timeAggregation\": {\n                    \"type\": \"String\"\n                  },\n                  \"failingPeriods\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationPeriods\": {\n                    \"type\": \"String\"\n                  },\n                  \"disksToInclude\": {\n                    \"type\": \"array\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\n                    \"apiVersion\": \"2021-04-01\",\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\n                  },\n                  {\n                    \"type\": \"Microsoft.Resources/deployments\",\n                    \"apiVersion\": \"2019-10-01\",\n                    \"name\": \"VMdataDiskSpaceAlert\",\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\n                    \"dependsOn\": [\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\n                    ],\n                    \"properties\": {\n                      \"mode\": \"Incremental\",\n                      \"template\": {\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                        \"contentVersion\": \"1.0.0.0\",\n                        \"parameters\": {\n                          \"enabled\": {\n                            \"type\": \"string\"\n                          },\n                          \"alertResourceGroupName\": {\n                            \"type\": \"string\"\n                          },\n                          \"alertResourceGroupLocation\": {\n                            \"type\": \"string\"\n                          }\n                        },\n                        \"variables\": {},\n                        \"resources\": [\n                          {\n                            \"type\": \"Microsoft.Insights/scheduledQueryRules\",\n                            \"apiVersion\": \"2022-08-01-preview\",\n                            \"name\": \"[[concat(subscription().displayName, '-VMLowdataDiskSpaceAlert')]\",\n                            \"location\": \"[[parameters('alertResourceGroupLocation')]\",\n                            \"properties\": {\n                              \"displayName\": \"[[concat(subscription().displayName, '-VMLowdataDiskSpaceAlert')]\",\n                              \"description\": \"Log Alert for Virtual Machine dataDiskSpace\",\n                              \"severity\": \"[[parameters('severity')]\",\n                              \"enabled\": \"[[parameters('enabled')]\",\n                              \"scopes\": [\n                                \"[[subscription().Id]\"\n                              ],\n                              \"targetResourceTypes\": [\n                                \"Microsoft.Compute/virtualMachines\"\n                              ],\n                              \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                              \"windowSize\": \"[[parameters('windowSize')]\",\n                              \"criteria\": {\n                                \"allOf\": [\n                                  {\n                                    \"query\": \"InsightsMetrics| where Origin == \\\"vm.azm.ms\\\"| where Namespace == \\\"LogicalDisk\\\" and Name == \\\"FreeSpacePercentage\\\"| extend Disk=tostring(todynamic(Tags)[\\\"vm.azm.ms/mountId\\\"])|where Disk !in ('C:','/')| summarize AggregatedValue = avg(Val) by bin(TimeGenerated, 15m), Computer, _ResourceId, Disk\",\n                                    \"metricMeasureColumn\": \"AggregatedValue\",\n                                    \"threshold\": \"[[parameters('threshold')]\",\n                                    \"operator\": \"[[parameters('operator')]\",\n                                    \"resourceIdColumn\": \"_ResourceId\",\n                                    \"timeAggregation\": \"[[parameters('timeAggregation')]\",\n                                    \"dimensions\": [\n                                      {\n                                        \"name\": \"Computer\",\n                                        \"operator\": \"Include\",\n                                        \"values\": [\n                                          \"*\"\n                                        ]\n                                      },\n                                      {\n                                        \"name\": \"Disk\",\n                                        \"operator\": \"Include\",\n                                        \"values\": \"[[parameters('disksToInclude')]\"\n                                      }\n                                    ],\n                                    \"failingPeriods\": {\n                                      \"numberOfEvaluationPeriods\": \"[[parameters('evaluationPeriods')]\",\n                                      \"minFailingPeriodsToAlert\": \"[[parameters('failingPeriods')]\"\n                                    }\n                                  }\n                                ]\n                              },\n                              \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                              \"ruleResolveConfiguration\": {\n                                \"autoResolved\": \"[[parameters('autoResolve')]\",\n                                \"timeToResolve\": \"[[parameters('autoResolveTime')]\"\n                              },\n                              \"parameters\": {\n                                \"alertResourceGroupName\": {\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\n                                },\n                                \"alertResourceGroupLocation\": {\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\n                                },\n                                \"severity\": {\n                                  \"value\": \"[[parameters('severity')]\"\n                                },\n                                \"windowSize\": {\n                                  \"value\": \"[[parameters('windowSize')]\"\n                                },\n                                \"evaluationFrequency\": {\n                                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                                },\n                                \"autoMitigate\": {\n                                  \"value\": \"[[parameters('autoMitigate')]\"\n                                },\n                                \"autoResolve\": {\n                                  \"value\": \"[[parameters('autoResolve')]\"\n                                },\n                                \"autoResolveTime\": {\n                                  \"value\": \"[[parameters('autoResolveTime')]\"\n                                },\n                                \"enabled\": {\n                                  \"value\": \"[[parameters('enabled')]\"\n                                },\n                                \"threshold\": {\n                                  \"value\": \"[[parameters('threshold')]\"\n                                },\n                                \"failingPeriods\": {\n                                  \"value\": \"[[parameters('failingPeriods')]\"\n                                },\n                                \"evaluationPeriods\": {\n                                  \"value\": \"[[parameters('evaluationPeriods')]\"\n                                },\n                                \"disksToInclude\": {\n                                  \"value\": \"[[parameters('disksToInclude')]\"\n                                }\n                              }\n                            }\n                          }\n                        ]\n                      },\n                      \"parameters\": {\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"alertResourceGroupName\": {\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\n                        },\n                        \"alertResourceGroupLocation\": {\n                          \"value\": \"[[parameters('alertResourceGroupLocation')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"alertResourceGroupName\": {\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\n                },\n                \"alertResourceGroupTags\": {\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\n                },\n                \"alertResourceGroupLocation\": {\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"autoResolve\": {\n                  \"value\": \"[[parameters('autoResolve')]\"\n                },\n                \"autoResolveTime\": {\n                  \"value\": \"[[parameters('autoResolveTime')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[parameters('threshold')]\"\n                },\n                \"operator\": {\n                  \"value\": \"[[parameters('operator')]\"\n                },\n                \"timeAggregation\": {\n                  \"value\": \"[[parameters('timeAggregation')]\"\n                },\n                \"failingPeriods\": {\n                  \"value\": \"[[parameters('failingPeriods')]\"\n                },\n                \"evaluationPeriods\": {\n                  \"value\": \"[[parameters('evaluationPeriods')]\"\n                },\n                \"disksToInclude\": {\n                  \"value\": \"[[parameters('disksToInclude')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#4": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_activitylog_LAWorkspace_KeyRegen\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy Activity Log LA Workspace Regenerate Key Alert\",\r\n    \"description\": \"Policy to Deploy Activity Log LA Workspace Regenerate Key Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Monitoring\",\r\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_alz_monitor\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"alertResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Name\",\r\n          \"description\": \"Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"AlzMonitoring-rg\"\r\n      },\r\n      \"alertResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Tags\",\r\n          \"description\": \"Tags on the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": {\r\n          \"environment\": \"test\",\r\n          \"_deployed_by_alz_monitor\": true\r\n        }\r\n      },\r\n      \"alertResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Location\",\r\n          \"description\": \"Location of the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"centralus\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring on resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.OperationalInsights/workspaces\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/activityLogAlerts\",\r\n          \"name\": \"ActivityLAWorkspaceRegenKey\",\r\n          \"existenceScope\": \"resourceGroup\",\r\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\r\n          \"deploymentScope\": \"subscription\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/ActivityLogAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              },\r\n              {\r\n                \"count\": {\r\n                  \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*]\",\r\n                  \"where\": {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].field\",\r\n                            \"equals\": \"category\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].equals\",\r\n                            \"equals\": \"Administrative\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"microsoft.insights/activityLogAlerts/condition.allOf[*].field\",\r\n                            \"equals\": \"operationName\"\r\n                          },\r\n                          {\r\n                            \"field\": \"microsoft.insights/activityLogAlerts/condition.allOf[*].equals\",\r\n                            \"equals\": \"Microsoft.OperationalInsights/workspaces/regeneratesharedkey/action\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                },\r\n                \"equals\": 2\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"location\": \"[[deployment().location]\",\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"alertResourceGroupName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"alertResourceGroupTags\": {\r\n                    \"type\": \"object\"\r\n                  },\r\n                  \"alertResourceGroupLocation\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\r\n                    \"apiVersion\": \"2021-04-01\",\r\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\r\n                  },\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/deployments\",\r\n                    \"apiVersion\": \"2019-10-01\",\r\n                    \"name\": \"ActivityLAWorkspaceRegenKey\",\r\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"dependsOn\": [\r\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\r\n                    ],\r\n                    \"properties\": {\r\n                      \"mode\": \"Incremental\",\r\n                      \"template\": {\r\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                        \"contentVersion\": \"1.0.0.0\",\r\n                        \"parameters\": {\r\n                          \"enabled\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupName\": {\r\n                            \"type\": \"string\"\r\n                          }\r\n                        },\r\n                        \"variables\": {},\r\n                        \"resources\": [\r\n                          {\r\n                            \"type\": \"microsoft.insights/activityLogAlerts\",\r\n                            \"apiVersion\": \"2020-10-01\",\r\n                            \"name\": \"ActivityLAWorkspaceRegenKey\",\r\n                            \"location\": \"global\",\r\n                            \"tags\": {\r\n                              \"_deployed_by_alz_monitor\": true\r\n                            },\r\n                            \"properties\": {\r\n                              \"description\": \"Activity Log LA Workspace Regenerate Key\",\r\n                              \"enabled\": \"[[parameters('enabled')]\",\r\n                              \"scopes\": [\r\n                                \"[[subscription().id]\"\r\n                              ],\r\n                              \"condition\": {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"category\",\r\n                                    \"equals\": \"Administrative\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"operationName\",\r\n                                    \"equals\": \"Microsoft.OperationalInsights/workspaces/regeneratesharedkey/action\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"status\",\r\n                                    \"containsAny\": [\r\n                                      \"succeeded\"\r\n                                    ]\r\n                                  }\r\n                                ]\r\n                              },\r\n                              \"parameters\": {\r\n                                \"enabled\": {\r\n                                  \"value\": \"[[parameters('enabled')]\"\r\n                                }\r\n                              }\r\n                            }\r\n                          }\r\n                        ]\r\n                      },\r\n                      \"parameters\": {\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"alertResourceGroupName\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"alertResourceGroupName\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                },\r\n                \"alertResourceGroupTags\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\r\n                },\r\n                \"alertResourceGroupLocation\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#40": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_VM_dataDiskWriteLatency_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy VM Data Disk Write Latency Alert\",\n    \"description\": \"Policy to audit/deploy VM dataDiskWriteLatency Alert\",\n    \"metadata\": {\n      \"version\": \"1.0.0\",\n      \"category\": \"Compute\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_alz_monitor\": \"True\"\n    },\n    \"parameters\": {\n      \"alertResourceGroupName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Resource Group Name\",\n          \"description\": \"Resource group the alert is placed in\"\n        },\n        \"defaultValue\": \"AlzMonitoring-rg\"\n      },\n      \"alertResourceGroupTags\": {\n        \"type\": \"Object\",\n        \"metadata\": {\n          \"displayName\": \"Resource Group Tags\",\n          \"description\": \"Tags on the Resource group the alert is placed in\"\n        },\n        \"defaultValue\": {\n          \"environment\": \"test\"\n        }\n      },\n      \"alertResourceGroupLocation\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Resource Group Location\",\n          \"description\": \"Location of the Resource group the alert is placed in\"\n        },\n        \"defaultValue\": \"centralus\"\n      },\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"2\"\n      },\n      \"operator\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Operator\"\n        },\n        \"allowedvalues\": [\n          \"Equals\",\n          \"GreaterThan\",\n          \"GreaterThanOrEqual\",\n          \"LessThan\",\n          \"LessThanOrEqual\"\n        ],\n        \"defaultvalue\": \"GreaterThan\"\n      },\n      \"timeAggregation\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"TimeAggregation\"\n        },\n        \"allowedValues\": [\n          \"Average\",\n          \"Count\",\n          \"Maximum\",\n          \"Minimum\",\n          \"Total\"\n        ],\n        \"defaultvalue\": \"Average\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"PT24H\"\n        ],\n        \"defaultValue\": \"PT15M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"autoResolve\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Resolve\",\n          \"description\": \"Auto Resolve for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"autoResolveTime\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Resolve\",\n          \"description\": \"Auto Resolve time for the alert in ISO 8601 format\"\n        },\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"30\"\n      },\n      \"failingPeriods\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"disaplayname\": \"Failing Periods\",\n          \"description\": \"Number of failing periods before alert is fired\"\n        },\n        \"defaultValue\": \"1\"\n      },\n      \"evaluationPeriods\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayname\": \"Evaluation Periods\",\n          \"description\": \"The number of aggregated lookback points.\"\n        },\n        \"defaultValue\": \"1\"\n      },\n      \"computersToInclude\": {\n        \"type\": \"array\",\n        \"metadata\": {\n          \"displayname\": \"Disks to be included to be monitored\",\n          \"description\": \"Array of Computer to be monitored\"\n        },\n        \"defaultValue\": [\n          \"*\"\n        ]\n      },\n      \"disksToInclude\": {\n        \"type\": \"array\",\n        \"metadata\": {\n          \"displayname\": \"Disks to be included to be monitored\",\n          \"description\": \"Array of disk to be monitored for disk both windows and linux\"\n        },\n        \"defaultValue\": [\n          \"*\"\n        ]\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"type\": \"Microsoft.Insights/scheduledQueryRules\",\n          \"existenceScope\": \"resourcegroup\",\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\n          \"deploymentScope\": \"subscription\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/displayName\",\n                \"equals\": \"[[concat(subscription().displayName, '-VMLowdataDiskWriteLatencyAlert')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/scopes[*]\",\n                \"equals\": \"[[subscription().id]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"location\": \"[[deployment().location]\",\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"alertResourceGroupName\": {\n                    \"type\": \"string\"\n                  },\n                  \"alertResourceGroupTags\": {\n                    \"type\": \"object\"\n                  },\n                  \"alertResourceGroupLocation\": {\n                    \"type\": \"string\"\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoResolve\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoResolveTime\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  },\n                  \"operator\": {\n                    \"type\": \"String\"\n                  },\n                  \"timeAggregation\": {\n                    \"type\": \"String\"\n                  },\n                  \"failingPeriods\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationPeriods\": {\n                    \"type\": \"String\"\n                  },\n                  \"disksToInclude\": {\n                    \"type\": \"array\"\n                  },\n                  \"computersToInclude\": {\n                    \"type\": \"array\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\n                    \"apiVersion\": \"2021-04-01\",\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\n                  },\n                  {\n                    \"type\": \"Microsoft.Resources/deployments\",\n                    \"apiVersion\": \"2019-10-01\",\n                    \"name\": \"VMdataDiskWriteLatencyAlert\",\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\n                    \"dependsOn\": [\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\n                    ],\n                    \"properties\": {\n                      \"mode\": \"Incremental\",\n                      \"template\": {\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                        \"contentVersion\": \"1.0.0.0\",\n                        \"parameters\": {\n                          \"enabled\": {\n                            \"type\": \"string\"\n                          },\n                          \"alertResourceGroupName\": {\n                            \"type\": \"string\"\n                          },\n                          \"alertResourceGroupLocation\": {\n                            \"type\": \"string\"\n                          }\n                        },\n                        \"variables\": {},\n                        \"resources\": [\n                          {\n                            \"type\": \"Microsoft.Insights/scheduledQueryRules\",\n                            \"apiVersion\": \"2022-08-01-preview\",\n                            \"name\": \"[[concat(subscription().displayName, '-VMHighdataDiskWriteLatencyAlert')]\",\n                            \"location\": \"[[parameters('alertResourceGroupLocation')]\",\n                            \"properties\": {\n                              \"displayName\": \"[[concat(subscription().displayName, '-VMHighdataDiskWriteLatencyAlert')]\",\n                              \"description\": \"Log Alert for Virtual Machine dataDiskWriteLatency\",\n                              \"severity\": \"[[parameters('severity')]\",\n                              \"enabled\": \"[[parameters('enabled')]\",\n                              \"scopes\": [\n                                \"[[subscription().Id]\"\n                              ],\n                              \"targetResourceTypes\": [\n                                \"Microsoft.Compute/virtualMachines\"\n                              ],\n                              \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                              \"windowSize\": \"[[parameters('windowSize')]\",\n                              \"criteria\": {\n                                \"allOf\": [\n                                  {\n                                    \"query\": \"InsightsMetrics| where Origin == \\\"vm.azm.ms\\\"| where Namespace == \\\"LogicalDisk\\\" and Name == \\\"WriteLatencyMs\\\"| extend Disk=tostring(todynamic(Tags)[\\\"vm.azm.ms/mountId\\\"])|where Disk !in ('C:','/')| summarize AggregatedValue = avg(Val) by bin(TimeGenerated, 15m), Computer, _ResourceId, Disk\",\n                                    \"metricMeasureColumn\": \"AggregatedValue\",\n                                    \"threshold\": \"[[parameters('threshold')]\",\n                                    \"operator\": \"[[parameters('operator')]\",\n                                    \"resourceIdColumn\": \"_ResourceId\",\n                                    \"timeAggregation\": \"[[parameters('timeAggregation')]\",\n                                    \"dimensions\": [\n                                      {\n                                        \"name\": \"Computer\",\n                                        \"operator\": \"Include\",\n                                        \"values\": \"[[parameters('computersToInclude')]\"\n                                      },\n                                      {\n                                        \"name\": \"Disk\",\n                                        \"operator\": \"Include\",\n                                        \"values\": \"[[parameters('disksToInclude')]\"\n                                      }\n                                    ],\n                                    \"failingPeriods\": {\n                                      \"numberOfEvaluationPeriods\": \"[[parameters('evaluationPeriods')]\",\n                                      \"minFailingPeriodsToAlert\": \"[[parameters('failingPeriods')]\"\n                                    }\n                                  }\n                                ]\n                              },\n                              \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                              \"ruleResolveConfiguration\": {\n                                \"autoResolved\": \"[[parameters('autoResolve')]\",\n                                \"timeToResolve\": \"[[parameters('autoResolveTime')]\"\n                              },\n                              \"parameters\": {\n                                \"alertResourceGroupName\": {\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\n                                },\n                                \"alertResourceGroupLocation\": {\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\n                                },\n                                \"severity\": {\n                                  \"value\": \"[[parameters('severity')]\"\n                                },\n                                \"windowSize\": {\n                                  \"value\": \"[[parameters('windowSize')]\"\n                                },\n                                \"evaluationFrequency\": {\n                                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                                },\n                                \"autoMitigate\": {\n                                  \"value\": \"[[parameters('autoMitigate')]\"\n                                },\n                                \"autoResolve\": {\n                                  \"value\": \"[[parameters('autoResolve')]\"\n                                },\n                                \"autoResolveTime\": {\n                                  \"value\": \"[[parameters('autoResolveTime')]\"\n                                },\n                                \"enabled\": {\n                                  \"value\": \"[[parameters('enabled')]\"\n                                },\n                                \"threshold\": {\n                                  \"value\": \"[[parameters('threshold')]\"\n                                },\n                                \"failingPeriods\": {\n                                  \"value\": \"[[parameters('failingPeriods')]\"\n                                },\n                                \"evaluationPeriods\": {\n                                  \"value\": \"[[parameters('evaluationPeriods')]\"\n                                },\n                                \"disksToInclude\": {\n                                  \"value\": \"[[parameters('disksToInclude')]\"\n                                },\n                                \"computersToInclude\": {\n                                  \"value\": \"[[parameters('computersToInclude')]\"\n                                }\n                              }\n                            }\n                          }\n                        ]\n                      },\n                      \"parameters\": {\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"alertResourceGroupName\": {\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\n                        },\n                        \"alertResourceGroupLocation\": {\n                          \"value\": \"[[parameters('alertResourceGroupLocation')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"alertResourceGroupName\": {\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\n                },\n                \"alertResourceGroupTags\": {\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\n                },\n                \"alertResourceGroupLocation\": {\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"autoResolve\": {\n                  \"value\": \"[[parameters('autoResolve')]\"\n                },\n                \"autoResolveTime\": {\n                  \"value\": \"[[parameters('autoResolveTime')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[parameters('threshold')]\"\n                },\n                \"operator\": {\n                  \"value\": \"[[parameters('operator')]\"\n                },\n                \"timeAggregation\": {\n                  \"value\": \"[[parameters('timeAggregation')]\"\n                },\n                \"failingPeriods\": {\n                  \"value\": \"[[parameters('failingPeriods')]\"\n                },\n                \"evaluationPeriods\": {\n                  \"value\": \"[[parameters('evaluationPeriods')]\"\n                },\n                \"disksToInclude\": {\n                  \"value\": \"[[parameters('disksToInclude')]\"\n                },\n                \"computersToInclude\": {\n                  \"value\": \"[[parameters('computersToInclude')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#41": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_VM_HeartBeat_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy VM HeartBeat Alert\",\n    \"description\": \"Policy to audit/deploy VM HeartBeat Alert for all VMs in the subscription\",\n    \"metadata\": {\n      \"version\": \"1.0.0\",\n      \"category\": \"Compute\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_alz_monitor\": \"True\"\n    },\n    \"parameters\": {\n      \"alertResourceGroupName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Resource Group Name\",\n          \"description\": \"Resource group the alert is placed in\"\n        },\n        \"defaultValue\": \"AlzMonitoring-rg\"\n      },\n      \"alertResourceGroupTags\": {\n        \"type\": \"Object\",\n        \"metadata\": {\n          \"displayName\": \"Resource Group Tags\",\n          \"description\": \"Tags on the Resource group the alert is placed in\"\n        },\n        \"defaultValue\": {\n          \"environment\": \"test\"\n        }\n      },\n      \"alertResourceGroupLocation\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Resource Group Location\",\n          \"description\": \"Location of the Resource group the alert is placed in\"\n        },\n        \"defaultValue\": \"centralus\"\n      },\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"1\"\n      },\n      \"operator\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Operator\"\n        },\n        \"allowedvalues\": [\n          \"Equals\",\n          \"GreaterThan\",\n          \"GreaterThanOrEqual\",\n          \"LessThan\",\n          \"LessThanOrEqual\"\n        ],\n        \"defaultvalue\": \"GreaterThan\"\n      },\n      \"timeAggregation\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"TimeAggregation\"\n        },\n        \"allowedValues\": [\n          \"Average\",\n          \"Count\",\n          \"Maximum\",\n          \"Minimum\",\n          \"Total\"\n        ],\n        \"defaultvalue\": \"Average\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"PT24H\"\n        ],\n        \"defaultValue\": \"PT15M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"autoResolve\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Resolve\",\n          \"description\": \"Auto Resolve for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"autoResolveTime\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Resolve\",\n          \"description\": \"Auto Resolve time for the alert in ISO 8601 format\"\n        },\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"10\"\n      },\n      \"failingPeriods\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"disaplayname\": \"Failing Periods\",\n          \"description\": \"Number of failing periods before alert is fired\"\n        },\n        \"defaultValue\": \"1\"\n      },\n      \"evaluationPeriods\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayname\": \"Evaluation Periods\",\n          \"description\": \"The number of aggregated lookback points.\"\n        },\n        \"defaultValue\": \"1\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"type\": \"Microsoft.Insights/scheduledQueryRules\",\n          \"existenceScope\": \"resourcegroup\",\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\n          \"deploymentScope\": \"subscription\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/displayName\",\n                \"equals\": \"[[concat(subscription().displayName, '-VMHeartBeatAlert')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/scopes[*]\",\n                \"equals\": \"[[subscription().id]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"location\": \"[[deployment().location]\",\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"alertResourceGroupName\": {\n                    \"type\": \"string\"\n                  },\n                  \"alertResourceGroupTags\": {\n                    \"type\": \"object\"\n                  },\n                  \"alertResourceGroupLocation\": {\n                    \"type\": \"string\"\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoResolve\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoResolveTime\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  },\n                  \"operator\": {\n                    \"type\": \"String\"\n                  },\n                  \"timeAggregation\": {\n                    \"type\": \"String\"\n                  },\n                  \"failingPeriods\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationPeriods\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\n                    \"apiVersion\": \"2021-04-01\",\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\n                  },\n                  {\n                    \"type\": \"Microsoft.Resources/deployments\",\n                    \"apiVersion\": \"2019-10-01\",\n                    \"name\": \"HeartBeatAlert\",\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\n                    \"dependsOn\": [\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\n                    ],\n                    \"properties\": {\n                      \"mode\": \"Incremental\",\n                      \"template\": {\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                        \"contentVersion\": \"1.0.0.0\",\n                        \"parameters\": {\n                          \"enabled\": {\n                            \"type\": \"string\"\n                          },\n                          \"alertResourceGroupName\": {\n                            \"type\": \"string\"\n                          },\n                          \"alertResourceGroupLocation\": {\n                            \"type\": \"string\"\n                          }\n                        },\n                        \"variables\": {},\n                        \"resources\": [\n                          {\n                            \"type\": \"Microsoft.Insights/scheduledQueryRules\",\n                            \"apiVersion\": \"2022-08-01-preview\",\n                            \"name\": \"[[concat(subscription().displayName, '-VMHeartBeatAlert')]\",\n                            \"location\": \"[[parameters('alertResourceGroupLocation')]\",\n                            \"properties\": {\n                              \"displayName\": \"[[concat(subscription().displayName, '-VMHeartBeatAlert')]\",\n                              \"description\": \"Log Alert for Virtual Machine Heartbeat\",\n                              \"severity\": \"[[parameters('severity')]\",\n                              \"enabled\": \"[[parameters('enabled')]\",\n                              \"scopes\": [\n                                \"[[subscription().Id]\"\n                              ],\n                              \"targetResourceTypes\": [\n                                \"Microsoft.Compute/virtualMachines\"\n                              ],\n                              \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                              \"windowSize\": \"[[parameters('windowSize')]\",\n                              \"criteria\": {\n                                \"allOf\": [\n                                  {\n                                    \"query\": \"Heartbeat| summarize TimeGenerated=max(TimeGenerated) by Computer, _ResourceId| extend Duration = datetime_diff('minute',now(),TimeGenerated)| summarize AggregatedValue = min(Duration) by Computer, bin(TimeGenerated,5m), _ResourceId\",\n                                    \"metricMeasureColumn\": \"AggregatedValue\",\n                                    \"threshold\": \"[[parameters('threshold')]\",\n                                    \"operator\": \"[[parameters('operator')]\",\n                                    \"resourceIdColumn\": \"_ResourceId\",\n                                    \"timeAggregation\": \"[[parameters('timeAggregation')]\",\n                                    \"dimensions\": [\n                                      {\n                                        \"name\": \"Computer\",\n                                        \"operator\": \"Include\",\n                                        \"values\": [\n                                          \"*\"\n                                        ]\n                                      }\n                                    ],\n                                    \"failingPeriods\": {\n                                      \"numberOfEvaluationPeriods\": \"[[parameters('evaluationPeriods')]\",\n                                      \"minFailingPeriodsToAlert\": \"[[parameters('failingPeriods')]\"\n                                    }\n                                  }\n                                ]\n                              },\n                              \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                              \"ruleResolveConfiguration\": {\n                                \"autoResolved\": \"[[parameters('autoResolve')]\",\n                                \"timeToResolve\": \"[[parameters('autoResolveTime')]\"\n                              },\n                              \"parameters\": {\n                                \"alertResourceGroupName\": {\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\n                                },\n                                \"alertResourceGroupLocation\": {\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\n                                },\n                                \"severity\": {\n                                  \"value\": \"[[parameters('severity')]\"\n                                },\n                                \"windowSize\": {\n                                  \"value\": \"[[parameters('windowSize')]\"\n                                },\n                                \"evaluationFrequency\": {\n                                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                                },\n                                \"autoMitigate\": {\n                                  \"value\": \"[[parameters('autoMitigate')]\"\n                                },\n                                \"autoResolve\": {\n                                  \"value\": \"[[parameters('autoResolve')]\"\n                                },\n                                \"autoResolveTime\": {\n                                  \"value\": \"[[parameters('autoResolveTime')]\"\n                                },\n                                \"enabled\": {\n                                  \"value\": \"[[parameters('enabled')]\"\n                                },\n                                \"threshold\": {\n                                  \"value\": \"[[parameters('threshold')]\"\n                                },\n                                \"failingPeriods\": {\n                                  \"value\": \"[[parameters('failingPeriods')]\"\n                                },\n                                \"evaluationPeriods\": {\n                                  \"value\": \"[[parameters('evaluationPeriods')]\"\n                                }\n                              }\n                            }\n                          }\n                        ]\n                      },\n                      \"parameters\": {\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"alertResourceGroupName\": {\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\n                        },\n                        \"alertResourceGroupLocation\": {\n                          \"value\": \"[[parameters('alertResourceGroupLocation')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"alertResourceGroupName\": {\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\n                },\n                \"alertResourceGroupTags\": {\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\n                },\n                \"alertResourceGroupLocation\": {\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"autoResolve\": {\n                  \"value\": \"[[parameters('autoResolve')]\"\n                },\n                \"autoResolveTime\": {\n                  \"value\": \"[[parameters('autoResolveTime')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[parameters('threshold')]\"\n                },\n                \"operator\": {\n                  \"value\": \"[[parameters('operator')]\"\n                },\n                \"timeAggregation\": {\n                  \"value\": \"[[parameters('timeAggregation')]\"\n                },\n                \"failingPeriods\": {\n                  \"value\": \"[[parameters('failingPeriods')]\"\n                },\n                \"evaluationPeriods\": {\n                  \"value\": \"[[parameters('evaluationPeriods')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#42": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_VM_HeartBeat_Alert_RG\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy VM HeartBeat Alert\",\r\n    \"description\": \"Policy to audit/deploy VM HeartBeat Alert for VMs in the resource group\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.0\",\r\n      \"category\": \"Compute\",\r\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_alz_monitor\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"operator\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Operator\"\r\n        },\r\n        \"allowedvalues\": [\r\n          \"Equals\",\r\n          \"GreaterThan\",\r\n          \"GreaterThanOrEqual\",\r\n          \"LessThan\",\r\n          \"LessThanOrEqual\"\r\n        ],\r\n        \"defaultvalue\": \"GreaterThan\"\r\n      },\r\n      \"timeAggregation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"TimeAggregation\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Average\",\r\n          \"Count\",\r\n          \"Maximum\",\r\n          \"Minimum\",\r\n          \"Total\"\r\n        ],\r\n        \"defaultvalue\": \"Average\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"PT24H\"\r\n        ],\r\n        \"defaultValue\": \"PT15M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"autoResolve\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Resolve\",\r\n          \"description\": \"Auto Resolve for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"autoResolveTime\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Resolve\",\r\n          \"description\": \"Auto Resolve time for the alert in ISO 8601 format\"\r\n        },\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"10\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/scheduledQueryRules\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/displayName\",\r\n                \"equals\": \"[[concat(resourceGroup().name, '-VMHeartBeatAlert')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name)]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoResolve\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoResolveTime\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"operator\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"timeAggregation\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/scheduledQueryRules\",\r\n                    \"apiVersion\": \"2022-08-01-preview\",\r\n                    \"name\": \"[[concat(resourceGroup().name, '-VMHeartBeatAlert')]\",\r\n                    \"location\": \"[[resourceGroup().location]\",\r\n                    \"properties\": {\r\n                      \"displayName\": \"[[concat(resourceGroup().name, '-VMHeartBeatAlert')]\",\r\n                      \"description\": \"Log Alert for Virtual Machine Heartbeat\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[resourceGroup().Id]\"\r\n                      ],\r\n                      \"targetResourceTypes\": [\r\n                        \"Microsoft.Compute/virtualMachines\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"query\": \"Heartbeat| summarize TimeGenerated=max(TimeGenerated) by Computer, _ResourceId| extend Duration = datetime_diff('minute',now(),TimeGenerated)| summarize AggregatedValue = min(Duration) by Computer, bin(TimeGenerated,5m), _ResourceId\",\r\n                            \"metricMeasureColumn\": \"AggregatedValue\",\r\n                            \"threshold\": \"[[parameters('threshold')]\",\r\n                            \"operator\": \"[[parameters('operator')]\",\r\n                            \"resourceIdColumn\": \"_ResourceId\",\r\n                            \"timeAggregation\": \"[[parameters('timeAggregation')]\",\r\n                            \"dimensions\": [\r\n                              {\r\n                                \"name\": \"Computer\",\r\n                                \"operator\": \"Include\",\r\n                                \"values\": [\r\n                                  \"*\"\r\n                                ]\r\n                              }\r\n                            ],\r\n                            \"failingPeriods\": {\r\n                              \"numberOfEvaluationPeriods\": 1,\r\n                              \"minFailingPeriodsToAlert\": 1\r\n                            }\r\n                          }\r\n                        ]\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"ruleResolveConfiguration\": {\r\n                        \"autoResolved\": \"[[parameters('autoResolve')]\",\r\n                        \"timeToResolve\": \"[[parameters('autoResolveTime')]\"\r\n                      },\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"autoResolve\": {\r\n                          \"value\": \"[[parameters('autoResolve')]\"\r\n                        },\r\n                        \"autoResolveTime\": {\r\n                          \"value\": \"[[parameters('autoResolveTime')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"threshold\": {\r\n                          \"value\": \"[[parameters('threshold')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"autoResolve\": {\r\n                  \"value\": \"[[parameters('autoResolve')]\"\r\n                },\r\n                \"autoResolveTime\": {\r\n                  \"value\": \"[[parameters('autoResolveTime')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                },\r\n                \"operator\": {\r\n                  \"value\": \"[[parameters('operator')]\"\r\n                },\r\n                \"timeAggregation\": {\r\n                  \"value\": \"[[parameters('timeAggregation')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}",
    "$fxv#43": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_VM_NetworkIn_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy VM Network Read Alert\",\n    \"description\": \"Policy to audit/deploy VM Nework Read Alert\",\n    \"metadata\": {\n      \"version\": \"1.0.0\",\n      \"category\": \"Compute\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_alz_monitor\": \"True\"\n    },\n    \"parameters\": {\n      \"alertResourceGroupName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Resource Group Name\",\n          \"description\": \"Resource group the alert is placed in\"\n        },\n        \"defaultValue\": \"AlzMonitoring-rg\"\n      },\n      \"alertResourceGroupTags\": {\n        \"type\": \"Object\",\n        \"metadata\": {\n          \"displayName\": \"Resource Group Tags\",\n          \"description\": \"Tags on the Resource group the alert is placed in\"\n        },\n        \"defaultValue\": {\n          \"environment\": \"test\"\n        }\n      },\n      \"alertResourceGroupLocation\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Resource Group Location\",\n          \"description\": \"Location of the Resource group the alert is placed in\"\n        },\n        \"defaultValue\": \"centralus\"\n      },\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"2\"\n      },\n      \"operator\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Operator\"\n        },\n        \"allowedvalues\": [\n          \"Equals\",\n          \"GreaterThan\",\n          \"GreaterThanOrEqual\",\n          \"LessThan\",\n          \"LessThanOrEqual\"\n        ],\n        \"defaultvalue\": \"GreaterThan\"\n      },\n      \"timeAggregation\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"TimeAggregation\"\n        },\n        \"allowedValues\": [\n          \"Average\",\n          \"Count\",\n          \"Maximum\",\n          \"Minimum\",\n          \"Total\"\n        ],\n        \"defaultvalue\": \"Average\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"PT24H\"\n        ],\n        \"defaultValue\": \"PT15M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"autoResolve\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Resolve\",\n          \"description\": \"Auto Resolve for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"autoResolveTime\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Resolve\",\n          \"description\": \"Auto Resolve time for the alert in ISO 8601 format\"\n        },\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"10000000\"\n      },\n      \"failingPeriods\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayname\": \"Failing Periods\",\n          \"description\": \"Number of failing periods before alert is fired\"\n        },\n        \"defaultValue\": \"1\"\n      },\n      \"evaluationPeriods\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayname\": \"Evaluation Periods\",\n          \"description\": \"The number of aggregated lookback points.\"\n        },\n        \"defaultValue\": \"1\"\n      },\n      \"networkInterfacesToInclude\": {\n        \"type\": \"array\",\n        \"metadata\": {\n          \"displayname\": \"Network Interface to be included to be monitored\",\n          \"description\": \"Array of Network Interface to be monitored\"\n        },\n        \"defaultValue\": [\n          \"*\"\n        ]\n      },\n      \"computersToInclude\": {\n        \"type\": \"array\",\n        \"metadata\": {\n          \"displayname\": \"Disks to be included to be monitored\",\n          \"description\": \"Array of Computer to be monitored\"\n        },\n        \"defaultValue\": [\n          \"*\"\n        ]\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"type\": \"Microsoft.Insights/scheduledQueryRules\",\n          \"existenceScope\": \"resourcegroup\",\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\n          \"deploymentScope\": \"subscription\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/displayName\",\n                \"equals\": \"[[concat(subscription().displayName, '-VMHighNetwrokInAlert')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/scopes[*]\",\n                \"equals\": \"[[subscription().id]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"location\": \"[[deployment().location]\",\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"alertResourceGroupName\": {\n                    \"type\": \"string\"\n                  },\n                  \"alertResourceGroupTags\": {\n                    \"type\": \"object\"\n                  },\n                  \"alertResourceGroupLocation\": {\n                    \"type\": \"string\"\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoResolve\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoResolveTime\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  },\n                  \"operator\": {\n                    \"type\": \"String\"\n                  },\n                  \"timeAggregation\": {\n                    \"type\": \"String\"\n                  },\n                  \"failingPeriods\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationPeriods\": {\n                    \"type\": \"String\"\n                  },\n                  \"computersToInclude\": {\n                    \"type\": \"array\"\n                  },\n                  \"networkInterfaceToInclude\": {\n                    \"type\": \"array\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\n                    \"apiVersion\": \"2021-04-01\",\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\n                  },\n                  {\n                    \"type\": \"Microsoft.Resources/deployments\",\n                    \"apiVersion\": \"2019-10-01\",\n                    \"name\": \"VMNetworkInAlert\",\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\n                    \"dependsOn\": [\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\n                    ],\n                    \"properties\": {\n                      \"mode\": \"Incremental\",\n                      \"template\": {\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                        \"contentVersion\": \"1.0.0.0\",\n                        \"parameters\": {\n                          \"enabled\": {\n                            \"type\": \"string\"\n                          },\n                          \"alertResourceGroupName\": {\n                            \"type\": \"string\"\n                          },\n                          \"alertResourceGroupLocation\": {\n                            \"type\": \"string\"\n                          }\n                        },\n                        \"variables\": {},\n                        \"resources\": [\n                          {\n                            \"type\": \"Microsoft.Insights/scheduledQueryRules\",\n                            \"apiVersion\": \"2022-08-01-preview\",\n                            \"name\": \"[[concat(subscription().displayName, '-VMHighNetworkInAlert')]\",\n                            \"location\": \"[[parameters('alertResourceGroupLocation')]\",\n                            \"properties\": {\n                              \"displayName\": \"[[concat(subscription().displayName, '-VMHighNetworkInAlert')]\",\n                              \"description\": \"Log Alert for Virtual Machine NetworkIn\",\n                              \"severity\": \"[[parameters('severity')]\",\n                              \"enabled\": \"[[parameters('enabled')]\",\n                              \"scopes\": [\n                                \"[[subscription().Id]\"\n                              ],\n                              \"targetResourceTypes\": [\n                                \"Microsoft.Compute/virtualMachines\"\n                              ],\n                              \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                              \"windowSize\": \"[[parameters('windowSize')]\",\n                              \"criteria\": {\n                                \"allOf\": [\n                                  {\n                                    \"query\": \"InsightsMetrics| where Origin == \\\"vm.azm.ms\\\"| where Namespace == \\\"Network\\\" and Name == \\\"ReadBytesPerSecond\\\"| | extend NetworkInterface=tostring(todynamic(Tags)[\\\"vm.azm.ms/networkDeviceId\\\"])|summarize AggregatedValue = avg(Val) by bin(TimeGenerated, 15m), Computer, _ResourceId, NetworkInterface\",\n                                    \"metricMeasureColumn\": \"AggregatedValue\",\n                                    \"threshold\": \"[[parameters('threshold')]\",\n                                    \"operator\": \"[[parameters('operator')]\",\n                                    \"resourceIdColumn\": \"_ResourceId\",\n                                    \"timeAggregation\": \"[[parameters('timeAggregation')]\",\n                                    \"dimensions\": [\n                                      {\n                                        \"name\": \"Computer\",\n                                        \"operator\": \"Include\",\n                                        \"values\": \"[[parameters('computersToInclude')]\"\n                                      },\n                                      {\n                                        \"name\": \"NetworkInterface\",\n                                        \"operator\": \"Include\",\n                                        \"values\": \"[[parameters('networkInterfacesToInclude')]\"\n                                      }\n                                    ],\n                                    \"failingPeriods\": {\n                                      \"numberOfEvaluationPeriods\": \"[[parameters('evaluationPeriods')]\",\n                                      \"minFailingPeriodsToAlert\": \"[[parameters('failingPeriods')]\"\n                                    }\n                                  }\n                                ]\n                              },\n                              \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                              \"ruleResolveConfiguration\": {\n                                \"autoResolved\": \"[[parameters('autoResolve')]\",\n                                \"timeToResolve\": \"[[parameters('autoResolveTime')]\"\n                              },\n                              \"parameters\": {\n                                \"alertResourceGroupName\": {\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\n                                },\n                                \"alertResourceGroupLocation\": {\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\n                                },\n                                \"severity\": {\n                                  \"value\": \"[[parameters('severity')]\"\n                                },\n                                \"windowSize\": {\n                                  \"value\": \"[[parameters('windowSize')]\"\n                                },\n                                \"evaluationFrequency\": {\n                                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                                },\n                                \"autoMitigate\": {\n                                  \"value\": \"[[parameters('autoMitigate')]\"\n                                },\n                                \"autoResolve\": {\n                                  \"value\": \"[[parameters('autoResolve')]\"\n                                },\n                                \"autoResolveTime\": {\n                                  \"value\": \"[[parameters('autoResolveTime')]\"\n                                },\n                                \"enabled\": {\n                                  \"value\": \"[[parameters('enabled')]\"\n                                },\n                                \"threshold\": {\n                                  \"value\": \"[[parameters('threshold')]\"\n                                },\n                                \"failingPeriods\": {\n                                  \"value\": \"[[parameters('failingPeriods')]\"\n                                },\n                                \"evaluationPeriods\": {\n                                  \"value\": \"[[parameters('evaluationPeriods')]\"\n                                },\n                                \"computersToInclude\": {\n                                  \"value\": \"[[parameters('computersToInclude')]\"\n                                },\n                                \"networkInterfacesToInclude\": {\n                                  \"value\": \"[[parameters('networkInterfacesToInclude')]\"\n                                }\n                              }\n                            }\n                          }\n                        ]\n                      },\n                      \"parameters\": {\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"alertResourceGroupName\": {\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\n                        },\n                        \"alertResourceGroupLocation\": {\n                          \"value\": \"[[parameters('alertResourceGroupLocation')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"alertResourceGroupName\": {\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\n                },\n                \"alertResourceGroupTags\": {\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\n                },\n                \"alertResourceGroupLocation\": {\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"autoResolve\": {\n                  \"value\": \"[[parameters('autoResolve')]\"\n                },\n                \"autoResolveTime\": {\n                  \"value\": \"[[parameters('autoResolveTime')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[parameters('threshold')]\"\n                },\n                \"operator\": {\n                  \"value\": \"[[parameters('operator')]\"\n                },\n                \"timeAggregation\": {\n                  \"value\": \"[[parameters('timeAggregation')]\"\n                },\n                \"failingPeriods\": {\n                  \"value\": \"[[parameters('failingPeriods')]\"\n                },\n                \"evaluationPeriods\": {\n                  \"value\": \"[[parameters('evaluationPeriods')]\"\n                },\n                \"computersToInclude\": {\n                  \"value\": \"[[parameters('computersToInclude')]\"\n                },\n                \"networkInterfacesToInclude\": {\n                  \"value\": \"[[parameters('networkInterfacesToInclude')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#44": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_VM_NetworkOut_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy VM Network Write Alert\",\n    \"description\": \"Policy to audit/deploy VM Network Out Alert\",\n    \"metadata\": {\n      \"version\": \"1.0.0\",\n      \"category\": \"Compute\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_alz_monitor\": \"True\"\n    },\n    \"parameters\": {\n      \"alertResourceGroupName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Resource Group Name\",\n          \"description\": \"Resource group the alert is placed in\"\n        },\n        \"defaultValue\": \"AlzMonitoring-rg\"\n      },\n      \"alertResourceGroupTags\": {\n        \"type\": \"Object\",\n        \"metadata\": {\n          \"displayName\": \"Resource Group Tags\",\n          \"description\": \"Tags on the Resource group the alert is placed in\"\n        },\n        \"defaultValue\": {\n          \"environment\": \"test\"\n        }\n      },\n      \"alertResourceGroupLocation\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Resource Group Location\",\n          \"description\": \"Location of the Resource group the alert is placed in\"\n        },\n        \"defaultValue\": \"centralus\"\n      },\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"2\"\n      },\n      \"operator\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Operator\"\n        },\n        \"allowedvalues\": [\n          \"Equals\",\n          \"GreaterThan\",\n          \"GreaterThanOrEqual\",\n          \"LessThan\",\n          \"LessThanOrEqual\"\n        ],\n        \"defaultvalue\": \"GreaterThan\"\n      },\n      \"timeAggregation\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"TimeAggregation\"\n        },\n        \"allowedValues\": [\n          \"Average\",\n          \"Count\",\n          \"Maximum\",\n          \"Minimum\",\n          \"Total\"\n        ],\n        \"defaultvalue\": \"Average\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"PT24H\"\n        ],\n        \"defaultValue\": \"PT15M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"autoResolve\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Resolve\",\n          \"description\": \"Auto Resolve for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"autoResolveTime\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Resolve\",\n          \"description\": \"Auto Resolve time for the alert in ISO 8601 format\"\n        },\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"10000000\"\n      },\n      \"failingPeriods\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayname\": \"Failing Periods\",\n          \"description\": \"Number of failing periods before alert is fired\"\n        },\n        \"defaultValue\": \"1\"\n      },\n      \"evaluationPeriods\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayname\": \"Evaluation Periods\",\n          \"description\": \"The number of aggregated lookback points.\"\n        },\n        \"defaultValue\": \"1\"\n      },\n      \"computersToInclude\": {\n        \"type\": \"array\",\n        \"metadata\": {\n          \"displayname\": \"Disks to be included to be monitored\",\n          \"description\": \"Array of Computer to be monitored\"\n        },\n        \"defaultValue\": [\n          \"*\"\n        ]\n      },\n      \"networkInterfacesToInclude\": {\n        \"type\": \"array\",\n        \"metadata\": {\n          \"displayname\": \"Network Interface to be included to be monitored\",\n          \"description\": \"Array of Network Interface to be monitored\"\n        },\n        \"defaultValue\": [\n          \"*\"\n        ]\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"type\": \"Microsoft.Insights/scheduledQueryRules\",\n          \"existenceScope\": \"resourcegroup\",\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\n          \"deploymentScope\": \"subscription\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/displayName\",\n                \"equals\": \"[[concat(subscription().displayName, '-VMHighNetwrokInAlert')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/scopes[*]\",\n                \"equals\": \"[[subscription().id]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"location\": \"[[deployment().location]\",\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"alertResourceGroupName\": {\n                    \"type\": \"string\"\n                  },\n                  \"alertResourceGroupTags\": {\n                    \"type\": \"object\"\n                  },\n                  \"alertResourceGroupLocation\": {\n                    \"type\": \"string\"\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoResolve\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoResolveTime\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  },\n                  \"operator\": {\n                    \"type\": \"String\"\n                  },\n                  \"timeAggregation\": {\n                    \"type\": \"String\"\n                  },\n                  \"failingPeriods\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationPeriods\": {\n                    \"type\": \"String\"\n                  },\n                  \"computersToInclude\": {\n                    \"type\": \"array\"\n                  },\n                  \"networkInterfaceToInclude\": {\n                    \"type\": \"array\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\n                    \"apiVersion\": \"2021-04-01\",\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\n                  },\n                  {\n                    \"type\": \"Microsoft.Resources/deployments\",\n                    \"apiVersion\": \"2019-10-01\",\n                    \"name\": \"VMNetworkOutAlert\",\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\n                    \"dependsOn\": [\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\n                    ],\n                    \"properties\": {\n                      \"mode\": \"Incremental\",\n                      \"template\": {\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                        \"contentVersion\": \"1.0.0.0\",\n                        \"parameters\": {\n                          \"enabled\": {\n                            \"type\": \"string\"\n                          },\n                          \"alertResourceGroupName\": {\n                            \"type\": \"string\"\n                          },\n                          \"alertResourceGroupLocation\": {\n                            \"type\": \"string\"\n                          }\n                        },\n                        \"variables\": {},\n                        \"resources\": [\n                          {\n                            \"type\": \"Microsoft.Insights/scheduledQueryRules\",\n                            \"apiVersion\": \"2022-08-01-preview\",\n                            \"name\": \"[[concat(subscription().displayName, '-VMHighNetworkOutAlert')]\",\n                            \"location\": \"[[parameters('alertResourceGroupLocation')]\",\n                            \"properties\": {\n                              \"displayName\": \"[[concat(subscription().displayName, '-VMHighNetworOutAlert')]\",\n                              \"description\": \"Log Alert for Virtual Machine NetworkOut\",\n                              \"severity\": \"[[parameters('severity')]\",\n                              \"enabled\": \"[[parameters('enabled')]\",\n                              \"scopes\": [\n                                \"[[subscription().Id]\"\n                              ],\n                              \"targetResourceTypes\": [\n                                \"Microsoft.Compute/virtualMachines\"\n                              ],\n                              \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                              \"windowSize\": \"[[parameters('windowSize')]\",\n                              \"criteria\": {\n                                \"allOf\": [\n                                  {\n                                    \"query\": \"InsightsMetrics| where Origin == \\\"vm.azm.ms\\\"| where Namespace == \\\"Network\\\" and Name == \\\"WriteBytesPerSecond\\\"| extend NetworkInterface=tostring(todynamic(Tags)[\\\"vm.azm.ms/networkDeviceId\\\"])|summarize AggregatedValue = avg(Val) by bin(TimeGenerated, 15m), Computer, _ResourceId, NetworkInterface\",\n                                    \"metricMeasureColumn\": \"AggregatedValue\",\n                                    \"threshold\": \"[[parameters('threshold')]\",\n                                    \"operator\": \"[[parameters('operator')]\",\n                                    \"resourceIdColumn\": \"_ResourceId\",\n                                    \"timeAggregation\": \"[[parameters('timeAggregation')]\",\n                                    \"dimensions\": [\n                                      {\n                                        \"name\": \"Computer\",\n                                        \"operator\": \"Include\",\n                                        \"values\": \"[[parameters('computersToInclude')]\"\n                                      },\n                                      {\n                                        \"name\": \"NetworkInterface\",\n                                        \"operator\": \"Include\",\n                                        \"values\": \"[[parameters('networkInterfacesToInclude')]\"\n                                      }\n                                    ],\n                                    \"failingPeriods\": {\n                                      \"numberOfEvaluationPeriods\": \"[[parameters('evaluationPeriods')]\",\n                                      \"minFailingPeriodsToAlert\": \"[[parameters('failingPeriods')]\"\n                                    }\n                                  }\n                                ]\n                              },\n                              \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                              \"ruleResolveConfiguration\": {\n                                \"autoResolved\": \"[[parameters('autoResolve')]\",\n                                \"timeToResolve\": \"[[parameters('autoResolveTime')]\"\n                              },\n                              \"parameters\": {\n                                \"alertResourceGroupName\": {\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\n                                },\n                                \"alertResourceGroupLocation\": {\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\n                                },\n                                \"severity\": {\n                                  \"value\": \"[[parameters('severity')]\"\n                                },\n                                \"windowSize\": {\n                                  \"value\": \"[[parameters('windowSize')]\"\n                                },\n                                \"evaluationFrequency\": {\n                                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                                },\n                                \"autoMitigate\": {\n                                  \"value\": \"[[parameters('autoMitigate')]\"\n                                },\n                                \"autoResolve\": {\n                                  \"value\": \"[[parameters('autoResolve')]\"\n                                },\n                                \"autoResolveTime\": {\n                                  \"value\": \"[[parameters('autoResolveTime')]\"\n                                },\n                                \"enabled\": {\n                                  \"value\": \"[[parameters('enabled')]\"\n                                },\n                                \"threshold\": {\n                                  \"value\": \"[[parameters('threshold')]\"\n                                },\n                                \"failingPeriods\": {\n                                  \"value\": \"[[parameters('failingPeriods')]\"\n                                },\n                                \"evaluationPeriods\": {\n                                  \"value\": \"[[parameters('evaluationPeriods')]\"\n                                },\n                                \"computersToInclude\": {\n                                  \"value\": \"[[parameters('computersToInclude')]\"\n                                },\n                                \"networkInterfacesToInclude\": {\n                                  \"value\": \"[[parameters('networkInterfacesToInclude')]\"\n                                }\n                              }\n                            }\n                          }\n                        ]\n                      },\n                      \"parameters\": {\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"alertResourceGroupName\": {\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\n                        },\n                        \"alertResourceGroupLocation\": {\n                          \"value\": \"[[parameters('alertResourceGroupLocation')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"alertResourceGroupName\": {\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\n                },\n                \"alertResourceGroupTags\": {\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\n                },\n                \"alertResourceGroupLocation\": {\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"autoResolve\": {\n                  \"value\": \"[[parameters('autoResolve')]\"\n                },\n                \"autoResolveTime\": {\n                  \"value\": \"[[parameters('autoResolveTime')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[parameters('threshold')]\"\n                },\n                \"operator\": {\n                  \"value\": \"[[parameters('operator')]\"\n                },\n                \"timeAggregation\": {\n                  \"value\": \"[[parameters('timeAggregation')]\"\n                },\n                \"failingPeriods\": {\n                  \"value\": \"[[parameters('failingPeriods')]\"\n                },\n                \"evaluationPeriods\": {\n                  \"value\": \"[[parameters('evaluationPeriods')]\"\n                },\n                \"computersToInclude\": {\n                  \"value\": \"[[parameters('computersToInclude')]\"\n                },\n                \"networkInterfacesToInclude\": {\n                  \"value\": \"[[parameters('networkInterfacesToInclude')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#45": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_VM_OSDiskreadLatency_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy VM OS Disk Read Latency Alert\",\n    \"description\": \"Policy to audit/deploy VM OSDiskreadLatency Alert\",\n    \"metadata\": {\n      \"version\": \"1.0.0\",\n      \"category\": \"Compute\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_alz_monitor\": \"True\"\n    },\n    \"parameters\": {\n      \"alertResourceGroupName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Resource Group Name\",\n          \"description\": \"Resource group the alert is placed in\"\n        },\n        \"defaultValue\": \"AlzMonitoring-rg\"\n      },\n      \"alertResourceGroupTags\": {\n        \"type\": \"Object\",\n        \"metadata\": {\n          \"displayName\": \"Resource Group Tags\",\n          \"description\": \"Tags on the Resource group the alert is placed in\"\n        },\n        \"defaultValue\": {\n          \"environment\": \"test\"\n        }\n      },\n      \"alertResourceGroupLocation\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Resource Group Location\",\n          \"description\": \"Location of the Resource group the alert is placed in\"\n        },\n        \"defaultValue\": \"centralus\"\n      },\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"2\"\n      },\n      \"operator\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Operator\"\n        },\n        \"allowedvalues\": [\n          \"Equals\",\n          \"GreaterThan\",\n          \"GreaterThanOrEqual\",\n          \"LessThan\",\n          \"LessThanOrEqual\"\n        ],\n        \"defaultvalue\": \"GreaterThan\"\n      },\n      \"timeAggregation\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"TimeAggregation\"\n        },\n        \"allowedValues\": [\n          \"Average\",\n          \"Count\",\n          \"Maximum\",\n          \"Minimum\",\n          \"Total\"\n        ],\n        \"defaultvalue\": \"Average\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"PT24H\"\n        ],\n        \"defaultValue\": \"PT15M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"autoResolve\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Resolve\",\n          \"description\": \"Auto Resolve for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"autoResolveTime\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Resolve\",\n          \"description\": \"Auto Resolve time for the alert in ISO 8601 format\"\n        },\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"30\"\n      },\n      \"failingPeriods\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"disaplayname\": \"Failing Periods\",\n          \"description\": \"Number of failing periods before alert is fired\"\n        },\n        \"defaultValue\": \"1\"\n      },\n      \"evaluationPeriods\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayname\": \"Evaluation Periods\",\n          \"description\": \"The number of aggregated lookback points.\"\n        },\n        \"defaultValue\": \"1\"\n      },\n      \"computersToInclude\": {\n        \"type\": \"array\",\n        \"metadata\": {\n          \"displayname\": \"Disks to be included to be monitored\",\n          \"description\": \"Array of Computer to be monitored\"\n        },\n        \"defaultValue\": [\n          \"*\"\n        ]\n      },\n      \"disksToInclude\": {\n        \"type\": \"array\",\n        \"metadata\": {\n          \"displayname\": \"Disks to be included to be monitored\",\n          \"description\": \"Array of disk to be monitored for disk both windows and linux\"\n        },\n        \"defaultValue\": [\n          \"C:\",\n          \"/\"\n        ]\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"type\": \"Microsoft.Insights/scheduledQueryRules\",\n          \"existenceScope\": \"resourcegroup\",\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\n          \"deploymentScope\": \"subscription\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/displayName\",\n                \"equals\": \"[[concat(subscription().displayName, '-VMLowOSDiskreadLatencyAlert')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/scopes[*]\",\n                \"equals\": \"[[subscription().id]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"location\": \"[[deployment().location]\",\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"alertResourceGroupName\": {\n                    \"type\": \"string\"\n                  },\n                  \"alertResourceGroupTags\": {\n                    \"type\": \"object\"\n                  },\n                  \"alertResourceGroupLocation\": {\n                    \"type\": \"string\"\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoResolve\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoResolveTime\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  },\n                  \"operator\": {\n                    \"type\": \"String\"\n                  },\n                  \"timeAggregation\": {\n                    \"type\": \"String\"\n                  },\n                  \"failingPeriods\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationPeriods\": {\n                    \"type\": \"String\"\n                  },\n                  \"disksToInclude\": {\n                    \"type\": \"array\"\n                  },\n                  \"computersToInclude\": {\n                    \"type\": \"array\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\n                    \"apiVersion\": \"2021-04-01\",\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\n                  },\n                  {\n                    \"type\": \"Microsoft.Resources/deployments\",\n                    \"apiVersion\": \"2019-10-01\",\n                    \"name\": \"VMOSDiskreadLatencyAlert\",\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\n                    \"dependsOn\": [\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\n                    ],\n                    \"properties\": {\n                      \"mode\": \"Incremental\",\n                      \"template\": {\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                        \"contentVersion\": \"1.0.0.0\",\n                        \"parameters\": {\n                          \"enabled\": {\n                            \"type\": \"string\"\n                          },\n                          \"alertResourceGroupName\": {\n                            \"type\": \"string\"\n                          },\n                          \"alertResourceGroupLocation\": {\n                            \"type\": \"string\"\n                          }\n                        },\n                        \"variables\": {},\n                        \"resources\": [\n                          {\n                            \"type\": \"Microsoft.Insights/scheduledQueryRules\",\n                            \"apiVersion\": \"2022-08-01-preview\",\n                            \"name\": \"[[concat(subscription().displayName, '-VMLowOSDiskreadLatencyAlert')]\",\n                            \"location\": \"[[parameters('alertResourceGroupLocation')]\",\n                            \"properties\": {\n                              \"displayName\": \"[[concat(subscription().displayName, '-VMLowOSDiskreadLatencyAlert')]\",\n                              \"description\": \"Log Alert for Virtual Machine OSDiskreadLatency\",\n                              \"severity\": \"[[parameters('severity')]\",\n                              \"enabled\": \"[[parameters('enabled')]\",\n                              \"scopes\": [\n                                \"[[subscription().Id]\"\n                              ],\n                              \"targetResourceTypes\": [\n                                \"Microsoft.Compute/virtualMachines\"\n                              ],\n                              \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                              \"windowSize\": \"[[parameters('windowSize')]\",\n                              \"criteria\": {\n                                \"allOf\": [\n                                  {\n                                    \"query\": \"InsightsMetrics| where Origin == \\\"vm.azm.ms\\\"| where Namespace == \\\"LogicalDisk\\\" and Name == \\\"ReadLatencyMs\\\"| extend Disk=tostring(todynamic(Tags)[\\\"vm.azm.ms/mountId\\\"])| summarize AggregatedValue = avg(Val) by bin(TimeGenerated, 15m), Computer, _ResourceId, Disk\",\n                                    \"metricMeasureColumn\": \"AggregatedValue\",\n                                    \"threshold\": \"[[parameters('threshold')]\",\n                                    \"operator\": \"[[parameters('operator')]\",\n                                    \"resourceIdColumn\": \"_ResourceId\",\n                                    \"timeAggregation\": \"[[parameters('timeAggregation')]\",\n                                    \"dimensions\": [\n                                      {\n                                        \"name\": \"Computer\",\n                                        \"operator\": \"Include\",\n                                        \"values\": \"[[parameters('computersToInclude')]\"\n                                      },\n                                      {\n                                        \"name\": \"Disk\",\n                                        \"operator\": \"Include\",\n                                        \"values\": \"[[parameters('disksToInclude')]\"\n                                      }\n                                    ],\n                                    \"failingPeriods\": {\n                                      \"numberOfEvaluationPeriods\": \"[[parameters('evaluationPeriods')]\",\n                                      \"minFailingPeriodsToAlert\": \"[[parameters('failingPeriods')]\"\n                                    }\n                                  }\n                                ]\n                              },\n                              \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                              \"ruleResolveConfiguration\": {\n                                \"autoResolved\": \"[[parameters('autoResolve')]\",\n                                \"timeToResolve\": \"[[parameters('autoResolveTime')]\"\n                              },\n                              \"parameters\": {\n                                \"alertResourceGroupName\": {\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\n                                },\n                                \"alertResourceGroupLocation\": {\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\n                                },\n                                \"severity\": {\n                                  \"value\": \"[[parameters('severity')]\"\n                                },\n                                \"windowSize\": {\n                                  \"value\": \"[[parameters('windowSize')]\"\n                                },\n                                \"evaluationFrequency\": {\n                                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                                },\n                                \"autoMitigate\": {\n                                  \"value\": \"[[parameters('autoMitigate')]\"\n                                },\n                                \"autoResolve\": {\n                                  \"value\": \"[[parameters('autoResolve')]\"\n                                },\n                                \"autoResolveTime\": {\n                                  \"value\": \"[[parameters('autoResolveTime')]\"\n                                },\n                                \"enabled\": {\n                                  \"value\": \"[[parameters('enabled')]\"\n                                },\n                                \"threshold\": {\n                                  \"value\": \"[[parameters('threshold')]\"\n                                },\n                                \"failingPeriods\": {\n                                  \"value\": \"[[parameters('failingPeriods')]\"\n                                },\n                                \"evaluationPeriods\": {\n                                  \"value\": \"[[parameters('evaluationPeriods')]\"\n                                },\n                                \"disksToInclude\": {\n                                  \"value\": \"[[parameters('disksToInclude')]\"\n                                },\n                                \"computersToInclude\": {\n                                  \"value\": \"[[parameters('computersToInclude')]\"\n                                }\n                              }\n                            }\n                          }\n                        ]\n                      },\n                      \"parameters\": {\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"alertResourceGroupName\": {\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\n                        },\n                        \"alertResourceGroupLocation\": {\n                          \"value\": \"[[parameters('alertResourceGroupLocation')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"alertResourceGroupName\": {\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\n                },\n                \"alertResourceGroupTags\": {\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\n                },\n                \"alertResourceGroupLocation\": {\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"autoResolve\": {\n                  \"value\": \"[[parameters('autoResolve')]\"\n                },\n                \"autoResolveTime\": {\n                  \"value\": \"[[parameters('autoResolveTime')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[parameters('threshold')]\"\n                },\n                \"operator\": {\n                  \"value\": \"[[parameters('operator')]\"\n                },\n                \"timeAggregation\": {\n                  \"value\": \"[[parameters('timeAggregation')]\"\n                },\n                \"failingPeriods\": {\n                  \"value\": \"[[parameters('failingPeriods')]\"\n                },\n                \"evaluationPeriods\": {\n                  \"value\": \"[[parameters('evaluationPeriods')]\"\n                },\n                \"disksToInclude\": {\n                  \"value\": \"[[parameters('disksToInclude')]\"\n                },\n                \"computersToInclude\": {\n                  \"value\": \"[[parameters('computersToInclude')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#46": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_VM_OSDiskSpace_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy VM OS Disk Space Alert\",\n    \"description\": \"Policy to audit/deploy VM OSDiskSpace Alert\",\n    \"metadata\": {\n      \"version\": \"1.0.0\",\n      \"category\": \"Compute\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_alz_monitor\": \"True\"\n    },\n    \"parameters\": {\n      \"alertResourceGroupName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Resource Group Name\",\n          \"description\": \"Resource group the alert is placed in\"\n        },\n        \"defaultValue\": \"AlzMonitoring-rg\"\n      },\n      \"alertResourceGroupTags\": {\n        \"type\": \"Object\",\n        \"metadata\": {\n          \"displayName\": \"Resource Group Tags\",\n          \"description\": \"Tags on the Resource group the alert is placed in\"\n        },\n        \"defaultValue\": {\n          \"environment\": \"test\"\n        }\n      },\n      \"alertResourceGroupLocation\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Resource Group Location\",\n          \"description\": \"Location of the Resource group the alert is placed in\"\n        },\n        \"defaultValue\": \"centralus\"\n      },\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"2\"\n      },\n      \"operator\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Operator\"\n        },\n        \"allowedvalues\": [\n          \"Equals\",\n          \"GreaterThan\",\n          \"GreaterThanOrEqual\",\n          \"LessThan\",\n          \"LessThanOrEqual\"\n        ],\n        \"defaultvalue\": \"LessThan\"\n      },\n      \"timeAggregation\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"TimeAggregation\"\n        },\n        \"allowedValues\": [\n          \"Average\",\n          \"Count\",\n          \"Maximum\",\n          \"Minimum\",\n          \"Total\"\n        ],\n        \"defaultvalue\": \"Average\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"PT24H\"\n        ],\n        \"defaultValue\": \"PT15M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"autoResolve\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Resolve\",\n          \"description\": \"Auto Resolve for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"autoResolveTime\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Resolve\",\n          \"description\": \"Auto Resolve time for the alert in ISO 8601 format\"\n        },\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"10\"\n      },\n      \"failingPeriods\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"disaplayname\": \"Failing Periods\",\n          \"description\": \"Number of failing periods before alert is fired\"\n        },\n        \"defaultValue\": \"1\"\n      },\n      \"evaluationPeriods\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayname\": \"Evaluation Periods\",\n          \"description\": \"The number of aggregated lookback points.\"\n        },\n        \"defaultValue\": \"1\"\n      },\n      \"computersToInclude\": {\n        \"type\": \"array\",\n        \"metadata\": {\n          \"displayname\": \"Disks to be included to be monitored\",\n          \"description\": \"Array of Computer to be monitored\"\n        },\n        \"defaultValue\": [\n          \"*\"\n        ]\n      },\n      \"disksToInclude\": {\n        \"type\": \"array\",\n        \"metadata\": {\n          \"displayname\": \"Disks to be included to be monitored\",\n          \"description\": \"Array of disk to be monitored for disk both windows and linux\"\n        },\n        \"defaultValue\": [\n          \"C:\",\n          \"/\"\n        ]\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"type\": \"Microsoft.Insights/scheduledQueryRules\",\n          \"existenceScope\": \"resourcegroup\",\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\n          \"deploymentScope\": \"subscription\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/displayName\",\n                \"equals\": \"[[concat(subscription().displayName, '-VMLowOSDiskSpaceAlert')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/scopes[*]\",\n                \"equals\": \"[[subscription().id]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"location\": \"[[deployment().location]\",\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"alertResourceGroupName\": {\n                    \"type\": \"string\"\n                  },\n                  \"alertResourceGroupTags\": {\n                    \"type\": \"object\"\n                  },\n                  \"alertResourceGroupLocation\": {\n                    \"type\": \"string\"\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoResolve\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoResolveTime\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  },\n                  \"operator\": {\n                    \"type\": \"String\"\n                  },\n                  \"timeAggregation\": {\n                    \"type\": \"String\"\n                  },\n                  \"failingPeriods\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationPeriods\": {\n                    \"type\": \"String\"\n                  },\n                  \"disksToInclude\": {\n                    \"type\": \"array\"\n                  },\n                  \"computersToInclude\": {\n                    \"type\": \"array\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\n                    \"apiVersion\": \"2021-04-01\",\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\n                  },\n                  {\n                    \"type\": \"Microsoft.Resources/deployments\",\n                    \"apiVersion\": \"2019-10-01\",\n                    \"name\": \"VMOSDiskSpaceAlert\",\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\n                    \"dependsOn\": [\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\n                    ],\n                    \"properties\": {\n                      \"mode\": \"Incremental\",\n                      \"template\": {\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                        \"contentVersion\": \"1.0.0.0\",\n                        \"parameters\": {\n                          \"enabled\": {\n                            \"type\": \"string\"\n                          },\n                          \"alertResourceGroupName\": {\n                            \"type\": \"string\"\n                          },\n                          \"alertResourceGroupLocation\": {\n                            \"type\": \"string\"\n                          }\n                        },\n                        \"variables\": {},\n                        \"resources\": [\n                          {\n                            \"type\": \"Microsoft.Insights/scheduledQueryRules\",\n                            \"apiVersion\": \"2022-08-01-preview\",\n                            \"name\": \"[[concat(subscription().displayName, '-VMLowOSDiskSpaceAlert')]\",\n                            \"location\": \"[[parameters('alertResourceGroupLocation')]\",\n                            \"properties\": {\n                              \"displayName\": \"[[concat(subscription().displayName, '-VMLowOSDiskSpaceAlert')]\",\n                              \"description\": \"Log Alert for Virtual Machine OSDiskSpace\",\n                              \"severity\": \"[[parameters('severity')]\",\n                              \"enabled\": \"[[parameters('enabled')]\",\n                              \"scopes\": [\n                                \"[[subscription().Id]\"\n                              ],\n                              \"targetResourceTypes\": [\n                                \"Microsoft.Compute/virtualMachines\"\n                              ],\n                              \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                              \"windowSize\": \"[[parameters('windowSize')]\",\n                              \"criteria\": {\n                                \"allOf\": [\n                                  {\n                                    \"query\": \"InsightsMetrics| where Origin == \\\"vm.azm.ms\\\"| where Namespace == \\\"LogicalDisk\\\" and Name == \\\"FreeSpacePercentage\\\"| extend Disk=tostring(todynamic(Tags)[\\\"vm.azm.ms/mountId\\\"])| summarize AggregatedValue = avg(Val) by bin(TimeGenerated, 15m), Computer, _ResourceId, Disk\",\n                                    \"metricMeasureColumn\": \"AggregatedValue\",\n                                    \"threshold\": \"[[parameters('threshold')]\",\n                                    \"operator\": \"[[parameters('operator')]\",\n                                    \"resourceIdColumn\": \"_ResourceId\",\n                                    \"timeAggregation\": \"[[parameters('timeAggregation')]\",\n                                    \"dimensions\": [\n                                      {\n                                        \"name\": \"Computer\",\n                                        \"operator\": \"Include\",\n                                        \"values\": \"[[parameters('computersToInclude')]\"\n                                      },\n                                      {\n                                        \"name\": \"Disk\",\n                                        \"operator\": \"Include\",\n                                        \"values\": \"[[parameters('disksToInclude')]\"\n                                      }\n                                    ],\n                                    \"failingPeriods\": {\n                                      \"numberOfEvaluationPeriods\": \"[[parameters('evaluationPeriods')]\",\n                                      \"minFailingPeriodsToAlert\": \"[[parameters('failingPeriods')]\"\n                                    }\n                                  }\n                                ]\n                              },\n                              \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                              \"ruleResolveConfiguration\": {\n                                \"autoResolved\": \"[[parameters('autoResolve')]\",\n                                \"timeToResolve\": \"[[parameters('autoResolveTime')]\"\n                              },\n                              \"parameters\": {\n                                \"alertResourceGroupName\": {\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\n                                },\n                                \"alertResourceGroupLocation\": {\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\n                                },\n                                \"severity\": {\n                                  \"value\": \"[[parameters('severity')]\"\n                                },\n                                \"windowSize\": {\n                                  \"value\": \"[[parameters('windowSize')]\"\n                                },\n                                \"evaluationFrequency\": {\n                                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                                },\n                                \"autoMitigate\": {\n                                  \"value\": \"[[parameters('autoMitigate')]\"\n                                },\n                                \"autoResolve\": {\n                                  \"value\": \"[[parameters('autoResolve')]\"\n                                },\n                                \"autoResolveTime\": {\n                                  \"value\": \"[[parameters('autoResolveTime')]\"\n                                },\n                                \"enabled\": {\n                                  \"value\": \"[[parameters('enabled')]\"\n                                },\n                                \"threshold\": {\n                                  \"value\": \"[[parameters('threshold')]\"\n                                },\n                                \"failingPeriods\": {\n                                  \"value\": \"[[parameters('failingPeriods')]\"\n                                },\n                                \"evaluationPeriods\": {\n                                  \"value\": \"[[parameters('evaluationPeriods')]\"\n                                },\n                                \"disksToInclude\": {\n                                  \"value\": \"[[parameters('disksToInclude')]\"\n                                },\n                                \"computersToInclude\": {\n                                  \"value\": \"[[parameters('computersToInclude')]\"\n                                }\n                              }\n                            }\n                          }\n                        ]\n                      },\n                      \"parameters\": {\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"alertResourceGroupName\": {\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\n                        },\n                        \"alertResourceGroupLocation\": {\n                          \"value\": \"[[parameters('alertResourceGroupLocation')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"alertResourceGroupName\": {\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\n                },\n                \"alertResourceGroupTags\": {\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\n                },\n                \"alertResourceGroupLocation\": {\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"autoResolve\": {\n                  \"value\": \"[[parameters('autoResolve')]\"\n                },\n                \"autoResolveTime\": {\n                  \"value\": \"[[parameters('autoResolveTime')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[parameters('threshold')]\"\n                },\n                \"operator\": {\n                  \"value\": \"[[parameters('operator')]\"\n                },\n                \"timeAggregation\": {\n                  \"value\": \"[[parameters('timeAggregation')]\"\n                },\n                \"failingPeriods\": {\n                  \"value\": \"[[parameters('failingPeriods')]\"\n                },\n                \"evaluationPeriods\": {\n                  \"value\": \"[[parameters('evaluationPeriods')]\"\n                },\n                \"disksToInclude\": {\n                  \"value\": \"[[parameters('disksToInclude')]\"\n                },\n                \"computersToInclude\": {\n                  \"value\": \"[[parameters('computersToInclude')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#47": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_VM_OSDiskwriteLatency_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy VM OS Disk Write Latency Alert\",\n    \"description\": \"Policy to audit/deploy VM OSDiskwriteLatency Alert\",\n    \"metadata\": {\n      \"version\": \"1.0.0\",\n      \"category\": \"Compute\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_alz_monitor\": \"True\"\n    },\n    \"parameters\": {\n      \"alertResourceGroupName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Resource Group Name\",\n          \"description\": \"Resource group the alert is placed in\"\n        },\n        \"defaultValue\": \"AlzMonitoring-rg\"\n      },\n      \"alertResourceGroupTags\": {\n        \"type\": \"Object\",\n        \"metadata\": {\n          \"displayName\": \"Resource Group Tags\",\n          \"description\": \"Tags on the Resource group the alert is placed in\"\n        },\n        \"defaultValue\": {\n          \"environment\": \"test\"\n        }\n      },\n      \"alertResourceGroupLocation\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Resource Group Location\",\n          \"description\": \"Location of the Resource group the alert is placed in\"\n        },\n        \"defaultValue\": \"centralus\"\n      },\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"2\"\n      },\n      \"operator\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Operator\"\n        },\n        \"allowedvalues\": [\n          \"Equals\",\n          \"GreaterThan\",\n          \"GreaterThanOrEqual\",\n          \"LessThan\",\n          \"LessThanOrEqual\"\n        ],\n        \"defaultvalue\": \"GreaterThan\"\n      },\n      \"timeAggregation\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"TimeAggregation\"\n        },\n        \"allowedValues\": [\n          \"Average\",\n          \"Count\",\n          \"Maximum\",\n          \"Minimum\",\n          \"Total\"\n        ],\n        \"defaultvalue\": \"Average\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"PT24H\"\n        ],\n        \"defaultValue\": \"PT15M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"autoResolve\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Resolve\",\n          \"description\": \"Auto Resolve for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"autoResolveTime\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Resolve\",\n          \"description\": \"Auto Resolve time for the alert in ISO 8601 format\"\n        },\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"50\"\n      },\n      \"failingPeriods\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"disaplayname\": \"Failing Periods\",\n          \"description\": \"Number of failing periods before alert is fired\"\n        },\n        \"defaultValue\": \"1\"\n      },\n      \"evaluationPeriods\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayname\": \"Evaluation Periods\",\n          \"description\": \"The number of aggregated lookback points.\"\n        },\n        \"defaultValue\": \"1\"\n      },\n      \"computersToInclude\": {\n        \"type\": \"array\",\n        \"metadata\": {\n          \"displayname\": \"Disks to be included to be monitored\",\n          \"description\": \"Array of Computer to be monitored\"\n        },\n        \"defaultValue\": [\n          \"*\"\n        ]\n      },\n      \"disksToInclude\": {\n        \"type\": \"array\",\n        \"metadata\": {\n          \"displayname\": \"Disks to be included to be monitored\",\n          \"description\": \"Array of disk to be monitored for disk both windows and linux\"\n        },\n        \"defaultValue\": [\n          \"C:\",\n          \"/\"\n        ]\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"type\": \"Microsoft.Insights/scheduledQueryRules\",\n          \"existenceScope\": \"resourcegroup\",\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\n          \"deploymentScope\": \"subscription\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/displayName\",\n                \"equals\": \"[[concat(subscription().displayName, '-VMLowOSDiskwriteLatencyAlert')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/scopes[*]\",\n                \"equals\": \"[[subscription().id]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"location\": \"[[deployment().location]\",\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"alertResourceGroupName\": {\n                    \"type\": \"string\"\n                  },\n                  \"alertResourceGroupTags\": {\n                    \"type\": \"object\"\n                  },\n                  \"alertResourceGroupLocation\": {\n                    \"type\": \"string\"\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoResolve\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoResolveTime\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  },\n                  \"operator\": {\n                    \"type\": \"String\"\n                  },\n                  \"timeAggregation\": {\n                    \"type\": \"String\"\n                  },\n                  \"failingPeriods\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationPeriods\": {\n                    \"type\": \"String\"\n                  },\n                  \"disksToInclude\": {\n                    \"type\": \"array\"\n                  },\n                  \"computersToInclude\": {\n                    \"type\": \"array\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\n                    \"apiVersion\": \"2021-04-01\",\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\n                  },\n                  {\n                    \"type\": \"Microsoft.Resources/deployments\",\n                    \"apiVersion\": \"2019-10-01\",\n                    \"name\": \"VMOSDiskwriteLatencyAlert\",\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\n                    \"dependsOn\": [\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\n                    ],\n                    \"properties\": {\n                      \"mode\": \"Incremental\",\n                      \"template\": {\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                        \"contentVersion\": \"1.0.0.0\",\n                        \"parameters\": {\n                          \"enabled\": {\n                            \"type\": \"string\"\n                          },\n                          \"alertResourceGroupName\": {\n                            \"type\": \"string\"\n                          },\n                          \"alertResourceGroupLocation\": {\n                            \"type\": \"string\"\n                          }\n                        },\n                        \"variables\": {},\n                        \"resources\": [\n                          {\n                            \"type\": \"Microsoft.Insights/scheduledQueryRules\",\n                            \"apiVersion\": \"2022-08-01-preview\",\n                            \"name\": \"[[concat(subscription().displayName, '-VMLowOSDiskwriteLatencyAlert')]\",\n                            \"location\": \"[[parameters('alertResourceGroupLocation')]\",\n                            \"properties\": {\n                              \"displayName\": \"[[concat(subscription().displayName, '-VMLowOSDiskwriteLatencyAlert')]\",\n                              \"description\": \"Log Alert for Virtual Machine OSDiskwriteLatency\",\n                              \"severity\": \"[[parameters('severity')]\",\n                              \"enabled\": \"[[parameters('enabled')]\",\n                              \"scopes\": [\n                                \"[[subscription().Id]\"\n                              ],\n                              \"targetResourceTypes\": [\n                                \"Microsoft.Compute/virtualMachines\"\n                              ],\n                              \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                              \"windowSize\": \"[[parameters('windowSize')]\",\n                              \"criteria\": {\n                                \"allOf\": [\n                                  {\n                                    \"query\": \"InsightsMetrics| where Origin == \\\"vm.azm.ms\\\"| where Namespace == \\\"LogicalDisk\\\" and Name == \\\"WriteLatencyMs\\\"| extend Disk=tostring(todynamic(Tags)[\\\"vm.azm.ms/mountId\\\"])| summarize AggregatedValue = avg(Val) by bin(TimeGenerated, 15m), Computer, _ResourceId, Disk\",\n                                    \"metricMeasureColumn\": \"AggregatedValue\",\n                                    \"threshold\": \"[[parameters('threshold')]\",\n                                    \"operator\": \"[[parameters('operator')]\",\n                                    \"resourceIdColumn\": \"_ResourceId\",\n                                    \"timeAggregation\": \"[[parameters('timeAggregation')]\",\n                                    \"dimensions\": [\n                                      {\n                                        \"name\": \"Computer\",\n                                        \"operator\": \"Include\",\n                                        \"values\": \"[[parameters('computersToInclude')]\"\n                                      },\n                                      {\n                                        \"name\": \"Disk\",\n                                        \"operator\": \"Include\",\n                                        \"values\": \"[[parameters('disksToInclude')]\"\n                                      }\n                                    ],\n                                    \"failingPeriods\": {\n                                      \"numberOfEvaluationPeriods\": \"[[parameters('evaluationPeriods')]\",\n                                      \"minFailingPeriodsToAlert\": \"[[parameters('failingPeriods')]\"\n                                    }\n                                  }\n                                ]\n                              },\n                              \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                              \"ruleResolveConfiguration\": {\n                                \"autoResolved\": \"[[parameters('autoResolve')]\",\n                                \"timeToResolve\": \"[[parameters('autoResolveTime')]\"\n                              },\n                              \"parameters\": {\n                                \"alertResourceGroupName\": {\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\n                                },\n                                \"alertResourceGroupLocation\": {\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\n                                },\n                                \"severity\": {\n                                  \"value\": \"[[parameters('severity')]\"\n                                },\n                                \"windowSize\": {\n                                  \"value\": \"[[parameters('windowSize')]\"\n                                },\n                                \"evaluationFrequency\": {\n                                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                                },\n                                \"autoMitigate\": {\n                                  \"value\": \"[[parameters('autoMitigate')]\"\n                                },\n                                \"autoResolve\": {\n                                  \"value\": \"[[parameters('autoResolve')]\"\n                                },\n                                \"autoResolveTime\": {\n                                  \"value\": \"[[parameters('autoResolveTime')]\"\n                                },\n                                \"enabled\": {\n                                  \"value\": \"[[parameters('enabled')]\"\n                                },\n                                \"threshold\": {\n                                  \"value\": \"[[parameters('threshold')]\"\n                                },\n                                \"failingPeriods\": {\n                                  \"value\": \"[[parameters('failingPeriods')]\"\n                                },\n                                \"evaluationPeriods\": {\n                                  \"value\": \"[[parameters('evaluationPeriods')]\"\n                                },\n                                \"disksToInclude\": {\n                                  \"value\": \"[[parameters('disksToInclude')]\"\n                                },\n                                \"computersToInclude\": {\n                                  \"value\": \"[[parameters('computersToInclude')]\"\n                                }\n                              }\n                            }\n                          }\n                        ]\n                      },\n                      \"parameters\": {\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"alertResourceGroupName\": {\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\n                        },\n                        \"alertResourceGroupLocation\": {\n                          \"value\": \"[[parameters('alertResourceGroupLocation')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"alertResourceGroupName\": {\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\n                },\n                \"alertResourceGroupTags\": {\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\n                },\n                \"alertResourceGroupLocation\": {\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"autoResolve\": {\n                  \"value\": \"[[parameters('autoResolve')]\"\n                },\n                \"autoResolveTime\": {\n                  \"value\": \"[[parameters('autoResolveTime')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[parameters('threshold')]\"\n                },\n                \"operator\": {\n                  \"value\": \"[[parameters('operator')]\"\n                },\n                \"timeAggregation\": {\n                  \"value\": \"[[parameters('timeAggregation')]\"\n                },\n                \"failingPeriods\": {\n                  \"value\": \"[[parameters('failingPeriods')]\"\n                },\n                \"evaluationPeriods\": {\n                  \"value\": \"[[parameters('evaluationPeriods')]\"\n                },\n                \"disksToInclude\": {\n                  \"value\": \"[[parameters('disksToInclude')]\"\n                },\n                \"computersToInclude\": {\n                  \"value\": \"[[parameters('computersToInclude')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#48": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_VM_CPU_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy VM CPU Alert\",\n    \"description\": \"Policy to audit/deploy VM CPU Alert\",\n    \"metadata\": {\n      \"version\": \"1.0.0\",\n      \"category\": \"Compute\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_alz_monitor\": \"True\"\n    },\n    \"parameters\": {\n      \"alertResourceGroupName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Resource Group Name\",\n          \"description\": \"Resource group the alert is placed in\"\n        },\n        \"defaultValue\": \"AlzMonitoring-rg\"\n      },\n      \"alertResourceGroupTags\": {\n        \"type\": \"Object\",\n        \"metadata\": {\n          \"displayName\": \"Resource Group Tags\",\n          \"description\": \"Tags on the Resource group the alert is placed in\"\n        },\n        \"defaultValue\": {\n          \"environment\": \"test\"\n        }\n      },\n      \"alertResourceGroupLocation\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Resource Group Location\",\n          \"description\": \"Location of the Resource group the alert is placed in\"\n        },\n        \"defaultValue\": \"centralus\"\n      },\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"2\"\n      },\n      \"operator\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Operator\"\n        },\n        \"allowedvalues\": [\n          \"Equals\",\n          \"GreaterThan\",\n          \"GreaterThanOrEqual\",\n          \"LessThan\",\n          \"LessThanOrEqual\"\n        ],\n        \"defaultvalue\": \"GreaterThan\"\n      },\n      \"timeAggregation\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"TimeAggregation\"\n        },\n        \"allowedValues\": [\n          \"Average\",\n          \"Count\",\n          \"Maximum\",\n          \"Minimum\",\n          \"Total\"\n        ],\n        \"defaultvalue\": \"Average\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"PT24H\"\n        ],\n        \"defaultValue\": \"PT15M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"autoResolve\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Resolve\",\n          \"description\": \"Auto Resolve for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"autoResolveTime\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Resolve\",\n          \"description\": \"Auto Resolve time for the alert in ISO 8601 format\"\n        },\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"85\"\n      },\n      \"failingPeriods\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayname\": \"Failing Periods\",\n          \"description\": \"Number of failing periods before alert is fired\"\n        },\n        \"defaultValue\": \"1\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"type\": \"Microsoft.Insights/scheduledQueryRules\",\n          \"existenceScope\": \"resourcegroup\",\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\n          \"deploymentScope\": \"subscription\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/displayName\",\n                \"equals\": \"[[concat(subscription().displayName, '-VMHighCPUAlert')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/scopes[*]\",\n                \"equals\": \"[[subscription().id]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"location\": \"[[deployment().location]\",\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"alertResourceGroupName\": {\n                    \"type\": \"string\"\n                  },\n                  \"alertResourceGroupTags\": {\n                    \"type\": \"object\"\n                  },\n                  \"alertResourceGroupLocation\": {\n                    \"type\": \"string\"\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoResolve\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoResolveTime\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  },\n                  \"operator\": {\n                    \"type\": \"String\"\n                  },\n                  \"timeAggregation\": {\n                    \"type\": \"String\"\n                  },\n                  \"failingPeriods\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\n                    \"apiVersion\": \"2021-04-01\",\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\n                  },\n                  {\n                    \"type\": \"Microsoft.Resources/deployments\",\n                    \"apiVersion\": \"2019-10-01\",\n                    \"name\": \"VMCPUAlert\",\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\n                    \"dependsOn\": [\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\n                    ],\n                    \"properties\": {\n                      \"mode\": \"Incremental\",\n                      \"template\": {\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                        \"contentVersion\": \"1.0.0.0\",\n                        \"parameters\": {\n                          \"enabled\": {\n                            \"type\": \"string\"\n                          },\n                          \"alertResourceGroupName\": {\n                            \"type\": \"string\"\n                          },\n                          \"alertResourceGroupLocation\": {\n                            \"type\": \"string\"\n                          }\n                        },\n                        \"variables\": {},\n                        \"resources\": [\n                          {\n                            \"type\": \"Microsoft.Insights/scheduledQueryRules\",\n                            \"apiVersion\": \"2022-08-01-preview\",\n                            \"name\": \"[[concat(subscription().displayName, '-VMHighCPUAlert')]\",\n                            \"location\": \"[[parameters('alertResourceGroupLocation')]\",\n                            \"properties\": {\n                              \"displayName\": \"[[concat(subscription().displayName, '-VMHighCPUAlert')]\",\n                              \"description\": \"Log Alert for Virtual Machine CPU\",\n                              \"severity\": \"[[parameters('severity')]\",\n                              \"enabled\": \"[[parameters('enabled')]\",\n                              \"scopes\": [\n                                \"[[subscription().Id]\"\n                              ],\n                              \"targetResourceTypes\": [\n                                \"Microsoft.Compute/virtualMachines\"\n                              ],\n                              \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                              \"windowSize\": \"[[parameters('windowSize')]\",\n                              \"criteria\": {\n                                \"allOf\": [\n                                  {\n                                    \"query\": \"InsightsMetrics| where Origin == \\\"vm.azm.ms\\\"| where Namespace == \\\"Processor\\\" and Name == \\\"UtilizationPercentage\\\"| summarize AggregatedValue = avg(Val) by bin(TimeGenerated, 15m), Computer, _ResourceId\",\n                                    \"metricMeasureColumn\": \"AggregatedValue\",\n                                    \"threshold\": \"[[parameters('threshold')]\",\n                                    \"operator\": \"[[parameters('operator')]\",\n                                    \"resourceIdColumn\": \"_ResourceId\",\n                                    \"timeAggregation\": \"[[parameters('timeAggregation')]\",\n                                    \"dimensions\": [\n                                      {\n                                        \"name\": \"Computer\",\n                                        \"operator\": \"Include\",\n                                        \"values\": [\n                                          \"*\"\n                                        ]\n                                      }\n                                    ],\n                                    \"failingPeriods\": {\n                                      \"numberOfEvaluationPeriods\": \"1\",\n                                      \"minFailingPeriodsToAlert\": \"[[parameters('failingPeriods')]\"\n                                    }\n                                  }\n                                ]\n                              },\n                              \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                              \"ruleResolveConfiguration\": {\n                                \"autoResolved\": \"[[parameters('autoResolve')]\",\n                                \"timeToResolve\": \"[[parameters('autoResolveTime')]\"\n                              },\n                              \"parameters\": {\n                                \"alertResourceGroupName\": {\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\n                                },\n                                \"alertResourceGroupLocation\": {\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\n                                },\n                                \"severity\": {\n                                  \"value\": \"[[parameters('severity')]\"\n                                },\n                                \"windowSize\": {\n                                  \"value\": \"[[parameters('windowSize')]\"\n                                },\n                                \"evaluationFrequency\": {\n                                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                                },\n                                \"autoMitigate\": {\n                                  \"value\": \"[[parameters('autoMitigate')]\"\n                                },\n                                \"autoResolve\": {\n                                  \"value\": \"[[parameters('autoResolve')]\"\n                                },\n                                \"autoResolveTime\": {\n                                  \"value\": \"[[parameters('autoResolveTime')]\"\n                                },\n                                \"enabled\": {\n                                  \"value\": \"[[parameters('enabled')]\"\n                                },\n                                \"threshold\": {\n                                  \"value\": \"[[parameters('threshold')]\"\n                                },\n                                \"failingPeriods\": {\n                                  \"value\": \"[[parameters('failingPeriods')]\"\n                                }\n                              }\n                            }\n                          }\n                        ]\n                      },\n                      \"parameters\": {\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"alertResourceGroupName\": {\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\n                        },\n                        \"alertResourceGroupLocation\": {\n                          \"value\": \"[[parameters('alertResourceGroupLocation')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"alertResourceGroupName\": {\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\n                },\n                \"alertResourceGroupTags\": {\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\n                },\n                \"alertResourceGroupLocation\": {\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"autoResolve\": {\n                  \"value\": \"[[parameters('autoResolve')]\"\n                },\n                \"autoResolveTime\": {\n                  \"value\": \"[[parameters('autoResolveTime')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[parameters('threshold')]\"\n                },\n                \"operator\": {\n                  \"value\": \"[[parameters('operator')]\"\n                },\n                \"timeAggregation\": {\n                  \"value\": \"[[parameters('timeAggregation')]\"\n                },\n                \"failingPeriods\": {\n                  \"value\": \"[[parameters('failingPeriods')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#49": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_VM_Memory_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy VM Memory Alert\",\n    \"description\": \"Policy to audit/deploy VM Memory Alert\",\n    \"metadata\": {\n      \"version\": \"1.0.0\",\n      \"category\": \"Compute\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_alz_monitor\": \"True\"\n    },\n    \"parameters\": {\n      \"alertResourceGroupName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Resource Group Name\",\n          \"description\": \"Resource group the alert is placed in\"\n        },\n        \"defaultValue\": \"AlzMonitoring-rg\"\n      },\n      \"alertResourceGroupTags\": {\n        \"type\": \"Object\",\n        \"metadata\": {\n          \"displayName\": \"Resource Group Tags\",\n          \"description\": \"Tags on the Resource group the alert is placed in\"\n        },\n        \"defaultValue\": {\n          \"environment\": \"test\"\n        }\n      },\n      \"alertResourceGroupLocation\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Resource Group Location\",\n          \"description\": \"Location of the Resource group the alert is placed in\"\n        },\n        \"defaultValue\": \"centralus\"\n      },\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"2\"\n      },\n      \"operator\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Operator\"\n        },\n        \"allowedvalues\": [\n          \"Equals\",\n          \"GreaterThan\",\n          \"GreaterThanOrEqual\",\n          \"LessThan\",\n          \"LessThanOrEqual\"\n        ],\n        \"defaultvalue\": \"LessThan\"\n      },\n      \"timeAggregation\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"TimeAggregation\"\n        },\n        \"allowedValues\": [\n          \"Average\",\n          \"Count\",\n          \"Maximum\",\n          \"Minimum\",\n          \"Total\"\n        ],\n        \"defaultvalue\": \"Average\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"PT24H\"\n        ],\n        \"defaultValue\": \"PT15M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"autoResolve\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Resolve\",\n          \"description\": \"Auto Resolve for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"autoResolveTime\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Resolve\",\n          \"description\": \"Auto Resolve time for the alert in ISO 8601 format\"\n        },\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"10\"\n      },\n      \"failingPeriods\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayname\": \"Failing Periods\",\n          \"description\": \"Number of failing periods before alert is fired\"\n        },\n        \"defaultValue\": \"1\"\n      },\n      \"evaluationPeriods\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayname\": \"Evaluation Periods\",\n          \"description\": \"The number of aggregated lookback points.\"\n        },\n        \"defaultValue\": \"1\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"type\": \"Microsoft.Insights/scheduledQueryRules\",\n          \"existenceScope\": \"resourcegroup\",\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\n          \"deploymentScope\": \"subscription\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/displayName\",\n                \"equals\": \"[[concat(subscription().displayName, '-VMLowMemoryAlert')]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/scopes[*]\",\n                \"equals\": \"[[subscription().id]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"location\": \"[[deployment().location]\",\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"alertResourceGroupName\": {\n                    \"type\": \"string\"\n                  },\n                  \"alertResourceGroupTags\": {\n                    \"type\": \"object\"\n                  },\n                  \"alertResourceGroupLocation\": {\n                    \"type\": \"string\"\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoResolve\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoResolveTime\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  },\n                  \"operator\": {\n                    \"type\": \"String\"\n                  },\n                  \"timeAggregation\": {\n                    \"type\": \"String\"\n                  },\n                  \"failingPeriods\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationPeriods\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\n                    \"apiVersion\": \"2021-04-01\",\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\n                  },\n                  {\n                    \"type\": \"Microsoft.Resources/deployments\",\n                    \"apiVersion\": \"2019-10-01\",\n                    \"name\": \"VMMemoryAlert\",\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\n                    \"dependsOn\": [\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\n                    ],\n                    \"properties\": {\n                      \"mode\": \"Incremental\",\n                      \"template\": {\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                        \"contentVersion\": \"1.0.0.0\",\n                        \"parameters\": {\n                          \"enabled\": {\n                            \"type\": \"string\"\n                          },\n                          \"alertResourceGroupName\": {\n                            \"type\": \"string\"\n                          },\n                          \"alertResourceGroupLocation\": {\n                            \"type\": \"string\"\n                          }\n                        },\n                        \"variables\": {},\n                        \"resources\": [\n                          {\n                            \"type\": \"Microsoft.Insights/scheduledQueryRules\",\n                            \"apiVersion\": \"2022-08-01-preview\",\n                            \"name\": \"[[concat(subscription().displayName, '-VMLowMemoryAlert')]\",\n                            \"location\": \"[[parameters('alertResourceGroupLocation')]\",\n                            \"properties\": {\n                              \"displayName\": \"[[concat(subscription().displayName, '-VMLowMemoryAlert')]\",\n                              \"description\": \"Log Alert for Virtual Machine Memory\",\n                              \"severity\": \"[[parameters('severity')]\",\n                              \"enabled\": \"[[parameters('enabled')]\",\n                              \"scopes\": [\n                                \"[[subscription().Id]\"\n                              ],\n                              \"targetResourceTypes\": [\n                                \"Microsoft.Compute/virtualMachines\"\n                              ],\n                              \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                              \"windowSize\": \"[[parameters('windowSize')]\",\n                              \"criteria\": {\n                                \"allOf\": [\n                                  {\n                                    \"query\": \"InsightsMetrics| where Origin == \\\"vm.azm.ms\\\"|where Namespace == \\\"Memory\\\" and Name == \\\"AvailableMB\\\"| extend TotalMemory = toreal(todynamic(Tags)[\\\"vm.azm.ms/memorySizeMB\\\"]) | extend AvailableMemoryPercentage = (toreal(Val) / TotalMemory) * 100.0| summarize AggregatedValue = avg(AvailableMemoryPercentage) by bin(TimeGenerated, 15m), Computer, _ResourceId\",\n                                    \"metricMeasureColumn\": \"AggregatedValue\",\n                                    \"threshold\": \"[[parameters('threshold')]\",\n                                    \"operator\": \"[[parameters('operator')]\",\n                                    \"resourceIdColumn\": \"_ResourceId\",\n                                    \"timeAggregation\": \"[[parameters('timeAggregation')]\",\n                                    \"dimensions\": [\n                                      {\n                                        \"name\": \"Computer\",\n                                        \"operator\": \"Include\",\n                                        \"values\": [\n                                          \"*\"\n                                        ]\n                                      }\n                                    ],\n                                    \"failingPeriods\": {\n                                      \"numberOfEvaluationPeriods\": \"[[parameters('evaluationPeriods')]\",\n                                      \"minFailingPeriodsToAlert\": \"[[parameters('failingPeriods')]\"\n                                    }\n                                  }\n                                ]\n                              },\n                              \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                              \"ruleResolveConfiguration\": {\n                                \"autoResolved\": \"[[parameters('autoResolve')]\",\n                                \"timeToResolve\": \"[[parameters('autoResolveTime')]\"\n                              },\n                              \"parameters\": {\n                                \"alertResourceGroupName\": {\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\n                                },\n                                \"alertResourceGroupLocation\": {\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\n                                },\n                                \"severity\": {\n                                  \"value\": \"[[parameters('severity')]\"\n                                },\n                                \"windowSize\": {\n                                  \"value\": \"[[parameters('windowSize')]\"\n                                },\n                                \"evaluationFrequency\": {\n                                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                                },\n                                \"autoMitigate\": {\n                                  \"value\": \"[[parameters('autoMitigate')]\"\n                                },\n                                \"autoResolve\": {\n                                  \"value\": \"[[parameters('autoResolve')]\"\n                                },\n                                \"autoResolveTime\": {\n                                  \"value\": \"[[parameters('autoResolveTime')]\"\n                                },\n                                \"enabled\": {\n                                  \"value\": \"[[parameters('enabled')]\"\n                                },\n                                \"threshold\": {\n                                  \"value\": \"[[parameters('threshold')]\"\n                                },\n                                \"failingPeriods\": {\n                                  \"value\": \"[[parameters('failingPeriods')]\"\n                                },\n                                \"evaluationPeriods\": {\n                                  \"value\": \"[[parameters('evaluationPeriods')]\"\n                                }\n                              }\n                            }\n                          }\n                        ]\n                      },\n                      \"parameters\": {\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"alertResourceGroupName\": {\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\n                        },\n                        \"alertResourceGroupLocation\": {\n                          \"value\": \"[[parameters('alertResourceGroupLocation')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"alertResourceGroupName\": {\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\n                },\n                \"alertResourceGroupTags\": {\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\n                },\n                \"alertResourceGroupLocation\": {\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"autoResolve\": {\n                  \"value\": \"[[parameters('autoResolve')]\"\n                },\n                \"autoResolveTime\": {\n                  \"value\": \"[[parameters('autoResolveTime')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[parameters('threshold')]\"\n                },\n                \"operator\": {\n                  \"value\": \"[[parameters('operator')]\"\n                },\n                \"timeAggregation\": {\n                  \"value\": \"[[parameters('timeAggregation')]\"\n                },\n                \"failingPeriods\": {\n                  \"value\": \"[[parameters('failingPeriods')]\"\n                },\n                \"evaluationPeriods\": {\n                  \"value\": \"[[parameters('evaluationPeriods')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
    "$fxv#5": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_activitylog_NSG_Delete\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy Activity Log NSG Delete Alert\",\r\n    \"description\": \"Policy to Deploy Activity Log NSG Delete Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Network\",\r\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_alz_monitor\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"alertResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Name\",\r\n          \"description\": \"Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"AlzMonitoring-rg\"\r\n      },\r\n      \"alertResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Tags\",\r\n          \"description\": \"Tags on the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": {\r\n          \"environment\": \"test\",\r\n          \"_deployed_by_alz_monitor\": true\r\n        }\r\n      },\r\n      \"alertResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Location\",\r\n          \"description\": \"Location of the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"centralus\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring on resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/networkSecurityGroups\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/activityLogAlerts\",\r\n          \"name\": \"ActivityNSGDelete\",\r\n          \"existenceScope\": \"resourcegroup\",\r\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\r\n          \"deploymentScope\": \"subscription\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/ActivityLogAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              },\r\n              {\r\n                \"count\": {\r\n                  \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*]\",\r\n                  \"where\": {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].field\",\r\n                            \"equals\": \"category\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].equals\",\r\n                            \"equals\": \"Administrative\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"microsoft.insights/activityLogAlerts/condition.allOf[*].field\",\r\n                            \"equals\": \"operationName\"\r\n                          },\r\n                          {\r\n                            \"field\": \"microsoft.insights/activityLogAlerts/condition.allOf[*].equals\",\r\n                            \"equals\": \"Microsoft.Network/networkSecurityGroups/delete\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                },\r\n                \"equals\": 2\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"location\": \"[[deployment().location]\",\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"alertResourceGroupName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"alertResourceGroupTags\": {\r\n                    \"type\": \"object\"\r\n                  },\r\n                  \"alertResourceGroupLocation\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\r\n                    \"apiVersion\": \"2021-04-01\",\r\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\r\n                  },\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/deployments\",\r\n                    \"apiVersion\": \"2019-10-01\",\r\n                    \"name\": \"ActivityNSGDelete\",\r\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"dependsOn\": [\r\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\r\n                    ],\r\n                    \"properties\": {\r\n                      \"mode\": \"Incremental\",\r\n                      \"template\": {\r\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                        \"contentVersion\": \"1.0.0.0\",\r\n                        \"parameters\": {\r\n                          \"enabled\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupName\": {\r\n                            \"type\": \"string\"\r\n                          }\r\n                        },\r\n                        \"variables\": {},\r\n                        \"resources\": [\r\n                          {\r\n                            \"type\": \"microsoft.insights/activityLogAlerts\",\r\n                            \"apiVersion\": \"2020-10-01\",\r\n                            \"name\": \"ActivityNSGDelete\",\r\n                            \"location\": \"global\",\r\n                            \"tags\": {\r\n                              \"_deployed_by_alz_monitor\": true\r\n                            },\r\n                            \"properties\": {\r\n                              \"description\": \"Activity Log NSG Delete\",\r\n                              \"enabled\": \"[[parameters('enabled')]\",\r\n                              \"scopes\": [\r\n                                \"[[subscription().id]\"\r\n                              ],\r\n                              \"condition\": {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"category\",\r\n                                    \"equals\": \"Administrative\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"operationName\",\r\n                                    \"equals\": \"Microsoft.Network/networkSecurityGroups/delete\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"status\",\r\n                                    \"containsAny\": [\r\n                                      \"succeeded\"\r\n                                    ]\r\n                                  }\r\n                                ]\r\n                              },\r\n                              \"parameters\": {\r\n                                \"enabled\": {\r\n                                  \"value\": \"[[parameters('enabled')]\"\r\n                                }\r\n                              }\r\n                            }\r\n                          }\r\n                        ]\r\n                      },\r\n                      \"parameters\": {\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"alertResourceGroupName\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"alertResourceGroupName\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                },\r\n                \"alertResourceGroupTags\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\r\n                },\r\n                \"alertResourceGroupLocation\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#50": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_VNET_DDoSAttack_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy VNet DDoS Attack Alert\",\n    \"description\": \"Policy to audit/deploy Virtual Network DDoS Attack Alert\",\n    \"metadata\": {\n      \"version\": \"1.0.1\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_alz_monitor\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"1\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT1M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"0\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisable\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/virtualNetworks\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\n            \"notEquals\": \"true\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/virtualNetworks\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"ifunderddosattack\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/virtualNetworks/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-DDOSAttackAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_alz_monitor\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for VNet DDOS Attack\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"ifunderddosattack\",\n                            \"metricNamespace\": \"Microsoft.Network/virtualNetworks\",\n                            \"metricName\": \"ifunderddosattack\",\n                            \"operator\": \"GreaterThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Maximum\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[parameters('threshold')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#51": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_VnetGw_TunnelBandwidth_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy VNetG Tunnel Bandwidth Alert\",\n    \"description\": \"Policy to audit/deploy Virtual Network Gateway Tunnel Bandwidth Alert\",\n    \"metadata\": {\n      \"version\": \"1.0.1\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_alz_monitor\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"0\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT1M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"1\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisable\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/virtualNetworkGateways\"\n          },\n          {\n            \"field\": \"Microsoft.Network/virtualNetworkGateways/gatewayType\",\n            \"equals\": \"VPN\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\n            \"notEquals\": \"true\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/virtualNetworkGateways\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"TunnelAverageBandwidth\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/virtualNetworkGateways/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-TunnelBandwidthAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_alz_monitor\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for VNet Gateway Tunnel Avg Bandwidth\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"TunnelAverageBandwidth\",\n                            \"metricNamespace\": \"Microsoft.Network/virtualNetworkGateways\",\n                            \"metricName\": \"TunnelAverageBandwidth\",\n                            \"operator\": \"LessThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[parameters('threshold')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#52": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_VnetGw_TunnelEgress_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy VNetG Tunnel Egress Alert\",\n    \"description\": \"Policy to audit/deploy Virtual Network Gateway Tunnel Egress Alert\",\n    \"metadata\": {\n      \"version\": \"1.0.1\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_alz_monitor\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"0\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"1\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"disabled\"\n      },\n      \"MonitorDisable\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/virtualNetworkGateways\"\n          },\n          {\n            \"field\": \"Microsoft.Network/virtualNetworkGateways/gatewayType\",\n            \"equals\": \"VPN\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\n            \"notEquals\": \"true\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/virtualNetworkGateways\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"TunnelEgressBytes\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/virtualNetworkGateways/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-TunnelEgressAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_alz_monitor\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for VNet Gateway Tunnel Egress Bytes\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"TunnelEgressBytes\",\n                            \"metricNamespace\": \"Microsoft.Network/virtualNetworkGateways\",\n                            \"metricName\": \"TunnelEgressBytes\",\n                            \"operator\": \"LessThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[parameters('threshold')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#53": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_VnetGw_TunnelEgressPacketDropCount_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy VNetG Egress Packet Drop Count Alert\",\n    \"description\": \"Policy to audit/deploy Vnet Gateway Egress Packet Drop Count Alert\",\n    \"metadata\": {\n      \"version\": \"1.0.1\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_alz_monitor\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"3\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisable\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"microsoft.network/virtualNetworkGateways\"\n          },\n          {\n            \"field\": \"Microsoft.Network/virtualNetworkGateways/gatewayType\",\n            \"equals\": \"VPN\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\n            \"notEquals\": \"true\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"microsoft.network/virtualNetworkGateways\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"TunnelEgressPacketDropCount\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/microsoft.network/virtualNetworkGateways/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-TunnelEgressPacketDropCountAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_alz_monitor\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for Vnet Gateway tunnel TunnelEgressPacketDropCount\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"alertSensitivity\": \"Medium\",\n                            \"failingPeriods\": {\n                              \"numberOfEvaluationPeriods\": 4,\n                              \"minFailingPeriodsToAlert\": 4\n                            },\n                            \"name\": \"TunnelEgressPacketDropCount\",\n                            \"metricNamespace\": \"microsoft.network/virtualNetworkGateways\",\n                            \"metricName\": \"TunnelEgressPacketDropCount\",\n                            \"operator\": \"GreaterThan\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"DynamicThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#54": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_VnetGw_TunnelEgressPacketDropMismatch_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy VNetG Egress Packet Drop Mismatch Alert\",\n    \"description\": \"Policy to audit/deploy Vnet Gateway Egress Packet Drop Mismatch Alert\",\n    \"metadata\": {\n      \"version\": \"1.0.1\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_alz_monitor\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"3\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisable\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"microsoft.network/virtualNetworkGateways\"\n          },\n          {\n            \"field\": \"Microsoft.Network/virtualNetworkGateways/gatewayType\",\n            \"equals\": \"VPN\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\n            \"notEquals\": \"true\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"microsoft.network/virtualNetworkGateways\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"TunnelEgressPacketDropTSMismatch\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/microsoft.network/virtualNetworkGateways/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-TunnelEgressPacketDropTSMismatchAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_alz_monitor\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for Vnet Gateway tunnel TunnelEgressPacketDropTSMismatch\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"alertSensitivity\": \"Medium\",\n                            \"failingPeriods\": {\n                              \"numberOfEvaluationPeriods\": 4,\n                              \"minFailingPeriodsToAlert\": 4\n                            },\n                            \"name\": \"TunnelEgressPacketDropTSMismatch\",\n                            \"metricNamespace\": \"microsoft.network/virtualNetworkGateways\",\n                            \"metricName\": \"TunnelEgressPacketDropTSMismatch\",\n                            \"operator\": \"GreaterThan\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"DynamicThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#55": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_VnetGw_ExpressRouteBitsPerSecond_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy VNetG ExpressRoute Bits Per Second Alert\",\n    \"description\": \"Policy to audit/deploy Virtual Network Gateway Express Route Bits Per Second Alert\",\n    \"metadata\": {\n      \"version\": \"1.0.1\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_alz_monitor\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"0\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT1M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"1\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisable\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/virtualNetworkGateways\"\n          },\n          {\n            \"field\": \"Microsoft.Network/virtualNetworkGateways/gatewayType\",\n            \"equals\": \"ExpressRoute\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\n            \"notEquals\": \"true\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/virtualNetworkGateways\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"ExpressRouteGatewayBitsPerSecond\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/virtualNetworkGateways/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-GatewayERBitsAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_alz_monitor\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for VNet Gateway Express Route Bits Per Second\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"ExpressRouteGatewayBitsPerSecond\",\n                            \"metricNamespace\": \"Microsoft.Network/virtualNetworkGateways\",\n                            \"metricName\": \"ExpressRouteGatewayBitsPerSecond\",\n                            \"operator\": \"LessThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[parameters('threshold')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#56": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_VnetGw_ExpressRouteCpuUtil_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy VNetG ExpressRoute CPU Utilization Alert\",\n    \"description\": \"Policy to audit/deploy Virtual Network Gateway Express Route CPU Utilization Alert\",\n    \"metadata\": {\n      \"version\": \"1.0.1\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_alz_monitor\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"1\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT1M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"80\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisable\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/virtualNetworkGateways\"\n          },\n          {\n            \"field\": \"Microsoft.Network/virtualNetworkGateways/gatewayType\",\n            \"equals\": \"ExpressRoute\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\n            \"notEquals\": \"true\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/virtualNetworkGateways\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"ExpressRouteGatewayCpuUtilization\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/virtualNetworkGateways/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-GatewayERCPUAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_alz_monitor\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for VNet Gateway Express Route CPU Utilization\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"ExpressRouteGatewayCpuUtilization\",\n                            \"metricNamespace\": \"Microsoft.Network/virtualNetworkGateways\",\n                            \"metricName\": \"ExpressRouteGatewayCpuUtilization\",\n                            \"operator\": \"GreaterThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[parameters('threshold')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#57": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_VnetGw_TunnelIngress_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy VNetG Tunnel Ingress Alert\",\n    \"description\": \"Policy to audit/deploy Virtual Network Gateway Tunnel Ingress Alert\",\n    \"metadata\": {\n      \"version\": \"1.0.1\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_alz_monitor\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"0\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"1\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"disabled\"\n      },\n      \"MonitorDisable\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Network/virtualNetworkGateways\"\n          },\n          {\n            \"field\": \"Microsoft.Network/virtualNetworkGateways/gatewayType\",\n            \"equals\": \"VPN\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\n            \"notEquals\": \"true\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"Microsoft.Network/virtualNetworkGateways\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"TunnelIngressBytes\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/virtualNetworkGateways/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-TunnelIngressAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_alz_monitor\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for VNet Gateway Tunnel ingress Bytes\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"TunnelIngressBytes\",\n                            \"metricNamespace\": \"Microsoft.Network/virtualNetworkGateways\",\n                            \"metricName\": \"TunnelIngressBytes\",\n                            \"operator\": \"LessThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[parameters('threshold')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#58": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_VnetGw_TunnelIngressPacketDropCount_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy VNetG Ingress Packet Drop Count Alert\",\n    \"description\": \"Policy to audit/deploy Vnet Gateway Ingress Packet Drop Count Alert\",\n    \"metadata\": {\n      \"version\": \"1.0.1\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_alz_monitor\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"3\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisable\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"microsoft.network/virtualNetworkGateways\"\n          },\n          {\n            \"field\": \"Microsoft.Network/virtualNetworkGateways/gatewayType\",\n            \"equals\": \"VPN\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\n            \"notEquals\": \"true\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"microsoft.network/virtualNetworkGateways\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"TunnelIngressPacketDropCount\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/microsoft.network/virtualNetworkGateways/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-TunnelIngressPacketDropCountAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_alz_monitor\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for Vnet Gateway tunnel TunnelIngressPacketDropCount\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"alertSensitivity\": \"Medium\",\n                            \"failingPeriods\": {\n                              \"numberOfEvaluationPeriods\": 4,\n                              \"minFailingPeriodsToAlert\": 4\n                            },\n                            \"name\": \"TunnelIngressPacketDropCount\",\n                            \"metricNamespace\": \"microsoft.network/virtualNetworkGateways\",\n                            \"metricName\": \"TunnelIngressPacketDropCount\",\n                            \"operator\": \"GreaterThan\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"DynamicThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#59": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_VnetGw_TunnelIngressPacketDropMismatch_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy VNetG Ingress Packet Drop Mismatch Alert\",\n    \"description\": \"Policy to audit/deploy Vnet Gateway Ingress Packet Drop Mismatch Alert\",\n    \"metadata\": {\n      \"version\": \"1.0.1\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_alz_monitor\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"3\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisable\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"microsoft.network/virtualNetworkGateways\"\n          },\n          {\n            \"field\": \"Microsoft.Network/virtualNetworkGateways/gatewayType\",\n            \"equals\": \"VPN\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\n            \"notEquals\": \"true\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"microsoft.network/virtualNetworkGateways\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"TunnelIngressPacketDropTSMismatch\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/microsoft.network/virtualNetworkGateways/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-TunnelIngressPacketDropTSMismatchAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_alz_monitor\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for Vnet Gateway tunnel TunnelIngressPacketDropTSMismatch\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"alertSensitivity\": \"Medium\",\n                            \"failingPeriods\": {\n                              \"numberOfEvaluationPeriods\": 4,\n                              \"minFailingPeriodsToAlert\": 4\n                            },\n                            \"name\": \"TunnelIngressPacketDropTSMismatch\",\n                            \"metricNamespace\": \"microsoft.network/virtualNetworkGateways\",\n                            \"metricName\": \"TunnelIngressPacketDropTSMismatch\",\n                            \"operator\": \"GreaterThan\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"DynamicThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#6": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_activitylog_ResourceHealth_Unhealthy_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy Resource Health Unhealthy Alert\",\n    \"description\": \"Policy to Deploy Resource Health Unhealthy Alert\",\n    \"metadata\": {\n      \"version\": \"1.0.1\",\n      \"category\": \"Monitoring\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_alz_monitor\": \"True\"\n    },\n    \"parameters\": {\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"alertResourceGroupName\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Resource Group Name\",\n          \"description\": \"Resource group the alert is placed in\"\n        },\n        \"defaultValue\": \"AlzMonitoring-rg\"\n      },\n      \"alertResourceGroupTags\": {\n        \"type\": \"Object\",\n        \"metadata\": {\n          \"displayName\": \"Resource Group Tags\",\n          \"description\": \"Tags on the Resource group the alert is placed in\"\n        },\n        \"defaultValue\": {\n          \"environment\": \"test\",\n          \"_deployed_by_alz_monitor\": true\n        }\n      },\n      \"alertResourceGroupLocation\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Resource Group Location\",\n          \"description\": \"Location of the Resource group the alert is placed in\"\n        },\n        \"defaultValue\": \"centralus\"\n      },\n      \"MonitorDisable\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Tag name to disable monitoring on subscripton level alerts. Set to true if monitoring should be disabled\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"Microsoft.Resources/subscriptions\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\n            \"notEquals\": \"true\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"deployIfNotExists\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"type\": \"Microsoft.Insights/activityLogAlerts\",\n          \"existenceScope\": \"resourcegroup\",\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\n          \"deploymentScope\": \"subscription\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/ActivityLogAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              },\n              {\n                \"count\": {\n                  \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*]\",\n                  \"where\": {\n                    \"anyOf\": [\n                      {\n                        \"allOf\": [\n                          {\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].field\",\n                            \"equals\": \"category\"\n                          },\n                          {\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].equals\",\n                            \"equals\": \"ResourceHealth\"\n                          }\n                        ]\n                      }\n                    ]\n                  }\n                },\n                \"equals\": 1\n              }\n            ]\n          },\n          \"deployment\": {\n            \"location\": \"[[deployment().location]\",\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"alertResourceGroupName\": {\n                    \"type\": \"string\"\n                  },\n                  \"alertResourceGroupTags\": {\n                    \"type\": \"object\"\n                  },\n                  \"alertResourceGroupLocation\": {\n                    \"type\": \"string\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"string\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\n                    \"apiVersion\": \"2021-04-01\",\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\n                  },\n                  {\n                    \"type\": \"Microsoft.Resources/deployments\",\n                    \"apiVersion\": \"2019-10-01\",\n                    \"name\": \"ResourceHealtAlert\",\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\n                    \"dependsOn\": [\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\n                    ],\n                    \"properties\": {\n                      \"mode\": \"Incremental\",\n                      \"template\": {\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                        \"contentVersion\": \"1.0.0.0\",\n                        \"parameters\": {\n                          \"enabled\": {\n                            \"type\": \"string\"\n                          },\n                          \"alertResourceGroupName\": {\n                            \"type\": \"string\"\n                          }\n                        },\n                        \"variables\": {},\n                        \"resources\": [\n                          {\n                            \"type\": \"microsoft.insights/activityLogAlerts\",\n                            \"apiVersion\": \"2020-10-01\",\n                            \"name\": \"ResourceHealthUnhealthyAlert\",\n                            \"location\": \"global\",\n                            \"tags\": {\n                              \"_deployed_by_alz_monitor\": true\n                            },\n                            \"properties\": {\n                              \"description\": \"Resource Health Unhealthy Alert\",\n                              \"enabled\": \"[[parameters('enabled')]\",\n                              \"scopes\": [\n                                \"[[subscription().id]\"\n                              ],\n                              \"condition\": {\n                                \"allOf\": [\n                                  {\n                                    \"field\": \"category\",\n                                    \"equals\": \"ResourceHealth\"\n                                  },\n                                  {\n                                    \"anyOf\": [\n                                      {\n                                        \"field\": \"properties.cause\",\n                                        \"equals\": \"PlatformInitiated\"\n                                      },\n                                      {\n                                        \"field\": \"properties.cause\",\n                                        \"equals\": \"UserInitiated\"\n                                      }\n                                    ]\n                                  },\n                                  {\n                                    \"anyOf\": [\n                                      {\n                                        \"field\": \"properties.currentHealthStatus\",\n                                        \"equals\": \"Degraded\"\n                                      },\n                                      {\n                                        \"field\": \"properties.currentHealthStatus\",\n                                        \"equals\": \"Unavailable\"\n                                      }\n                                    ]\n                                  }\n                                ]\n                              },\n                              \"parameters\": {\n                                \"enabled\": {\n                                  \"value\": \"[[parameters('enabled')]\"\n                                }\n                              }\n                            }\n                          }\n                        ]\n                      },\n                      \"parameters\": {\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"alertResourceGroupName\": {\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"alertResourceGroupName\": {\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\n                },\n                \"alertResourceGroupTags\": {\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\n                },\n                \"alertResourceGroupLocation\": {\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#60": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_VPNGw_BandwidthUtil_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy VPNG Bandwidth Utilization Alert\",\n    \"description\": \"Policy to audit/deploy VPN Gateway Bandwidth Utilization Alert\",\n    \"metadata\": {\n      \"version\": \"1.0.1\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_alz_monitor\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"0\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT1M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"1\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisable\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"microsoft.network/vpngateways\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\n            \"notEquals\": \"true\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"microsoft.network/vpngateways\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"tunnelaveragebandwidth\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/microsoft.network/vpngateways/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-GatewayBandwidthAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_alz_monitor\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for VPN Gateway Bandwidth Utilization\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"tunnelaveragebandwidth\",\n                            \"metricNamespace\": \"microsoft.network/vpngateways\",\n                            \"metricName\": \"tunnelaveragebandwidth\",\n                            \"operator\": \"LessThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[parameters('threshold')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#61": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_VPNGw_BGPPeerStatus_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy VPNG  BGP Peer Status Alert\",\n    \"description\": \"Policy to audit/deploy VPN Gateway BGP Peer Status Alert\",\n    \"metadata\": {\n      \"version\": \"1.0.1\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_alz_monitor\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"0\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT1M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"1\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisable\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"microsoft.network/vpngateways\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\n            \"notEquals\": \"true\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"microsoft.network/vpngateways\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"bgppeerstatus\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/microsoft.network/vpngateways/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-BGPPeerStatusAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_alz_monitor\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for VPN Gateway BGP peer status\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"bgppeerstatus\",\n                            \"metricNamespace\": \"microsoft.network/vpngateways\",\n                            \"metricName\": \"bgppeerstatus\",\n                            \"operator\": \"LessThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Total\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[parameters('threshold')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#62": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_VPNGw_Egress_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy VPNG Egress Alert\",\n    \"description\": \"Policy to audit/deploy VPN Gateway Egress Alert\",\n    \"metadata\": {\n      \"version\": \"1.0.1\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_alz_monitor\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"0\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"1\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"disabled\"\n      },\n      \"MonitorDisable\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"microsoft.network/vpngateways\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\n            \"notEquals\": \"true\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"microsoft.network/vpngateways\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"tunnelegressbytes\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/microsoft.network/vpngateways/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-TunnelEgressAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_alz_monitor\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for VPN Gateway tunnel egress bytes\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"tunnelegressbytes\",\n                            \"metricNamespace\": \"microsoft.network/vpngateways\",\n                            \"metricName\": \"tunnelegressbytes\",\n                            \"operator\": \"LessThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[parameters('threshold')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#63": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_VPNGw_TunnelEgressPacketDropCount_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy VPNG Egress Packet Drop Count Alert\",\n    \"description\": \"Policy to audit/deploy VPN Gateway Egress Packet Drop Count Alert\",\n    \"metadata\": {\n      \"version\": \"1.0.1\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_alz_monitor\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"3\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisable\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"microsoft.network/vpngateways\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\n            \"notEquals\": \"true\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"microsoft.network/vpngateways\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"TunnelEgressPacketDropCount\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/microsoft.network/vpngateways/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-TunnelEgressPacketDropCountAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_alz_monitor\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for VPN Gateway tunnel TunnelEgressPacketDropCount\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"alertSensitivity\": \"Medium\",\n                            \"failingPeriods\": {\n                              \"numberOfEvaluationPeriods\": 4,\n                              \"minFailingPeriodsToAlert\": 4\n                            },\n                            \"name\": \"TunnelEgressPacketDropCount\",\n                            \"metricNamespace\": \"microsoft.network/vpngateways\",\n                            \"metricName\": \"TunnelEgressPacketDropCount\",\n                            \"operator\": \"GreaterThan\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"DynamicThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#64": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_VPNGw_TunnelEgressPacketDropMismatch_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy VPNG Egress Packet Drop Mismatch Alert\",\n    \"description\": \"Policy to audit/deploy VPN Gateway Egress Packet Drop Mismatch Alert\",\n    \"metadata\": {\n      \"version\": \"1.0.1\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_alz_monitor\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"3\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisable\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"microsoft.network/vpngateways\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\n            \"notEquals\": \"true\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"microsoft.network/vpngateways\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"TunnelEgressPacketDropTSMismatch\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/microsoft.network/vpngateways/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-TunnelEgressPacketDropTSMismatchAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_alz_monitor\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for VPN Gateway tunnel TunnelEgressPacketDropTSMismatch\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"alertSensitivity\": \"Medium\",\n                            \"failingPeriods\": {\n                              \"numberOfEvaluationPeriods\": 4,\n                              \"minFailingPeriodsToAlert\": 4\n                            },\n                            \"name\": \"TunnelEgressPacketDropTSMismatch\",\n                            \"metricNamespace\": \"microsoft.network/vpngateways\",\n                            \"metricName\": \"TunnelEgressPacketDropTSMismatch\",\n                            \"operator\": \"GreaterThan\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"DynamicThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#65": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_VPNGw_Ingress_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy VPNG Ingress Alert\",\n    \"description\": \"Policy to audit/deploy VPN Gateway Ingress Alert\",\n    \"metadata\": {\n      \"version\": \"1.0.1\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_alz_monitor\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"0\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"threshold\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Threshold\",\n          \"description\": \"Threshold for the alert\"\n        },\n        \"defaultValue\": \"1\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"disabled\"\n      },\n      \"MonitorDisable\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"microsoft.network/vpngateways\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\n            \"notEquals\": \"true\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"microsoft.network/vpngateways\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"tunnelingressbytes\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/microsoft.network/vpngateways/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  },\n                  \"threshold\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-TunnelIngressAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_alz_monitor\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for VPN Gateway tunnel ingress bytes\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"name\": \"tunnelingressbytes\",\n                            \"metricNamespace\": \"microsoft.network/vpngateways\",\n                            \"metricName\": \"tunnelingressbytes\",\n                            \"operator\": \"LessThan\",\n                            \"threshold\": \"[[parameters('threshold')]\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"StaticThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        },\n                        \"threshold\": {\n                          \"value\": \"[[parameters('threshold')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                },\n                \"threshold\": {\n                  \"value\": \"[[parameters('threshold')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#66": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_VPNGw_TunnelIngressPacketDropCount_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy VPNG Ingress Packet Drop Count Alert\",\n    \"description\": \"Policy to audit/deploy VPN Gateway Ingress Packet Drop Count Alert\",\n    \"metadata\": {\n      \"version\": \"1.0.1\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_alz_monitor\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"3\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisable\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"microsoft.network/vpngateways\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\n            \"notEquals\": \"true\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"microsoft.network/vpngateways\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"TunnelIngressPacketDropCount\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/microsoft.network/vpngateways/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-TunnelIngressPacketDropCountAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_alz_monitor\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for VPN Gateway tunnel TunnelIngressPacketDropCount\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"alertSensitivity\": \"Medium\",\n                            \"failingPeriods\": {\n                              \"numberOfEvaluationPeriods\": 4,\n                              \"minFailingPeriodsToAlert\": 4\n                            },\n                            \"name\": \"TunnelIngressPacketDropCount\",\n                            \"metricNamespace\": \"microsoft.network/vpngateways\",\n                            \"metricName\": \"TunnelIngressPacketDropCount\",\n                            \"operator\": \"GreaterThan\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"DynamicThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#67": "{\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\n  \"apiVersion\": \"2021-06-01\",\n  \"name\": \"Deploy_VPNGw_TunnelIngressPacketDropMismatch_Alert\",\n  \"properties\": {\n    \"policyType\": \"Custom\",\n    \"mode\": \"All\",\n    \"displayName\": \"Deploy VPNG Ingress Packet Drop Mismatch Alert\",\n    \"description\": \"Policy to audit/deploy VPN Gateway Ingress Packet Drop Mismatch Alert\",\n    \"metadata\": {\n      \"version\": \"1.0.1\",\n      \"category\": \"Network\",\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\n      \"alzCloudEnvironments\": [\n        \"AzureCloud\"\n      ],\n      \"_deployed_by_alz_monitor\": \"True\"\n    },\n    \"parameters\": {\n      \"severity\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Severity\",\n          \"description\": \"Severity of the Alert\"\n        },\n        \"allowedValues\": [\n          \"0\",\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\"\n        ],\n        \"defaultValue\": \"3\"\n      },\n      \"windowSize\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Window Size\",\n          \"description\": \"Window size for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\",\n          \"PT6H\",\n          \"PT12H\",\n          \"P1D\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"evaluationFrequency\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Evaluation Frequency\",\n          \"description\": \"Evaluation frequency for the alert\"\n        },\n        \"allowedValues\": [\n          \"PT1M\",\n          \"PT5M\",\n          \"PT15M\",\n          \"PT30M\",\n          \"PT1H\"\n        ],\n        \"defaultValue\": \"PT5M\"\n      },\n      \"autoMitigate\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Auto Mitigate\",\n          \"description\": \"Auto Mitigate for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"enabled\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Alert State\",\n          \"description\": \"Alert state for the alert\"\n        },\n        \"allowedValues\": [\n          \"true\",\n          \"false\"\n        ],\n        \"defaultValue\": \"true\"\n      },\n      \"effect\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Effect of the policy\"\n        },\n        \"allowedValues\": [\n          \"deployIfNotExists\",\n          \"disabled\"\n        ],\n        \"defaultValue\": \"deployIfNotExists\"\n      },\n      \"MonitorDisable\": {\n        \"type\": \"String\",\n        \"metadata\": {\n          \"displayName\": \"Effect\",\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\n        },\n        \"defaultValue\": \"MonitorDisable\"\n      }\n    },\n    \"policyRule\": {\n      \"if\": {\n        \"allOf\": [\n          {\n            \"field\": \"type\",\n            \"equals\": \"microsoft.network/vpngateways\"\n          },\n          {\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\n            \"notEquals\": \"true\"\n          }\n        ]\n      },\n      \"then\": {\n        \"effect\": \"[[parameters('effect')]\",\n        \"details\": {\n          \"roleDefinitionIds\": [\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\n          ],\n          \"type\": \"Microsoft.Insights/metricAlerts\",\n          \"existenceCondition\": {\n            \"allOf\": [\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\n                \"equals\": \"microsoft.network/vpngateways\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria.allOf[*].metricName\",\n                \"equals\": \"TunnelIngressPacketDropTSMismatch\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/microsoft.network/vpngateways/', field('fullName'))]\"\n              },\n              {\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\n                \"equals\": \"[[parameters('enabled')]\"\n              }\n            ]\n          },\n          \"deployment\": {\n            \"properties\": {\n              \"mode\": \"incremental\",\n              \"template\": {\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n                \"contentVersion\": \"1.0.0.0\",\n                \"parameters\": {\n                  \"resourceName\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceName\",\n                      \"description\": \"Name of the resource\"\n                    }\n                  },\n                  \"resourceId\": {\n                    \"type\": \"String\",\n                    \"metadata\": {\n                      \"displayName\": \"resourceId\",\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\n                    }\n                  },\n                  \"severity\": {\n                    \"type\": \"String\"\n                  },\n                  \"windowSize\": {\n                    \"type\": \"String\"\n                  },\n                  \"evaluationFrequency\": {\n                    \"type\": \"String\"\n                  },\n                  \"autoMitigate\": {\n                    \"type\": \"String\"\n                  },\n                  \"enabled\": {\n                    \"type\": \"String\"\n                  }\n                },\n                \"variables\": {},\n                \"resources\": [\n                  {\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\n                    \"apiVersion\": \"2018-03-01\",\n                    \"name\": \"[[concat(parameters('resourceName'), '-TunnelIngressPacketDropTSMismatchAlert')]\",\n                    \"location\": \"global\",\n                    \"tags\": {\n                      \"_deployed_by_alz_monitor\": true\n                    },\n                    \"properties\": {\n                      \"description\": \"Metric Alert for VPN Gateway tunnel TunnelIngressPacketDropTSMismatch\",\n                      \"severity\": \"[[parameters('severity')]\",\n                      \"enabled\": \"[[parameters('enabled')]\",\n                      \"scopes\": [\n                        \"[[parameters('resourceId')]\"\n                      ],\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\n                      \"windowSize\": \"[[parameters('windowSize')]\",\n                      \"criteria\": {\n                        \"allOf\": [\n                          {\n                            \"alertSensitivity\": \"Medium\",\n                            \"failingPeriods\": {\n                              \"numberOfEvaluationPeriods\": 4,\n                              \"minFailingPeriodsToAlert\": 4\n                            },\n                            \"name\": \"TunnelIngressPacketDropTSMismatch\",\n                            \"metricNamespace\": \"microsoft.network/vpngateways\",\n                            \"metricName\": \"TunnelIngressPacketDropTSMismatch\",\n                            \"operator\": \"GreaterThan\",\n                            \"timeAggregation\": \"Average\",\n                            \"criterionType\": \"DynamicThresholdCriterion\"\n                          }\n                        ],\n                        \"odata.type\": \"Microsoft.Azure.Monitor.MultipleResourceMultipleMetricCriteria\"\n                      },\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\n                      \"parameters\": {\n                        \"severity\": {\n                          \"value\": \"[[parameters('severity')]\"\n                        },\n                        \"windowSize\": {\n                          \"value\": \"[[parameters('windowSize')]\"\n                        },\n                        \"evaluationFrequency\": {\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\n                        },\n                        \"autoMitigate\": {\n                          \"value\": \"[[parameters('autoMitigate')]\"\n                        },\n                        \"enabled\": {\n                          \"value\": \"[[parameters('enabled')]\"\n                        }\n                      }\n                    }\n                  }\n                ]\n              },\n              \"parameters\": {\n                \"resourceName\": {\n                  \"value\": \"[[field('name')]\"\n                },\n                \"resourceId\": {\n                  \"value\": \"[[field('id')]\"\n                },\n                \"severity\": {\n                  \"value\": \"[[parameters('severity')]\"\n                },\n                \"windowSize\": {\n                  \"value\": \"[[parameters('windowSize')]\"\n                },\n                \"evaluationFrequency\": {\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\n                },\n                \"autoMitigate\": {\n                  \"value\": \"[[parameters('autoMitigate')]\"\n                },\n                \"enabled\": {\n                  \"value\": \"[[parameters('enabled')]\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",
    "$fxv#68": "{\r\n  \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Alerting-Connectivity\",\r\n  \"properties\": {\r\n    \"displayName\": \"Deploy Connectivity alerts\",\r\n    \"description\": \"Initiative to deploy AMBA alerts relevant to the ALZ Connectivity Management group\",\r\n    \"metadata\": {    \r\n      \"version\": \"1.2.0\",\r\n      \"category\": \"Monitoring\",\r\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_alz_monitor\": true\r\n    },\r\n    \"parameters\": {\r\n      \"ALZMonitorResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"ALZ-Monitoring-RG\"\r\n      },\r\n      \"ALZMonitorResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"defaultValue\": {\r\n          \"_deployed_by_alz_monitor\": true\r\n        }\r\n      },\r\n      \"ALZMonitorResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"centralus\"\r\n      },\r\n      \"ERCIRQoSDropBitsinPerSecAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"2\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"ERCIRQoSDropBitsinPerSecWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"ERCIRQoSDropBitsinPerSecEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"ERCIRQoSDropBitsinPerSecPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"ERCIRQoSDropBitsinPerSecAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"ERCIRQoSDropBitsoutPerSecAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"2\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"ERCIRQoSDropBitsoutPerSecWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"ERCIRQoSDropBitsoutPerSecEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"ERCIRQoSDropBitsoutPerSecPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"ERCIRQoSDropBitsoutPerSecAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"VPNGwBGPPeerStatusAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"3\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"VPNGwBGPPeerStatusWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"VPNGwBGPPeerStatusEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"VPNGwBGPPeerStatusPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"VPNGwBGPPeerStatusAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"VPNGwBGPPeerStatusThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"VnetGwERCpuUtilAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"3\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"VnetGwERCpuUtilWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"VnetGwERCpuUtilEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT1M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"VnetGwERCpuUtilPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"VnetGwERCpuUtilAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"VnetGwERCpuUtilThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"80\"\r\n      },\r\n      \"VnetGwTunnelBWAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"0\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"VnetGwTunnelBWWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"VnetGwTunnelBWEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT1M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"VnetGwTunnelBWPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"VnetGwTunnelBWAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"VnetGwTunnelBWThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"VnetGwTunnelEgressAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"0\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"VnetGwTunnelEgressWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"VnetGwTunnelEgressEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"VnetGwTunnelEgressPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"disabled\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"VnetGwTunnelEgressAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"VnetGwTunnelEgressThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"VnetGwTunnelIngressAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"0\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"VnetGwTunnelIngressWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"VnetGwTunnelIngressEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"VnetGwTunnelIngressPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"disabled\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"VnetGwTunnelIngressAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"VnetGwTunnelIngressThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"VPNGWBandWidthUtilAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"0\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"VPNGWBandWidthUtilWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"VPNGWBandWidthUtilEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"VPNGWBandWidthUtilPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"VPNGWBandWidthUtilAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"VPNGWBandWidthUtilThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"VPNGWEgressAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"0\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"VPNGWEgressWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"VPNGWEgressEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"VPNGWEgressPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"disabled\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"VPNGWEgressAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"VPNGWEgressThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"VPNGWTunnelEgressPacketDropCountAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"3\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"VPNGWTunnelEgressPacketDropCountWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"VPNGWTunnelEgressPacketDropCountFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"VPNGWTunnelEgressPacketDropCountPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"VPNGWTunnelEgressPacketDropCountAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"VPNGWTunnelEgressPacketDropMismatchAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"3\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"VPNGWTunnelEgressPacketDropMismatchWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"VPNGWTunnelEgressPacketDropMismatchFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"VPNGWTunnelEgressPacketDropMismatchPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"VPNGWTunnelEgressPacketDropMismatchAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"VPNGWIngressAlertSeverity\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"0\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"VPNGWIngressWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"VPNGWIngressEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"VPNGWIngressPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"disabled\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"VPNGWIngressAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"VPNGWIngressThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"VPNGWIngressAutoMitigate\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"VPNGWTunnelIngressPacketDropCountAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"3\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"VPNGWTunnelIngressPacketDropCountWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"VPNGWTunnelIngressPacketDropCountFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"VPNGWTunnelIngressPacketDropCountPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"VPNGWTunnelIngressPacketDropCountAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"VPNGWTunnelIngressPacketDropMismatchAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"3\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"VPNGWTunnelIngressPacketDropMismatchWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"VPNGWTunnelIngressPacketDropMismatchFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"VPNGWTunnelIngressPacketDropMismatchPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"VPNGWTunnelIngressPacketDropMismatchAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"PDNSZCapacityUtilAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"2\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"PDNSZCapacityUtilWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT1H\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"PDNSZCapacityUtilEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT1H\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"PDNSZCapacityUtilPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"PDNSZCapacityUtilAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"PDNSZCapacityUtilThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"80\"\r\n      },\r\n      \"PDNSZQueryVolumeAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"4\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"PDNSZQueryVolumeWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT1H\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"PDNSZQueryVolumeEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT1H\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"PDNSZQueryVolumePolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"disabled\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"PDNSZQueryVolumeAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"PDNSZQueryVolumeThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"500\"\r\n      },\r\n      \"PDNSZRecordSetCapacityAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"2\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"PDNSZRecordSetCapacityWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT1H\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"PDNSZRecordSetCapacityEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT1H\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"PDNSZRecordSetCapacityPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"PDNSZRecordSetCapacityAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"PDNSZRecordSetCapacityThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"80\"\r\n      },\r\n      \"PDNSZRegistrationCapacityUtilAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"2\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"PDNSZRegistrationCapacityUtilWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT1H\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"PDNSZRegistrationCapacityUtilEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT1H\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"PDNSZRegistrationCapacityUtilPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"PDNSZRegistrationCapacityUtilAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"PDNSZRegistrationCapacityUtilThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"80\"\r\n      },\r\n      \"PIPDDoSAttackAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"1\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"PIPDDoSAttackWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"PIPDDoSAttackEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"PIPDDoSAttackPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"PIPDDoSAttackAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"PIPDDoSAttackThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"0\"\r\n      },\r\n      \"PIPPacketsInDDoSAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"4\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"PIPPacketsInDDoSWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"PIPPacketsInDDoSEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"PIPPacketsInDDoSPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"disabled\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"PIPPacketsInDDoSAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"PIPPacketsInDDoSThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"40000\"\r\n      },\r\n      \"PIPVIPAvailabilityAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"1\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"PIPVIPAvailabilityWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"PIPVIPAvailabilityEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT1M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"PIPVIPAvailabilityPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"PIPVIPAvailabilityAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"PIPVIPAvailabilityThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"PIPBytesInDDoSAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"4\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"PIPBytesInDDoSWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"PIPBytesInDDoSEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"PIPBytesInDDoSPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"disabled\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"PIPBytesInDDoSAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"PIPBytesInDDoSThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"8000000\"\r\n      },\r\n      \"ERGwExpressRouteBitsInAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"0\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"ERGwExpressRouteBitsInWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"ERGwExpressRouteBitsInEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"ERGwExpressRouteBitsInPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"disabled\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"ERGwExpressRouteBitsInAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"ERGwExpressRouteBitsInThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"ERGwExpressRouteBitsOutAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"0\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"ERGwExpressRouteBitsOutWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"ERGwExpressRouteBitsOutEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"ERGwExpressRouteBitsOutPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"disabled\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"ERGwExpressRouteBitsOutAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"ERGwExpressRouteBitsOutThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"ERGwExpressRouteCpuUtilAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"1\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"ERGwExpressRouteCpuUtilWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"ERGwExpressRouteCpuUtilEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT1M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"ERGwExpressRouteCpuUtilPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"ERGwExpressRouteCpuUtilAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"ERGwExpressRouteCpuUtilThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"80\"\r\n      },\r\n      \"VNETDDOSAttackAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"1\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"VNETDDOSAttackWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"VNETDDOSAttackEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT1M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"VNETDDOSAttackPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"VNETDDOSAttackAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"VNETDDOSAttackThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"VnetGwTunnelEgressPacketDropCountAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"1\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"VnetGwTunnelEgressPacketDropCountWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"VnetGwTunnelEgressPacketDropCountEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"VnetGwTunnelEgressPacketDropCountPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"VnetGwTunnelEgressPacketDropCountAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"VnetGwTunnelEgressPacketDropMismatchAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"3\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"VnetGwTunnelEgressPacketDropMismatchWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"VnetGwTunnelEgressPacketDropMismatchEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"VnetGwTunnelEgressPacketDropMismatchPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"VnetGwTunnelEgressPacketDropMismatchAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"VnetGwExpressRouteBitsPerSecondAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"0\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"VnetGwExpressRouteBitsPerSecondWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"VnetGwExpressRouteBitsPerSecondEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT1M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"VnetGwExpressRouteBitsPerSecondPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"VnetGwExpressRouteBitsPerSecondAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"VnetGwExpressRouteBitsPerSecondThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"VnetGwTunnelIngressPacketDropMismatchAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"3\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"VnetGwTunnelIngressPacketDropMismatchWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"VnetGwTunnelIngressPacketDropMismatchEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"VnetGwTunnelIngressPacketDropMismatchPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"VnetGwTunnelIngressPacketDropMismatchAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"VnetGwTunnelIngressPacketDropCountAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"3\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"VnetGwTunnelIngressPacketDropCountWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"VnetGwTunnelIngressPacketDropCountEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"VnetGwTunnelIngressPacketDropCountPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"VnetGwTunnelIngressPacketDropCountAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"ERCIRBgpAvailabilityAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"0\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"ERCIRBgpAvailabilityWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"ERCIRBgpAvailabilityEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT1M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"ERCIRBgpAvailabilityPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"ERCIRBgpAvailabilityAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"ERCIRBgpAvailabilityThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"90\"\r\n      },\r\n      \"ERCIRArpAvailabilityAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"0\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"ERCIRArpAvailabilityWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"ERCIRArpAvailabilityFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT1M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"ERCIRArpAvailabilityPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"ERCIRArpAvailabilityAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"ERCIRArpAvailabilityThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"90\"\r\n      },\r\n      \"AFWSNATPortUtilizationAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"1\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"AFWSNATPortUtilizationWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"AFWSNATPortUtilizationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT1M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"AFWSNATPortUtilizationPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"AFWSNATPortUtilizationAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"AFWSNATPortUtilizationThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"80\"\r\n      },\r\n      \"FirewallHealthAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"0\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"FirewallHealthWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"FirewallHealthEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT1M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"FirewallHealthPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"FirewallHealthAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"FirewallHealthThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"90\"\r\n      },\r\n      \"activityFWDeleteAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"activityNSGDeleteAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"activityUDRUpdateAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"activityVPNGWDeleteAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      }\r\n    },\r\n    \"policyDefinitions\": [\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_ERCIRQoSDropBitsinPerSec\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_ERCIR_QosDropBitsInPerSecond_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('ERCIRQoSDropBitsinPerSecAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('ERCIRQoSDropBitsinPerSecWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('ERCIRQoSDropBitsinPerSecEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('ERCIRQoSDropBitsinPerSecPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('ERCIRQoSDropBitsinPerSecAlertState')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_ERCIRQoSDropBitsoutPerSec\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_ERCIR_QosDropBitsOutPerSecond_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('ERCIRQoSDropBitsoutPerSecAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('ERCIRQoSDropBitsoutPerSecWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('ERCIRQoSDropBitsoutPerSecEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('ERCIRQoSDropBitsoutPerSecPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('ERCIRQoSDropBitsoutPerSecAlertState')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VPNGwBGPPeerStatus\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VPNGw_BGPPeerStatus_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VPNGwBGPPeerStatusAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VPNGwBGPPeerStatusWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VPNGwBGPPeerStatusEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VPNGwBGPPeerStatusPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VPNGwBGPPeerStatusAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('VPNGwBGPPeerStatusThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VnetGwERCpuUtil\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VnetGw_ExpressRouteCpuUtil_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VnetGwERCpuUtilAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VnetGwERCpuUtilWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VnetGwERCpuUtilEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VnetGwERCpuUtilPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VnetGwERCpuUtilAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('VnetGwERCpuUtilThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VnetGwTunnelBW\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VnetGw_TunnelBandwidth_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelBWAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelBWWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelBWEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelBWPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelBWAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelBWThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VnetGwTunnelEgress\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VnetGw_TunnelEgress_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelEgressAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelEgressWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelEgressEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelEgressPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelEgressAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelEgressThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VnetGwTunnelIngress\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VnetGw_TunnelIngress_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelIngressAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelIngressWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelIngressEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelIngressPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelIngressAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelIngressThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VPNGWBandWidthUtil\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VPNGw_BandwidthUtil_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VPNGWBandWidthUtilAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VPNGWBandWidthUtilWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VPNGWBandWidthUtilEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VPNGWBandWidthUtilPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VPNGWBandWidthUtilAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('VPNGWBandWidthUtilThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VPNGWEgress\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VPNGw_Egress_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VPNGWEgressAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VPNGWEgressWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VPNGWEgressEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VPNGWEgressPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VPNGWEgressAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('VPNGWEgressThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VPNGWTunnelEgressPacketDropCount\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VPNGw_TunnelEgressPacketDropCount_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VPNGWTunnelEgressPacketDropCountAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VPNGWTunnelEgressPacketDropCountWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VPNGWTunnelEgressPacketDropCountFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VPNGWTunnelEgressPacketDropCountPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VPNGWTunnelEgressPacketDropCountAlertState')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VPNGWTunnelEgressPacketDropMismatch\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VPNGw_TunnelEgressPacketDropMismatch_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VPNGWTunnelEgressPacketDropMismatchAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VPNGWTunnelEgressPacketDropMismatchWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VPNGWTunnelEgressPacketDropMismatchFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VPNGWTunnelEgressPacketDropMismatchPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VPNGWTunnelEgressPacketDropMismatchAlertState')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VPNGWIngress\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VPNGw_Ingress_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VPNGWIngressAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VPNGWIngressWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VPNGWIngressEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VPNGWIngressPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VPNGWIngressAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('VPNGWIngressThreshold')]\"\r\n          },\r\n          \"autoMitigate\": {\r\n            \"value\": \"[[parameters('VPNGWIngressAutoMitigate')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VPNGWTunnelIngressPacketDropCount\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VPNGw_TunnelIngressPacketDropCount_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VPNGWTunnelIngressPacketDropCountAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VPNGWTunnelIngressPacketDropCountWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VPNGWTunnelIngressPacketDropCountFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VPNGWTunnelIngressPacketDropCountPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VPNGWTunnelIngressPacketDropCountAlertState')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VPNGWTunnelIngressPacketDropMismatch\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VPNGw_TunnelIngressPacketDropMismatch_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VPNGWTunnelIngressPacketDropMismatchAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VPNGWTunnelIngressPacketDropMismatchWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VPNGWTunnelIngressPacketDropMismatchFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VPNGWTunnelIngressPacketDropMismatchPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VPNGWTunnelIngressPacketDropMismatchAlertState')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_PDNSZCapacityUtil\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_PDNSZ_CapacityUtil_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('PDNSZCapacityUtilAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('PDNSZCapacityUtilWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('PDNSZCapacityUtilEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('PDNSZCapacityUtilPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('PDNSZCapacityUtilAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('PDNSZCapacityUtilThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_PDNSZQueryVolume\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_PDNSZ_QueryVolume_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('PDNSZQueryVolumeAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('PDNSZQueryVolumeWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('PDNSZQueryVolumeEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('PDNSZQueryVolumePolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('PDNSZQueryVolumeAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('PDNSZQueryVolumeThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_PDNSZRecordSetCapacity\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_PDNSZ_RecordSetCapacity_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('PDNSZRecordSetCapacityAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('PDNSZRecordSetCapacityWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('PDNSZRecordSetCapacityEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('PDNSZRecordSetCapacityPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('PDNSZRecordSetCapacityAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('PDNSZRecordSetCapacityThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_PDNSZRegistrationCapacityUtil\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_DNSZ_RegistrationCapacityUtil_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('PDNSZRegistrationCapacityUtilAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('PDNSZRegistrationCapacityUtilWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('PDNSZRegistrationCapacityUtilEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('PDNSZRegistrationCapacityUtilPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('PDNSZRegistrationCapacityUtilAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('PDNSZRegistrationCapacityUtilThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_ERGwExpressRouteBitsIn\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_ERGw_ExpressRouteBitsIn_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('ERGwExpressRouteBitsInAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('ERGwExpressRouteBitsInWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('ERGwExpressRouteBitsInEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('ERGwExpressRouteBitsInPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('ERGwExpressRouteBitsInAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('ERGwExpressRouteBitsInThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_ERGwExpressRouteBitsOut\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_ERGw_ExpressRouteBitsOut_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('ERGwExpressRouteBitsOutAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('ERGwExpressRouteBitsOutWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('ERGwExpressRouteBitsOutEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('ERGwExpressRouteBitsOutPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('ERGwExpressRouteBitsOutAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('ERGwExpressRouteBitsOutThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_ERGwExpressRouteCpuUtil\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_ERGw_ExpressRouteCpuUtil_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('ERGwExpressRouteCpuUtilAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('ERGwExpressRouteCpuUtilWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('ERGwExpressRouteCpuUtilEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('ERGwExpressRouteCpuUtilPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('ERGwExpressRouteCpuUtilAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('ERGwExpressRouteCpuUtilThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VnetGwTunnelEgressPacketDropCount\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VnetGw_TunnelEgressPacketDropCount_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelEgressPacketDropCountAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelEgressPacketDropCountWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelEgressPacketDropCountEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelEgressPacketDropCountPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelEgressPacketDropCountAlertState')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VnetGwTunnelEgressPacketDropMismatch\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VnetGw_TunnelEgressPacketDropMismatch_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelEgressPacketDropMismatchAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelEgressPacketDropMismatchWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelEgressPacketDropMismatchEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelEgressPacketDropMismatchPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelEgressPacketDropMismatchAlertState')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VnetGwExpressRouteBitsPerSecond\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VnetGw_ExpressRouteBitsPerSecond_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VnetGwExpressRouteBitsPerSecondAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VnetGwExpressRouteBitsPerSecondWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VnetGwExpressRouteBitsPerSecondEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VnetGwExpressRouteBitsPerSecondPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VnetGwExpressRouteBitsPerSecondAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('VnetGwExpressRouteBitsPerSecondThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VnetGwTunnelIngressPacketDropMismatchWindowSize\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VnetGw_TunnelIngressPacketDropMismatch_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelIngressPacketDropMismatchAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelIngressPacketDropMismatchWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelIngressPacketDropMismatchEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelIngressPacketDropMismatchPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelIngressPacketDropMismatchAlertState')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VnetGwTunnelIngressPacketDropCountWindowSize\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VnetGw_TunnelIngressPacketDropCount_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelIngressPacketDropCountAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelIngressPacketDropCountWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelIngressPacketDropCountEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelIngressPacketDropCountPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VnetGwTunnelIngressPacketDropCountAlertState')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_ERCIRBgpAvailability\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_ERCIR_BgpAvailability_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('ERCIRBgpAvailabilityAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('ERCIRBgpAvailabilityWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('ERCIRBgpAvailabilityEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('ERCIRBgpAvailabilityPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('ERCIRBgpAvailabilityAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('ERCIRBgpAvailabilityThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_ERCIRArpAvailability\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_ERCIR_ArpAvailability_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('ERCIRArpAvailabilityAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('ERCIRArpAvailabilityWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('ERCIRArpAvailabilityFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('ERCIRArpAvailabilityPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('ERCIRArpAvailabilityAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('ERCIRArpAvailabilityThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_AFWSNATPortUtilization\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_AFW_SNATPortUtilization_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('AFWSNATPortUtilizationAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('AFWSNATPortUtilizationWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('AFWSNATPortUtilizationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('AFWSNATPortUtilizationPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('AFWSNATPortUtilizationAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('AFWSNATPortUtilizationThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_PIPBytesInDDoSEvaluationFrequency\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_PublicIp_BytesInDDoSAttack_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('PIPBytesInDDoSAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('PIPBytesInDDoSWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('PIPBytesInDDoSEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('PIPBytesInDDoSPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('PIPBytesInDDoSAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('PIPBytesInDDoSThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_PIPDDoSAttack\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_PublicIp_DDoSAttack_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('PIPDDoSAttackAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('PIPDDoSAttackWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('PIPDDoSAttackEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('PIPDDoSAttackPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('PIPDDoSAttackAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('PIPDDoSAttackThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_PIPPacketsInDDoS\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_PublicIp_PacketsInDDoSAttack_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('PIPPacketsInDDoSAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('PIPPacketsInDDoSWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('PIPPacketsInDDoSEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('PIPPacketsInDDoSPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('PIPPacketsInDDoSAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('PIPPacketsInDDoSThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_PIPVIPAvailability\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_PublicIp_VIPAvailability_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('PIPVIPAvailabilityAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('PIPVIPAvailabilityWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('PIPVIPAvailabilityEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('PIPVIPAvailabilityPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('PIPVIPAvailabilityAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('PIPVIPAvailabilityThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VNETDDOSAttack\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VNET_DDoSAttack_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VNETDDOSAttackAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VNETDDOSAttackWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VNETDDOSAttackEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VNETDDOSAttackPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VNETDDOSAttackAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('VNETDDOSAttackThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_FirewallHealth\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_AFW_FirewallHealth_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('FirewallHealthAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('FirewallHealthWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('FirewallHealthEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('FirewallHealthPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('FirewallHealthAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('FirewallHealthThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_activityFWDelete\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_activitylog_Firewall_Delete')]\",\r\n        \"parameters\": {\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('activityFWDeleteAlertState')]\"\r\n          },\r\n          \"alertResourceGroupName\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupName')]\"\r\n          },\r\n          \"alertResourceGroupTags\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupTags')]\"\r\n          },\r\n          \"alertResourceGroupLocation\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupLocation')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_activityNSGDelete\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_activitylog_NSG_Delete')]\",\r\n        \"parameters\": {\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('activityNSGDeleteAlertState')]\"\r\n          },\r\n          \"alertResourceGroupName\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupName')]\"\r\n          },\r\n          \"alertResourceGroupTags\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupTags')]\"\r\n          },\r\n          \"alertResourceGroupLocation\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupLocation')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_activityUDRUpdate\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_activitylog_RouteTable_Update')]\",\r\n        \"parameters\": {\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('activityUDRUpdateAlertState')]\"\r\n          },\r\n          \"alertResourceGroupName\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupName')]\"\r\n          },\r\n          \"alertResourceGroupTags\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupTags')]\"\r\n          },\r\n          \"alertResourceGroupLocation\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupLocation')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_activityVPNGWDelete\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_activitylog_VPNGateway_Delete')]\",\r\n        \"parameters\": {\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('activityVPNGWDeleteAlertState')]\"\r\n          },\r\n          \"alertResourceGroupName\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupName')]\"\r\n          },\r\n          \"alertResourceGroupTags\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupTags')]\"\r\n          },\r\n          \"alertResourceGroupLocation\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupLocation')]\"\r\n          }\r\n        }\r\n      }\r\n    ],\r\n    \"policyType\": \"Custom\",\r\n    \"policyDefinitionGroups\": null\r\n  }\r\n}",
    "$fxv#69": "    {\r\n  \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Alerting-Identity\",\r\n  \"properties\": {\r\n    \"displayName\": \"Deploy Identity alerts\",\r\n    \"description\": \"Initiative to deploy AMBA alerts relevant to the ALZ Identity Management group\",\r\n    \"metadata\": {\r\n      \"version\": \"1.2.0\",\r\n      \"category\": \"Monitoring\",\r\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_alz_monitor\": true\r\n    },\r\n    \"parameters\": {\r\n      \"ALZMonitorResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"ALZ-Monitoring-RG\"\r\n      },\r\n      \"ALZMonitorResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"defaultValue\": {\r\n          \"_deployed_by_alz_monitor\": true\r\n        }\r\n      },\r\n      \"ALZMonitorResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"centralus\"\r\n      },\r\n      \"KVRequestAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"2\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"KVRequestWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"KVRequestEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"KVRequestPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"disabled\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"KVRequestAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"KvAvailabilityAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"1\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"KvAvailabilityWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT1M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"KvAvailabilityEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT1M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"KvAvailabilityPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"disabled\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"KvAvailabilityAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"KVAvailabilityThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"20\"\r\n      },\r\n      \"KvLatencyAvailabilityAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"3\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"KvLatencyAvailabilityWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"KvLatencyAvailabilityEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"KvLatencyAvailabilityPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"disabled\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"KvLatencyAvailabilityAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"KvLatencyAvailabilityThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1000\"\r\n      },\r\n      \"KVCapacityAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"1\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"KVCapacityWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"KVCapacityEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT1M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"KVCapacityPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"disabled\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"KVCapacityAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"KVCapacityThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"75\"\r\n      },\r\n      \"activityKVDeleteAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      }\r\n    },\r\n    \"policyDefinitions\": [\r\n\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_KVRequest\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_KeyVault_Requests_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('KVRequestAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('KVRequestWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('KVRequestEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('KVRequestPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('KVRequestAlertState')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_KvAvailability\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_KeyVault_Availability_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('KvAvailabilityAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('KvAvailabilityWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('KvAvailabilityEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('KvAvailabilityPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('KvAvailabilityAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('KVAvailabilityThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_KvLatencyAvailability\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_KeyVault_Latency_Alert')]\",\r\n        \"parameters\": {\r\n\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('KvLatencyAvailabilityAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('KvLatencyAvailabilityWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('KvLatencyAvailabilityEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('KvLatencyAvailabilityPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('KvLatencyAvailabilityAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('KvLatencyAvailabilityThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_KVCapacity\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_KeyVault_Capacity_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('KVCapacityAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('KVCapacityWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('KVCapacityEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('KVCapacityPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('KVCapacityAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('KVCapacityThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_activityKVDelete\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_activitylog_KeyVault_Delete')]\",\r\n        \"parameters\": {\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('activityKVDeleteAlertState')]\"\r\n          },\r\n          \"alertResourceGroupName\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupName')]\"\r\n          },\r\n          \"alertResourceGroupTags\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupTags')]\"\r\n          },\r\n          \"alertResourceGroupLocation\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupLocation')]\"\r\n          }\r\n        }\r\n      }\r\n    ],\r\n    \"policyType\": \"Custom\",\r\n    \"policyDefinitionGroups\": null\r\n  }\r\n}",
    "$fxv#7": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_activitylog_RouteTable_Update\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy Activity Log Route Table Update Alert\",\r\n    \"description\": \"Policy to Deploy Activity Log Route Table Update Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.1\",\r\n      \"category\": \"Network\",\r\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_alz_monitor\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"alertResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Name\",\r\n          \"description\": \"Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"AlzMonitoring-rg\"\r\n      },\r\n      \"alertResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Tags\",\r\n          \"description\": \"Tags on the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": {\r\n          \"environment\": \"test\",\r\n          \"_deployed_by_alz_monitor\": true\r\n        }\r\n      },\r\n      \"alertResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Location\",\r\n          \"description\": \"Location of the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"centralus\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring on resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/routeTables\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/activityLogAlerts\",\r\n          \"name\": \"ActivityUDRUpdate\",\r\n          \"existenceScope\": \"resourcegroup\",\r\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\r\n          \"deploymentScope\": \"subscription\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/ActivityLogAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              },\r\n              {\r\n                \"count\": {\r\n                  \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*]\",\r\n                  \"where\": {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].field\",\r\n                            \"equals\": \"category\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].equals\",\r\n                            \"equals\": \"Administrative\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"microsoft.insights/activityLogAlerts/condition.allOf[*].field\",\r\n                            \"equals\": \"operationName\"\r\n                          },\r\n                          {\r\n                            \"field\": \"microsoft.insights/activityLogAlerts/condition.allOf[*].equals\",\r\n                            \"equals\": \"Microsoft.Network/routeTables/routes/write\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                },\r\n                \"equals\": 2\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"location\": \"[[deployment().location]\",\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"alertResourceGroupName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"alertResourceGroupTags\": {\r\n                    \"type\": \"object\"\r\n                  },\r\n                  \"alertResourceGroupLocation\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\r\n                    \"apiVersion\": \"2021-04-01\",\r\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\r\n                  },\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/deployments\",\r\n                    \"apiVersion\": \"2019-10-01\",\r\n                    \"name\": \"ActivityUDRUpdate\",\r\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"dependsOn\": [\r\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\r\n                    ],\r\n                    \"properties\": {\r\n                      \"mode\": \"Incremental\",\r\n                      \"template\": {\r\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                        \"contentVersion\": \"1.0.0.0\",\r\n                        \"parameters\": {\r\n                          \"enabled\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupName\": {\r\n                            \"type\": \"string\"\r\n                          }\r\n                        },\r\n                        \"variables\": {},\r\n                        \"resources\": [\r\n                          {\r\n                            \"type\": \"microsoft.insights/activityLogAlerts\",\r\n                            \"apiVersion\": \"2020-10-01\",\r\n                            \"name\": \"ActivityUDRUpdate\",\r\n                            \"location\": \"global\",\r\n                            \"tags\": {\r\n                              \"_deployed_by_alz_monitor\": true\r\n                            },\r\n                            \"properties\": {\r\n                              \"description\": \"Activity Log Route table update\",\r\n                              \"enabled\": \"[[parameters('enabled')]\",\r\n                              \"scopes\": [\r\n                                \"[[subscription().id]\"\r\n                              ],\r\n                              \"condition\": {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"category\",\r\n                                    \"equals\": \"Administrative\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"operationName\",\r\n                                    \"equals\": \"Microsoft.Network/routeTables/routes/write\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"status\",\r\n                                    \"containsAny\": [\r\n                                      \"succeeded\"\r\n                                    ]\r\n                                  }\r\n                                ]\r\n                              },\r\n                              \"parameters\": {\r\n                                \"enabled\": {\r\n                                  \"value\": \"[[parameters('enabled')]\"\r\n                                }\r\n                              }\r\n                            }\r\n                          }\r\n                        ]\r\n                      },\r\n                      \"parameters\": {\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"alertResourceGroupName\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"alertResourceGroupName\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                },\r\n                \"alertResourceGroupTags\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\r\n                },\r\n                \"alertResourceGroupLocation\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#70": "    {\r\n  \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Alerting-LandingZone\",\r\n  \"properties\": {\r\n    \"displayName\": \"Deploy Landing zone alerts\",\r\n    \"description\": \"Initiative to deploy AMBA alerts relevant to the ALZ LandingZone Management group\",\r\n    \"metadata\": {\r\n      \"version\": \"1.2.0\",\r\n      \"category\": \"Monitoring\",\r\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_alz_monitor\": true\r\n    },\r\n    \"parameters\": {\r\n      \"ALZMonitorResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"ALZ-Monitoring-RG\"\r\n      },\r\n      \"ALZMonitorResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"defaultValue\": {\r\n          \"_deployed_by_alz_monitor\": true\r\n        }\r\n      },\r\n      \"ALZMonitorResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"centralus\"\r\n      },\r\n      \"KVRequestAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"2\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"KVRequestWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"KVRequestEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"KVRequestPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"disabled\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"KVRequestAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"KvAvailabilityAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"1\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"KvAvailabilityWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT1M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"KvAvailabilityEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT1M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"KvAvailabilityPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"disabled\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"KvAvailabilityAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"KVAvailabilityThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"20\"\r\n      },\r\n      \"KvLatencyAvailabilityAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"3\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"KvLatencyAvailabilityWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"KvLatencyAvailabilityEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"KvLatencyAvailabilityPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"disabled\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"KvLatencyAvailabilityAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"KvLatencyAvailabilityThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1000\"\r\n      },\r\n      \"KVCapacityAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"1\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"KVCapacityWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"KVCapacityEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT1M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"KVCapacityPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"disabled\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"KVCapacityAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"KVCapacityThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"75\"\r\n      },\r\n      \"activityKVDeleteAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"StorageAccountAvailabilityAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"1\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"StorageAccountAvailabilityWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"StorageAccountAvailabilityFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"StorageAccountAvailabilityPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"StorageAccountAvailabilityAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"StorageAccountAvailabilityThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"90\"\r\n      },\r\n      \"PIPDDoSAttackAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"1\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"PIPDDoSAttackWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"PIPDDoSAttackEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"PIPDDoSAttackPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"PIPDDoSAttackAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"PIPDDoSAttackThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"0\"\r\n      },\r\n      \"PIPPacketsInDDoSAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"4\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"PIPPacketsInDDoSWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"PIPPacketsInDDoSEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"PIPPacketsInDDoSPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"disabled\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"PIPPacketsInDDoSAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"PIPPacketsInDDoSThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"40000\"\r\n      },\r\n      \"PIPVIPAvailabilityAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"1\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"PIPVIPAvailabilityWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"PIPVIPAvailabilityEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT1M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"PIPVIPAvailabilityPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"PIPVIPAvailabilityAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"PIPVIPAvailabilityThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"PIPBytesInDDoSAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"4\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"PIPBytesInDDoSWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"PIPBytesInDDoSEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"PIPBytesInDDoSPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"disabled\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"PIPBytesInDDoSAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"PIPBytesInDDoSThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"8000000\"\r\n      },\r\n      \"RVBackupHealthMonitorPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"modify\",\r\n        \"allowedValues\": [\r\n          \"modify\",\r\n          \"audit\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"VNETDDOSAttackAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"1\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"VNETDDOSAttackWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"VNETDDOSAttackEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT1M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"VNETDDOSAttackPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"VNETDDOSAttackAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"VNETDDOSAttackThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"activityNSGDeleteAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"activityUDRUpdateAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"VMHeartBeatRGAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"1\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"VMHeartBeatRGWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT15M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"VMHeartBeatRGEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"VMHeartBeatRGAutoMitigate\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"VMHeartBeatRGAutoResolve\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"VMHeartBeatRGAutoResolveTime\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"00:10:00\"\r\n      },\r\n      \"VMHeartBeatRGPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"VMHeartBeatRGAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"VMHeartBeatRGThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"10\"\r\n      },\r\n      \"VMHeartBeatRGOperator\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"GreaterThan\",\r\n        \"allowedValues\": [\r\n          \"Equals\",\r\n          \"GreaterThan\",\r\n          \"GreaterThanOrEqual\",\r\n          \"LessThan\",\r\n          \"LessThanOrEqual\"\r\n        ]\r\n      },\r\n      \"VMHeartBeatRGTimeAggregation\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"Average\",\r\n        \"allowedValues\": [\r\n          \"Average\",\r\n          \"Count\",\r\n          \"Maximum\",\r\n          \"Minimum\",\r\n          \"Total\"\r\n        ]\r\n      },\r\n      \"VMNetworkInAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"2\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"VMNetworkInWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT15M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"VMNetworkInEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"VMNetworkInAutoMitigate\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"VMNetworkInAutoResolve\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"VMNetworkInAutoResolveTime\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"00:10:00\"\r\n      },\r\n      \"VMNetworkInPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"VMNetworkInAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"VMNetworkInThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"10000000\"\r\n      },\r\n      \"VMNetworkInOperator\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"GreaterThan\",\r\n        \"allowedValues\": [\r\n          \"Equals\",\r\n          \"GreaterThan\",\r\n          \"GreaterThanOrEqual\",\r\n          \"LessThan\",\r\n          \"LessThanOrEqual\"\r\n        ]\r\n      },\r\n      \"VMNetworkInTimeAggregation\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"Average\",\r\n        \"allowedValues\": [\r\n          \"Average\",\r\n          \"Count\",\r\n          \"Maximum\",\r\n          \"Minimum\",\r\n          \"Total\"\r\n        ]\r\n      },\r\n      \"VMNetworkInEvaluationPeriods\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"VMNetworkInFailingPeriods\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"VMNetworkInComputersToInclude\": {\r\n        \"type\": \"array\",\r\n        \"defaultValue\": [\r\n          \"*\"\r\n        ]\r\n      },\r\n      \"VMNetworkInNetworkInterfaceToInclude\": {\r\n        \"type\": \"array\",\r\n        \"defaultValue\": [\r\n          \"*\"\r\n        ]\r\n      },\r\n      \"VMNetworkOutAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"2\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"VMNetworkOutWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT15M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"VMNetworkOutEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"VMNetworkOutAutoMitigate\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"VMNetworkOutAutoResolve\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"VMNetworkOutAutoResolveTime\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"00:10:00\"\r\n      },\r\n      \"VMNetworkOutPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"VMNetworkOutAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"VMNetworkOutThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"10000000\"\r\n      },\r\n      \"VMNetworkOutOperator\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"GreaterThan\",\r\n        \"allowedValues\": [\r\n          \"Equals\",\r\n          \"GreaterThan\",\r\n          \"GreaterThanOrEqual\",\r\n          \"LessThan\",\r\n          \"LessThanOrEqual\"\r\n        ]\r\n      },\r\n      \"VMNetworkOutTimeAggregation\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"Average\",\r\n        \"allowedValues\": [\r\n          \"Average\",\r\n          \"Count\",\r\n          \"Maximum\",\r\n          \"Minimum\",\r\n          \"Total\"\r\n        ]\r\n      },\r\n      \"VMNetworkOutEvaluationPeriods\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"VMNetworkOutFailingPeriods\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"VMNetworkOutComputersToInclude\": {\r\n        \"type\": \"array\",\r\n        \"defaultValue\": [\r\n          \"*\"\r\n        ]\r\n      },\r\n      \"VMNetworkOutNetworkInterfaceToInclude\": {\r\n        \"type\": \"array\",\r\n        \"defaultValue\": [\r\n          \"*\"\r\n        ]\r\n      },\r\n      \"VMInsightsAlertResourceGroupName\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"AlzMonitoring-rg\"\r\n      },\r\n      \"VMInsightsAlertResourceGroupLocation\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"centralus\"\r\n      },\r\n      \"VMInsightsAlertResourceGroupTags\": {\r\n        \"type\": \"object\",\r\n        \"defaultValue\": {\r\n          \"environment\": \"test\"\r\n        }\r\n      },\r\n      \"VMOSDiskReadLatencyAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"2\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"VMOSDiskReadLatencyWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT15M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"VMOSDiskReadLatencyEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"VMOSDiskReadLatencyAutoMitigate\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"VMOSDiskReadLatencyAutoResolve\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"VMOSDiskReadLatencyAutoResolveTime\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"00:10:00\"\r\n      },\r\n      \"VMOSDiskReadLatencyPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"VMOSDiskReadLatencyAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"VMOSDiskReadLatencyThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"30\"\r\n      },\r\n      \"VMOSDiskReadLatencyOperator\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"LessThan\",\r\n        \"allowedValues\": [\r\n          \"Equals\",\r\n          \"GreaterThan\",\r\n          \"GreaterThanOrEqual\",\r\n          \"LessThan\",\r\n          \"LessThanOrEqual\"\r\n        ]\r\n      },\r\n      \"VMOSDiskReadLatencyTimeAggregation\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"Average\",\r\n        \"allowedValues\": [\r\n          \"Average\",\r\n          \"Count\",\r\n          \"Maximum\",\r\n          \"Minimum\",\r\n          \"Total\"\r\n        ]\r\n      },\r\n      \"VMOSDiskReadLatencyEvaluationPeriods\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"VMOSDiskReadLatencyFailingPeriods\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"VMOSDiskReadLatencyComputersToInclude\": {\r\n        \"type\": \"array\",\r\n        \"defaultValue\": [\r\n          \"*\"\r\n        ]\r\n      },\r\n      \"VMOSDiskReadLatencyDisksToInclude\": {\r\n        \"type\": \"array\",\r\n        \"defaultValue\": [\r\n          \"C:\",\r\n          \"/\"\r\n        ]\r\n      },\r\n      \"VMOSDiskWriteLatencyAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"2\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"VMOSDiskWriteLatencyWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT15M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"VMOSDiskWriteLatencyEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"VMOSDiskWriteLatencyAutoMitigate\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"VMOSDiskWriteLatencyAutoResolve\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"VMOSDiskWriteLatencyAutoResolveTime\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"00:10:00\"\r\n      },\r\n      \"VMOSDiskWriteLatencyPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"VMOSDiskWriteLatencyAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"VMOSDiskWriteLatencyThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"50\"\r\n      },\r\n      \"VMOSDiskWriteLatencyOperator\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"LessThan\",\r\n        \"allowedValues\": [\r\n          \"Equals\",\r\n          \"GreaterThan\",\r\n          \"GreaterThanOrEqual\",\r\n          \"LessThan\",\r\n          \"LessThanOrEqual\"\r\n        ]\r\n      },\r\n      \"VMOSDiskWriteLatencyTimeAggregation\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"Average\",\r\n        \"allowedValues\": [\r\n          \"Average\",\r\n          \"Count\",\r\n          \"Maximum\",\r\n          \"Minimum\",\r\n          \"Total\"\r\n        ]\r\n      },\r\n      \"VMOSDiskWriteLatencyEvaluationPeriods\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"VMOSDiskWriteLatencyFailingPeriods\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"VMOSDiskWriteLatencyComputersToInclude\": {\r\n        \"type\": \"array\",\r\n        \"defaultValue\": [\r\n          \"*\"\r\n        ]\r\n      },\r\n      \"VMOSDiskWriteLatencyDisksToInclude\": {\r\n        \"type\": \"array\",\r\n        \"defaultValue\": [\r\n          \"C:\",\r\n          \"/\"\r\n        ]\r\n      },\r\n      \"VMOSDiskSpaceAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"2\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"VMOSDiskSpaceWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT15M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"VMOSDiskSpaceEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"VMOSDiskSpaceAutoMitigate\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"VMOSDiskSpaceAutoResolve\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"VMOSDiskSpaceAutoResolveTime\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"00:10:00\"\r\n      },\r\n      \"VMOSDiskSpacePolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"VMOSDiskSpaceAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"VMOSDiskSpaceThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"10\"\r\n      },\r\n      \"VMOSDiskSpaceOperator\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"LessThan\",\r\n        \"allowedValues\": [\r\n          \"Equals\",\r\n          \"GreaterThan\",\r\n          \"GreaterThanOrEqual\",\r\n          \"LessThan\",\r\n          \"LessThanOrEqual\"\r\n        ]\r\n      },\r\n      \"VMOSDiskSpaceTimeAggregation\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"Average\",\r\n        \"allowedValues\": [\r\n          \"Average\",\r\n          \"Count\",\r\n          \"Maximum\",\r\n          \"Minimum\",\r\n          \"Total\"\r\n        ]\r\n      },\r\n      \"VMOSDiskSpaceEvaluationPeriods\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"VMOSDiskSpaceFailingPeriods\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"VMOSDiskSpaceComputersToInclude\": {\r\n        \"type\": \"array\",\r\n        \"defaultValue\": [\r\n          \"*\"\r\n        ]\r\n      },\r\n      \"VMOSDiskSpaceDisksToInclude\": {\r\n        \"type\": \"array\",\r\n        \"defaultValue\": [\r\n          \"C:\",\r\n          \"/\"\r\n        ]\r\n      },\r\n      \"VMPercentCPUAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"2\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"VMPercentCPUWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT15M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"VMPercentCPUEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"VMPercentCPUAutoMitigate\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"VMPercentCPUAutoResolve\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"VMPercentCPUAutoResolveTime\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"00:10:00\"\r\n      },\r\n      \"VMPercentCPUPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"VMPercentCPUAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"VMPercentCPUThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"85\"\r\n      },\r\n      \"VMPercentCPUOperator\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"GreaterThan\",\r\n        \"allowedValues\": [\r\n          \"Equals\",\r\n          \"GreaterThan\",\r\n          \"GreaterThanOrEqual\",\r\n          \"LessThan\",\r\n          \"LessThanOrEqual\"\r\n        ]\r\n      },\r\n      \"VMPercentCPUTimeAggregation\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"Average\",\r\n        \"allowedValues\": [\r\n          \"Average\",\r\n          \"Count\",\r\n          \"Maximum\",\r\n          \"Minimum\",\r\n          \"Total\"\r\n        ]\r\n      },\r\n      \"VMPercentMemoryAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"2\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"VMPercentMemoryWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT15M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"VMPercentMemoryEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"VMPercentMemoryAutoMitigate\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"VMPercentMemoryAutoResolve\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"VMPercentMemoryAutoResolveTime\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"00:10:00\"\r\n      },\r\n      \"VMPercentMemoryPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"VMPercentMemoryAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"VMPercentMemoryThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"10\"\r\n      },\r\n      \"VMPercentMemoryOperator\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"LessThan\",\r\n        \"allowedValues\": [\r\n          \"Equals\",\r\n          \"GreaterThan\",\r\n          \"GreaterThanOrEqual\",\r\n          \"LessThan\",\r\n          \"LessThanOrEqual\"\r\n        ]\r\n      },\r\n      \"VMPercentMemoryTimeAggregation\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"Average\",\r\n        \"allowedValues\": [\r\n          \"Average\",\r\n          \"Count\",\r\n          \"Maximum\",\r\n          \"Minimum\",\r\n          \"Total\"\r\n        ]\r\n      },\r\n      \"VMDataDiskSpaceAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"2\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"VMDataDiskSpaceWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT15M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"VMDataDiskSpaceEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"VMDataDiskSpaceAutoMitigate\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"VMDataDiskSpaceAutoResolve\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"VMDataDiskSpaceAutoResolveTime\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"00:10:00\"\r\n      },\r\n      \"VMDataDiskSpacePolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"VMDataDiskSpaceAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"VMDataDiskSpaceThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"10\"\r\n      },\r\n      \"VMDataDiskSpaceOperator\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"LessThan\",\r\n        \"allowedValues\": [\r\n          \"Equals\",\r\n          \"GreaterThan\",\r\n          \"GreaterThanOrEqual\",\r\n          \"LessThan\",\r\n          \"LessThanOrEqual\"\r\n        ]\r\n      },\r\n      \"VMDataDiskSpaceTimeAggregation\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"Average\",\r\n        \"allowedValues\": [\r\n          \"Average\",\r\n          \"Count\",\r\n          \"Maximum\",\r\n          \"Minimum\",\r\n          \"Total\"\r\n        ]\r\n      },\r\n      \"VMDataDiskSpaceEvaluationPeriods\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"VMDataDiskSpaceFailingPeriods\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"VMDataDiskSpaceDisksToInclude\": {\r\n        \"type\": \"array\",\r\n        \"defaultValue\": [\r\n          \"*\"\r\n        ]\r\n      },\r\n      \"VMDataDiskReadLatencyAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"2\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"VMDataDiskReadLatencyWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT15M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"VMDataDiskReadLatencyEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"VMDataDiskReadLatencyAutoMitigate\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"VMDataDiskReadLatencyAutoResolve\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"VMDataDiskReadLatencyAutoResolveTime\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"00:10:00\"\r\n      },\r\n      \"VMDataDiskReadLatencyPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"VMDataDiskReadLatencyAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"VMDataDiskReadLatencyThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"30\"\r\n      },\r\n      \"VMDataDiskReadLatencyOperator\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"LessThan\",\r\n        \"allowedValues\": [\r\n          \"Equals\",\r\n          \"GreaterThan\",\r\n          \"GreaterThanOrEqual\",\r\n          \"LessThan\",\r\n          \"LessThanOrEqual\"\r\n        ]\r\n      },\r\n      \"VMDataDiskReadLatencyTimeAggregation\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"Average\",\r\n        \"allowedValues\": [\r\n          \"Average\",\r\n          \"Count\",\r\n          \"Maximum\",\r\n          \"Minimum\",\r\n          \"Total\"\r\n        ]\r\n      },\r\n      \"VMDataDiskReadLatencyEvaluationPeriods\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"VMDataDiskReadLatencyFailingPeriods\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"VMDataDiskReadLatencyComputersToInclude\": {\r\n        \"type\": \"array\",\r\n        \"defaultValue\": [\r\n          \"*\"\r\n        ]\r\n      },\r\n      \"VMDataDiskReadLatencyDisksToInclude\": {\r\n        \"type\": \"array\",\r\n        \"defaultValue\": [\r\n          \"*\"\r\n        ]\r\n      },\r\n      \"VMDataDiskWriteLatencyAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"2\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"VMDataDiskWriteLatencyWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT15M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"VMDataDiskWriteLatencyEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"VMDataDiskWriteLatencyAutoMitigate\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"VMDataDiskWriteLatencyAutoResolve\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"VMDataDiskWriteLatencyAutoResolveTime\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"00:10:00\"\r\n      },\r\n      \"VMDataDiskWriteLatencyPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"VMDataDiskWriteLatencyAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"VMDataDiskWriteLatencyThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"30\"\r\n      },\r\n      \"VMDataDiskWriteLatencyOperator\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"LessThan\",\r\n        \"allowedValues\": [\r\n          \"Equals\",\r\n          \"GreaterThan\",\r\n          \"GreaterThanOrEqual\",\r\n          \"LessThan\",\r\n          \"LessThanOrEqual\"\r\n        ]\r\n      },\r\n      \"VMDataDiskWriteLatencyTimeAggregation\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"Average\",\r\n        \"allowedValues\": [\r\n          \"Average\",\r\n          \"Count\",\r\n          \"Maximum\",\r\n          \"Minimum\",\r\n          \"Total\"\r\n        ]\r\n      },\r\n      \"VMDataDiskWriteLatencyEvaluationPeriods\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"VMDataDiskWriteLatencyFailingPeriods\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"VMDataDiskWriteLatencyComputersToInclude\": {\r\n        \"type\": \"array\",\r\n        \"defaultValue\": [\r\n          \"*\"\r\n        ]\r\n      },\r\n      \"VMDataDiskWriteLatencyDisksToInclude\": {\r\n        \"type\": \"array\",\r\n        \"defaultValue\": [\r\n          \"*\"\r\n        ]\r\n      }\r\n    },\r\n    \"policyDefinitions\": [\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_KVRequest\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_KeyVault_Requests_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('KVRequestAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('KVRequestWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('KVRequestEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('KVRequestPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('KVRequestAlertState')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_KvAvailability\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_KeyVault_Availability_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('KvAvailabilityAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('KvAvailabilityWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('KvAvailabilityEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('KvAvailabilityPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('KvAvailabilityAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('KVAvailabilityThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_KvLatencyAvailability\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_KeyVault_Latency_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('KvLatencyAvailabilityAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('KvLatencyAvailabilityWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('KvLatencyAvailabilityEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('KvLatencyAvailabilityPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('KvLatencyAvailabilityAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('KvLatencyAvailabilityThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_KVCapacity\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_KeyVault_Capacity_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('KVCapacityAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('KVCapacityWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('KVCapacityEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('KVCapacityPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('KVCapacityAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('KVCapacityThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_activityKVDelete\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_activitylog_KeyVault_Delete')]\",\r\n        \"parameters\": {\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('activityKVDeleteAlertState')]\"\r\n          },\r\n          \"alertResourceGroupName\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupName')]\"\r\n          },\r\n          \"alertResourceGroupTags\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupTags')]\"\r\n          },\r\n          \"alertResourceGroupLocation\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupLocation')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_StorageAccountAvailability\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_StorageAccount_Availability_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('StorageAccountAvailabilityAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('StorageAccountAvailabilityWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('StorageAccountAvailabilityFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('StorageAccountAvailabilityPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('StorageAccountAvailabilityAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('StorageAccountAvailabilityThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_PIPBytesInDDoS\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_PublicIp_BytesInDDoSAttack_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('PIPBytesInDDoSAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('PIPBytesInDDoSWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('PIPBytesInDDoSEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('PIPBytesInDDoSPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('PIPBytesInDDoSAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('PIPBytesInDDoSThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_PIPDDoSAttack\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_PublicIp_DDoSAttack_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('PIPDDoSAttackAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('PIPDDoSAttackWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('PIPDDoSAttackEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('PIPDDoSAttackPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('PIPDDoSAttackAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('PIPDDoSAttackThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_PIPPacketsInDDoS\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_PublicIp_PacketsInDDoSAttack_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('PIPPacketsInDDoSAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('PIPPacketsInDDoSWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('PIPPacketsInDDoSEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('PIPPacketsInDDoSPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('PIPPacketsInDDoSAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('PIPPacketsInDDoSThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_PIPVIPAvailability\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_PublicIp_VIPAvailability_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('PIPVIPAvailabilityAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('PIPVIPAvailabilityWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('PIPVIPAvailabilityEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('PIPVIPAvailabilityPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('PIPVIPAvailabilityAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('PIPVIPAvailabilityThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_activityNSGDelete\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_activitylog_NSG_Delete')]\",\r\n        \"parameters\": {\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('activityNSGDeleteAlertState')]\"\r\n          },\r\n          \"alertResourceGroupName\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupName')]\"\r\n          },\r\n          \"alertResourceGroupTags\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupTags')]\"\r\n          },\r\n          \"alertResourceGroupLocation\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupLocation')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_activityUDRUpdate\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_activitylog_RouteTable_Update')]\",\r\n        \"parameters\": {\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('activityUDRUpdateAlertState')]\"\r\n          },\r\n          \"alertResourceGroupName\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupName')]\"\r\n          },\r\n          \"alertResourceGroupTags\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupTags')]\"\r\n          },\r\n          \"alertResourceGroupLocation\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupLocation')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_RVBackupHealthMonitor\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_RecoveryVault_BackupHealthMonitor_Alert')]\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('RVBackupHealthMonitorPolicyEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VNETDDOSAttack\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VNET_DDoSAttack_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VNETDDOSAttackAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VNETDDOSAttackWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VNETDDOSAttackEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VNETDDOSAttackPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VNETDDOSAttackAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('VNETDDOSAttackThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VMHeartBeatRG\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VM_HeartBeat_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VMHeartBeatRGAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VMHeartBeatRGWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VMHeartBeatRGEvaluationFrequency')]\"\r\n          },\r\n          \"autoMitigate\": {\r\n            \"value\": \"[[parameters('VMHeartBeatRGAutoMitigate')]\"\r\n          },\r\n          \"autoResolve\": {\r\n            \"value\": \"[[parameters('VMHeartBeatRGAutoResolve')]\"\r\n          },\r\n          \"autoResolveTime\": {\r\n            \"value\": \"[[parameters('VMHeartBeatRGAutoResolveTime')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VMHeartBeatRGPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VMHeartBeatRGAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('VMHeartBeatRGThreshold')]\"\r\n          },\r\n          \"operator\": {\r\n            \"value\": \"[[parameters('VMHeartBeatRGOperator')]\"\r\n          },\r\n          \"timeAggregation\": {\r\n            \"value\": \"[[parameters('VMHeartBeatRGTimeAggregation')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VMNetworkIn\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VM_NetworkIn_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VMNetworkInAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VMNetworkInWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VMNetworkInEvaluationFrequency')]\"\r\n          },\r\n          \"autoMitigate\": {\r\n            \"value\": \"[[parameters('VMNetworkInAutoMitigate')]\"\r\n          },\r\n          \"autoResolve\": {\r\n            \"value\": \"[[parameters('VMNetworkInAutoResolve')]\"\r\n          },\r\n          \"autoResolveTime\": {\r\n            \"value\": \"[[parameters('VMNetworkInAutoResolveTime')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VMNetworkInPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VMNetworkInAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('VMNetworkInThreshold')]\"\r\n          },\r\n          \"operator\": {\r\n            \"value\": \"[[parameters('VMNetworkInOperator')]\"\r\n          },\r\n          \"timeAggregation\": {\r\n            \"value\": \"[[parameters('VMNetworkInTimeAggregation')]\"\r\n          },\r\n          \"failingPeriods\": {\r\n            \"value\": \"[[parameters('VMNetworkInFailingPeriods')]\"\r\n          },\r\n          \"evaluationPeriods\": {\r\n            \"value\": \"[[parameters('VMNetworkInEvaluationPeriods')]\"\r\n          },\r\n          \"computersToInclude\": {\r\n            \"value\": \"[[parameters('VMNetworkInComputersToInclude')]\"\r\n          },\r\n          \"networkInterfacesToInclude\": {\r\n            \"value\": \"[[parameters('VMNetworkInNetworkInterfaceToInclude')]\"\r\n          },\r\n          \"alertResourceGroupName\": {\r\n            \"value\": \"[[parameters('VMInsightsAlertResourceGroupName')]\"\r\n          },\r\n          \"alertResourceGroupTags\": {\r\n            \"value\": \"[[parameters('VMInsightsAlertResourceGroupTags')]\"\r\n          },\r\n          \"alertResourceGroupLocation\": {\r\n            \"value\": \"[[parameters('VMInsightsAlertResourceGroupLocation')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VMNetworkOut\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VM_NetworkOut_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VMNetworkOutAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VMNetworkOutWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VMNetworkOutEvaluationFrequency')]\"\r\n          },\r\n          \"autoMitigate\": {\r\n            \"value\": \"[[parameters('VMNetworkOutAutoMitigate')]\"\r\n          },\r\n          \"autoResolve\": {\r\n            \"value\": \"[[parameters('VMNetworkOutAutoResolve')]\"\r\n          },\r\n          \"autoResolveTime\": {\r\n            \"value\": \"[[parameters('VMNetworkOutAutoResolveTime')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VMNetworkOutPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VMNetworkOutAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('VMNetworkOutThreshold')]\"\r\n          },\r\n          \"operator\": {\r\n            \"value\": \"[[parameters('VMNetworkOutOperator')]\"\r\n          },\r\n          \"timeAggregation\": {\r\n            \"value\": \"[[parameters('VMNetworkOutTimeAggregation')]\"\r\n          },\r\n          \"failingPeriods\": {\r\n            \"value\": \"[[parameters('VMNetworkOutFailingPeriods')]\"\r\n          },\r\n          \"evaluationPeriods\": {\r\n            \"value\": \"[[parameters('VMNetworkOutEvaluationPeriods')]\"\r\n          },\r\n          \"computersToInclude\": {\r\n            \"value\": \"[[parameters('VMNetworkOutComputersToInclude')]\"\r\n          },\r\n          \"networkInterfacesToInclude\": {\r\n            \"value\": \"[[parameters('VMNetworkOutNetworkInterfaceToInclude')]\"\r\n          },\r\n          \"alertResourceGroupName\": {\r\n            \"value\": \"[[parameters('VMInsightsAlertResourceGroupName')]\"\r\n          },\r\n          \"alertResourceGroupTags\": {\r\n            \"value\": \"[[parameters('VMInsightsAlertResourceGroupTags')]\"\r\n          },\r\n          \"alertResourceGroupLocation\": {\r\n            \"value\": \"[[parameters('VMInsightsAlertResourceGroupLocation')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VMOSDiskReadLatency\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VM_OSDiskreadLatency_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VMOSDiskReadLatencyAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VMOSDiskReadLatencyWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VMOSDiskReadLatencyEvaluationFrequency')]\"\r\n          },\r\n          \"autoMitigate\": {\r\n            \"value\": \"[[parameters('VMOSDiskReadLatencyAutoMitigate')]\"\r\n          },\r\n          \"autoResolve\": {\r\n            \"value\": \"[[parameters('VMOSDiskReadLatencyAutoResolve')]\"\r\n          },\r\n          \"autoResolveTime\": {\r\n            \"value\": \"[[parameters('VMOSDiskReadLatencyAutoResolveTime')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VMOSDiskReadLatencyPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VMOSDiskReadLatencyAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('VMOSDiskReadLatencyThreshold')]\"\r\n          },\r\n          \"operator\": {\r\n            \"value\": \"[[parameters('VMOSDiskReadLatencyOperator')]\"\r\n          },\r\n          \"timeAggregation\": {\r\n            \"value\": \"[[parameters('VMOSDiskReadLatencyTimeAggregation')]\"\r\n          },\r\n          \"failingPeriods\": {\r\n            \"value\": \"[[parameters('VMOSDiskReadLatencyFailingPeriods')]\"\r\n          },\r\n          \"evaluationPeriods\": {\r\n            \"value\": \"[[parameters('VMOSDiskReadLatencyEvaluationPeriods')]\"\r\n          },\r\n          \"computersToInclude\": {\r\n            \"value\": \"[[parameters('VMOSDiskReadLatencyComputersToInclude')]\"\r\n          },\r\n          \"disksToInclude\": {\r\n            \"value\": \"[[parameters('VMOSDiskReadLatencyDisksToInclude')]\"\r\n          },\r\n          \"alertResourceGroupName\": {\r\n            \"value\": \"[[parameters('VMInsightsAlertResourceGroupName')]\"\r\n          },\r\n          \"alertResourceGroupTags\": {\r\n            \"value\": \"[[parameters('VMInsightsAlertResourceGroupTags')]\"\r\n          },\r\n          \"alertResourceGroupLocation\": {\r\n            \"value\": \"[[parameters('VMInsightsAlertResourceGroupLocation')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VMOSDiskWriteLatency\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VM_OSDiskwriteLatency_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VMOSDiskWriteLatencyAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VMOSDiskWriteLatencyWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VMOSDiskWriteLatencyEvaluationFrequency')]\"\r\n          },\r\n          \"autoMitigate\": {\r\n            \"value\": \"[[parameters('VMOSDiskWriteLatencyAutoMitigate')]\"\r\n          },\r\n          \"autoResolve\": {\r\n            \"value\": \"[[parameters('VMOSDiskWriteLatencyAutoResolve')]\"\r\n          },\r\n          \"autoResolveTime\": {\r\n            \"value\": \"[[parameters('VMOSDiskWriteLatencyAutoResolveTime')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VMOSDiskWriteLatencyPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VMOSDiskWriteLatencyAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('VMOSDiskWriteLatencyThreshold')]\"\r\n          },\r\n          \"operator\": {\r\n            \"value\": \"[[parameters('VMOSDiskWriteLatencyOperator')]\"\r\n          },\r\n          \"timeAggregation\": {\r\n            \"value\": \"[[parameters('VMOSDiskWriteLatencyTimeAggregation')]\"\r\n          },\r\n          \"failingPeriods\": {\r\n            \"value\": \"[[parameters('VMOSDiskWriteLatencyFailingPeriods')]\"\r\n          },\r\n          \"evaluationPeriods\": {\r\n            \"value\": \"[[parameters('VMOSDiskWriteLatencyEvaluationPeriods')]\"\r\n          },\r\n          \"computersToInclude\": {\r\n            \"value\": \"[[parameters('VMOSDiskWriteLatencyComputersToInclude')]\"\r\n          },\r\n          \"disksToInclude\": {\r\n            \"value\": \"[[parameters('VMOSDiskWriteLatencyDisksToInclude')]\"\r\n          },\r\n          \"alertResourceGroupName\": {\r\n            \"value\": \"[[parameters('VMInsightsAlertResourceGroupName')]\"\r\n          },\r\n          \"alertResourceGroupTags\": {\r\n            \"value\": \"[[parameters('VMInsightsAlertResourceGroupTags')]\"\r\n          },\r\n          \"alertResourceGroupLocation\": {\r\n            \"value\": \"[[parameters('VMInsightsAlertResourceGroupLocation')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VMOSDiskSpace\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VM_OSDiskSpace_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VMOSDiskSpaceAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VMOSDiskSpaceWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VMOSDiskSpaceEvaluationFrequency')]\"\r\n          },\r\n          \"autoMitigate\": {\r\n            \"value\": \"[[parameters('VMOSDiskSpaceAutoMitigate')]\"\r\n          },\r\n          \"autoResolve\": {\r\n            \"value\": \"[[parameters('VMOSDiskSpaceAutoResolve')]\"\r\n          },\r\n          \"autoResolveTime\": {\r\n            \"value\": \"[[parameters('VMOSDiskSpaceAutoResolveTime')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VMOSDiskSpacePolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VMOSDiskSpaceAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('VMOSDiskSpaceThreshold')]\"\r\n          },\r\n          \"operator\": {\r\n            \"value\": \"[[parameters('VMOSDiskSpaceOperator')]\"\r\n          },\r\n          \"timeAggregation\": {\r\n            \"value\": \"[[parameters('VMOSDiskSpaceTimeAggregation')]\"\r\n          },\r\n          \"failingPeriods\": {\r\n            \"value\": \"[[parameters('VMOSDiskSpaceFailingPeriods')]\"\r\n          },\r\n          \"evaluationPeriods\": {\r\n            \"value\": \"[[parameters('VMOSDiskSpaceEvaluationPeriods')]\"\r\n          },\r\n          \"computersToInclude\": {\r\n            \"value\": \"[[parameters('VMOSDiskSpaceComputersToInclude')]\"\r\n          },\r\n          \"disksToInclude\": {\r\n            \"value\": \"[[parameters('VMOSDiskSpaceDisksToInclude')]\"\r\n          },\r\n          \"alertResourceGroupName\": {\r\n            \"value\": \"[[parameters('VMInsightsAlertResourceGroupName')]\"\r\n          },\r\n          \"alertResourceGroupTags\": {\r\n            \"value\": \"[[parameters('VMInsightsAlertResourceGroupTags')]\"\r\n          },\r\n          \"alertResourceGroupLocation\": {\r\n            \"value\": \"[[parameters('VMInsightsAlertResourceGroupLocation')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VMPercentCPU\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VM_CPU_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VMPercentCPUAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VMPercentCPUWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VMPercentCPUEvaluationFrequency')]\"\r\n          },\r\n          \"autoMitigate\": {\r\n            \"value\": \"[[parameters('VMPercentCPUAutoMitigate')]\"\r\n          },\r\n          \"autoResolve\": {\r\n            \"value\": \"[[parameters('VMPercentCPUAutoResolve')]\"\r\n          },\r\n          \"autoResolveTime\": {\r\n            \"value\": \"[[parameters('VMPercentCPUAutoResolveTime')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VMPercentCPUPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VMPercentCPUAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('VMPercentCPUThreshold')]\"\r\n          },\r\n          \"operator\": {\r\n            \"value\": \"[[parameters('VMPercentCPUOperator')]\"\r\n          },\r\n          \"timeAggregation\": {\r\n            \"value\": \"[[parameters('VMPercentCPUTimeAggregation')]\"\r\n          },\r\n          \"alertResourceGroupName\": {\r\n            \"value\": \"[[parameters('VMInsightsAlertResourceGroupName')]\"\r\n          },\r\n          \"alertResourceGroupTags\": {\r\n            \"value\": \"[[parameters('VMInsightsAlertResourceGroupTags')]\"\r\n          },\r\n          \"alertResourceGroupLocation\": {\r\n            \"value\": \"[[parameters('VMInsightsAlertResourceGroupLocation')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VMPercentMemory\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VM_Memory_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VMPercentMemoryAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VMPercentMemoryWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VMPercentMemoryEvaluationFrequency')]\"\r\n          },\r\n          \"autoMitigate\": {\r\n            \"value\": \"[[parameters('VMPercentMemoryAutoMitigate')]\"\r\n          },\r\n          \"autoResolve\": {\r\n            \"value\": \"[[parameters('VMPercentMemoryAutoResolve')]\"\r\n          },\r\n          \"autoResolveTime\": {\r\n            \"value\": \"[[parameters('VMPercentMemoryAutoResolveTime')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VMPercentMemoryPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VMPercentMemoryAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('VMPercentMemoryThreshold')]\"\r\n          },\r\n          \"operator\": {\r\n            \"value\": \"[[parameters('VMPercentMemoryOperator')]\"\r\n          },\r\n          \"timeAggregation\": {\r\n            \"value\": \"[[parameters('VMPercentMemoryTimeAggregation')]\"\r\n          },\r\n          \"alertResourceGroupName\": {\r\n            \"value\": \"[[parameters('VMInsightsAlertResourceGroupName')]\"\r\n          },\r\n          \"alertResourceGroupTags\": {\r\n            \"value\": \"[[parameters('VMInsightsAlertResourceGroupTags')]\"\r\n          },\r\n          \"alertResourceGroupLocation\": {\r\n            \"value\": \"[[parameters('VMInsightsAlertResourceGroupLocation')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VMDataDiskSpace\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VM_dataDiskSpace_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VMDataDiskSpaceAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VMDataDiskSpaceWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VMDataDiskSpaceEvaluationFrequency')]\"\r\n          },\r\n          \"autoMitigate\": {\r\n            \"value\": \"[[parameters('VMDataDiskSpaceAutoMitigate')]\"\r\n          },\r\n          \"autoResolve\": {\r\n            \"value\": \"[[parameters('VMDataDiskSpaceAutoResolve')]\"\r\n          },\r\n          \"autoResolveTime\": {\r\n            \"value\": \"[[parameters('VMDataDiskSpaceAutoResolveTime')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VMDataDiskSpacePolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VMDataDiskSpaceAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('VMDataDiskSpaceThreshold')]\"\r\n          },\r\n          \"operator\": {\r\n            \"value\": \"[[parameters('VMDataDiskSpaceOperator')]\"\r\n          },\r\n          \"timeAggregation\": {\r\n            \"value\": \"[[parameters('VMDataDiskSpaceTimeAggregation')]\"\r\n          },\r\n          \"failingPeriods\": {\r\n            \"value\": \"[[parameters('VMDataDiskSpaceFailingPeriods')]\"\r\n          },\r\n          \"evaluationPeriods\": {\r\n            \"value\": \"[[parameters('VMDataDiskSpaceEvaluationPeriods')]\"\r\n          },\r\n          \"disksToInclude\": {\r\n            \"value\": \"[[parameters('VMDataDiskSpaceDisksToInclude')]\"\r\n          },\r\n          \"alertResourceGroupName\": {\r\n            \"value\": \"[[parameters('VMInsightsAlertResourceGroupName')]\"\r\n          },\r\n          \"alertResourceGroupTags\": {\r\n            \"value\": \"[[parameters('VMInsightsAlertResourceGroupTags')]\"\r\n          },\r\n          \"alertResourceGroupLocation\": {\r\n            \"value\": \"[[parameters('VMInsightsAlertResourceGroupLocation')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VMDataDiskReadLatency\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VM_dataDiskReadLatency_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VMDataDiskReadLatencyAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VMDataDiskReadLatencyWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VMDataDiskReadLatencyEvaluationFrequency')]\"\r\n          },\r\n          \"autoMitigate\": {\r\n            \"value\": \"[[parameters('VMDataDiskReadLatencyAutoMitigate')]\"\r\n          },\r\n          \"autoResolve\": {\r\n            \"value\": \"[[parameters('VMDataDiskReadLatencyAutoResolve')]\"\r\n          },\r\n          \"autoResolveTime\": {\r\n            \"value\": \"[[parameters('VMDataDiskReadLatencyAutoResolveTime')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VMDataDiskReadLatencyPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VMDataDiskReadLatencyAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('VMDataDiskReadLatencyThreshold')]\"\r\n          },\r\n          \"operator\": {\r\n            \"value\": \"[[parameters('VMDataDiskReadLatencyOperator')]\"\r\n          },\r\n          \"timeAggregation\": {\r\n            \"value\": \"[[parameters('VMDataDiskReadLatencyTimeAggregation')]\"\r\n          },\r\n          \"failingPeriods\": {\r\n            \"value\": \"[[parameters('VMDataDiskReadLatencyFailingPeriods')]\"\r\n          },\r\n          \"evaluationPeriods\": {\r\n            \"value\": \"[[parameters('VMDataDiskReadLatencyEvaluationPeriods')]\"\r\n          },\r\n          \"computersToInclude\": {\r\n            \"value\": \"[[parameters('VMDataDiskReadLatencyComputersToInclude')]\"\r\n          },\r\n          \"disksToInclude\": {\r\n            \"value\": \"[[parameters('VMDataDiskReadLatencyDisksToInclude')]\"\r\n          },\r\n          \"alertResourceGroupName\": {\r\n            \"value\": \"[[parameters('VMInsightsAlertResourceGroupName')]\"\r\n          },\r\n          \"alertResourceGroupTags\": {\r\n            \"value\": \"[[parameters('VMInsightsAlertResourceGroupTags')]\"\r\n          },\r\n          \"alertResourceGroupLocation\": {\r\n            \"value\": \"[[parameters('VMInsightsAlertResourceGroupLocation')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_VMDataDiskWriteLatency\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_VM_dataDiskWriteLatency_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('VMDataDiskWriteLatencyAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('VMDataDiskWriteLatencyWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('VMDataDiskWriteLatencyEvaluationFrequency')]\"\r\n          },\r\n          \"autoMitigate\": {\r\n            \"value\": \"[[parameters('VMDataDiskWriteLatencyAutoMitigate')]\"\r\n          },\r\n          \"autoResolve\": {\r\n            \"value\": \"[[parameters('VMDataDiskWriteLatencyAutoResolve')]\"\r\n          },\r\n          \"autoResolveTime\": {\r\n            \"value\": \"[[parameters('VMDataDiskWriteLatencyAutoResolveTime')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('VMDataDiskWriteLatencyPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('VMDataDiskWriteLatencyAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('VMDataDiskWriteLatencyThreshold')]\"\r\n          },\r\n          \"operator\": {\r\n            \"value\": \"[[parameters('VMDataDiskWriteLatencyOperator')]\"\r\n          },\r\n          \"timeAggregation\": {\r\n            \"value\": \"[[parameters('VMDataDiskWriteLatencyTimeAggregation')]\"\r\n          },\r\n          \"failingPeriods\": {\r\n            \"value\": \"[[parameters('VMDataDiskWriteLatencyFailingPeriods')]\"\r\n          },\r\n          \"evaluationPeriods\": {\r\n            \"value\": \"[[parameters('VMDataDiskWriteLatencyEvaluationPeriods')]\"\r\n          },\r\n          \"computersToInclude\": {\r\n            \"value\": \"[[parameters('VMDataDiskWriteLatencyComputersToInclude')]\"\r\n          },\r\n          \"disksToInclude\": {\r\n            \"value\": \"[[parameters('VMDataDiskWriteLatencyDisksToInclude')]\"\r\n          },\r\n          \"alertResourceGroupName\": {\r\n            \"value\": \"[[parameters('VMInsightsAlertResourceGroupName')]\"\r\n          },\r\n          \"alertResourceGroupTags\": {\r\n            \"value\": \"[[parameters('VMInsightsAlertResourceGroupTags')]\"\r\n          },\r\n          \"alertResourceGroupLocation\": {\r\n            \"value\": \"[[parameters('VMInsightsAlertResourceGroupLocation')]\"\r\n          }\r\n        }\r\n      }\r\n    ],\r\n    \"policyType\": \"Custom\",\r\n    \"policyDefinitionGroups\": null\r\n  }\r\n}",
    "$fxv#71": "    {\r\n  \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Alerting-Management\",\r\n  \"properties\": {\r\n    \"displayName\": \"Deploy Management alerts\",\r\n    \"description\": \"Initiative to deploy AMBA alerts relevant to the ALZ Management management group\",\r\n    \"metadata\": {\r\n      \"version\": \"1.2.0\",\r\n      \"category\": \"Monitoring\",\r\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_alz_monitor\": true\r\n    },\r\n    \"parameters\": {\r\n      \"ALZMonitorResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"ALZ-Monitoring-RG\"\r\n      },\r\n      \"ALZMonitorResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"defaultValue\": {\r\n          \"_deployed_by_alz_monitor\": true\r\n        }\r\n      },\r\n      \"ALZMonitorResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"centralus\"\r\n      },\r\n      \"AATotalJobAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"2\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"AATotalJobAlertWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"AATotalJobAlertEvaluationFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT1M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"AATotalJobAlertPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"AATotalJobAlertAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"AATotalJobAlertThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"20\"\r\n      },\r\n      \"RVBackupHealthPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"modify\",\r\n        \"allowedValues\": [\r\n          \"modify\",\r\n          \"audit\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"StorageAccountAvailabilityAlertSeverity\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"1\",\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ]\r\n      },\r\n      \"StorageAccountAvailabilityWindowSize\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ]\r\n      },\r\n      \"StorageAccountAvailabilityFrequency\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"PT5M\",\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ]\r\n      },\r\n      \"StorageAccountAvailabilityPolicyEffect\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"deployIfNotExists\",\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ]\r\n      },\r\n      \"StorageAccountAvailabilityAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"StorageAccountAvailabilityThreshold\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"90\"\r\n      },\r\n      \"activityLAWDeleteAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"activityLAWKeyRegenAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      }\r\n    },\r\n    \"policyDefinitions\": [\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_activityLAWDelete\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_activitylog_LAWorkspace_Delete')]\",\r\n        \"parameters\": {\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('activityLAWDeleteAlertState')]\"\r\n          },\r\n          \"alertResourceGroupName\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupName')]\"\r\n          },\r\n          \"alertResourceGroupTags\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupTags')]\"\r\n          },\r\n          \"alertResourceGroupLocation\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupLocation')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_activityLAWKeyRegen\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_activitylog_LAWorkspace_KeyRegen')]\",\r\n        \"parameters\": {\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('activityLAWKeyRegenAlertState')]\"\r\n          },\r\n          \"alertResourceGroupName\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupName')]\"\r\n          },\r\n          \"alertResourceGroupTags\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupTags')]\"\r\n          },\r\n          \"alertResourceGroupLocation\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupLocation')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_AATotalJob\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_AA_TotalJob_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('AATotalJobAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('AATotalJobAlertWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('AATotalJobAlertEvaluationFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('AATotalJobAlertPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('AATotalJobAlertAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('AATotalJobAlertThreshold')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_RVBackupHealth\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_RecoveryVault_BackupHealthMonitor_Alert')]\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('RVBackupHealthPolicyEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_StorageAccountAvailability\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_StorageAccount_Availability_Alert')]\",\r\n        \"parameters\": {\r\n          \"severity\": {\r\n            \"value\": \"[[parameters('StorageAccountAvailabilityAlertSeverity')]\"\r\n          },\r\n          \"windowSize\": {\r\n            \"value\": \"[[parameters('StorageAccountAvailabilityWindowSize')]\"\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"value\": \"[[parameters('StorageAccountAvailabilityFrequency')]\"\r\n          },\r\n          \"effect\": {\r\n            \"value\": \"[[parameters('StorageAccountAvailabilityPolicyEffect')]\"\r\n          },\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('StorageAccountAvailabilityAlertState')]\"\r\n          },\r\n          \"threshold\": {\r\n            \"value\": \"[[parameters('StorageAccountAvailabilityThreshold')]\"\r\n          }\r\n\r\n        }\r\n      }\r\n    ],\r\n    \"policyType\": \"Custom\",\r\n    \"policyDefinitionGroups\": null\r\n  }\r\n}",
    "$fxv#72": "{\r\n  \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Alerting-ServiceHealth\",\r\n  \"properties\": {\r\n    \"displayName\": \"Deploy Service Health alerts\",\r\n    \"description\": \"Initiative to deploy AMBA Service Health alerts to Azure services\",\r\n    \"metadata\": {\r\n      \"version\": \"1.2.0\",\r\n      \"category\": \"Monitoring\",\r\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_alz_monitor\": true\r\n    },\r\n    \"parameters\": {\r\n      \"ALZMonitorResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"ALZ-Monitoring-RG\"\r\n      },\r\n      \"ALZMonitorResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"defaultValue\": {\r\n          \"_deployed_by_alz_monitor\": true\r\n        }\r\n      },\r\n      \"ALZMonitorResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"defaultValue\": \"centralus\"\r\n      },\r\n      \"ResHlthUnhealthyAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"SvcHlthAdvisoryAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"SvcHlthIncidentAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"SvcHlthMaintenanceAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"svcHlthSecAdvisoryAlertState\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"ALZMonitorActionGroupEmail\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"action@mail.com\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"string\",\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyDefinitions\": [\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_ResHlthUnhealthy\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_activitylog_ResourceHealth_Unhealthy_Alert')]\",\r\n        \"parameters\": {\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('ResHlthUnhealthyAlertState')]\"\r\n          },\r\n          \"alertResourceGroupName\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupName')]\"\r\n          },\r\n          \"alertResourceGroupTags\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupTags')]\"\r\n          },\r\n          \"alertResourceGroupLocation\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupLocation')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_SvcHlthAdvisory\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_activitylog_ServiceHealth_HealthAdvisory')]\",\r\n        \"parameters\": {\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('SvcHlthAdvisoryAlertState')]\"\r\n          },\r\n          \"alertResourceGroupName\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupName')]\"\r\n          },\r\n          \"alertResourceGroupTags\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupTags')]\"\r\n          },\r\n          \"alertResourceGroupLocation\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupLocation')]\"\r\n          },\r\n          \"ALZMonitorActionGroupEmail\": {\r\n            \"value\": \"[[parameters('ALZMonitorActionGroupEmail')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_SvcHlthIncident\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_activitylog_ServiceHealth_Incident')]\",\r\n        \"parameters\": {\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('SvcHlthIncidentAlertState')]\"\r\n          },\r\n          \"alertResourceGroupName\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupName')]\"\r\n          },\r\n          \"alertResourceGroupTags\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupTags')]\"\r\n          },\r\n          \"alertResourceGroupLocation\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupLocation')]\"\r\n          },\r\n          \"ALZMonitorActionGroupEmail\": {\r\n            \"value\": \"[[parameters('ALZMonitorActionGroupEmail')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_SvcHlthMaintenance\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_activitylog_ServiceHealth_Maintenance')]\",\r\n        \"parameters\": {\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('SvcHlthMaintenanceAlertState')]\"\r\n          },\r\n          \"alertResourceGroupName\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupName')]\"\r\n          },\r\n          \"alertResourceGroupTags\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupTags')]\"\r\n          },\r\n          \"alertResourceGroupLocation\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupLocation')]\"\r\n          },\r\n          \"ALZMonitorActionGroupEmail\": {\r\n            \"value\": \"[[parameters('ALZMonitorActionGroupEmail')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_svcHlthSecAdvisory\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_activitylog_ServiceHealth_SecurityAdvisory')]\",\r\n        \"parameters\": {\r\n          \"enabled\": {\r\n            \"value\": \"[[parameters('svcHlthSecAdvisoryAlertState')]\"\r\n          },\r\n          \"alertResourceGroupName\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupName')]\"\r\n          },\r\n          \"alertResourceGroupTags\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupTags')]\"\r\n          },\r\n          \"alertResourceGroupLocation\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupLocation')]\"\r\n          },\r\n          \"ALZMonitorActionGroupEmail\": {\r\n            \"value\": \"[[parameters('ALZMonitorActionGroupEmail')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ALZ_AlertProcessing_Rule\",\r\n        \"policyDefinitionId\": \"[concat('/providers/Microsoft.Management/managementGroups/',managementGroup().name, '/providers/Microsoft.Authorization/policyDefinitions/Deploy_AlertProcessing_Rule')]\",\r\n        \"parameters\": {\r\n          \"ALZMonitorResourceGroupName\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupName')]\"\r\n          },\r\n          \"ALZMonitorResourceGroupTags\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupTags')]\"\r\n          },\r\n          \"ALZMonitorResourceGroupLocation\": {\r\n            \"value\": \"[[parameters('ALZMonitorResourceGroupLocation')]\"\r\n          },\r\n          \"ALZMonitorActionGroupEmail\": {\r\n            \"value\": \"[[parameters('ALZMonitorActionGroupEmail')]\"\r\n          },\r\n          \"MonitorDisable\": {\r\n            \"value\": \"[[parameters('MonitorDisable')]\"\r\n          }\r\n        }\r\n      }\r\n    ],\r\n    \"policyType\": \"Custom\",\r\n    \"policyDefinitionGroups\": null\r\n  }\r\n}",
    "$fxv#8": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_activitylog_ServiceHealth_HealthAdvisory\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy Service Health Advisory Alert\",\r\n    \"description\": \"Policy to Deploy Service Health Advisory Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.1.0\",\r\n      \"category\": \"Monitoring\",\r\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_alz_monitor\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"alertResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Name\",\r\n          \"description\": \"Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"AlzMonitoring-rg\"\r\n      },\r\n      \"alertResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Tags\",\r\n          \"description\": \"Tags on the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": {\r\n          \"environment\": \"test\",\r\n          \"_deployed_by_alz_monitor\": true\r\n        }\r\n      },\r\n      \"alertResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Location\",\r\n          \"description\": \"Location of the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"centralus\"\r\n      },\r\n      \"ALZMonitorActionGroupEmail\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Action Group Email\",\r\n          \"description\": \"Email address to send alerts to\"\r\n        },\r\n        \"defaultValue\": \"action@mail.com\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring  Subscription level alerts. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/activityLogAlerts\",\r\n          \"existenceScope\": \"resourcegroup\",\r\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\r\n          \"deploymentScope\": \"subscription\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/ActivityLogAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              },\r\n              {\r\n                \"count\": {\r\n                  \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*]\",\r\n                  \"where\": {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].field\",\r\n                            \"equals\": \"category\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].equals\",\r\n                            \"equals\": \"ServiceHealth\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].field\",\r\n                            \"equals\": \"properties.incidentType\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].equals\",\r\n                            \"equals\": \"ActionRequired\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                },\r\n                \"equals\": 2\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"location\": \"[[deployment().location]\",\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"alertResourceGroupName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"alertResourceGroupTags\": {\r\n                    \"type\": \"object\"\r\n                  },\r\n                  \"alertResourceGroupLocation\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"ALZMonitorActionGroupEmail\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\r\n                    \"apiVersion\": \"2021-04-01\",\r\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\r\n                  },\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/deployments\",\r\n                    \"apiVersion\": \"2019-10-01\",\r\n                    \"name\": \"ALZ-SvcHealth-Health\",\r\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"dependsOn\": [\r\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\r\n                    ],\r\n                    \"properties\": {\r\n                      \"mode\": \"Incremental\",\r\n                      \"template\": {\r\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                        \"contentVersion\": \"1.0.0.0\",\r\n                        \"parameters\": {\r\n                          \"enabled\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupName\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"ALZMonitorActionGroupEmail\": {\r\n                            \"type\": \"string\"\r\n                          }\r\n                        },\r\n                        \"variables\": {},\r\n                        \"resources\": [\r\n                          {\r\n                            \"type\": \"microsoft.insights/activityLogAlerts\",\r\n                            \"apiVersion\": \"2020-10-01\",\r\n                            \"location\": \"global\",\r\n                            \"dependsOn\": [\r\n                              \"[[concat(subscription().Id, '/resourceGroups/', parameters('alertResourceGroupName'), '/providers/Microsoft.Insights/actionGroups/AlzActionGrp')]\"\r\n                            ],\r\n                            \"tags\": {\r\n                              \"_deployed_by_alz_monitor\": true\r\n                            },\r\n                            \"name\": \"ServiceHealthAdvisoryEvent\",\r\n                            \"properties\": {\r\n                              \"actions\": {\r\n                                \"actionGroups\": [\r\n                                  {\r\n                                    \"actionGroupId\": \"[[concat(subscription().Id, '/resourceGroups/', parameters('alertResourceGroupName'), '/providers/Microsoft.Insights/actionGroups/AlzActionGrp')]\"\r\n                                  }\r\n                                ]\r\n                              },\r\n                              \"description\": \"Service Health Advisory Alert\",\r\n                              \"enabled\": \"[[parameters('enabled')]\",\r\n                              \"scopes\": [\r\n                                \"[[subscription().id]\"\r\n                              ],\r\n                              \"condition\": {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"category\",\r\n                                    \"equals\": \"ServiceHealth\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"properties.incidentType\",\r\n                                    \"equals\": \"ActionRequired\"\r\n                                  }\r\n                                ]\r\n                              },\r\n                              \"parameters\": {\r\n                                \"enabled\": {\r\n                                  \"value\": \"[[parameters('enabled')]\"\r\n                                }\r\n                              }\r\n                            }\r\n                          },\r\n                          {\r\n                            \"type\": \"Microsoft.Insights/actionGroups\",\r\n                            \"apiVersion\": \"2022-04-01\",\r\n                            \"name\": \"AlzActionGrp\",\r\n                            \"location\": \"global\",\r\n                            \"tags\": {\r\n                              \"_deployed_by_alz_monitor\": true\r\n                            },\r\n                            \"properties\": {\r\n                              \"groupShortName\": \"AlzActionGrp\",\r\n                              \"enabled\": true,\r\n                              \"emailReceivers\": [\r\n                                {\r\n                                  \"name\": \"AlzMail\",\r\n                                  \"emailAddress\": \"[[parameters('ALZMonitorActionGroupEmail')]\",\r\n                                  \"useCommonAlertSchema\": true\r\n                                }\r\n                              ]\r\n                            }\r\n                          }\r\n                        ]\r\n                      },\r\n                      \"parameters\": {\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"alertResourceGroupName\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                        },\r\n                        \"ALZMonitorActionGroupEmail\": {\r\n                          \"value\": \"[[parameters('ALZMonitorActionGroupEmail')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"alertResourceGroupName\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                },\r\n                \"alertResourceGroupTags\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\r\n                },\r\n                \"ALZMonitorActionGroupEmail\": {\r\n                  \"value\": \"[[parameters('ALZMonitorActionGroupEmail')]\"\r\n                },\r\n                \"alertResourceGroupLocation\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#9": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_activitylog_ServiceHealth_Incident\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy Service Health Incident Alert\",\r\n    \"description\": \"Policy to Deploy Service Health Incident Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.1.0\",\r\n      \"category\": \"Monitoring\",\r\n      \"source\": \"https://github.com/Azure/Enterprise-Scale/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_alz_monitor\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"alertResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Name\",\r\n          \"description\": \"Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"AlzMonitoring-rg\"\r\n      },\r\n      \"alertResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Tags\",\r\n          \"description\": \"Tags on the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": {\r\n          \"environment\": \"test\",\r\n          \"_deployed_by_alz_monitor\": true\r\n        }\r\n      },\r\n      \"alertResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Location\",\r\n          \"description\": \"Location of the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"centralus\"\r\n      },\r\n      \"ALZMonitorActionGroupEmail\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Action Group Email\",\r\n          \"description\": \"Email address to send alerts to\"\r\n        },\r\n        \"defaultValue\": \"action@mail.com\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring  Subscription level alerts. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/activityLogAlerts\",\r\n          \"existenceScope\": \"resourcegroup\",\r\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\r\n          \"deploymentScope\": \"subscription\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/ActivityLogAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              },\r\n              {\r\n                \"count\": {\r\n                  \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*]\",\r\n                  \"where\": {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].field\",\r\n                            \"equals\": \"category\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].equals\",\r\n                            \"equals\": \"ServiceHealth\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"microsoft.insights/activityLogAlerts/condition.allOf[*].field\",\r\n                            \"equals\": \"properties.incidentType\"\r\n                          },\r\n                          {\r\n                            \"field\": \"microsoft.insights/activityLogAlerts/condition.allOf[*].equals\",\r\n                            \"equals\": \"Incident\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                },\r\n                \"equals\": 2\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"location\": \"[[deployment().location]\",\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"alertResourceGroupName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"alertResourceGroupTags\": {\r\n                    \"type\": \"object\"\r\n                  },\r\n                  \"alertResourceGroupLocation\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"ALZMonitorActionGroupEmail\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\r\n                    \"apiVersion\": \"2021-04-01\",\r\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\r\n                  },\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/deployments\",\r\n                    \"apiVersion\": \"2019-10-01\",\r\n                    \"name\": \"ServiceHealthIncident\",\r\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"dependsOn\": [\r\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\r\n                    ],\r\n                    \"properties\": {\r\n                      \"mode\": \"Incremental\",\r\n                      \"template\": {\r\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                        \"contentVersion\": \"1.0.0.0\",\r\n                        \"parameters\": {\r\n                          \"enabled\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupName\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"ALZMonitorActionGroupEmail\": {\r\n                            \"type\": \"string\"\r\n                          }\r\n                        },\r\n                        \"variables\": {},\r\n                        \"resources\": [\r\n                          {\r\n                            \"type\": \"microsoft.insights/activityLogAlerts\",\r\n                            \"apiVersion\": \"2020-10-01\",\r\n                            \"name\": \"ServieHealthIncident\",\r\n                            \"location\": \"global\",\r\n                            \"dependsOn\": [\r\n                              \"[[concat(subscription().Id, '/resourceGroups/', parameters('alertResourceGroupName'), '/providers/Microsoft.Insights/actionGroups/AlzActionGrp')]\"\r\n                            ],\r\n                            \"tags\": {\r\n                              \"_deployed_by_alz_monitor\": true\r\n                            },\r\n                            \"properties\": {\r\n                              \"actions\": {\r\n                                \"actionGroups\": [\r\n                                  {\r\n                                    \"actionGroupId\": \"[[concat(subscription().Id, '/resourceGroups/', parameters('alertResourceGroupName'), '/providers/Microsoft.Insights/actionGroups/AlzActionGrp')]\"\r\n                                  }\r\n                                ]\r\n                              },\r\n                              \"description\": \"ServiceHealthIncidentAlert\",\r\n                              \"enabled\": \"[[parameters('enabled')]\",\r\n                              \"scopes\": [\r\n                                \"[[subscription().id]\"\r\n                              ],\r\n                              \"condition\": {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"category\",\r\n                                    \"equals\": \"ServiceHealth\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"properties.incidentType\",\r\n                                    \"equals\": \"Incident\"\r\n                                  }\r\n                                ]\r\n                              },\r\n                              \"parameters\": {\r\n                                \"enabled\": {\r\n                                  \"value\": \"[[parameters('enabled')]\"\r\n                                }\r\n                              }\r\n                            }\r\n                          },\r\n                          {\r\n                            \"type\": \"Microsoft.Insights/actionGroups\",\r\n                            \"apiVersion\": \"2022-04-01\",\r\n                            \"name\": \"AlzActionGrp\",\r\n                            \"location\": \"global\",\r\n                            \"tags\": {\r\n                              \"_deployed_by_alz_monitor\": true\r\n                            },\r\n                            \"properties\": {\r\n                              \"groupShortName\": \"AlzActionGrp\",\r\n                              \"enabled\": true,\r\n                              \"emailReceivers\": [\r\n                                {\r\n                                  \"name\": \"AlzMail\",\r\n                                  \"emailAddress\": \"[[parameters('ALZMonitorActionGroupEmail')]\",\r\n                                  \"useCommonAlertSchema\": true\r\n                                }\r\n                              ]\r\n                            }\r\n                          }\r\n                        ]\r\n                      },\r\n                      \"parameters\": {\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"alertResourceGroupName\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                        },\r\n                        \"ALZMonitorActionGroupEmail\": {\r\n                          \"value\": \"[[parameters('ALZMonitorActionGroupEmail')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"alertResourceGroupName\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                },\r\n                \"alertResourceGroupTags\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\r\n                },\r\n                \"alertResourceGroupLocation\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                },\r\n                \"ALZMonitorActionGroupEmail\": {\r\n                  \"value\": \"[[parameters('ALZMonitorActionGroupEmail')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "cloudEnv": "[environment().name]",
    "defaultDeploymentLocationByCloudType": {
      "AzureCloud": "northeurope",
      "AzureChinaCloud": "chinaeast2",
      "AzureUSGovernment": "usgovvirginia"
    },
    "templateVars": {
      "scope": "/providers/Microsoft.Management/managementGroups/contoso",
      "defaultDeploymentLocation": "\"location\": \"northeurope\"",
      "localizedDeploymentLocation": "[format('\"location\": \"{0}\"', variables('defaultDeploymentLocationByCloudType')[variables('cloudEnv')])]"
    },
    "targetDeploymentLocationByCloudType": {
      "AzureCloud": "[coalesce(parameters('location'), 'northeurope')]",
      "AzureChinaCloud": "[coalesce(parameters('location'), 'chinaeast2')]",
      "AzureUSGovernment": "[coalesce(parameters('location'), 'usgovvirginia')]"
    },
    "deploymentLocation": "[format('\"location\": \"{0}\"', variables('targetDeploymentLocationByCloudType')[variables('cloudEnv')])]",
    "loadPolicyDefinitions": {
      "All": [
        "[variables('$fxv#0')]",
        "[variables('$fxv#1')]",
        "[variables('$fxv#2')]",
        "[variables('$fxv#3')]",
        "[variables('$fxv#4')]",
        "[variables('$fxv#5')]",
        "[variables('$fxv#6')]",
        "[variables('$fxv#7')]",
        "[variables('$fxv#8')]",
        "[variables('$fxv#9')]",
        "[variables('$fxv#10')]",
        "[variables('$fxv#11')]",
        "[variables('$fxv#12')]",
        "[variables('$fxv#13')]",
        "[variables('$fxv#14')]",
        "[variables('$fxv#15')]",
        "[variables('$fxv#16')]",
        "[variables('$fxv#17')]",
        "[variables('$fxv#18')]",
        "[variables('$fxv#19')]",
        "[variables('$fxv#20')]",
        "[variables('$fxv#21')]",
        "[variables('$fxv#22')]",
        "[variables('$fxv#23')]",
        "[variables('$fxv#24')]",
        "[variables('$fxv#25')]",
        "[variables('$fxv#26')]",
        "[variables('$fxv#27')]",
        "[variables('$fxv#28')]",
        "[variables('$fxv#29')]",
        "[variables('$fxv#30')]",
        "[variables('$fxv#31')]",
        "[variables('$fxv#32')]",
        "[variables('$fxv#33')]",
        "[variables('$fxv#34')]",
        "[variables('$fxv#35')]",
        "[variables('$fxv#36')]",
        "[variables('$fxv#37')]",
        "[variables('$fxv#38')]",
        "[variables('$fxv#39')]",
        "[variables('$fxv#40')]",
        "[variables('$fxv#41')]",
        "[variables('$fxv#42')]",
        "[variables('$fxv#43')]",
        "[variables('$fxv#44')]",
        "[variables('$fxv#45')]",
        "[variables('$fxv#46')]",
        "[variables('$fxv#47')]",
        "[variables('$fxv#48')]",
        "[variables('$fxv#49')]",
        "[variables('$fxv#50')]",
        "[variables('$fxv#51')]",
        "[variables('$fxv#52')]",
        "[variables('$fxv#53')]",
        "[variables('$fxv#54')]",
        "[variables('$fxv#55')]",
        "[variables('$fxv#56')]",
        "[variables('$fxv#57')]",
        "[variables('$fxv#58')]",
        "[variables('$fxv#59')]",
        "[variables('$fxv#60')]",
        "[variables('$fxv#61')]",
        "[variables('$fxv#62')]",
        "[variables('$fxv#63')]",
        "[variables('$fxv#64')]",
        "[variables('$fxv#65')]",
        "[variables('$fxv#66')]",
        "[variables('$fxv#67')]"
      ],
      "AzureCloud": [],
      "AzureChinaCloud": [],
      "AzureUSGovernment": []
    },
    "loadPolicySetDefinitions": {
      "All": [
        "[variables('$fxv#68')]",
        "[variables('$fxv#69')]",
        "[variables('$fxv#70')]",
        "[variables('$fxv#71')]",
        "[variables('$fxv#72')]"
      ],
      "AzureCloud": [],
      "AzureChinaCloud": [],
      "AzureUSGovernment": []
    },
    "policyDefinitionsByCloudType": {
      "All": "[variables('policyDefinitionsAll')]",
      "AzureCloud": "[variables('policyDefinitionsAzureCloud')]",
      "AzureChinaCloud": "[variables('policyDefinitionsAzureChinaCloud')]",
      "AzureUSGovernment": "[variables('policyDefinitionsAzureUSGovernment')]"
    },
    "policySetDefinitionsByCloudType": {
      "All": "[variables('policySetDefinitionsAll')]",
      "AzureCloud": "[variables('policySetDefinitionsAzureCloud')]",
      "AzureChinaCloud": "[variables('policySetDefinitionsAzureChinaCloud')]",
      "AzureUSGovernment": "[variables('policySetDefinitionsAzureUSGovernment')]"
    },
    "policyDefinitions": "[concat(variables('policyDefinitionsByCloudType').All, variables('policyDefinitionsByCloudType')[variables('cloudEnv')])]",
    "policySetDefinitions": "[concat(variables('policySetDefinitionsByCloudType').All, variables('policySetDefinitionsByCloudType')[variables('cloudEnv')])]"
  },
  "resources": [
    {
      "copy": {
        "name": "PolicyDefinitions",
        "count": "[length(variables('policyDefinitions'))]"
      },
      "type": "Microsoft.Authorization/policyDefinitions",
      "apiVersion": "2020-09-01",
      "name": "[variables('policyDefinitions')[copyIndex()].name]",
      "properties": {
        "description": "[variables('policyDefinitions')[copyIndex()].properties.description]",
        "displayName": "[variables('policyDefinitions')[copyIndex()].properties.displayName]",
        "metadata": "[variables('policyDefinitions')[copyIndex()].properties.metadata]",
        "mode": "[variables('policyDefinitions')[copyIndex()].properties.mode]",
        "parameters": "[variables('policyDefinitions')[copyIndex()].properties.parameters]",
        "policyType": "[variables('policyDefinitions')[copyIndex()].properties.policyType]",
        "policyRule": "[variables('policyDefinitions')[copyIndex()].properties.policyRule]"
      }
    },
    {
      "copy": {
        "name": "PolicySetDefinitions",
        "count": "[length(variables('policySetDefinitions'))]"
      },
      "type": "Microsoft.Authorization/policySetDefinitions",
      "apiVersion": "2020-09-01",
      "name": "[variables('policySetDefinitions')[copyIndex()].name]",
      "properties": {
        "description": "[variables('policySetDefinitions')[copyIndex()].properties.description]",
        "displayName": "[variables('policySetDefinitions')[copyIndex()].properties.displayName]",
        "metadata": "[variables('policySetDefinitions')[copyIndex()].properties.metadata]",
        "parameters": "[variables('policySetDefinitions')[copyIndex()].properties.parameters]",
        "policyType": "[variables('policySetDefinitions')[copyIndex()].properties.policyType]",
        "policyDefinitions": "[variables('policySetDefinitions')[copyIndex()].properties.policyDefinitions]",
        "policyDefinitionGroups": "[variables('policySetDefinitions')[copyIndex()].properties.policyDefinitionGroups]"
      },
      "dependsOn": [
        "PolicyDefinitions"
      ]
    }
  ],
  "outputs": {
    "policyDefinitionNames": {
      "type": "array",
      "copy": {
        "count": "[length(variables('policyDefinitions'))]",
        "input": "[variables('policyDefinitions')[copyIndex()].name]"
      }
    },
    "policySetDefinitionNames": {
      "type": "array",
      "copy": {
        "count": "[length(variables('policySetDefinitions'))]",
        "input": "[variables('policySetDefinitions')[copyIndex()].name]"
      }
    }
  }
}