{
    "$schema": "https://schema.management.azure.com/schemas/2021-09-09/uiFormDefinition.schema.json#",
    "view": {
        "kind": "Form",
        "properties": {
            "title": "Azure landing zone accelerator",
            "steps": [
                {
                    "name": "basics",
                    "label": "Deployment settings",
                    "elements": [
                        {
                            "name": "cloudEnvironment",
                            "type": "Microsoft.Common.Section",
                            "label": "Select cloud environment",
                            "elements": [
                                {
                                    "name": "selection",
                                    "type": "Microsoft.Common.DropDown",
                                    "visible": true,
                                    "label": "Azure cloud environment",
                                    "defaultValue": "[if(contains(steps('basics').resourceScope.location.name, 'china'), 'Azure China Cloud', if(contains(steps('basics').resourceScope.location.name, 'usgov'), 'Azure US Government', if(contains(steps('basics').resourceScope.location.name, 'usdod'), 'Azure US Government', 'Azure Cloud')))]",
                                    "multiselect": false,
                                    "selectAll": false,
                                    "filter": false,
                                    "multiLine": true,
                                    "toolTip": "Select your target Azure cloud environment.",
                                    "constraints": {
                                        "allowedValues": [
                                            {
                                                "label": "Azure Cloud",
                                                "value": "AzureCloud"
                                            },
                                            {
                                                "label": "Azure China Cloud",
                                                "value": "AzureChinaCloud"
                                            },
                                            {
                                                "label": "Azure US Government",
                                                "value": "AzureUSGovernment"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "warning",
                                    "type": "Microsoft.Common.InfoBox",
                                    "visible": true,
                                    "options": {
                                        "icon": "Warning",
                                        "text": "This value should be automatically set based on the list of available locations. Only change this if you believe the value to be incorrect.",
                                        "uri": "https://docs.microsoft.com/en-us/cli/azure/manage-clouds-azure-cli"
                                    }
                                }
                            ]
                        },
                        {
                            "name": "resourceScope",
                            "type": "Microsoft.Common.ResourceScope"
                        },
                        {
                            "name": "getSubscriptions",
                            "type": "Microsoft.Solutions.ArmApiControl",
                            "request": {
                                "method": "POST",
                                "path": "providers/Microsoft.ResourceGraph/resources?api-version=2021-03-01",
                                "body": {
                                    "query": "ResourceContainers | where type =~ 'microsoft.resources/subscriptions' | where properties.state =~ 'enabled' | project label=tostring(name), description=subscriptionId, value=subscriptionId | order by label asc"
                                }
                            }
                        },
                        {
                            "name": "getLocations",
                            "type": "Microsoft.Solutions.ArmApiControl",
                            "request": {
                                "method": "GET",
                                "path": "locations?api-version=2019-11-01"
                            }
                        },
                        {
                            "name": "getRegulatoryCompliancePolicies",
                            "type": "Microsoft.Solutions.ArmApiControl",
                            "request": {
                                "method": "POST",
                                "path": "providers/Microsoft.ResourceGraph/resources?api-version=2021-03-01",
                                "body": {
                                    "query": "policyresources | where type == 'microsoft.authorization/policysetdefinitions' | extend metadataCategory=tostring(properties.metadata.category) | extend metadataDeprecated=tostring(properties.metadata.deprecated) | extend displayName=tostring(properties.displayName) | extend description=tostring(properties.description) | where properties.metadata.category =~ 'Regulatory Compliance' | where metadataDeprecated != 'true' |  extend valueOutput=pack('displayName', displayName, 'id', id, 'description', description) | project id, name, displayName, description, metadataCategory, valueOutput | project label=displayName, description, value=valueOutput | order by label asc"
                                }
                            }
                        }
                    ]
                },
                {
                    "name": "core",
                    "label": "Azure core setup",
                    "subLabel": {
                        "preValidation": "Provide a company prefix for the management group structure that will be created.",
                        "postValidation": "Done"
                    },
                    "bladeTitle": "ALZ - Core Settings",
                    "elements": [
                        {
                            "name": "info",
                            "type": "Microsoft.Common.InfoBox",
                            "visible": true,
                            "options": {
                                "text": "Azure Landing Zones ARM deployment requires access at the tenant root (/) scope. Visit this link to ensure you have the appropriate RBAC permission to complete the deployment",
                                "uri": "https://docs.microsoft.com/azure/role-based-access-control/elevate-access-global-admin",
                                "style": "Info"
                            }
                        },
                        {
                            "name": "mgmtGroup",
                            "type": "Microsoft.Common.TextBlock",
                            "visible": true,
                            "options": {
                                "text": "Azure Landing Zones will create the management group hierarchy under the Tenant Root Group with the prefix provided at this step.",
                                "link": {
                                    "label": "Learn more",
                                    "uri": "https://docs.microsoft.com/azure/cloud-adoption-framework/ready/enterprise-scale/management-group-and-subscription-organization"
                                }
                            }
                        },
                        {
                            "name": "alzMgmtGroupExistingWarning",
                            "type": "Microsoft.Common.InfoBox",
                            "visible": true,
                            "options": {
                                "text": "This deployment will create the ALZ default Management Group hierarchy with Names/IDs that are documented in the FAQ (click on this box to be taken to this page). If you have existing Management Groups that have the same Names/IDs these will be targeted in the ALZ deployment (click on this box to find out how to handle this or to see what will happen)",
                                "style": "Warning",
                                "uri": "https://github.com/Azure/Enterprise-Scale/wiki/FAQ#what-happens-if-i-have-existing-management-groups-that-have-the-same-nameids-as-ones-that-will-be-deployed-in-the-alz-portal-accelerator"
                            }
                        },
                        {
                            "name": "enterpriseScaleCompanyPrefix",
                            "type": "Microsoft.Common.TextBox",
                            "label": "Resource prefix (Root ID)",
                            "toolTip": "Provide a resource prefix (max 10 characters, unique at tenant-scope). This will be used for the Management Group hierarchy and other resources created as part of this deployment.",
                            "defaultValue": "",
                            "constraints": {
                                "required": true,
                                "regex": "^[a-z0-9A-Z-]{1,10}$",
                                "validationMessage": "The prefix must be 1-10 characters."
                            }
                        },
                        {
                            "name": "platformSubscription",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Platform subscription options",
                            "defaultValue": "Dedicated (recommended)",
                            "toolTip": "If 'Dedicated (recommended)' is selected, dedicated Subscriptions will be used for deploying connectivity, identity and management resources. Select Single for testing purposes where all roles will be deployed in a single subscription.",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Dedicated (recommended)",
                                        "value": "Dedicated"
                                    },
                                    {
                                        "label": "Single",
                                        "value": "Single"
                                    }
                                ]
                            },
                            "visible": true
                        },
                        {
                            "name": "singleSubscription",
                            "type": "Microsoft.Common.Section",
                            "label": "Single platform subscription",
                            "elements": [
                                {
                                    "name": "subWarning",
                                    "type": "Microsoft.Common.InfoBox",
                                    "visible": true,
                                    "options": {
                                        "icon": "Warning",
                                        "text": "Dedicated subscriptions are recommended for the different platform resource categories to ensure scale, sustainability, and segregation of duties. A single subscription can be used for proof of concepts, or by smaller organizations.",
                                        "uri": "https://docs.microsoft.com/azure/cloud-adoption-framework/ready/enterprise-scale/management-group-and-subscription-organization"
                                    }
                                },
                                {
                                    "name": "singleSubText",
                                    "type": "Microsoft.Common.TextBlock",
                                    "visible": true,
                                    "options": {
                                        "text": "Select a single subscription that will be used for all platform resources. This includes resources relating to platform management, security, governance, automation, connectivity, and identity."
                                    }
                                },
                                {
                                    "name": "selector",
                                    "type": "Microsoft.Common.DropDown",
                                    "label": "Platform subscription",
                                    "defaultValue": "[parse('[]')]",
                                    "toolTip": "",
                                    "multiselect": false,
                                    "selectAll": false,
                                    "filter": true,
                                    "filterPlaceholder": "Filter subscriptions...",
                                    "multiLine": true,
                                    "visible": true,
                                    "constraints": {
                                        "allowedValues": "[steps('basics').getSubscriptions.data]",
                                        "required": true
                                    }
                                }
                            ],
                            "visible": "[equals(steps('core').platformSubscription, 'Single')]"
                        },
                        {
                            "name": "deploySecondaryRegion",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Deploy in a secondary region",
                            "defaultValue": "Yes (recommended)",
                            "visible": true,
                            "toolTip": "If you select Yes, you will be prompted to deploy resources in an additional region where appropriate.",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes (recommended)",
                                        "value": "Yes"
                                    },
                                    {
                                        "label": "No",
                                        "value": "No"
                                    }
                                ]
                            }
                        },
                        {
                            "name": "denyClassicResources",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Prevent the deployment of classic resources",
                            "defaultValue": "Yes (recommended)",
                            "visible": true,
                            "toolTip": "If 'Yes' is selected then Azure Policy will prevent deployment of classic resources which will be retired on 31 August 2024.<br>Uses the policy <a href=\"https://www.azadvertizer.net/azpolicyadvertizer/6c112d4e-5bc7-47ae-a041-ea2d9dccd749.html\">Not allowed resource types</a> with parameters including all classic resources.",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes (recommended)",
                                        "value": "Yes"
                                    },
                                    {
                                        "label": "Audit only",
                                        "value": "Audit"
                                    },
                                    {
                                        "label": "No",
                                        "value": "No"
                                    }
                                ]
                            }
                        },
                        {
                            "name": "denyVMUnmanagedDisk",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Prevent the deployment of virtual machines and virtual machine scale sets with unmanaged disks",
                            "defaultValue": "Yes (recommended)",
                            "visible": true,
                            "toolTip": "If 'Yes' is selected then Azure Policy will prevent deployment of virtual machines and virtual machine scales sets with unmanaged disks.<br>Uses the policy <a href=\"https://www.azadvertizer.net/azpolicyadvertizer/06a78e20-9358-41c9-923c-fb736d382a4d.html\">Audit VMs that do not use managed disks</a> using a Deny override.",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes (recommended)",
                                        "value": "Yes"
                                    },
                                    {
                                        "label": "No",
                                        "value": "No"
                                    }
                                ]
                            }
                        },
                        {
                            "name": "cuaSection",
                            "type": "Microsoft.Common.Section",
                            "label": "Telemetry Tracking Using Customer Usage Attribution (PID)",
                            "elements": [
                                {
                                    "name": "cuaSettingsInfo",
                                    "type": "Microsoft.Common.InfoBox",
                                    "visible": "[equals(steps('basics').cloudEnvironment.selection, 'AzureCloud')]",
                                    "options": {
                                        "text": "Microsoft can identify the deployments of the Azure Resource Manager templates with the deployed Azure resources. Microsoft collects this information to provide the best experiences with their products and to operate their business. The telemetry is collected through customer usage attribution. The data is collected and governed by Microsoft's privacy policies, located at the trust center. Visit this link to find out more.",
                                        "uri": "https://github.com/Azure/Enterprise-Scale/wiki/Deploying-Enterprise-Scale-CustomerUsage",
                                        "style": "Info"
                                    }
                                },
                                {
                                    "name": "telemetryOptOut",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "visible": "[equals(steps('basics').cloudEnvironment.selection, 'AzureCloud')]",
                                    "label": "Customer Usage Selection Options",
                                    "defaultValue": "[if(equals(steps('basics').cloudEnvironment.selection, 'AzureCloud'), 'Enabled', 'Disabled')]",
                                    "constraints": {
                                        "allowedValues": [
                                            {
                                                "label": "Enabled",
                                                "value": "No"
                                            },
                                            {
                                                "label": "Disabled",
                                                "value": "Yes"
                                            }
                                        ],
                                        "required": true
                                    }
                                }
                            ],
                            "visible": "[equals(steps('basics').cloudEnvironment.selection, 'AzureCloud')]"
                        }
                    ]
                },
                {
                    "name": "management",
                    "label": "Platform management, security, and governance",
                    "subLabel": {
                        "preValidation": "",
                        "postValidation": ""
                    },
                    "bladeTitle": "ALZ - Management Settings",
                    "elements": [
                        {
                            "name": "esPlatformMgmtGroup",
                            "type": "Microsoft.Common.Section",
                            "label": "Platform Management Group",
                            "elements": [
                                {
                                    "name": "enforceKvGuardrailsPlat",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "label": "Enforce Key Vault recommended guardrails",
                                    "defaultValue": "Yes (recommended)",
                                    "toolTip": "If 'Yes' is selected, Azure Policy Initiative will be assigned to ensure recommended Key Vault policies are enabled.<br>Uses the custom initiative <a href=\"https://www.azadvertizer.net/azpolicyinitiativesadvertizer/Enforce-Guardrails-KeyVault.html\">Enforce recommended guardrails for Azure Key Vault.</a>.",
                                    "constraints": {
                                        "allowedValues": [
                                            {
                                                "label": "Yes (recommended)",
                                                "value": "Yes"
                                            },
                                            {
                                                "label": "Audit only",
                                                "value": "Audit"
                                            },
                                            {
                                                "label": "No",
                                                "value": "No"
                                            }
                                        ]
                                    },
                                    "visible": true
                                }
                            ]
                        },
                        {
                            "name": "multiPlatformMgmtSub",
                            "type": "Microsoft.Common.InfoBox",
                            "visible": "[not(equals(steps('core').platformSubscription, 'Single'))]",
                            "options": {
                                "text": "To enable platform management, security and governance, you must allocate a management Subscription. Please note, this Subscription will be moved to the platform Management Group, and ARM will deploy a Log Analytics workspace and requisite settings. We recommend using a new Subscription with no existing resources. Note that Azure Policy will be used to govern the configuration for the platform at scale.",
                                "uri": "https://docs.microsoft.com/azure/cloud-adoption-framework/ready/enterprise-scale/management-and-monitoring",
                                "style": "Info"
                            }
                        },
                        {
                            "name": "singlePlatformMgmtSub",
                            "type": "Microsoft.Common.InfoBox",
                            "visible": "[equals(steps('core').platformSubscription, 'Single')]",
                            "options": {
                                "text": "To enable platform management, security and governance, you can configure core infra such as Log Analytics, Azure Security Center and additional monitoring solutions to your dedicated platform subscription. Note that Azure Policy will be used to govern the configuration for the platform at scale.",
                                "uri": "https://docs.microsoft.com/azure/cloud-adoption-framework/ready/enterprise-scale/management-and-monitoring",
                                "style": "Info"
                            }
                        },
                        {
                            "name": "enableLogAnalytics",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Deploy Log Analytics workspace and enable monitoring for your platform and resources",
                            "defaultValue": "Yes (recommended)",
                            "toolTip": "If 'Yes' is selected when also adding a subscription for management, ARM will deploy resources and enable them for continuous compliance.",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes (recommended)",
                                        "value": "Yes"
                                    },
                                    {
                                        "label": "No",
                                        "value": "No"
                                    }
                                ]
                            },
                            "visible": true
                        },
                        {
                            "name": "retentionInDays",
                            "type": "Microsoft.Common.Slider",
                            "min": 30,
                            "max": 730,
                            "label": "Log Analytics Data Retention (days)",
                            "subLabel": "Days",
                            "defaultValue": 30,
                            "showStepMarkers": false,
                            "toolTip": "Select retention days for Azure logs. Default is 30 days (free retention period). If you are also deploying Microsoft Sentinel, change this to 90 days (free retention for Sentinel).",
                            "constraints": {
                                "required": false
                            },
                            "visible": "[equals(steps('management').enableLogAnalytics,'Yes')]"
                        },
                        {
                            "name": "archiveLoggingInfo",
                            "type": "Microsoft.Common.InfoBox",
                            "visible": "true",
                            "options": {
                                "text": "Note: Log Analytics offers two log data plans, Analytics and Basic, that let you reduce log ingestion and retention costs, and archive that let you keep older data at a reduced cost. After deployment, go to the tables menu in the Log Analytics workspace and select the tables you want to archive or set with basic plan.<br><ul><li><a href=\"https://learn.microsoft.com/en-us/azure/azure-monitor/logs/data-retention-archive\">Configure data retention and archive policies in Azure Monitor Logs</a><li><a href=\"https://learn.microsoft.com/en-us/azure/azure-monitor/logs/basic-logs-configure\">Set a table's log data plan to Basic or Analytics</a></ul>",
                                "style": "Info"
                            }
                        },
                        {
                            "name": "esMgmtSubSection",
                            "type": "Microsoft.Common.Section",
                            "label": "Management subscription",
                            "elements": [
                                {
                                    "name": "esMgmtSubUniqueWarning",
                                    "type": "Microsoft.Common.InfoBox",
                                    "visible": true,
                                    "options": {
                                        "text": "Ensure you select a subscription that is dedicated/unique for Management. Selecting the same Subscription here for Connectivity or Identity will result in a deployment failure. If you want to use a single Subscription for all platform resources, select 'Single' on the 'Azure Core Setup' blade.",
                                        "uri": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-subscriptions#organization-and-governance-design-considerations",
                                        "style": "Warning"
                                    }
                                },
                                {
                                    "name": "esMgmtSub",
                                    "type": "Microsoft.Common.DropDown",
                                    "label": "Management subscription",
                                    "defaultValue": "[parse('[]')]",
                                    "toolTip": "",
                                    "multiselect": false,
                                    "selectAll": false,
                                    "filter": true,
                                    "filterPlaceholder": "Filter subscriptions...",
                                    "multiLine": true,
                                    "visible": true,
                                    "constraints": {
                                        "allowedValues": "[steps('basics').getSubscriptions.data]",
                                        "required": false
                                    }
                                }
                            ],
                            "visible": "[and(equals(steps('management').enableLogAnalytics, 'Yes'), not(equals(steps('core').platformSubscription, 'Single')))]"
                        },
                        {
                            "name": "monitoring",
                            "type": "Microsoft.Common.TextBlock",
                            "visible": "[equals(steps('management').enableLogAnalytics,'Yes')]",
                            "options": {
                                "text": "Select which Azure Monitor solutions you will enable for your Log Analytics workspace",
                                "link": {
                                    "label": "Learn more",
                                    "uri": "https://docs.microsoft.com/azure/azure-monitor/insights/solutions"
                                }
                            }
                        },
                        {
                            "name": "userAssignedIdentityResourceGroup",
                            "type": "Microsoft.Common.TextBox",
                            "label": "Resource group for the User Assigned Managed Identity for AMA",
                            "toolTip": "Resource group for the User Assigned Managed Identity for Azure Monitor Agent. Will be created in all subscriptions in scope for the policy",
                            "visible": "[equals(steps('management').enableLogAnalytics,'Yes')]",
                            "defaultValue": "rg-ama-prod-001",
                            "constraints": {
                                "required": "[equals(steps('management').enableLogAnalytics,'Yes')]",
                                "regex": "^[a-zA-Z0-9][a-zA-Z0-9-_.()]{0,89}[a-zA-Z0-9]$",
                                "validationMessage": "Please provide a valid resource group name"
                            }
                        },
                        {
                            "name": "enableChangeTracking",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Deploy Change Tracking",
                            "defaultValue": "Yes (recommended)",
                            "toolTip": "If 'Yes' is selected when also adding a subscription for management, ARM will deploy resources and enable them for continuous compliance.",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes (recommended)",
                                        "value": "Yes"
                                    },
                                    {
                                        "label": "No",
                                        "value": "No"
                                    }
                                ]
                            },
                            "visible": "[equals(steps('management').enableLogAnalytics,'Yes')]"
                        },
                        {
                            "name": "enableUpdateMgmt",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Deploy Azure Update Manager",
                            "defaultValue": "Yes (recommended)",
                            "toolTip": "If 'Yes' is selected when also adding a subscription for management, ARM will deploy resources and enable them for continuous compliance.",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes (recommended)",
                                        "value": "Yes"
                                    },
                                    {
                                        "label": "No",
                                        "value": "No"
                                    }
                                ]
                            },
                            "visible": "[equals(steps('management').enableLogAnalytics,'Yes')]"
                        },
                        {
                            "name": "enableVmInsights",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Deploy VM Insights",
                            "defaultValue": "Yes (recommended)",
                            "toolTip": "If 'Yes' is selected when also adding a subscription for management, ARM will deploy resources and enable them for continuous compliance.",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes (recommended)",
                                        "value": "Yes"
                                    },
                                    {
                                        "label": "No",
                                        "value": "No"
                                    }
                                ]
                            },
                            "visible": "[equals(steps('management').enableLogAnalytics,'Yes')]"
                        },
                        {
                            "name": "textBlock0",
                            "type": "Microsoft.Common.TextBlock",
                            "visible": "[equals(steps('management').enableLogAnalytics,'Yes')]",
                            "options": {
                                "text": "Select which Microsoft Defender for Cloud solutions you will enable.",
                                "link": {
                                    "label": "Learn more",
                                    "uri": "https://docs.microsoft.com/azure/security/fundamentals/overview"
                                }
                            }
                        },
                        {
                            "name": "enableAsc",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Deploy Microsoft Defender for Cloud and enable security monitoring for your platform and resources",
                            "defaultValue": "Yes (recommended)",
                            "toolTip": "Selecting 'Yes' will enable the options to configure individual Microsoft Defender for Cloud components, and will enable Microsoft Defender for Cloud plans on all subscriptions in the Azure Landing Zone. If 'Yes' is selected when also adding a subscription for management, ARM will deploy resources and enable them for continuous compliance.",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes (recommended)",
                                        "value": "Yes"
                                    },
                                    {
                                        "label": "No",
                                        "value": "No"
                                    }
                                ]
                            },
                            "visible": "[equals(steps('management').enableLogAnalytics,'Yes')]"
                        },
                        {
                            "name": "emailContactAsc",
                            "type": "Microsoft.Common.TextBox",
                            "label": "Microsoft Defender for Cloud Email Contact",
                            "toolTip": "Email address to get email notifications from Microsoft Defender for Cloud.",
                            "visible": "[equals(steps('management').enableAsc,'Yes')]",
                            "defaultValue": "",
                            "constraints": {
                                "required": "[equals(steps('management').enableAsc,'Yes')]",
                                "regex": "^[\\w-\\.]+@([\\w-]+\\.)+[\\w-]{2,4}$",
                                "validationMessage": "Please provide a valid email address"
                            }
                        },
                        {
                            "name": "enableAscForServers",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Enable Microsoft Defender for Cloud for servers",
                            "defaultValue": "Yes (recommended)",
                            "toolTip": "If 'Yes' is selected, Microsoft Defender for Cloud will be enabled for all servers.<br>Uses the custom initiative <a href=\"https://www.azadvertizer.net/azpolicyinitiativesadvertizer/Deploy-MDFC-Config.html\">Deploy Microsoft Defender for Cloud configuration</a>.",
                            "visible": "[equals(steps('management').enableAsc,'Yes')]",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes (recommended)",
                                        "value": "DeployIfNotExists"
                                    },
                                    {
                                        "label": "No",
                                        "value": "Disabled"
                                    }
                                ]
                            }
                        },
                        {
                            "name": "enableAscForServersVulnerabilityAssessments",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Enable Microsoft Defender for Cloud for servers vulnerability assessments",
                            "defaultValue": "Yes (recommended)",
                            "toolTip": "If 'Yes' is selected, Microsoft Defender for Cloud for servers vulnerability assessments will be enabled for all servers.<br>Uses the custom initiative <a href=\"https://www.azadvertizer.net/azpolicyinitiativesadvertizer/Deploy-MDFC-Config.html\">Deploy Microsoft Defender for Cloud configuration</a>.",
                            "visible": "[equals(steps('management').enableAsc,'Yes')]",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes (recommended)",
                                        "value": "DeployIfNotExists"
                                    },
                                    {
                                        "label": "No",
                                        "value": "Disabled"
                                    }
                                ]
                            }
                        },
                        {
                            "name": "vulnerabilityAssessmentProvider",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Choose the Microsoft Defender for Cloud for servers vulnerability assessments provider",
                            "defaultValue": "Microsoft Defender vulnerability management (recommended)",
                            "toolTip": "Choose the preferred vulnerability assessment provider for Microsoft Defender for Cloud for servers vulnerability assessments.<br>Uses the custom initiative <a href=\"https://www.azadvertizer.net/azpolicyinitiativesadvertizer/Deploy-MDFC-Config.html\">Deploy Microsoft Defender for Cloud configuration</a>.",
                            "visible": "[and(equals(steps('management').enableAsc,'Yes'), equals(steps('management').enableAscForServersVulnerabilityAssessments,'DeployIfNotExists'))]",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Microsoft Defender for Cloud integrated Qualys scanner",
                                        "value": "default"
                                    },
                                    {
                                        "label": "Microsoft Defender vulnerability management (recommended)",
                                        "value": "mdeTvm"
                                    }
                                ]
                            }
                        },
                        {
                            "name": "enableAscForOssDb",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Enable Microsoft Defender for Cloud for open-source relational databases",
                            "defaultValue": "Yes (recommended)",
                            "toolTip": "If 'Yes' is selected, Microsoft Defender for Cloud will be enabled for open-source relational databases.<br>Uses the custom initiative <a href=\"https://www.azadvertizer.net/azpolicyinitiativesadvertizer/Deploy-MDFC-Config.html\">Deploy Microsoft Defender for Cloud configuration</a>.",
                            "visible": "[and(equals(steps('management').enableAsc,'Yes'), equals(steps('basics').cloudEnvironment.selection, 'AzureCloud'))]",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes (recommended)",
                                        "value": "DeployIfNotExists"
                                    },
                                    {
                                        "label": "No",
                                        "value": "Disabled"
                                    }
                                ]
                            }
                        },
                        {
                            "name": "enableAscForCosmosDbs",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Enable Microsoft Defender for Cloud for Cosmos DB",
                            "defaultValue": "Yes (recommended)",
                            "toolTip": "If 'Yes' is selected, Microsoft Defender for Cloud will be enabled for Cosmos DB.<br>Uses the custom initiative <a href=\"https://www.azadvertizer.net/azpolicyinitiativesadvertizer/Deploy-MDFC-Config.html\">Deploy Microsoft Defender for Cloud configuration</a>.",
                            "visible": "[and(equals(steps('management').enableAsc,'Yes'), equals(steps('basics').cloudEnvironment.selection, 'AzureCloud'))]",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes (recommended)",
                                        "value": "DeployIfNotExists"
                                    },
                                    {
                                        "label": "No",
                                        "value": "Disabled"
                                    }
                                ]
                            }
                        },
                        {
                            "name": "enableAscForAppServices",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Enable Microsoft Defender for Cloud for AppServices",
                            "defaultValue": "Yes (recommended)",
                            "toolTip": "If 'Yes' is selected, Microsoft Defender for Cloud will be enabled for AppServices.<br>Uses the custom initiative <a href=\"https://www.azadvertizer.net/azpolicyinitiativesadvertizer/Deploy-MDFC-Config.html\">Deploy Microsoft Defender for Cloud configuration</a>.",
                            "visible": "[and(equals(steps('management').enableAsc,'Yes'), equals(steps('basics').cloudEnvironment.selection, 'AzureCloud'))]",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes (recommended)",
                                        "value": "DeployIfNotExists"
                                    },
                                    {
                                        "label": "No",
                                        "value": "Disabled"
                                    }
                                ]
                            }
                        },
                        {
                            "name": "enableAscForStorage",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Enable Microsoft Defender for Cloud for Storage",
                            "defaultValue": "Yes (recommended)",
                            "toolTip": "If 'Yes' is selected, Microsoft Defender for Cloud will be enabled for Storage.<br>Uses the custom initiative <a href=\"https://www.azadvertizer.net/azpolicyinitiativesadvertizer/Deploy-MDFC-Config.html\">Deploy Microsoft Defender for Cloud configuration</a>.",
                            "visible": "[and(equals(steps('management').enableAsc,'Yes'), or(equals(steps('basics').cloudEnvironment.selection, 'AzureCloud'), equals(steps('basics').cloudEnvironment.selection, 'AzureUSGovernment')))]",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes (recommended)",
                                        "value": "DeployIfNotExists"
                                    },
                                    {
                                        "label": "No",
                                        "value": "Disabled"
                                    }
                                ]
                            }
                        },
                        {
                            "name": "enableAscForSql",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Enable Microsoft Defender for Cloud for Azure SQL Database",
                            "defaultValue": "Yes (recommended)",
                            "toolTip": "If 'Yes' is selected, Microsoft Defender for Cloud will be enabled for Azure SQL Database.<br>Uses the custom initiative <a href=\"https://www.azadvertizer.net/azpolicyinitiativesadvertizer/Deploy-MDFC-Config.html\">Deploy Microsoft Defender for Cloud configuration</a>.",
                            "visible": "[equals(steps('management').enableAsc,'Yes')]",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes (recommended)",
                                        "value": "DeployIfNotExists"
                                    },
                                    {
                                        "label": "No",
                                        "value": "Disabled"
                                    }
                                ]
                            }
                        },
                        {
                            "name": "enableAscForSqlOnVm",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Enable Microsoft Defender for Cloud for SQL servers on machines",
                            "defaultValue": "Yes (recommended)",
                            "toolTip": "If 'Yes' is selected, Microsoft Defender for Cloud will be enabled for SQL servers on virtual machines.<br>Uses the custom initiative <a href=\"https://www.azadvertizer.net/azpolicyinitiativesadvertizer/Deploy-MDFC-Config.html\">Deploy Microsoft Defender for Cloud configuration</a>.",
                            "visible": "[and(equals(steps('management').enableAsc,'Yes'), equals(steps('basics').cloudEnvironment.selection, 'AzureCloud'))]",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes (recommended)",
                                        "value": "DeployIfNotExists"
                                    },
                                    {
                                        "label": "No",
                                        "value": "Disabled"
                                    }
                                ]
                            }
                        },
                        {
                            "name": "enableAscForKeyVault",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Enable Microsoft Defender for Cloud for Key Vault",
                            "defaultValue": "Yes (recommended)",
                            "toolTip": "If 'Yes' is selected, Microsoft Defender for Cloud will be enabled for Key Vault.<br>Uses the custom initiative <a href=\"https://www.azadvertizer.net/azpolicyinitiativesadvertizer/Deploy-MDFC-Config.html\">Deploy Microsoft Defender for Cloud configuration</a>.",
                            "visible": "[and(equals(steps('management').enableAsc,'Yes'), equals(steps('basics').cloudEnvironment.selection, 'AzureCloud'))]",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes (recommended)",
                                        "value": "DeployIfNotExists"
                                    },
                                    {
                                        "label": "No",
                                        "value": "Disabled"
                                    }
                                ]
                            }
                        },
                        {
                            "name": "enableAscForArm",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Enable Microsoft Defender for Cloud for Azure Resource Manager",
                            "defaultValue": "Yes (recommended)",
                            "toolTip": "If 'Yes' is selected, Microsoft Defender for Cloud will be enabled for Resource Manager.<br>Uses the custom initiative <a href=\"https://www.azadvertizer.net/azpolicyinitiativesadvertizer/Deploy-MDFC-Config.html\">Deploy Microsoft Defender for Cloud configuration</a>.",
                            "visible": "[and(equals(steps('management').enableAsc,'Yes'), or(equals(steps('basics').cloudEnvironment.selection, 'AzureCloud'), equals(steps('basics').cloudEnvironment.selection, 'AzureUSGovernment')))]",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes (recommended)",
                                        "value": "DeployIfNotExists"
                                    },
                                    {
                                        "label": "No",
                                        "value": "Disabled"
                                    }
                                ]
                            }
                        },
                        {
                            "name": "enableAscForApis",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Enable Microsoft Defender for Cloud for APIs",
                            "defaultValue": "Yes (recommended)",
                            "toolTip": "If 'Yes' is selected, Microsoft Defender for Cloud will be enabled for APIs.<br>Uses the custom initiative <a href=\"https://www.azadvertizer.net/azpolicyinitiativesadvertizer/Deploy-MDFC-Config.html\">Deploy Microsoft Defender for Cloud configuration</a>.",
                            "visible": "[and(equals(steps('management').enableAsc,'Yes'), or(equals(steps('basics').cloudEnvironment.selection, 'AzureCloud'), equals(steps('basics').cloudEnvironment.selection, 'AzureUSGovernment')))]",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes (recommended)",
                                        "value": "DeployIfNotExists"
                                    },
                                    {
                                        "label": "No",
                                        "value": "Disabled"
                                    }
                                ]
                            }
                        },
                        {
                            "name": "enableAscForCspm",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Enable Microsoft Defender CSPM",
                            "defaultValue": "Yes (recommended)",
                            "toolTip": "If 'Yes' is selected, Microsoft Defender CSPM will be enabled.<br>Uses the custom initiative <a href=\"https://www.azadvertizer.net/azpolicyinitiativesadvertizer/Deploy-MDFC-Config.html\">Deploy Microsoft Defender for Cloud configuration</a>.",
                            "visible": "[and(equals(steps('management').enableAsc,'Yes'), or(equals(steps('basics').cloudEnvironment.selection, 'AzureCloud'), equals(steps('basics').cloudEnvironment.selection, 'AzureUSGovernment')))]",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes (recommended)",
                                        "value": "DeployIfNotExists"
                                    },
                                    {
                                        "label": "No",
                                        "value": "Disabled"
                                    }
                                ]
                            }
                        },
                        {
                            "name": "enableAscForDns",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Enable Microsoft Defender for Cloud for DNS",
                            "defaultValue": "Yes (recommended)",
                            "toolTip": "If 'Yes' is selected, Microsoft Defender for Cloud will be enabled for DNS.<br>Uses the custom initiative <a href=\"https://www.azadvertizer.net/azpolicyinitiativesadvertizer/Deploy-MDFC-Config.html\">Deploy Microsoft Defender for Cloud configuration</a>.",
                            "visible": "[and(equals(steps('management').enableAsc,'Yes'), or(equals(steps('basics').cloudEnvironment.selection, 'AzureCloud'), equals(steps('basics').cloudEnvironment.selection, 'AzureUSGovernment')))]",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes (recommended)",
                                        "value": "DeployIfNotExists"
                                    },
                                    {
                                        "label": "No",
                                        "value": "Disabled"
                                    }
                                ]
                            }
                        },
                        {
                            "name": "enableAscForContainers",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Enable Microsoft Defender for Cloud for Containers (Kubernetes and Container Registries)",
                            "defaultValue": "Yes (recommended)",
                            "toolTip": "If 'Yes' is selected, Microsoft Defender for Cloud will be enabled for Containers (Kubernetes and Container Registries).<br>Uses the custom initiative <a href=\"https://www.azadvertizer.net/azpolicyinitiativesadvertizer/Deploy-MDFC-Config.html\">Deploy Microsoft Defender for Cloud configuration</a>.",
                            "visible": "[equals(steps('management').enableAsc,'Yes')]",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes (recommended)",
                                        "value": "DeployIfNotExists"
                                    },
                                    {
                                        "label": "No",
                                        "value": "Disabled"
                                    }
                                ]
                            }
                        },
                        {
                            "name": "enableMDEndpoints",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Deploy Microsoft Defender for Endpoints",
                            "defaultValue": "Yes (recommended)",
                            "toolTip": "If 'Yes' is selected, Microsoft Defender for Endpoints will be deployed to supported virtual machines. You may want to disable this if you are using a third-party endpoint protection solution.<br>Uses the initiative <a href=\"https://www.azadvertizer.net/azpolicyinitiativesadvertizer/e20d08c5-6d64-656d-6465-ce9e37fd0ebc.html\">Deploy Microsoft Defender for Endpoint agent</a>.",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes (recommended)",
                                        "value": "DeployIfNotExists"
                                    },
                                    {
                                        "label": "No",
                                        "value": "Disabled"
                                    }
                                ]
                            },
                            "visible": "[equals(steps('management').enableAsc,'Yes')]"
                        }
                    ]
                },
                {
                    "name": "monitor",
                    "label": "Baseline alerts and monitoring",
                    "subLabel": {
                        "preValidation": "",
                        "postValidation": ""
                    },
                    "bladeTitle": "ALZ - Baseline Alerts",
                    "elements": [
                        {
                            "name": "baselinealertsintro",
                            "type": "Microsoft.Common.InfoBox",
                            "visible": true,
                            "options": {
                                "text": "Azure Landing Zones will create ARM automation to deploy baseline alerts automatically as resources are deployed. Note that selecting Yes to the Option 'Deploy one or more Azure Monitor Baseline Alerts', will automatically import all policies and initiatives and will assign the Deploy Azure Monitor Baseline Alerts for Service Health policy initiative at the intermediate root.",
                                "uri": "https://aka.ms/amba/alz/docs",
                                "style": "Info"
                            }
                        },
                        {
                            "name": "enableMonitorBaselines",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Deploy one or more Azure Monitor Baseline Alerts",
                            "defaultValue": "Yes (recommended)",
                            "toolTip": "If 'Yes' is selected Azure Monitor Baseline Alerts can be enabled for the selected resources. Note that choosing Yes will import all Monitor baseline alerts into your environment, and assign the Deploy Azure Monitor Service Health policy initiative to your designated intermediate root. For more information on what is included in the Service Health initiative please refer to https://aka.ms/amba/alz/wiki under Azure Policy Initiatives and Alert Details",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes (recommended)",
                                        "value": "Yes"
                                    },
                                    {
                                        "label": "No",
                                        "value": "No"
                                    }
                                ]
                            },
                            "visible": true
                        },
                        {
                            "name": "monitorAlertsResourceGroup",
                            "type": "Microsoft.Common.TextBox",
                            "label": "Resource group for baseline alerts",
                            "toolTip": "Resource group for activity log alerts and action groups. Will be created in all subscriptions in scope for the policy",
                            "visible": "[equals(steps('monitor').enableMonitorBaselines,'Yes')]",
                            "defaultValue": "rg-amba-monitoring-001",
                            "constraints": {
                                "required": "[equals(steps('monitor').enableMonitorBaselines,'Yes')]",
                                "regex": "^[a-zA-Z0-9][a-zA-Z0-9-_.()]{0,89}[a-zA-Z0-9]$",
                                "validationMessage": "Please provide a valid resource group name"
                            }
                        },
                        {
                            "name": "emailContactActionGroup",
                            "type": "Microsoft.Common.TextBox",
                            "label": "Email contact for action group notifications",
                            "toolTip": "Email address to get email notifications from alerts",
                            "visible": "[equals(steps('monitor').enableMonitorBaselines,'Yes')]",
                            "defaultValue": "",
                            "constraints": {
                                "required": "[equals(steps('monitor').enableMonitorBaselines,'Yes')]",
                                "regex": "^[\\w-\\.]+@([\\w-]+\\.)+[\\w-]{2,4}$",
                                "validationMessage": "Please provide a valid email address"
                            }
                        },
                        {
                            "name": "enableMonitorConnectivity",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Enable Azure Monitor Baseline Alerts for Connectivity. ",
                            "defaultValue": "Yes (recommended)",
                            "toolTip": "If 'Yes' is selected the Deploy Azure Monitor Baseline Alerts for Connectivity policy initiative is assigned to the Connectivity management group. This will ensure that relevant new resources created within that scope are configured with appropriate baseline alerts. For more details on what is included in the initiative please refer to https://aka.ms/amba/alz/wiki under Azure Policy Initiatives and Alert Details.",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes (recommended)",
                                        "value": "Yes"
                                    },
                                    {
                                        "label": "No",
                                        "value": "No"
                                    }
                                ]
                            },
                            "visible": "[equals(steps('monitor').enableMonitorBaselines,'Yes')]"
                        },
                        {
                            "name": "enableMonitorIdentity",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Enable Azure Monitor Baseline Alerts for Identity",
                            "defaultValue": "Yes (recommended)",
                            "toolTip": "If 'Yes' is selected the Deploy Azure Monitor Baseline Alerts for Identity policy initiative is assigned to the Identity management group. This will ensure that relevant new resources created within that scope are configured with appropriate baseline alerts. For more details on what is included in the initiative please refer to https://aka.ms/amba/alz/wiki under Azure Policy Initiatives and Alert Details.",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes (recommended)",
                                        "value": "Yes"
                                    },
                                    {
                                        "label": "No",
                                        "value": "No"
                                    }
                                ]
                            },
                            "visible": "[equals(steps('monitor').enableMonitorBaselines,'Yes')]"
                        },
                        {
                            "name": "enableMonitorManagement",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Enable Azure Monitor Baseline Alerts for Management",
                            "defaultValue": "Yes (recommended)",
                            "toolTip": "If 'Yes' is selected the Deploy Azure Monitor Baseline Alerts for Management policy initiative is assigned to the Management management group. This will ensure that relevant new resources created within that scope are configured with appropriate baseline alerts. For more details on what is included in the initiative please refer to https://aka.ms/amba/alz/wiki under Azure Policy Initiatives and Alert Details.",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes (recommended)",
                                        "value": "Yes"
                                    },
                                    {
                                        "label": "No",
                                        "value": "No"
                                    }
                                ]
                            },
                            "visible": "[equals(steps('monitor').enableMonitorBaselines,'Yes')]"
                        },
                        {
                            "name": "enableMonitorLandingZones",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Enable Azure Monitor Baseline Alerts for Landing Zones",
                            "defaultValue": "Yes (recommended)",
                            "toolTip": "If 'Yes' is selected the Deploy Azure Monitor Baseline Alerts for Landing Zone policy initiative is assigned to the Landing Zones management group. This will ensure that relevant new resources created within that scope are configured with appropriate baseline alerts. For more details on what is included in the initiative please refer to https://aka.ms/amba/alz/wiki under Azure Policy Initiatives and Alert Details.",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes (recommended)",
                                        "value": "Yes"
                                    },
                                    {
                                        "label": "No",
                                        "value": "No"
                                    }
                                ]
                            },
                            "visible": "[equals(steps('monitor').enableMonitorBaselines,'Yes')]"
                        }
                    ]
                },
                {
                    "name": "connectivity",
                    "label": "Network topology and connectivity",
                    "subLabel": {
                        "preValidation": "",
                        "postValidation": ""
                    },
                    "bladeTitle": "ALZ - Connectivity Settings",
                    "elements": [
                        {
                            "name": "multiPlatformConnectivitySub",
                            "type": "Microsoft.Common.InfoBox",
                            "visible": "[not(equals(steps('core').platformSubscription, 'Single'))]",
                            "options": {
                                "text": "To enable network topology and connectivity, you must allocate a dedicated connectivity Subscription. Please note, this Subscription will be moved to the connectivity Management Group, and ARM will deploy the first hub virtual network for either a hub and spoke or Virtual WAN  network topology. Additional networking platform resources such as gateways or Azure Firewall can be deployed. We recommend using a new dedicated Subscription with no existing resources.",
                                "uri": "https://docs.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/define-an-azure-network-topology",
                                "style": "Info"
                            }
                        },
                        {
                            "name": "singlePlatformConnectivitySub",
                            "type": "Microsoft.Common.InfoBox",
                            "visible": "[equals(steps('core').platformSubscription, 'Single')]",
                            "options": {
                                "text": "To enable network topology and connectivity, you can select the preferred networking topology, and deploy this into the dedicated platform subscription. Additional networking platform resources such as gateways or Azure Firewall can also be deployed.",
                                "uri": "https://docs.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/define-an-azure-network-topology",
                                "style": "Info"
                            }
                        },
                        {
                            "name": "enableHub",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Deploy networking topology",
                            "defaultValue": "No",
                            "toolTip": "Select the preferred network topology. If third-party NVA is a requirement, you must deploy this into the connectivity subscription post the deployment.",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Hub and spoke with Azure Firewall",
                                        "value": "vhub"
                                    },
                                    {
                                        "label": "Hub and spoke with your own third-party NVA",
                                        "value": "nva"
                                    },
                                    {
                                        "label": "Virtual WAN (Microsoft managed)",
                                        "value": "vwan"
                                    },
                                    {
                                        "label": "No",
                                        "value": "No"
                                    }
                                ]
                            },
                            "visible": true
                        },
                        {
                            "name": "esNwSubSection",
                            "type": "Microsoft.Common.Section",
                            "label": "Connectivity subscription",
                            "elements": [
                                {
                                    "name": "esNwSubUniqueWarning",
                                    "type": "Microsoft.Common.InfoBox",
                                    "visible": true,
                                    "options": {
                                        "text": "Ensure you select a subscription that is dedicated/unique for Connectivity. Selecting the same Subscription here for Management or Identity will result in a deployment failure. If you want to use a single Subscription for all platform resources, select 'Single' on the 'Azure Core Setup' blade.",
                                        "uri": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-subscriptions#organization-and-governance-design-considerations",
                                        "style": "Warning"
                                    }
                                },
                                {
                                    "name": "esNwSub",
                                    "type": "Microsoft.Common.DropDown",
                                    "label": "Connectivity subscription",
                                    "defaultValue": "[parse('[]')]",
                                    "toolTip": "",
                                    "multiselect": false,
                                    "selectAll": false,
                                    "filter": true,
                                    "filterPlaceholder": "Filter subscriptions...",
                                    "multiLine": true,
                                    "visible": true,
                                    "constraints": {
                                        "allowedValues": "[steps('basics').getSubscriptions.data]",
                                        "required": true
                                    }
                                }
                            ],
                            "visible": "[and(not(equals(steps('connectivity').enableHub, 'No')), not(equals(steps('core').platformSubscription, 'Single')))]"
                        },
                        {
                            "name": "esAddressHubVWAN",
                            "type": "Microsoft.Common.TextBox",
                            "label": "Address space (required for vWAN hub)",
                            "toolTip": "Provide address prefix in CIDR notation (e.g 10.100.0.0/23)",
                            "defaultValue": "10.100.0.0/23",
                            "visible": "[and(not(equals(steps('connectivity').enableHub, 'No')), not(equals(steps('connectivity').enableHub, 'nva')), not(equals(steps('connectivity').enableHub, 'vhub')))]",
                            "constraints": {
                                "required": true,
                                "validations": [
                                    {
                                        "regex": "^(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:\/(1[0-9]|2[0-4]))$",
                                        "message": "Invalid CIDR range. The address prefix must be in the range [10,24]."
                                    }
                                ]
                            }
                        },
                        {
                            "name": "esAddressHubHS",
                            "type": "Microsoft.Common.TextBox",
                            "label": "Address space (required for hub virtual network)",
                            "toolTip": "Provide address prefix in CIDR notation (e.g 10.100.0.0/16)",
                            "defaultValue": "10.100.0.0/16",
                            "visible": "[and(not(equals(steps('connectivity').enableHub, 'No')), not(equals(steps('connectivity').enableHub, 'vwan')))]",
                            "constraints": {
                                "required": true,
                                "validations": [
                                    {
                                        "regex": "^(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:\/(1[0-9]|2[0-4]))$",
                                        "message": "Invalid CIDR range. The address prefix must be in the range [10,24]."
                                    }
                                ]
                            }
                        },
                        {
                            "name": "connectivityLocation",
                            "type": "Microsoft.Common.DropDown",
                            "label": "Region for the first networking hub",
                            "filter": true,
                            "toolTip": "Select the target region for you connectivity deployment (requires you to provide a subscriptionId for connectivity)",
                            "defaultValue": "[steps('basics').resourceScope.location.displayName]",
                            "constraints": {
                                "allowedValues": "[map(steps('basics').getLocations.value,(item) => parse(concat('{\"label\":\"',item.displayName,'\",\"value\":\"',item.name,'\"}')))]",
                                "required": true
                            },
                            "visible": "[not(equals(steps('connectivity').enableHub, 'No'))]"
                        },
                        {
                            "name": "esNwZtnNote",
                            "type": "Microsoft.Common.InfoBox",
                            "visible": "[and(not(equals(steps('connectivity').enableHub, 'No')), not(equals(steps('connectivity').enableHub, 'nva')))]",
                            "options": {
                                "text": "ALZ defaults are aligned to Zero Trust Networking principles. Click on this box to learn more about the Zero Trust Networking principles and how to apply them.",
                                "uri": "https://learn.microsoft.com/security/zero-trust/deploy/networks",
                                "style": "Info"
                            }
                        },
                        {
                            "name": "enableDdoS",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Enable DDoS Network Protection",
                            "defaultValue": "Yes (recommended)",
                            "visible": "[not(equals(steps('connectivity').enableHub, 'No'))]",
                            "toolTip": "If 'Yes' is selected when also adding a connectivity subscription, DDoS Network Protection will be enabled.",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes (recommended)",
                                        "value": "Yes"
                                    },
                                    {
                                        "label": "No",
                                        "value": "No"
                                    }
                                ]
                            }
                        },
                        {
                            "name": "enablePrivateDnsZones",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Create Private DNS Zones for Azure PaaS services",
                            "defaultValue": "Yes (recommended)",
                            "visible": "[or(equals(steps('connectivity').enableHub, 'vhub'), equals(steps('connectivity').enableHub, 'nva'))]",
                            "toolTip": "If 'Yes' is selected when also adding a subscription for connectivity, ARM will create Private DNS Zones for Azure PaaS services based on your selection below",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes (recommended)",
                                        "value": "Yes"
                                    },
                                    {
                                        "label": "No",
                                        "value": "No"
                                    }
                                ]
                            }
                        },
                        {
                            "name": "privateDnsZones",
                            "type": "Microsoft.Common.DropDown",
                            "label": "Select Private DNS Zones to create",
                            "multiselect": true,
                            "selectAll": true,
                            "filter": true,
                            "multiLine": true,
                            "defaultValue": [
                                {
                                    "value": "privatelink.regionGeoShortCode.backup.windowsazure.com"
                                },
                                {
                                    "value": "[format('privatelink.{0}.azmk8s.io', toLower(steps('connectivity').connectivityLocation))]"
                                },
                                {
                                    "value": "[format('privatelink.{0}.batch.azure.com', toLower(steps('connectivity').connectivityLocation))]"
                                },
                                {
                                    "value": "[format('privatelink.{0}.kusto.windows.net', toLower(steps('connectivity').connectivityLocation))]"
                                },
                                {
                                    "value": "privatelink.adf.azure.com"
                                },
                                {
                                    "value": "privatelink.afs.azure.net"
                                },
                                {
                                    "value": "privatelink.agentsvc.azure-automation.net"
                                },
                                {
                                    "value": "privatelink.analysis.windows.net"
                                },
                                {
                                    "value": "privatelink.api.azureml.ms"
                                },
                                {
                                    "value": "privatelink.azconfig.io"
                                },
                                {
                                    "value": "privatelink.azure-api.net"
                                },
                                {
                                    "value": "privatelink.azure-automation.net"
                                },
                                {
                                    "value": "privatelink.azurecr.io"
                                },
                                {
                                    "value": "privatelink.azure-devices.net"
                                },
                                {
                                    "value": "privatelink.azure-devices-provisioning.net"
                                },
                                {
                                    "value": "privatelink.azuredatabricks.net"
                                },
                                {
                                    "value": "privatelink.azurehdinsight.net"
                                },
                                {
                                    "value": "privatelink.azurehealthcareapis.com"
                                },
                                {
                                    "value": "privatelink.azurestaticapps.net"
                                },
                                {
                                    "value": "privatelink.azuresynapse.net"
                                },
                                {
                                    "value": "privatelink.azurewebsites.net"
                                },
                                {
                                    "value": "privatelink.batch.azure.com"
                                },
                                {
                                    "value": "privatelink.blob.core.windows.net"
                                },
                                {
                                    "value": "privatelink.cassandra.cosmos.azure.com"
                                },
                                {
                                    "value": "privatelink.cognitiveservices.azure.com"
                                },
                                {
                                    "value": "privatelink.database.windows.net"
                                },
                                {
                                    "value": "privatelink.datafactory.azure.net"
                                },
                                {
                                    "value": "privatelink.dev.azuresynapse.net"
                                },
                                {
                                    "value": "privatelink.dfs.core.windows.net"
                                },
                                {
                                    "value": "privatelink.dicom.azurehealthcareapis.com"
                                },
                                {
                                    "value": "privatelink.digitaltwins.azure.net"
                                },
                                {
                                    "value": "privatelink.directline.botframework.com"
                                },
                                {
                                    "value": "privatelink.documents.azure.com"
                                },
                                {
                                    "value": "privatelink.eventgrid.azure.net"
                                },
                                {
                                    "value": "privatelink.file.core.windows.net"
                                },
                                {
                                    "value": "privatelink.gremlin.cosmos.azure.com"
                                },
                                {
                                    "value": "privatelink.guestconfiguration.azure.com"
                                },
                                {
                                    "value": "privatelink.his.arc.azure.com"
                                },
                                {
                                    "value": "privatelink.kubernetesconfiguration.azure.com"
                                },
                                {
                                    "value": "privatelink.managedhsm.azure.net"
                                },
                                {
                                    "value": "privatelink.mariadb.database.azure.com"
                                },
                                {
                                    "value": "privatelink.media.azure.net"
                                },
                                {
                                    "value": "privatelink.mongo.cosmos.azure.com"
                                },
                                {
                                    "value": "privatelink.monitor.azure.com"
                                },
                                {
                                    "value": "privatelink.mysql.database.azure.com"
                                },
                                {
                                    "value": "privatelink.notebooks.azure.net"
                                },
                                {
                                    "value": "privatelink.ods.opinsights.azure.com"
                                },
                                {
                                    "value": "privatelink.oms.opinsights.azure.com"
                                },
                                {
                                    "value": "privatelink.pbidedicated.windows.net"
                                },
                                {
                                    "value": "privatelink.postgres.database.azure.com"
                                },
                                {
                                    "value": "privatelink.prod.migration.windowsazure.com"
                                },
                                {
                                    "value": "privatelink.purview.azure.com"
                                },
                                {
                                    "value": "privatelink.purviewstudio.azure.com"
                                },
                                {
                                    "value": "privatelink.queue.core.windows.net"
                                },
                                {
                                    "value": "privatelink.redis.cache.windows.net"
                                },
                                {
                                    "value": "privatelink.redisenterprise.cache.azure.net"
                                },
                                {
                                    "value": "privatelink.search.windows.net"
                                },
                                {
                                    "value": "privatelink.service.signalr.net"
                                },
                                {
                                    "value": "privatelink.servicebus.windows.net"
                                },
                                {
                                    "value": "privatelink.siterecovery.windowsazure.com"
                                },
                                {
                                    "value": "privatelink.sql.azuresynapse.net"
                                },
                                {
                                    "value": "privatelink.table.core.windows.net"
                                },
                                {
                                    "value": "privatelink.table.cosmos.azure.com"
                                },
                                {
                                    "value": "privatelink.tip1.powerquery.microsoft.com"
                                },
                                {
                                    "value": "privatelink.token.botframework.com"
                                },
                                {
                                    "value": "privatelink.vaultcore.azure.net"
                                },
                                {
                                    "value": "privatelink.web.core.windows.net"
                                },
                                {
                                    "value": "privatelink.webpubsub.azure.com"
                                }
                            ],
                            "visible": "[and(or(equals(steps('connectivity').enableHub, 'vhub'), equals(steps('connectivity').enableHub, 'nva')), not(equals(steps('connectivity').enablePrivateDnsZones,'No')))]",
                            "toolTip": "Select each Private DNS Zone to create which will offer DNS integration with Azure PaaS services where you enable private endpoints.",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "privatelink.regionGeoShortCode.backup.windowsazure.com",
                                        "value": "privatelink.regionGeoShortCode.backup.windowsazure.com",
                                        "description": "This Private DNS Zone contains an Azure Region's geo short code (e.g. 'uksouth' is 'uks' - list available <a href=\"https://learn.microsoft.com/azure/backup/backup-azure-private-endpoints-configure-manage#when-using-custom-dns-server-or-host-files\">here</a>) that is based on the region selected above for your hub."
                                    },
                                    {
                                        "label": "privatelink.region.azmk8s.io",
                                        "value": "[format('privatelink.{0}.azmk8s.io', toLower(steps('connectivity').connectivityLocation))]",
                                        "description": "This Private DNS Zone contains the Azure Region's short name (e.g. 'uksouth') that is based on the region selected above for your hub."
                                    },
                                    {
                                        "label": "privatelink.region.batch.azure.com",
                                        "value": "[format('privatelink.{0}.batch.azure.com', toLower(steps('connectivity').connectivityLocation))]",
                                        "description": "This Private DNS Zone contains the Azure Region's short name (e.g. 'uksouth') that is based on the region selected above for your hub."
                                    },
                                    {
                                        "label": "privatelink.region.kusto.windows.net",
                                        "value": "[format('privatelink.{0}.kusto.windows.net', toLower(steps('connectivity').connectivityLocation))]",
                                        "description": "This Private DNS Zone contains the Azure Region's short name (e.g. 'uksouth') that is based on the region selected above for your hub."
                                    },
                                    {
                                        "label": "privatelink.adf.azure.com",
                                        "value": "privatelink.adf.azure.com"
                                    },
                                    {
                                        "label": "privatelink.afs.azure.net",
                                        "value": "privatelink.afs.azure.net"
                                    },
                                    {
                                        "label": "privatelink.agentsvc.azure-automation.net",
                                        "value": "privatelink.agentsvc.azure-automation.net"
                                    },
                                    {
                                        "label": "privatelink.analysis.windows.net",
                                        "value": "privatelink.analysis.windows.net"
                                    },
                                    {
                                        "label": "privatelink.api.azureml.ms",
                                        "value": "privatelink.api.azureml.ms"
                                    },
                                    {
                                        "label": "privatelink.azconfig.io",
                                        "value": "privatelink.azconfig.io"
                                    },
                                    {
                                        "label": "privatelink.azure-api.net",
                                        "value": "privatelink.azure-api.net"
                                    },
                                    {
                                        "label": "privatelink.azure-automation.net",
                                        "value": "privatelink.azure-automation.net"
                                    },
                                    {
                                        "label": "privatelink.azurecr.io",
                                        "value": "privatelink.azurecr.io"
                                    },
                                    {
                                        "label": "privatelink.azure-devices.net",
                                        "value": "privatelink.azure-devices.net"
                                    },
                                    {
                                        "label": "privatelink.azure-devices-provisioning.net",
                                        "value": "privatelink.azure-devices-provisioning.net"
                                    },
                                    {
                                        "label": "privatelink.azuredatabricks.net",
                                        "value": "privatelink.azuredatabricks.net"
                                    },
                                    {
                                        "label": "privatelink.azurehdinsight.net",
                                        "value": "privatelink.azurehdinsight.net"
                                    },
                                    {
                                        "label": "privatelink.azurehealthcareapis.com",
                                        "value": "privatelink.azurehealthcareapis.com"
                                    },
                                    {
                                        "label": "privatelink.azurestaticapps.net",
                                        "value": "privatelink.azurestaticapps.net"
                                    },
                                    {
                                        "label": "privatelink.azuresynapse.net",
                                        "value": "privatelink.azuresynapse.net"
                                    },
                                    {
                                        "label": "privatelink.azurewebsites.net",
                                        "value": "privatelink.azurewebsites.net"
                                    },
                                    {
                                        "label": "privatelink.batch.azure.com",
                                        "value": "privatelink.batch.azure.com"
                                    },
                                    {
                                        "label": "privatelink.blob.core.windows.net",
                                        "value": "privatelink.blob.core.windows.net"
                                    },
                                    {
                                        "label": "privatelink.cassandra.cosmos.azure.com",
                                        "value": "privatelink.cassandra.cosmos.azure.com"
                                    },
                                    {
                                        "label": "privatelink.cognitiveservices.azure.com",
                                        "value": "privatelink.cognitiveservices.azure.com"
                                    },
                                    {
                                        "label": "privatelink.database.windows.net",
                                        "value": "privatelink.database.windows.net"
                                    },
                                    {
                                        "label": "privatelink.datafactory.azure.net",
                                        "value": "privatelink.datafactory.azure.net"
                                    },
                                    {
                                        "label": "privatelink.dev.azuresynapse.net",
                                        "value": "privatelink.dev.azuresynapse.net"
                                    },
                                    {
                                        "label": "privatelink.dfs.core.windows.net",
                                        "value": "privatelink.dfs.core.windows.net"
                                    },
                                    {
                                        "label": "privatelink.dicom.azurehealthcareapis.com",
                                        "value": "privatelink.dicom.azurehealthcareapis.com"
                                    },
                                    {
                                        "label": "privatelink.digitaltwins.azure.net",
                                        "value": "privatelink.digitaltwins.azure.net"
                                    },
                                    {
                                        "label": "privatelink.directline.botframework.com",
                                        "value": "privatelink.directline.botframework.com"
                                    },
                                    {
                                        "label": "privatelink.documents.azure.com",
                                        "value": "privatelink.documents.azure.com"
                                    },
                                    {
                                        "label": "privatelink.eventgrid.azure.net",
                                        "value": "privatelink.eventgrid.azure.net"
                                    },
                                    {
                                        "label": "privatelink.file.core.windows.net",
                                        "value": "privatelink.file.core.windows.net"
                                    },
                                    {
                                        "label": "privatelink.gremlin.cosmos.azure.com",
                                        "value": "privatelink.gremlin.cosmos.azure.com"
                                    },
                                    {
                                        "label": "privatelink.guestconfiguration.azure.com",
                                        "value": "privatelink.guestconfiguration.azure.com"
                                    },
                                    {
                                        "label": "privatelink.his.arc.azure.com",
                                        "value": "privatelink.his.arc.azure.com"
                                    },
                                    {
                                        "label": "privatelink.kubernetesconfiguration.azure.com",
                                        "value": "privatelink.kubernetesconfiguration.azure.com"
                                    },
                                    {
                                        "label": "privatelink.managedhsm.azure.net",
                                        "value": "privatelink.managedhsm.azure.net"
                                    },
                                    {
                                        "label": "privatelink.mariadb.database.azure.com",
                                        "value": "privatelink.mariadb.database.azure.com"
                                    },
                                    {
                                        "label": "privatelink.media.azure.net",
                                        "value": "privatelink.media.azure.net"
                                    },
                                    {
                                        "label": "privatelink.mongo.cosmos.azure.com",
                                        "value": "privatelink.mongo.cosmos.azure.com"
                                    },
                                    {
                                        "label": "privatelink.monitor.azure.com",
                                        "value": "privatelink.monitor.azure.com"
                                    },
                                    {
                                        "label": "privatelink.mysql.database.azure.com",
                                        "value": "privatelink.mysql.database.azure.com"
                                    },
                                    {
                                        "label": "privatelink.notebooks.azure.net",
                                        "value": "privatelink.notebooks.azure.net"
                                    },
                                    {
                                        "label": "privatelink.ods.opinsights.azure.com",
                                        "value": "privatelink.ods.opinsights.azure.com"
                                    },
                                    {
                                        "label": "privatelink.oms.opinsights.azure.com",
                                        "value": "privatelink.oms.opinsights.azure.com"
                                    },
                                    {
                                        "label": "privatelink.pbidedicated.windows.net",
                                        "value": "privatelink.pbidedicated.windows.net"
                                    },
                                    {
                                        "label": "privatelink.postgres.database.azure.com",
                                        "value": "privatelink.postgres.database.azure.com"
                                    },
                                    {
                                        "label": "privatelink.prod.migration.windowsazure.com",
                                        "value": "privatelink.prod.migration.windowsazure.com"
                                    },
                                    {
                                        "label": "privatelink.purview.azure.com",
                                        "value": "privatelink.purview.azure.com"
                                    },
                                    {
                                        "label": "privatelink.purviewstudio.azure.com",
                                        "value": "privatelink.purviewstudio.azure.com"
                                    },
                                    {
                                        "label": "privatelink.queue.core.windows.net",
                                        "value": "privatelink.queue.core.windows.net"
                                    },
                                    {
                                        "label": "privatelink.redis.cache.windows.net",
                                        "value": "privatelink.redis.cache.windows.net"
                                    },
                                    {
                                        "label": "privatelink.redisenterprise.cache.azure.net",
                                        "value": "privatelink.redisenterprise.cache.azure.net"
                                    },
                                    {
                                        "label": "privatelink.search.windows.net",
                                        "value": "privatelink.search.windows.net"
                                    },
                                    {
                                        "label": "privatelink.service.signalr.net",
                                        "value": "privatelink.service.signalr.net"
                                    },
                                    {
                                        "label": "privatelink.servicebus.windows.net",
                                        "value": "privatelink.servicebus.windows.net"
                                    },
                                    {
                                        "label": "privatelink.siterecovery.windowsazure.com",
                                        "value": "privatelink.siterecovery.windowsazure.com"
                                    },
                                    {
                                        "label": "privatelink.sql.azuresynapse.net",
                                        "value": "privatelink.sql.azuresynapse.net"
                                    },
                                    {
                                        "label": "privatelink.table.core.windows.net",
                                        "value": "privatelink.table.core.windows.net"
                                    },
                                    {
                                        "label": "privatelink.table.cosmos.azure.com",
                                        "value": "privatelink.table.cosmos.azure.com"
                                    },
                                    {
                                        "label": "privatelink.tip1.powerquery.microsoft.com",
                                        "value": "privatelink.tip1.powerquery.microsoft.com"
                                    },
                                    {
                                        "label": "privatelink.token.botframework.com",
                                        "value": "privatelink.token.botframework.com"
                                    },
                                    {
                                        "label": "privatelink.vaultcore.azure.net",
                                        "value": "privatelink.vaultcore.azure.net"
                                    },
                                    {
                                        "label": "privatelink.web.core.windows.net",
                                        "value": "privatelink.web.core.windows.net"
                                    },
                                    {
                                        "label": "privatelink.webpubsub.azure.com",
                                        "value": "privatelink.webpubsub.azure.com"
                                    }
                                ]
                            }
                        },
                        {
                            "name": "enableVpnGw",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Deploy VPN Gateway",
                            "defaultValue": "No",
                            "visible": "[not(equals(steps('connectivity').enableHub, 'No'))]",
                            "toolTip": "If 'Yes' is selected when also adding a subscription for connectivity, ARM will deploy VPN gateway",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes",
                                        "value": "Yes"
                                    },
                                    {
                                        "label": "No",
                                        "value": "No"
                                    }
                                ]
                            }
                        },
                        {
                            "name": "gwRegionalOrAz",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Deploy zone redundant or regional VPN Gateway",
                            "defaultValue": "Zone redundant (recommended)",
                            "visible": "[and(and(equals(steps('connectivity').enableVpnGw,'Yes'), not(equals(steps('connectivity').enableHub, 'vwan'))), equals(steps('connectivity').enableVpnGw,'Yes'),contains(split('brazilsouth,canadacentral,centralus,eastus,eastus2,southcentralus,westus2,westus3,francecentral,germanywestcentral,northeurope,norwayeast,uksouth,westeurope,swedencentral,switzerlandnorth,qatarcentral,uaenorth,southafricanorth,australiaeast,centralindia,japaneast,koreacentral,southeastasia,eastasia,italynorth', ','), steps('connectivity').connectivityLocation))]",
                            "toolTip": "If 'Yes' is selected when also adding a subscription for connectivity, ARM will deploy Virtual Gateway to the selected region and availability zones.",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Zone redundant (recommended)",
                                        "value": "Zone"
                                    },
                                    {
                                        "label": "Regional",
                                        "value": "Regional"
                                    }
                                ]
                            }
                        },
                        {
                            "name": "enableVpnActiveActive",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Deploy VPN Gateway in Active/Active mode",
                            "defaultValue": "No",
                            "visible": "[and(equals(steps('connectivity').enableVpnGw,'Yes'), not(equals(steps('connectivity').enableHub, 'vwan')), equals(steps('connectivity').enableVpnGw,'Yes'))]",
                            "toolTip": "Deploy the VPN gateway in Active/Active mode",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes",
                                        "value": "Yes"
                                    },
                                    {
                                        "label": "No",
                                        "value": "No"
                                    }
                                ]
                            }
                        },
                        {
                            "name": "esGwNoAzSku",
                            "type": "Microsoft.Common.DropDown",
                            "label": "Select the VPN Gateway SKU",
                            "defaultValue": "",
                            "multiselect": false,
                            "selectAll": false,
                            "filter": false,
                            "multiLine": true,
                            "visible": "[and(and(equals(steps('connectivity').enableVpnGw, 'Yes'), not(equals(steps('connectivity').enableHub, 'vwan'))), equals(steps('connectivity').enableVpnGw,'Yes'), not(contains(split('brazilsouth,canadacentral,centralus,eastus,eastus2,southcentralus,westus2,westus3,francecentral,germanywestcentral,northeurope,norwayeast,uksouth,westeurope,swedencentral,switzerlandnorth,qatarcentral,uaenorth,southafricanorth,australiaeast,centralindia,japaneast,koreacentral,southeastasia,eastasia,italynorth', ','), steps('connectivity').connectivityLocation)))]",
                            "toolTip": "Select the required SKU for the VPN gateway.",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "VpnGw2",
                                        "description": "Supports BGP, max 30 S2S/VNet-VNet tunnels, max 128 P2S SSTP connections, max 500 IKEv2/OpenVPN connections, aggregate throughput is 1.25 Gbps",
                                        "value": "VpnGw2"
                                    },
                                    {
                                        "label": "VpnGw3",
                                        "description": "Supports BGP, max 30 S2S/VNet-VNet tunnels, max 128 P2S SSTP connections, max 1000 IKEv2/OpenVPN connections, aggregate throughput is 2.5 Gbps",
                                        "value": "VpnGw3"
                                    },
                                    {
                                        "label": "VpnGw4",
                                        "description": "Supports BGP, max 30 S2S/VNet-VNet tunnels, max 128 P2S SSTP connections, max 5000 IKEv2/OpenVPN connections, aggregate throughput is 5 Gbps",
                                        "value": "VpnGw4"
                                    },
                                    {
                                        "label": "VpnGw5",
                                        "description": "Supports BGP, max 30 S2S/VNet-VNet tunnels, max 128 P2S SSTP connections, max 10000 IKEv2/OpenVPN connections, aggregate throughput is 10 Gbps",
                                        "value": "VpnGw5"
                                    }
                                ]
                            }
                        },
                        {
                            "name": "gwAzSku",
                            "type": "Microsoft.Common.DropDown",
                            "label": "Select the VPN Gateway SKU",
                            "defaultValue": "",
                            "multiselect": false,
                            "selectAll": false,
                            "filter": false,
                            "multiLine": true,
                            "visible": "[and(and(equals(steps('connectivity').enableVpnGw, 'Yes'), not(equals(steps('connectivity').enableHub, 'vwan'))), equals(steps('connectivity').enableVpnGw,'Yes'), equals(steps('connectivity').gwRegionalOrAz, 'Zone') ,contains(split('brazilsouth,canadacentral,centralus,eastus,eastus2,southcentralus,westus2,westus3,francecentral,germanywestcentral,northeurope,norwayeast,uksouth,westeurope,swedencentral,switzerlandnorth,qatarcentral,uaenorth,southafricanorth,australiaeast,centralindia,japaneast,koreacentral,southeastasia,eastasia,italynorth', ','), steps('connectivity').connectivityLocation))]",
                            "toolTip": "Select the required SKU for the VPN gateway.",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "VpnGw2AZ",
                                        "description": "Supports BGP, max 30 S2S/VNet-VNet tunnels, max 128 P2S SSTP connections, max 500 IKEv2/OpenVPN connections, aggregate throughput is 1.25 Gbps",
                                        "value": "VpnGw2AZ"
                                    },
                                    {
                                        "label": "VpnGw3AZ",
                                        "description": "Supports BGP, max 30 S2S/VNet-VNet tunnels, max 128 P2S SSTP connections, max 1000 IKEv2/OpenVPN connections, aggregate throughput is 2.5 Gbps",
                                        "value": "VpnGw3AZ"
                                    },
                                    {
                                        "label": "VpnGw4AZ",
                                        "description": "Supports BGP, max 30 S2S/VNet-VNet tunnels, max 128 P2S SSTP connections, max 5000 IKEv2/OpenVPN connections, aggregate throughput is 5 Gbps",
                                        "value": "VpnGw4AZ"
                                    },
                                    {
                                        "label": "VpnGw5AZ",
                                        "description": "Supports BGP, max 30 S2S/VNet-VNet tunnels, max 128 P2S SSTP connections, max 10000 IKEv2/OpenVPN connections, aggregate throughput is 10 Gbps",
                                        "value": "VpnGw5AZ"
                                    }
                                ]
                            }
                        },
                        {
                            "name": "gwRegionalSku",
                            "type": "Microsoft.Common.DropDown",
                            "label": "Select the VPN Gateway SKU",
                            "defaultValue": "",
                            "multiselect": false,
                            "selectAll": false,
                            "filter": false,
                            "multiLine": true,
                            "visible": "[and(and(equals(steps('connectivity').enableVpnGw, 'Yes'), not(equals(steps('connectivity').enableHub, 'vwan'))), equals(steps('connectivity').enableVpnGw,'Yes'), equals(steps('connectivity').gwRegionalOrAz, 'Regional'))]",
                            "toolTip": "Select the required SKU for the VPN gateway.",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "VpnGw2",
                                        "description": "Supports BGP, max 30 S2S/VNet-VNet tunnels, max 128 P2S SSTP connections, max 500 IKEv2/OpenVPN connections, aggregate throughput is 1.25 Gbps",
                                        "value": "VpnGw2"
                                    },
                                    {
                                        "label": "VpnGw3",
                                        "description": "Supports BGP, max 30 S2S/VNet-VNet tunnels, max 128 P2S SSTP connections, max 1000 IKEv2/OpenVPN connections, aggregate throughput is 2.5 Gbps",
                                        "value": "VpnGw3"
                                    },
                                    {
                                        "label": "VpnGw4",
                                        "description": "Supports BGP, max 30 S2S/VNet-VNet tunnels, max 128 P2S SSTP connections, max 5000 IKEv2/OpenVPN connections, aggregate throughput is 5 Gbps",
                                        "value": "VpnGw4"
                                    },
                                    {
                                        "label": "VpnGw5",
                                        "description": "Supports BGP, max 30 S2S/VNet-VNet tunnels, max 128 P2S SSTP connections, max 10000 IKEv2/OpenVPN connections, aggregate throughput is 10 Gbps",
                                        "value": "VpnGw5"
                                    }
                                ]
                            }
                        },
                        {
                            "name": "vpnGateWayScaleUnit",
                            "type": "Microsoft.Common.DropDown",
                            "label": "Select the VPN Gateway scale unit",
                            "defaultValue": "",
                            "multiselect": false,
                            "selectAll": false,
                            "filter": false,
                            "multiLine": true,
                            "visible": "[and(equals(steps('connectivity').enableVpnGw, 'Yes'), equals(steps('connectivity').enableHub, 'vwan'))]",
                            "toolTip": "Select the VPN Gateway scale unit",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "1 scale unit",
                                        "description": "Supports 500 Mbps x2",
                                        "value": "1"
                                    },
                                    {
                                        "label": "2 scale units",
                                        "description": "Supports 1 Gbps x 2",
                                        "value": "2"
                                    },
                                    {
                                        "label": "3 scale units",
                                        "description": "Supports 1.5 Gbps x 2",
                                        "value": "3"
                                    },
                                    {
                                        "label": "4 scale units",
                                        "description": "Supports 2 Gbps x 2",
                                        "value": "4"
                                    },
                                    {
                                        "label": "5 scale units",
                                        "description": "Supports 2.5 Gbps x 2",
                                        "value": "5"
                                    },
                                    {
                                        "label": "6 scale units",
                                        "description": "Supports 3 Gbps x 2",
                                        "value": "6"
                                    },
                                    {
                                        "label": "7 scale units",
                                        "description": "Supports 3.5 Gbps x 2",
                                        "value": "7"
                                    },
                                    {
                                        "label": "8 scale units",
                                        "description": "Supports 4 Gbps x 2",
                                        "value": "8"
                                    },
                                    {
                                        "label": "9 scale units",
                                        "description": "Supports 4.5 Gbps x 2",
                                        "value": "9"
                                    },
                                    {
                                        "label": "10 scale units",
                                        "description": "Supports 5 Gbps x 2",
                                        "value": "10"
                                    },
                                    {
                                        "label": "11 scale units",
                                        "description": "Supports 5.5 Gbps x 2",
                                        "value": "11"
                                    },
                                    {
                                        "label": "12 scale units",
                                        "description": "Supports 6 Gbps x 2",
                                        "value": "12"
                                    },
                                    {
                                        "label": "13 scale units",
                                        "description": "Supports 6.5 Gbps x 2",
                                        "value": "13"
                                    },
                                    {
                                        "label": "14 scale units",
                                        "description": "Supports 7 Gbps x 2",
                                        "value": "14"
                                    },
                                    {
                                        "label": "15 scale units",
                                        "description": "Supports 7.5 Gbps x 2",
                                        "value": "15"
                                    },
                                    {
                                        "label": "16 scale units",
                                        "description": "Supports 8 Gbps x 2",
                                        "value": "16"
                                    },
                                    {
                                        "label": "17 scale units",
                                        "description": "Supports 8.5 Gbps x 2",
                                        "value": "17"
                                    },
                                    {
                                        "label": "18 scale units",
                                        "description": "Supports 9 Gbps x 2",
                                        "value": "18"
                                    },
                                    {
                                        "label": "19 scale units",
                                        "description": "Supports 9.5 Gbps x 2",
                                        "value": "19"
                                    },
                                    {
                                        "label": "20 scale units",
                                        "description": "Supports 10 Gbps x 2",
                                        "value": "20"
                                    }
                                ]
                            }
                        },
                        {
                            "name": "subnetMaskForGw",
                            "type": "Microsoft.Common.TextBox",
                            "label": "Subnet for VPN/ExpressRoute Gateways",
                            "toolTip": "Provide address prefix in CIDR notation (e.g 10.100.1.0/24)",
                            "defaultValue": "10.100.1.0/24",
                            "visible": "[and(not(equals(steps('connectivity').enableHub, 'vwan')), or(equals(steps('connectivity').enableErGw, 'Yes'),equals(steps('connectivity').enableVpnGw, 'Yes')))]",
                            "constraints": {
                                "required": true,
                                "validations": [
                                    {
                                        "regex": "^(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:\/(2[0-7]))$",
                                        "message": "Invalid CIDR range. The address prefix must be in the range [20,27]."
                                    },
                                    {
                                        "isValid": "[if(greaterOrEquals(last(split(steps('connectivity').esAddressHubHS, '/')), 8), equals(last(take(split(first(split(steps('connectivity').esAddressHubHS, '/')), '.'), 1)), last(take(split(first(split(steps('connectivity').subnetMaskForGw, '/')), '.'), 1))), true)]",
                                        "message": "CIDR range not within virtual network CIDR range (first octet)."
                                    },
                                    {
                                        "isValid": "[if(greaterOrEquals(last(split(steps('connectivity').esAddressHubHS, '/')), 16), equals(last(take(split(first(split(steps('connectivity').esAddressHubHS, '/')), '.'), 2)), last(take(split(first(split(steps('connectivity').subnetMaskForGw, '/')), '.'), 2))), true)]",
                                        "message": "CIDR range not within virtual network CIDR range (second octet)."
                                    },
                                    {
                                        "isValid": "[if(greaterOrEquals(last(split(steps('connectivity').esAddressHubHS, '/')), 24), equals(last(take(split(first(split(steps('connectivity').esAddressHubHS, '/')), '.'), 3)), last(take(split(first(split(steps('connectivity').subnetMaskForGw, '/')), '.'), 3))), true)]",
                                        "message": "CIDR range not within virtual network CIDR range (third octet)."
                                    },
                                    {
                                        "isValid": "[lessOrEquals(last(split(steps('connectivity').esAddressHubHS, '/')), last(split(steps('connectivity').subnetMaskForGw, '/')))]",
                                        "message": "CIDR range not within virtual network CIDR range (subnet mask)."
                                    }
                                ]
                            }
                        },
                        {
                            "name": "enableErGw",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Deploy ExpressRoute Gateway",
                            "defaultValue": "No",
                            "visible": "[not(equals(steps('connectivity').enableHub, 'No'))]",
                            "toolTip": "If 'Yes' is selected when also adding a subscription for connectivity, ARM will deploy Express Route gateway",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes",
                                        "value": "Yes"
                                    },
                                    {
                                        "label": "No",
                                        "value": "No"
                                    }
                                ]
                            }
                        },
                        {
                            "name": "erRegionalOrAz",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Deploy zone redundant or regional ExpressRoute Gateway",
                            "defaultValue": "Zone redundant (recommended)",
                            "visible": "[and(and(equals(steps('connectivity').enableErGw, 'Yes'), not(equals(steps('connectivity').enableHub, 'vwan'))),equals(steps('connectivity').enableErGw,'Yes'),contains(split('brazilsouth,canadacentral,centralus,eastus,eastus2,southcentralus,westus2,westus3,francecentral,germanywestcentral,northeurope,norwayeast,uksouth,westeurope,swedencentral,switzerlandnorth,qatarcentral,uaenorth,southafricanorth,australiaeast,centralindia,japaneast,koreacentral,southeastasia,eastasia,italynorth', ','), steps('connectivity').connectivityLocation))]",
                            "toolTip": "If 'Yes' is selected when also adding a subscription for connectivity, ARM will deploy Express Route Gateway to the selected region and availability zones.",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Zone redundant (recommended)",
                                        "value": "Zone"
                                    },
                                    {
                                        "label": "Regional",
                                        "value": "Regional"
                                    }
                                ]
                            }
                        },
                        {
                            "name": "erAzSku",
                            "type": "Microsoft.Common.DropDown",
                            "label": "Select the ExpressRoute Gateway SKU",
                            "defaultValue": "",
                            "multiselect": false,
                            "selectAll": false,
                            "filter": false,
                            "multiLine": true,
                            "visible": "[and(and(equals(steps('connectivity').enableErGw, 'Yes'), not(equals(steps('connectivity').enableHub, 'vwan'))),equals(steps('connectivity').enableErGw,'Yes'), equals(steps('connectivity').erRegionalOrAz, 'Zone'), contains(split('brazilsouth,canadacentral,centralus,eastus,eastus2,southcentralus,westus2,westus3,francecentral,germanywestcentral,northeurope,norwayeast,uksouth,westeurope,swedencentral,switzerlandnorth,qatarcentral,uaenorth,southafricanorth,australiaeast,centralindia,japaneast,koreacentral,southeastasia,eastasia,italynorth', ','), steps('connectivity').connectivityLocation))]",
                            "toolTip": "Select the required SKU for the Express Route gateway.",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "ErGw1AZ",
                                        "description": "Megabits per second 1000, packets per second 100,000, connections per second 7000, max number of cicuit connections is 4",
                                        "value": "ErGw1AZ"
                                    },
                                    {
                                        "label": "ErGw2AZ",
                                        "description": "Megabits per second 2000, packets per second 250,000, connections per second 14000, max number of cicuit connections is 8",
                                        "value": "ErGw2AZ"
                                    },
                                    {
                                        "label": "ErGw3AZ",
                                        "description": "Megabits per second 10,000, packets per second 1,000,000, connections per second 28,000, max number of cicuit connections is 16",
                                        "value": "ErGw3AZ"
                                    }
                                ]
                            }
                        },
                        {
                            "name": "erRegionalSku",
                            "type": "Microsoft.Common.DropDown",
                            "label": "Select the ExpressRoute Gateway SKU",
                            "defaultValue": "",
                            "multiselect": false,
                            "selectAll": false,
                            "filter": false,
                            "multiLine": true,
                            "visible": "[and(and(equals(steps('connectivity').enableErGw, 'Yes'), not(equals(steps('connectivity').enableHub, 'vwan'))), equals(steps('connectivity').enableErGw,'Yes'), equals(steps('connectivity').erRegionalOrAz, 'Regional'), contains(split('brazilsouth,canadacentral,centralus,eastus,eastus2,southcentralus,westus2,westus3,francecentral,germanywestcentral,northeurope,norwayeast,uksouth,westeurope,swedencentral,switzerlandnorth,qatarcentral,uaenorth,southafricanorth,australiaeast,centralindia,japaneast,koreacentral,southeastasia,eastasia,italynorth', ','), steps('connectivity').connectivityLocation))]",
                            "toolTip": "Select the required SKU for the Express Route gateway.",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Standard",
                                        "description": "Megabits per second 1000, packets per second 100,000, connections per second 7000, max number of cicuit connections is 4",
                                        "value": "Standard"
                                    },
                                    {
                                        "label": "HighPerformance",
                                        "description": "Megabits per second 2000, packets per second 250,000, connections per second 14000, max number of cicuit connections is 8",
                                        "value": "HighPerformance"
                                    },
                                    {
                                        "label": "UltraPerformance",
                                        "description": "Megabits per second 10,000, packets per second 1,000,000, connections per second 28,000, max number of cicuit connections is 16",
                                        "value": "UltraPerformance"
                                    }
                                ]
                            }
                        },
                        {
                            "name": "esErNoAzSku",
                            "type": "Microsoft.Common.DropDown",
                            "label": "Select the ExpressRoute Gateway SKU",
                            "defaultValue": "",
                            "multiselect": false,
                            "selectAll": false,
                            "filter": false,
                            "multiLine": true,
                            "visible": "[and(and(equals(steps('connectivity').enableErGw, 'Yes'), not(equals(steps('connectivity').enableHub, 'vwan'))),equals(steps('connectivity').enableErGw,'Yes'), not(contains(split('canadacentral,centralus,eastus,eastus2,southcentralus,westus2,francecentral,germanywestcentral,northeurope,westeurope,uksouth,southafricanorth,japaneast,southeastasia,australiaeast,italynorth', ','), steps('connectivity').connectivityLocation)))]",
                            "toolTip": "Select the required SKU for the Express Route gateway.",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Standard",
                                        "description": "Megabits per second 1000, packets per second 100,000, connections per second 7000, max number of cicuit connections is 4",
                                        "value": "Standard"
                                    },
                                    {
                                        "label": "HighPerformance",
                                        "description": "Megabits per second 2000, packets per second 250,000, connections per second 14000, max number of cicuit connections is 8",
                                        "value": "HighPerformance"
                                    },
                                    {
                                        "label": "UltraPerformance",
                                        "description": "Megabits per second 10,000, packets per second 1,000,000, connections per second 28,000, max number of cicuit connections is 16",
                                        "value": "UltraPerformance"
                                    }
                                ]
                            }
                        },
                        {
                            "name": "expressRouteScaleUnit",
                            "type": "Microsoft.Common.DropDown",
                            "label": "Select the ExpressRoute Gateway scale unit",
                            "defaultValue": "",
                            "multiselect": false,
                            "selectAll": false,
                            "filter": false,
                            "multiLine": true,
                            "visible": "[and(equals(steps('connectivity').enableErGw, 'Yes'), equals(steps('connectivity').enableHub, 'vwan'))]",
                            "toolTip": "Select the ExpressRoute Gateway scale unit",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "1 scale unit",
                                        "description": "Supports 2 Gbps",
                                        "value": "1"
                                    },
                                    {
                                        "label": "2 scale units",
                                        "description": "Supports 4 Gbps",
                                        "value": "2"
                                    },
                                    {
                                        "label": "3 scale units",
                                        "description": "Supports 6 Gbps",
                                        "value": "3"
                                    },
                                    {
                                        "label": "4 scale units",
                                        "description": "Supports 8 Gbps",
                                        "value": "4"
                                    },
                                    {
                                        "label": "5 scale units",
                                        "description": "Supports 10 Gbps",
                                        "value": "5"
                                    },
                                    {
                                        "label": "6 scale units",
                                        "description": "Supports 12 Gbps",
                                        "value": "6"
                                    },
                                    {
                                        "label": "7 scale units",
                                        "description": "Supports 14 Gbps",
                                        "value": "7"
                                    },
                                    {
                                        "label": "8 scale units",
                                        "description": "Supports 16 Gbps",
                                        "value": "8"
                                    },
                                    {
                                        "label": "9 scale units",
                                        "description": "Supports 18 Gbps",
                                        "value": "9"
                                    },
                                    {
                                        "label": "10 scale units",
                                        "description": "Supports 20 Gbps",
                                        "value": "10"
                                    }
                                ]
                            }
                        },
                        {
                            "name": "enableAzFw",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Deploy Azure Firewall",
                            "defaultValue": "Yes (recommended)",
                            "visible": "[or(equals(steps('connectivity').enableHub, 'vhub'), equals(steps('connectivity').enableHub, 'vwan'))]",
                            "toolTip": "If 'Yes' is selected when also adding a subscription for connectivity, ARM will deploy Azure Firewall",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes (recommended)",
                                        "value": "Yes"
                                    },
                                    {
                                        "label": "No",
                                        "value": "No"
                                    }
                                ]
                            }
                        },
                        {
                            "name": "firewallSku",
                            "type": "Microsoft.Common.DropDown",
                            "label": "Select Azure Firewall tier",
                            "defaultValue": "Premium",
                            "multiselect": false,
                            "selectAll": false,
                            "filter": false,
                            "multiLine": true,
                            "visible": "[equals(steps('connectivity').enableAzFw, 'Yes')]",
                            "toolTip": "Select Azure Firewall tier",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Basic",
                                        "description": "Basic Azure Firewall",
                                        "value": "Basic"
                                    },
                                    {
                                        "label": "Standard",
                                        "description": "Standard Azure Firewall",
                                        "value": "Standard"
                                    },
                                    {
                                        "label": "Premium",
                                        "description": "Premium Azure Firewall adds support for TLS inspection, IDPS, URL filtering and web categories.",
                                        "value": "Premium"
                                    }
                                ]
                            }
                        },
                        {
                            "name": "esFWAZNote",
                            "type": "Microsoft.Common.InfoBox",
                            "visible": "[if(or(equals(steps('connectivity').enableHub, 'vhub'), equals(steps('connectivity').enableHub, 'vwan')), and(equals(steps('connectivity').enableAzFw,'Yes'), contains(split('brazilsouth,canadacentral,centralus,eastus,eastus2,southcentralus,westus2,westus3,francecentral,germanywestcentral,northeurope,norwayeast,uksouth,westeurope,swedencentral,switzerlandnorth,qatarcentral,uaenorth,southafricanorth,australiaeast,centralindia,japaneast,koreacentral,southeastasia,eastasia,italynorth', ','), steps('connectivity').connectivityLocation)), false)]",
                            "options": {
                                "text": "ALZ enables Availability Zones for all services that it deploys by default for maximum resiliency in regions where Availability Zones are supported, including for Azure Firewall. Review the selected Availability Zones meet your architectural requirements and that you understand the added costs for inbound and outbound data transfers associated with Avaialability Zones, before proceeding. Click on this box to learn more about the Availability Zones and Azure Firewall.",
                                "uri": "https://learn.microsoft.com/en-us/azure/firewall/features#built-in-high-availability",
                                "style": "Info"
                            }
                        },
                        {
                            "name": "firewallZones",
                            "type": "Microsoft.Common.DropDown",
                            "label": "Select Availability Zones for the Azure Firewall",
                            "defaultValue": [{"value": "1"}, {"value": "2"}, {"value": "3"}],
                            "multiselect": true,
                            "selectAll": true,
                            "filter": true,
                            "visible": "[if(or(equals(steps('connectivity').enableHub, 'vhub'), equals(steps('connectivity').enableHub, 'vwan')), and(equals(steps('connectivity').enableAzFw,'Yes'), contains(split('brazilsouth,canadacentral,centralus,eastus,eastus2,southcentralus,westus2,westus3,francecentral,germanywestcentral,northeurope,norwayeast,uksouth,westeurope,swedencentral,switzerlandnorth,qatarcentral,uaenorth,southafricanorth,australiaeast,centralindia,japaneast,koreacentral,southeastasia,eastasia,italynorth', ','), steps('connectivity').connectivityLocation)), false)]",
                            "toolTip": "If 'Yes' is selected when also adding a subscription for connectivity, ARM will deploy Azure Firewall to the selected region and availability zones.",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Zone 1",
                                        "value": "1"
                                    },
                                    {
                                        "label": "Zone 2",
                                        "value": "2"
                                    },
                                    {
                                        "label": "Zone 3",
                                        "value": "3"
                                    }
                                ]
                            }
                        },
                        {
                            "name": "subnetMaskForAzFw",
                            "type": "Microsoft.Common.TextBox",
                            "label": "Subnet for Azure Firewall",
                            "toolTip": "Provide address prefix in CIDR notation (e.g 10.100.0.0/24)",
                            "defaultValue": "10.100.0.0/24",
                            "visible": "[and(equals(steps('connectivity').enableAzFw, 'Yes'), not(equals(steps('connectivity').enableHub, 'vwan')))]",
                            "constraints": {
                                "required": true,
                                "validations": [
                                    {
                                        "regex": "^(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:\/(2[0-6]))$",
                                        "message": "Invalid CIDR range. The address prefix must be in the range [20,26]."
                                    },
                                    {
                                        "isValid": "[if(greaterOrEquals(last(split(steps('connectivity').esAddressHubHS, '/')), 8), equals(last(take(split(first(split(steps('connectivity').esAddressHubHS, '/')), '.'), 1)), last(take(split(first(split(steps('connectivity').subnetMaskForAzFw, '/')), '.'), 1))), true)]",
                                        "message": "CIDR range not within virtual network CIDR range (first octet)."
                                    },
                                    {
                                        "isValid": "[if(greaterOrEquals(last(split(steps('connectivity').esAddressHubHS, '/')), 16), equals(last(take(split(first(split(steps('connectivity').esAddressHubHS, '/')), '.'), 2)), last(take(split(first(split(steps('connectivity').subnetMaskForAzFw, '/')), '.'), 2))), true)]",
                                        "message": "CIDR range not within virtual network CIDR range (second octet)."
                                    },
                                    {
                                        "isValid": "[if(greaterOrEquals(last(split(steps('connectivity').esAddressHubHS, '/')), 24), equals(last(take(split(first(split(steps('connectivity').esAddressHubHS, '/')), '.'), 3)), last(take(split(first(split(steps('connectivity').subnetMaskForAzFw, '/')), '.'), 3))), true)]",
                                        "message": "CIDR range not within virtual network CIDR range (third octet)."
                                    },
                                    {
                                        "isValid": "[lessOrEquals(last(split(steps('connectivity').esAddressHubHS, '/')), last(split(steps('connectivity').subnetMaskForAzFw, '/')))]",
                                        "message": "CIDR range not within virtual network CIDR range (subnet mask)."
                                    }
                                ]
                            }
                        },
                        {
                            "name": "subnetMaskForAzFwMgmt",
                            "type": "Microsoft.Common.TextBox",
                            "label": "Subnet for Azure Firewall Mgmt (Optional Only for Basic SKU)",
                            "toolTip": "Provide address prefix in CIDR notation (e.g 10.100.0.0/26)",
                            "defaultValue": "10.100.2.0/24",
                            "visible": "[and(equals(steps('connectivity').enableAzFw, 'Yes'), equals(steps('connectivity').firewallSku, 'Basic'), not(equals(steps('connectivity').enableHub, 'vwan')))]",
                            "constraints": {
                                "required": true,
                                "validations": [
                                    {
                                        "regex": "^(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:\/(2[0-6]))$",
                                        "message": "Invalid CIDR range. The address prefix must be in the range [20,26]."
                                    },
                                    {
                                        "isValid": "[if(greaterOrEquals(last(split(steps('connectivity').esAddressHubHS, '/')), 8), equals(last(take(split(first(split(steps('connectivity').esAddressHubHS, '/')), '.'), 1)), last(take(split(first(split(steps('connectivity').subnetMaskForAzFw, '/')), '.'), 1))), true)]",
                                        "message": "CIDR range not within virtual network CIDR range (first octet)."
                                    },
                                    {
                                        "isValid": "[if(greaterOrEquals(last(split(steps('connectivity').esAddressHubHS, '/')), 16), equals(last(take(split(first(split(steps('connectivity').esAddressHubHS, '/')), '.'), 2)), last(take(split(first(split(steps('connectivity').subnetMaskForAzFw, '/')), '.'), 2))), true)]",
                                        "message": "CIDR range not within virtual network CIDR range (second octet)."
                                    },
                                    {
                                        "isValid": "[if(greaterOrEquals(last(split(steps('connectivity').esAddressHubHS, '/')), 24), equals(last(take(split(first(split(steps('connectivity').esAddressHubHS, '/')), '.'), 3)), last(take(split(first(split(steps('connectivity').subnetMaskForAzFw, '/')), '.'), 3))), true)]",
                                        "message": "CIDR range not within virtual network CIDR range (third octet)."
                                    },
                                    {
                                        "isValid": "[lessOrEquals(last(split(steps('connectivity').esAddressHubHS, '/')), last(split(steps('connectivity').subnetMaskForAzFwMgmt, '/')))]",
                                        "message": "CIDR range not within virtual network CIDR range (subnet mask)."
                                    }
                                ]
                            }
                        },
                        {
                            "name": "enableAzFwDnsProxy",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Enable Azure Firewall as a DNS proxy",
                            "defaultValue": "No",
                            "visible": "[and(equals(steps('connectivity').enableAzFw, 'Yes'), not(equals(steps('connectivity').firewallSku, 'Basic')))]",
                            "toolTip": "If 'Yes' is selected when also adding a subscription for connectivity, ARM will enable Azure Firewall as a DNS Proxy.",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes",
                                        "value": "Yes"
                                    },
                                    {
                                        "label": "No",
                                        "value": "No"
                                    }
                                ]
                            }
                        },
                        {
                            "name": "enablevWANRoutingIntent",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Enable vWAN Routing Intent",
                            "defaultValue": "No",
                            "visible": "[and(not(equals(steps('connectivity').enableHub, 'No')), not(equals(steps('connectivity').enableHub, 'nva')), not(equals(steps('connectivity').enableHub, 'vhub')), equals(steps('connectivity').enableAzFw, 'Yes'))]",
                            "toolTip": "Enable vWan Routing Intent and set Azure Firewall as the next hop either for Internet Traffic, Private Traffic or both",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes",
                                        "value": "Yes"
                                    },
                                    {
                                        "label": "No",
                                        "value": "No"
                                    }
                                ]
                            }
                        },
                        {
                            "name": "vWANRoutingIntentforInternetTraffic",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Select Yes if you want to enable routing intent policy to apply on Internet Traffic",
                            "defaultValue": "No",
                            "visible": "[and(not(equals(steps('connectivity').enableHub, 'No')), not(equals(steps('connectivity').enableHub, 'nva')), not(equals(steps('connectivity').enableHub, 'vhub')), equals(steps('connectivity').enableAzFw, 'Yes'),equals(steps('connectivity').enablevWANRoutingIntent, 'Yes'))]",
                            "toolTip": "Enable vWAN Routing Intent for Internet Traffic",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes",
                                        "value": "Yes"
                                    },
                                    {
                                        "label": "No",
                                        "value": "No"
                                    }
                                ]
                            }
                        },
                        {
                            "name": "vWANRoutingIntentforPrivateTraffic",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Select Yes if you want to enable routing intent policy to apply on Private Traffic",
                            "defaultValue": "No",
                            "visible": "[and(not(equals(steps('connectivity').enableHub, 'No')), not(equals(steps('connectivity').enableHub, 'nva')), not(equals(steps('connectivity').enableHub, 'vhub')), equals(steps('connectivity').enableAzFw, 'Yes'),equals(steps('connectivity').enablevWANRoutingIntent, 'Yes'))]",
                            "toolTip": "Enable vWAN Routing Intent for Private Traffic",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes",
                                        "value": "Yes"
                                    },
                                    {
                                        "label": "No",
                                        "value": "No"
                                    }
                                ]
                            }
                        },
                        {
                            "name": "vWANHubRoutingPreference",
                            "type": "Microsoft.Common.DropDown",
                            "label": "Hub Routing Preference",
                            "defaultValue": "ExpressRoute (default)",
                            "multiselect": false,
                            "selectAll": false,
                            "filter": false,
                            "multiLine": true,
                            "visible": "[and(not(equals(steps('connectivity').enableHub, 'No')), not(equals(steps('connectivity').enableHub, 'nva')), not(equals(steps('connectivity').enableHub, 'vhub')))]",
                            "toolTip": "Preference used in selecting best path when the virtual hub learns multiple paths to the same destination route-prefix.<a href=\"https://learn.microsoft.com/azure/virtual-wan/about-virtual-hub-routing-preference\">Virtual hub routing preference</a>.",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "ExpressRoute (default)",
                                        "description": "ExpressRoute is the preferred path. (default)",
                                        "value": "ExpressRoute"
                                    },
                                    {
                                        "label": "VPN",
                                        "description": "VPN is the preferred path",
                                        "value": "VpnGateway"
                                    },
                                    {
                                        "label": "AS Path",
                                        "description": "AS Path is the preferred path",
                                        "value": "ASPath"
                                    }
                                ]
                            }
                        },
                        {
                            "name": "vWANHubCapacity",
                            "type": "Microsoft.Common.DropDown",
                            "label": "Virtual Hub Capacity",
                            "defaultValue": "",
                            "multiselect": false,
                            "selectAll": false,
                            "filter": false,
                            "multiLine": true,
                            "visible": "[and(not(equals(steps('connectivity').enableHub, 'No')), not(equals(steps('connectivity').enableHub, 'nva')), not(equals(steps('connectivity').enableHub, 'vhub')))]",
                            "toolTip": "Routing infrastructure units determine the minimum throughput of the Virtual WAN hub router and the number of Virtual Machines that can be deployed in Virtual Networks connected to the Virtual WAN hub. Two routing infrastructure units are included at no extra cost with a deployment of a hub.<a href=\"https://learn.microsoft.com/azure/virtual-wan/hub-settings#capacity\">Virtual Hub Capacity</a>.",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "2",
                                        "description": "2 Routing Infrastructure Units, 3 Gbps Aggregate Throughput, Supports 2000 VMs",
                                        "value": "2"
                                    },
                                    {
                                        "label": "3",
                                        "description": "3 Routing Infrastructure Units, 3 Gbps Aggregate Throughput, Supports 3000 VMs",
                                        "value": "3"
                                    },
                                    {
                                        "label": "4",
                                        "description": "4 Routing Infrastructure Units, 4 Gbps Aggregate Throughput, Supports 4000 VMs",
                                        "value": "4"
                                    },
                                    {
                                        "label": "5",
                                        "description": "5 Routing Infrastructure Units, 5 Gbps Aggregate Throughput, Supports 5000 VMs",
                                        "value": "5"
                                    },
                                    {
                                        "label": "6",
                                        "description": "6 Routing Infrastructure Units, 6 Gbps Aggregate Throughput, Supports 6000 VMs",
                                        "value": "6"
                                    },
                                    {
                                        "label": "7",
                                        "description": "7 Routing Infrastructure Units, 7 Gbps Aggregate Throughput, Supports 7000 VMs",
                                        "value": "7"
                                    },
                                    {
                                        "label": "8",
                                        "description": "8 Routing Infrastructure Units, 8 Gbps Aggregate Throughput, Supports 8000 VMs",
                                        "value": "8"
                                    },
                                    {
                                        "label": "9",
                                        "description": "9 Routing Infrastructure Units, 9 Gbps Aggregate Throughput, Supports 9000 VMs",
                                        "value": "9"
                                    },
                                    {
                                        "label": "10",
                                        "description": "10 Routing Infrastructure Units, 10 Gbps Aggregate Throughput, Supports 10000 VMs",
                                        "value": "10"
                                    },
                                    {
                                        "label": "11",
                                        "description": "11 Routing Infrastructure Units, 11 Gbps Aggregate Throughput, Supports 11000 VMs",
                                        "value": "11"
                                    },
                                    {
                                        "label": "12",
                                        "description": "12 Routing Infrastructure Units, 12 Gbps Aggregate Throughput, Supports 12000 VMs",
                                        "value": "12"
                                    },
                                    {
                                        "label": "13",
                                        "description": "13 Routing Infrastructure Units, 13 Gbps Aggregate Throughput, Supports 13000 VMs",
                                        "value": "13"
                                    },
                                    {
                                        "label": "14",
                                        "description": "14 Routing Infrastructure Units, 14 Gbps Aggregate Throughput, Supports 14000 VMs",
                                        "value": "14"
                                    },
                                    {
                                        "label": "15",
                                        "description": "15 Routing Infrastructure Units, 15 Gbps Aggregate Throughput, Supports 15000 VMs",
                                        "value": "15"
                                    },
                                    {
                                        "label": "16",
                                        "description": "16 Routing Infrastructure Units, 16 Gbps Aggregate Throughput, Supports 16000 VMs",
                                        "value": "16"
                                    },
                                    {
                                        "label": "17",
                                        "description": "17 Routing Infrastructure Units, 17 Gbps Aggregate Throughput, Supports 17000 VMs",
                                        "value": "17"
                                    },
                                    {
                                        "label": "18",
                                        "description": "18 Routing Infrastructure Units, 18 Gbps Aggregate Throughput, Supports 18000 VMs",
                                        "value": "18"
                                    },
                                    {
                                        "label": "19",
                                        "description": "19 Routing Infrastructure Units, 19 Gbps Aggregate Throughput, Supports 19000 VMs",
                                        "value": "19"
                                    },
                                    {
                                        "label": "20",
                                        "description": "20 Routing Infrastructure Units, 20 Gbps Aggregate Throughput, Supports 20000 VMs",
                                        "value": "20"
                                    },
                                    {
                                        "label": "21",
                                        "description": "21 Routing Infrastructure Units, 21 Gbps Aggregate Throughput, Supports 21000 VMs",
                                        "value": "21"
                                    },
                                    {
                                        "label": "22",
                                        "description": "22 Routing Infrastructure Units, 22 Gbps Aggregate Throughput, Supports 22000 VMs",
                                        "value": "22"
                                    },
                                    {
                                        "label": "23",
                                        "description": "23 Routing Infrastructure Units, 23 Gbps Aggregate Throughput, Supports 23000 VMs",
                                        "value": "23"
                                    },
                                    {
                                        "label": "24",
                                        "description": "24 Routing Infrastructure Units, 24 Gbps Aggregate Throughput, Supports 24000 VMs",
                                        "value": "24"
                                    },
                                    {
                                        "label": "25",
                                        "description": "25 Routing Infrastructure Units, 25 Gbps Aggregate Throughput, Supports 25000 VMs",
                                        "value": "25"
                                    },
                                    {
                                        "label": "26",
                                        "description": "26 Routing Infrastructure Units, 26 Gbps Aggregate Throughput, Supports 26000 VMs",
                                        "value": "26"
                                    },
                                    {
                                        "label": "27",
                                        "description": "27 Routing Infrastructure Units, 27 Gbps Aggregate Throughput, Supports 27000 VMs",
                                        "value": "27"
                                    },
                                    {
                                        "label": "28",
                                        "description": "28 Routing Infrastructure Units, 28 Gbps Aggregate Throughput, Supports 28000 VMs",
                                        "value": "28"
                                    },
                                    {
                                        "label": "29",
                                        "description": "29 Routing Infrastructure Units, 29 Gbps Aggregate Throughput, Supports 29000 VMs",
                                        "value": "29"
                                    },
                                    {
                                        "label": "30",
                                        "description": "30 Routing Infrastructure Units, 30 Gbps Aggregate Throughput, Supports 30000 VMs",
                                        "value": "30"
                                    },
                                    {
                                        "label": "31",
                                        "description": "31 Routing Infrastructure Units, 31 Gbps Aggregate Throughput, Supports 31000 VMs",
                                        "value": "31"
                                    },
                                    {
                                        "label": "32",
                                        "description": "32 Routing Infrastructure Units, 32 Gbps Aggregate Throughput, Supports 32000 VMs",
                                        "value": "32"
                                    },
                                    {
                                        "label": "33",
                                        "description": "33 Routing Infrastructure Units, 33 Gbps Aggregate Throughput, Supports 33000 VMs",
                                        "value": "33"
                                    },
                                    {
                                        "label": "34",
                                        "description": "34 Routing Infrastructure Units, 34 Gbps Aggregate Throughput, Supports 34000 VMs",
                                        "value": "34"
                                    },
                                    {
                                        "label": "35",
                                        "description": "35 Routing Infrastructure Units, 35 Gbps Aggregate Throughput, Supports 35000 VMs",
                                        "value": "35"
                                    },
                                    {
                                        "label": "36",
                                        "description": "36 Routing Infrastructure Units, 36 Gbps Aggregate Throughput, Supports 36000 VMs",
                                        "value": "36"
                                    },
                                    {
                                        "label": "37",
                                        "description": "37 Routing Infrastructure Units, 37 Gbps Aggregate Throughput, Supports 37000 VMs",
                                        "value": "37"
                                    },
                                    {
                                        "label": "38",
                                        "description": "38 Routing Infrastructure Units, 38 Gbps Aggregate Throughput, Supports 38000 VMs",
                                        "value": "38"
                                    },
                                    {
                                        "label": "39",
                                        "description": "39 Routing Infrastructure Units, 39 Gbps Aggregate Throughput, Supports 39000 VMs",
                                        "value": "39"
                                    },
                                    {
                                        "label": "40",
                                        "description": "40 Routing Infrastructure Units, 40 Gbps Aggregate Throughput, Supports 40000 VMs",
                                        "value": "40"
                                    },
                                    {
                                        "label": "41",
                                        "description": "41 Routing Infrastructure Units, 41 Gbps Aggregate Throughput, Supports 41000 VMs",
                                        "value": "41"
                                    },
                                    {
                                        "label": "42",
                                        "description": "42 Routing Infrastructure Units, 42 Gbps Aggregate Throughput, Supports 42000 VMs",
                                        "value": "42"
                                    },
                                    {
                                        "label": "43",
                                        "description": "43 Routing Infrastructure Units, 43 Gbps Aggregate Throughput, Supports 43000 VMs",
                                        "value": "43"
                                    },
                                    {
                                        "label": "44",
                                        "description": "44 Routing Infrastructure Units, 44 Gbps Aggregate Throughput, Supports 44000 VMs",
                                        "value": "44"
                                    },
                                    {
                                        "label": "45",
                                        "description": "45 Routing Infrastructure Units, 45 Gbps Aggregate Throughput, Supports 45000 VMs",
                                        "value": "45"
                                    },
                                    {
                                        "label": "46",
                                        "description": "46 Routing Infrastructure Units, 46 Gbps Aggregate Throughput, Supports 46000 VMs",
                                        "value": "46"
                                    },
                                    {
                                        "label": "47",
                                        "description": "47 Routing Infrastructure Units, 47 Gbps Aggregate Throughput, Supports 47000 VMs",
                                        "value": "47"
                                    },
                                    {
                                        "label": "48",
                                        "description": "48 Routing Infrastructure Units, 48 Gbps Aggregate Throughput, Supports 48000 VMs",
                                        "value": "48"
                                    },
                                    {
                                        "label": "49",
                                        "description": "49 Routing Infrastructure Units, 49 Gbps Aggregate Throughput, Supports 49000 VMs",
                                        "value": "49"
                                    },
                                    {
                                        "label": "50",
                                        "description": "50 Routing Infrastructure Units, 50 Gbps Aggregate Throughput, Supports 50000 VMs",
                                        "value": "50"
                                    }
                                ]
                            }
                        },
                        {
                            "name": "esNetworkSecondarySubSection",
                            "type": "Microsoft.Common.Section",
                            "label": "Secondary Region Networking",
                            "visible": "[and(not(equals(steps('connectivity').enableHub, 'No')), equals(steps('core').deploySecondaryRegion, 'Yes'))]",
                            "elements":[
                                {
                                    "name": "secondaryRegionNetworkInfo",
                                    "type": "Microsoft.Common.InfoBox",
                                    "visible": "[and(not(equals(steps('connectivity').enableHub, 'No')), not(equals(steps('connectivity').enableHub, 'No')))]",
                                    "options": {
                                        "text": "Your second region's networking resources will be deployed in the same subscription as the first region's.  If you select the same region twice, the secondary resources will not be deployed and you may encounter errors.",
                                        "uri": "https://docs.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/define-an-azure-network-topology",
                                        "style": "Info"
                                    }
                                },
                                {
                                    "name": "connectivityLocationSecondary",
                                    "type": "Microsoft.Common.DropDown",
                                    "label": "Region to extend networking",
                                    "filter": true,
                                    "toolTip": "Select the target region for your second connectivity deployment (requires you to provide a subscriptionId for connectivity)",
                                    "defaultValue": "[parse('[]')]",
                                    "constraints": {
                                        "allowedValues": "[map(steps('basics').getLocations.value,(item) => parse(concat('{\"label\":\"',item.displayName,'\",\"value\":\"',item.name,'\"}')))]",
                                        "required": true
                                    },
                                    "visible": "[and(not(equals(steps('connectivity').enableHub, 'No')), not(equals(steps('connectivity').enableHub, 'No')))]"
                                },
                                {
                                    "name": "esAddressHubVWANSecondary",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Address space for your second virtual hub (required for vWAN hub)",
                                    "toolTip": "Provide address prefix in CIDR notation (e.g 10.200.0.0/23)",
                                    "defaultValue": "10.200.0.0/23",
                                    "visible": "[and(not(equals(steps('connectivity').enableHub, 'No')), not(equals(steps('connectivity').enableHub, 'nva')), not(equals(steps('connectivity').enableHub, 'vhub')), not(equals(steps('connectivity').enableHub, 'No')), not(equals(steps('connectivity').enableHub, 'nva')), not(equals(steps('connectivity').enableHub, 'vhub')))]",
                                    "constraints": {
                                        "required": true,
                                        "validations": [
                                            {
                                                "regex": "^(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:\/(1[0-9]|2[0-4]))$",
                                                "message": "Invalid CIDR range. The address prefix must be in the range [10,24]."
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "esAddressHubHSSecondary",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Address space for your second hub virtual network(required for hub virtual network)",
                                    "toolTip": "Provide address prefix in CIDR notation (e.g 10.200.0.0/16)",
                                    "defaultValue": "10.200.0.0/16",
                                    "visible": "[and(not(equals(steps('connectivity').enableHub, 'No')), not(equals(steps('connectivity').enableHub, 'vwan')), not(equals(steps('connectivity').enableHub, 'No')), not(equals(steps('connectivity').enableHub, 'vwan')))]",
                                    "constraints": {
                                        "required": true,
                                        "validations": [
                                            {
                                                "regex": "^(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:\/(1[0-9]|2[0-4]))$",
                                                "message": "Invalid CIDR range. The address prefix must be in the range [10,24]."
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "esNwZtnNote",
                                    "type": "Microsoft.Common.InfoBox",
                                    "visible": "[and(not(equals(steps('connectivity').enableHub, 'No')), not(equals(steps('connectivity').enableHub, 'nva')))]",
                                    "options": {
                                        "text": "ALZ defaults are aligned to Zero Trust Networking principles. Click on this box to learn more about the Zero Trust Networking principles and how to apply them.",
                                        "uri": "https://learn.microsoft.com/security/zero-trust/deploy/networks",
                                        "style": "Info"
                                    }
                                },
                                {
                                    "name": "esDNSRegionNote",
                                    "type": "Microsoft.Common.InfoBox",
                                    "visible": "[or(equals(steps('connectivity').enableHub, 'vhub'), equals(steps('connectivity').enableHub, 'nva'))]",
                                    "options": {
                                        "text": "For multi-region deployments it is recommended to deploy multiple private endpoints for PaaS instances, once in each region where clients exist.  If this is your usecase, then deploy region specific Private DNS zones.  Click on this box to learn about managing Private Link and DNS integration at scale.",
                                        "uri": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/private-link-and-dns-integration-at-scale",
                                        "style": "Info"
                                    }
                                },
                                {
                                    "name": "enableVpnGwSecondary",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "label": "Deploy VPN Gateway in your second region",
                                    "defaultValue": "No",
                                    "visible": "[and(not(equals(steps('connectivity').enableHub, 'No')), not(equals(steps('connectivity').enableHub, 'No')))]",
                                    "toolTip": "If 'Yes' is selected when also adding a subscription for connectivity, ARM will deploy VPN gateway",
                                    "constraints": {
                                        "allowedValues": [
                                            {
                                                "label": "Yes",
                                                "value": "Yes"
                                            },
                                            {
                                                "label": "No",
                                                "value": "No"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "gwRegionalOrAzSecondary",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "label": "Deploy zone redundant or regional VPN Gateway in your second region",
                                    "defaultValue": "Zone redundant (recommended)",
                                    "visible": "[and(and(equals(steps('connectivity').esNetworkSecondarySubSection.enableVpnGwSecondary,'Yes'), not(equals(steps('connectivity').enableHub, 'vwan'))), equals(steps('connectivity').esNetworkSecondarySubSection.enableVpnGwSecondary,'Yes'),contains(split('brazilsouth,canadacentral,centralus,eastus,eastus2,southcentralus,westus2,westus3,francecentral,germanywestcentral,northeurope,norwayeast,uksouth,westeurope,swedencentral,switzerlandnorth,qatarcentral,uaenorth,southafricanorth,australiaeast,centralindia,japaneast,koreacentral,southeastasia,eastasia,italynorth', ','), steps('connectivity').esNetworkSecondarySubSection.connectivityLocationSecondary))]",
                                    "toolTip": "If 'Yes' is selected when also adding a subscription for connectivity, ARM will deploy Virtual Gateway to the selected region and availability zones.",
                                    "constraints": {
                                        "allowedValues": [
                                            {
                                                "label": "Zone redundant (recommended)",
                                                "value": "Zone"
                                            },
                                            {
                                                "label": "Regional",
                                                "value": "Regional"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "enableVpnActiveActiveSecondary",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "label": "Deploy VPN Gateway in Active/Active mode in your second region",
                                    "defaultValue": "No",
                                    "visible": "[and(equals(steps('connectivity').esNetworkSecondarySubSection.enableVpnGwSecondary,'Yes'), not(equals(steps('connectivity').enableHub, 'vwan')), equals(steps('connectivity').esNetworkSecondarySubSection.enableVpnGwSecondary,'Yes'))]",
                                    "toolTip": "Deploy the VPN gateway in Active/Active mode",
                                    "constraints": {
                                        "allowedValues": [
                                            {
                                                "label": "Yes",
                                                "value": "Yes"
                                            },
                                            {
                                                "label": "No",
                                                "value": "No"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "esGwNoAzSkuSecondary",
                                    "type": "Microsoft.Common.DropDown",
                                    "label": "Select the VPN Gateway SKU for your second region",
                                    "defaultValue": "",
                                    "multiselect": false,
                                    "selectAll": false,
                                    "filter": false,
                                    "multiLine": true,
                                    "visible": "[and(and(equals(steps('connectivity').esNetworkSecondarySubSection.enableVpnGwSecondary, 'Yes'), not(equals(steps('connectivity').enableHub, 'vwan'))), equals(steps('connectivity').esNetworkSecondarySubSection.enableVpnGwSecondary,'Yes'), not(contains(split('brazilsouth,canadacentral,centralus,eastus,eastus2,southcentralus,westus2,westus3,francecentral,germanywestcentral,northeurope,norwayeast,uksouth,westeurope,swedencentral,switzerlandnorth,qatarcentral,uaenorth,southafricanorth,australiaeast,centralindia,japaneast,koreacentral,southeastasia,eastasia,italynorth', ','), steps('connectivity').esNetworkSecondarySubSection.connectivityLocationSecondary)))]",
                                    "toolTip": "Select the required SKU for the VPN gateway.",
                                    "constraints": {
                                        "allowedValues": [
                                            {
                                                "label": "VpnGw2",
                                                "description": "Supports BGP, max 30 S2S/VNet-VNet tunnels, max 128 P2S SSTP connections, max 500 IKEv2/OpenVPN connections, aggregate throughput is 1.25 Gbps",
                                                "value": "VpnGw2"
                                            },
                                            {
                                                "label": "VpnGw3",
                                                "description": "Supports BGP, max 30 S2S/VNet-VNet tunnels, max 128 P2S SSTP connections, max 1000 IKEv2/OpenVPN connections, aggregate throughput is 2.5 Gbps",
                                                "value": "VpnGw3"
                                            },
                                            {
                                                "label": "VpnGw4",
                                                "description": "Supports BGP, max 30 S2S/VNet-VNet tunnels, max 128 P2S SSTP connections, max 5000 IKEv2/OpenVPN connections, aggregate throughput is 5 Gbps",
                                                "value": "VpnGw4"
                                            },
                                            {
                                                "label": "VpnGw5",
                                                "description": "Supports BGP, max 30 S2S/VNet-VNet tunnels, max 128 P2S SSTP connections, max 10000 IKEv2/OpenVPN connections, aggregate throughput is 10 Gbps",
                                                "value": "VpnGw5"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "gwAzSkuSecondary",
                                    "type": "Microsoft.Common.DropDown",
                                    "label": "Select the VPN Gateway SKU for your second region",
                                    "defaultValue": "",
                                    "multiselect": false,
                                    "selectAll": false,
                                    "filter": false,
                                    "multiLine": true,
                                    "visible": "[and(and(equals(steps('connectivity').esNetworkSecondarySubSection.enableVpnGwSecondary, 'Yes'), not(equals(steps('connectivity').enableHub, 'vwan'))), equals(steps('connectivity').esNetworkSecondarySubSection.enableVpnGwSecondary,'Yes'), equals(steps('connectivity').esNetworkSecondarySubSection.gwRegionalOrAzSecondary, 'Zone') ,contains(split('brazilsouth,canadacentral,centralus,eastus,eastus2,southcentralus,westus2,westus3,francecentral,germanywestcentral,northeurope,norwayeast,uksouth,westeurope,swedencentral,switzerlandnorth,qatarcentral,uaenorth,southafricanorth,australiaeast,centralindia,japaneast,koreacentral,southeastasia,eastasia,italynorth', ','), steps('connectivity').esNetworkSecondarySubSection.connectivityLocationSecondary))]",
                                    "toolTip": "Select the required SKU for the VPN gateway.",
                                    "constraints": {
                                        "allowedValues": [
                                            {
                                                "label": "VpnGw2AZ",
                                                "description": "Supports BGP, max 30 S2S/VNet-VNet tunnels, max 128 P2S SSTP connections, max 500 IKEv2/OpenVPN connections, aggregate throughput is 1.25 Gbps",
                                                "value": "VpnGw2AZ"
                                            },
                                            {
                                                "label": "VpnGw3AZ",
                                                "description": "Supports BGP, max 30 S2S/VNet-VNet tunnels, max 128 P2S SSTP connections, max 1000 IKEv2/OpenVPN connections, aggregate throughput is 2.5 Gbps",
                                                "value": "VpnGw3AZ"
                                            },
                                            {
                                                "label": "VpnGw4AZ",
                                                "description": "Supports BGP, max 30 S2S/VNet-VNet tunnels, max 128 P2S SSTP connections, max 5000 IKEv2/OpenVPN connections, aggregate throughput is 5 Gbps",
                                                "value": "VpnGw4AZ"
                                            },
                                            {
                                                "label": "VpnGw5AZ",
                                                "description": "Supports BGP, max 30 S2S/VNet-VNet tunnels, max 128 P2S SSTP connections, max 10000 IKEv2/OpenVPN connections, aggregate throughput is 10 Gbps",
                                                "value": "VpnGw5AZ"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "gwRegionalSkuSecondary",
                                    "type": "Microsoft.Common.DropDown",
                                    "label": "Select the VPN Gateway SKU for your second region",
                                    "defaultValue": "",
                                    "multiselect": false,
                                    "selectAll": false,
                                    "filter": false,
                                    "multiLine": true,
                                    "visible": "[and(and(equals(steps('connectivity').esNetworkSecondarySubSection.enableVpnGwSecondary, 'Yes'), not(equals(steps('connectivity').enableHub, 'vwan'))), equals(steps('connectivity').esNetworkSecondarySubSection.enableVpnGwSecondary,'Yes'), equals(steps('connectivity').esNetworkSecondarySubSection.gwRegionalOrAzSecondary, 'Regional'))]",
                                    "toolTip": "Select the required SKU for the VPN gateway.",
                                    "constraints": {
                                        "allowedValues": [
                                            {
                                                "label": "VpnGw2",
                                                "description": "Supports BGP, max 30 S2S/VNet-VNet tunnels, max 128 P2S SSTP connections, max 500 IKEv2/OpenVPN connections, aggregate throughput is 1.25 Gbps",
                                                "value": "VpnGw2"
                                            },
                                            {
                                                "label": "VpnGw3",
                                                "description": "Supports BGP, max 30 S2S/VNet-VNet tunnels, max 128 P2S SSTP connections, max 1000 IKEv2/OpenVPN connections, aggregate throughput is 2.5 Gbps",
                                                "value": "VpnGw3"
                                            },
                                            {
                                                "label": "VpnGw4",
                                                "description": "Supports BGP, max 30 S2S/VNet-VNet tunnels, max 128 P2S SSTP connections, max 5000 IKEv2/OpenVPN connections, aggregate throughput is 5 Gbps",
                                                "value": "VpnGw4"
                                            },
                                            {
                                                "label": "VpnGw5",
                                                "description": "Supports BGP, max 30 S2S/VNet-VNet tunnels, max 128 P2S SSTP connections, max 10000 IKEv2/OpenVPN connections, aggregate throughput is 10 Gbps",
                                                "value": "VpnGw5"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "vpnGateWayScaleUnitSecondary",
                                    "type": "Microsoft.Common.DropDown",
                                    "label": "Select the VPN Gateway scale unit for your second region",
                                    "defaultValue": "",
                                    "multiselect": false,
                                    "selectAll": false,
                                    "filter": false,
                                    "multiLine": true,
                                    "visible": "[and(equals(steps('connectivity').esNetworkSecondarySubSection.enableVpnGwSecondary, 'Yes'), equals(steps('connectivity').enableHub, 'vwan'))]",
                                    "toolTip": "Select the VPN Gateway scale unit",
                                    "constraints": {
                                        "allowedValues": [
                                            {
                                                "label": "1 scale unit",
                                                "description": "Supports 500 Mbps x2",
                                                "value": "1"
                                            },
                                            {
                                                "label": "2 scale units",
                                                "description": "Supports 1 Gbps x 2",
                                                "value": "2"
                                            },
                                            {
                                                "label": "3 scale units",
                                                "description": "Supports 1.5 Gbps x 2",
                                                "value": "3"
                                            },
                                            {
                                                "label": "4 scale units",
                                                "description": "Supports 2 Gbps x 2",
                                                "value": "4"
                                            },
                                            {
                                                "label": "5 scale units",
                                                "description": "Supports 2.5 Gbps x 2",
                                                "value": "5"
                                            },
                                            {
                                                "label": "6 scale units",
                                                "description": "Supports 3 Gbps x 2",
                                                "value": "6"
                                            },
                                            {
                                                "label": "7 scale units",
                                                "description": "Supports 3.5 Gbps x 2",
                                                "value": "7"
                                            },
                                            {
                                                "label": "8 scale units",
                                                "description": "Supports 4 Gbps x 2",
                                                "value": "8"
                                            },
                                            {
                                                "label": "9 scale units",
                                                "description": "Supports 4.5 Gbps x 2",
                                                "value": "9"
                                            },
                                            {
                                                "label": "10 scale units",
                                                "description": "Supports 5 Gbps x 2",
                                                "value": "10"
                                            },
                                            {
                                                "label": "11 scale units",
                                                "description": "Supports 5.5 Gbps x 2",
                                                "value": "11"
                                            },
                                            {
                                                "label": "12 scale units",
                                                "description": "Supports 6 Gbps x 2",
                                                "value": "12"
                                            },
                                            {
                                                "label": "13 scale units",
                                                "description": "Supports 6.5 Gbps x 2",
                                                "value": "13"
                                            },
                                            {
                                                "label": "14 scale units",
                                                "description": "Supports 7 Gbps x 2",
                                                "value": "14"
                                            },
                                            {
                                                "label": "15 scale units",
                                                "description": "Supports 7.5 Gbps x 2",
                                                "value": "15"
                                            },
                                            {
                                                "label": "16 scale units",
                                                "description": "Supports 8 Gbps x 2",
                                                "value": "16"
                                            },
                                            {
                                                "label": "17 scale units",
                                                "description": "Supports 8.5 Gbps x 2",
                                                "value": "17"
                                            },
                                            {
                                                "label": "18 scale units",
                                                "description": "Supports 9 Gbps x 2",
                                                "value": "18"
                                            },
                                            {
                                                "label": "19 scale units",
                                                "description": "Supports 9.5 Gbps x 2",
                                                "value": "19"
                                            },
                                            {
                                                "label": "20 scale units",
                                                "description": "Supports 10 Gbps x 2",
                                                "value": "20"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "subnetMaskForGwSecondary",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Subnet for VPN/ExpressRoute Gateways in your second region",
                                    "toolTip": "Provide address prefix in CIDR notation (e.g 10.200.1.0/24)",
                                    "defaultValue": "10.200.1.0/24",
                                    "visible": "[and(not(equals(steps('connectivity').enableHub, 'vwan')), or(equals(steps('connectivity').esNetworkSecondarySubSection.enableErGwSecondary, 'Yes'),equals(steps('connectivity').esNetworkSecondarySubSection.enableVpnGwSecondary, 'Yes')))]",
                                    "constraints": {
                                        "required": true,
                                        "validations": [
                                            {
                                                "regex": "^(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:\/(2[0-7]))$",
                                                "message": "Invalid CIDR range. The address prefix must be in the range [20,27]."
                                            },
                                            {
                                                "isValid": "[if(greaterOrEquals(last(split(steps('connectivity').esNetworkSecondarySubSection.esAddressHubHSSecondary, '/')), 8), equals(last(take(split(first(split(steps('connectivity').esNetworkSecondarySubSection.esAddressHubHSSecondary, '/')), '.'), 1)), last(take(split(first(split(steps('connectivity').esNetworkSecondarySubSection.subnetMaskForGwSecondary, '/')), '.'), 1))), true)]",
                                                "message": "CIDR range not within virtual network CIDR range (first octet)."
                                            },
                                            {
                                                "isValid": "[if(greaterOrEquals(last(split(steps('connectivity').esNetworkSecondarySubSection.esAddressHubHSSecondary, '/')), 16), equals(last(take(split(first(split(steps('connectivity').esNetworkSecondarySubSection.esAddressHubHSSecondary, '/')), '.'), 2)), last(take(split(first(split(steps('connectivity').esNetworkSecondarySubSection.subnetMaskForGwSecondary, '/')), '.'), 2))), true)]",
                                                "message": "CIDR range not within virtual network CIDR range (second octet)."
                                            },
                                            {
                                                "isValid": "[if(greaterOrEquals(last(split(steps('connectivity').esNetworkSecondarySubSection.esAddressHubHSSecondary, '/')), 24), equals(last(take(split(first(split(steps('connectivity').esNetworkSecondarySubSection.esAddressHubHSSecondary, '/')), '.'), 3)), last(take(split(first(split(steps('connectivity').esNetworkSecondarySubSection.subnetMaskForGwSecondary, '/')), '.'), 3))), true)]",
                                                "message": "CIDR range not within virtual network CIDR range (third octet)."
                                            },
                                            {
                                                "isValid": "[lessOrEquals(last(split(steps('connectivity').esNetworkSecondarySubSection.esAddressHubHSSecondary, '/')), last(split(steps('connectivity').esNetworkSecondarySubSection.subnetMaskForGwSecondary, '/')))]",
                                                "message": "CIDR range not within virtual network CIDR range (subnet mask)."
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "enableErGwSecondary",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "label": "Deploy ExpressRoute Gateway in your second region",
                                    "defaultValue": "No",
                                    "visible": "[and(not(equals(steps('connectivity').enableHub, 'No')), not(equals(steps('connectivity').enableHub, 'No')))]",
                                    "toolTip": "If 'Yes' is selected when also adding a subscription for connectivity, ARM will deploy Express Route gateway",
                                    "constraints": {
                                        "allowedValues": [
                                            {
                                                "label": "Yes",
                                                "value": "Yes"
                                            },
                                            {
                                                "label": "No",
                                                "value": "No"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "erRegionalOrAzSecondary",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "label": "Deploy zone redundant or regional ExpressRoute Gateway in your second region",
                                    "defaultValue": "Zone redundant (recommended)",
                                    "visible": "[and(and(equals(steps('connectivity').esNetworkSecondarySubSection.enableErGwSecondary, 'Yes'), not(equals(steps('connectivity').enableHub, 'vwan'))),equals(steps('connectivity').esNetworkSecondarySubSection.enableErGwSecondary,'Yes'),contains(split('brazilsouth,canadacentral,centralus,eastus,eastus2,southcentralus,westus2,westus3,francecentral,germanywestcentral,northeurope,norwayeast,uksouth,westeurope,swedencentral,switzerlandnorth,qatarcentral,uaenorth,southafricanorth,australiaeast,centralindia,japaneast,koreacentral,southeastasia,eastasia,italynorth', ','), steps('connectivity').esNetworkSecondarySubSection.connectivityLocationSecondary))]",
                                    "toolTip": "If 'Yes' is selected when also adding a subscription for connectivity, ARM will deploy Express Route Gateway to the selected region and availability zones.",
                                    "constraints": {
                                        "allowedValues": [
                                            {
                                                "label": "Zone redundant (recommended)",
                                                "value": "Zone"
                                            },
                                            {
                                                "label": "Regional",
                                                "value": "Regional"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "erAzSkuSecondary",
                                    "type": "Microsoft.Common.DropDown",
                                    "label": "Select the ExpressRoute Gateway SKU for your second region",
                                    "defaultValue": "",
                                    "multiselect": false,
                                    "selectAll": false,
                                    "filter": false,
                                    "multiLine": true,
                                    "visible": "[and(and(equals(steps('connectivity').esNetworkSecondarySubSection.enableErGwSecondary, 'Yes'), not(equals(steps('connectivity').enableHub, 'vwan'))),equals(steps('connectivity').esNetworkSecondarySubSection.enableErGwSecondary,'Yes'), equals(steps('connectivity').esNetworkSecondarySubSection.erRegionalOrAzSecondary, 'Zone'), contains(split('brazilsouth,canadacentral,centralus,eastus,eastus2,southcentralus,westus2,westus3,francecentral,germanywestcentral,northeurope,norwayeast,uksouth,westeurope,swedencentral,switzerlandnorth,qatarcentral,uaenorth,southafricanorth,australiaeast,centralindia,japaneast,koreacentral,southeastasia,eastasia,italynorth', ','), steps('connectivity').esNetworkSecondarySubSection.connectivityLocationSecondary))]",
                                    "toolTip": "Select the required SKU for the Express Route gateway.",
                                    "constraints": {
                                        "allowedValues": [
                                            {
                                                "label": "ErGw1AZ",
                                                "description": "Megabits per second 1000, packets per second 100,000, connections per second 7000, max number of cicuit connections is 4",
                                                "value": "ErGw1AZ"
                                            },
                                            {
                                                "label": "ErGw2AZ",
                                                "description": "Megabits per second 2000, packets per second 250,000, connections per second 14000, max number of cicuit connections is 8",
                                                "value": "ErGw2AZ"
                                            },
                                            {
                                                "label": "ErGw3AZ",
                                                "description": "Megabits per second 10,000, packets per second 1,000,000, connections per second 28,000, max number of cicuit connections is 16",
                                                "value": "ErGw3AZ"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "erRegionalSkuSecondary",
                                    "type": "Microsoft.Common.DropDown",
                                    "label": "Select the ExpressRoute Gateway SKU for your second region",
                                    "defaultValue": "",
                                    "multiselect": false,
                                    "selectAll": false,
                                    "filter": false,
                                    "multiLine": true,
                                    "visible": "[and(and(equals(steps('connectivity').esNetworkSecondarySubSection.enableErGwSecondary, 'Yes'), not(equals(steps('connectivity').enableHub, 'vwan'))), equals(steps('connectivity').esNetworkSecondarySubSection.enableErGwSecondary,'Yes'), equals(steps('connectivity').esNetworkSecondarySubSection.erRegionalOrAzSecondary, 'Regional'), contains(split('brazilsouth,canadacentral,centralus,eastus,eastus2,southcentralus,westus2,westus3,francecentral,germanywestcentral,northeurope,norwayeast,uksouth,westeurope,swedencentral,switzerlandnorth,qatarcentral,uaenorth,southafricanorth,australiaeast,centralindia,japaneast,koreacentral,southeastasia,eastasia,italynorth', ','), steps('connectivity').esNetworkSecondarySubSection.connectivityLocationSecondary))]",
                                    "toolTip": "Select the required SKU for the Express Route gateway.",
                                    "constraints": {
                                        "allowedValues": [
                                            {
                                                "label": "Standard",
                                                "description": "Megabits per second 1000, packets per second 100,000, connections per second 7000, max number of cicuit connections is 4",
                                                "value": "Standard"
                                            },
                                            {
                                                "label": "HighPerformance",
                                                "description": "Megabits per second 2000, packets per second 250,000, connections per second 14000, max number of cicuit connections is 8",
                                                "value": "HighPerformance"
                                            },
                                            {
                                                "label": "UltraPerformance",
                                                "description": "Megabits per second 10,000, packets per second 1,000,000, connections per second 28,000, max number of cicuit connections is 16",
                                                "value": "UltraPerformance"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "esErNoAzSkuSecondary",
                                    "type": "Microsoft.Common.DropDown",
                                    "label": "Select the ExpressRoute Gateway SKU for your second region",
                                    "defaultValue": "",
                                    "multiselect": false,
                                    "selectAll": false,
                                    "filter": false,
                                    "multiLine": true,
                                    "visible": "[and(and(equals(steps('connectivity').enableErGw, 'Yes'), not(equals(steps('connectivity').enableHub, 'vwan'))),equals(steps('connectivity').enableErGw,'Yes'), not(contains(split('canadacentral,centralus,eastus,eastus2,southcentralus,westus2,francecentral,germanywestcentral,northeurope,westeurope,uksouth,southafricanorth,japaneast,southeastasia,australiaeast,italynorth', ','), steps('connectivity').connectivityLocation)))]",
                                    "toolTip": "Select the required SKU for the Express Route gateway.",
                                    "constraints": {
                                        "allowedValues": [
                                            {
                                                "label": "Standard",
                                                "description": "Megabits per second 1000, packets per second 100,000, connections per second 7000, max number of cicuit connections is 4",
                                                "value": "Standard"
                                            },
                                            {
                                                "label": "HighPerformance",
                                                "description": "Megabits per second 2000, packets per second 250,000, connections per second 14000, max number of cicuit connections is 8",
                                                "value": "HighPerformance"
                                            },
                                            {
                                                "label": "UltraPerformance",
                                                "description": "Megabits per second 10,000, packets per second 1,000,000, connections per second 28,000, max number of cicuit connections is 16",
                                                "value": "UltraPerformance"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "expressRouteScaleUnitSecondary",
                                    "type": "Microsoft.Common.DropDown",
                                    "label": "Select the ExpressRoute Gateway scale unit for your second region",
                                    "defaultValue": "",
                                    "multiselect": false,
                                    "selectAll": false,
                                    "filter": false,
                                    "multiLine": true,
                                    "visible": "[and(equals(steps('connectivity').esNetworkSecondarySubSection.enableErGwSecondary, 'Yes'), equals(steps('connectivity').enableHub, 'vwan'))]",
                                    "toolTip": "Select the ExpressRoute Gateway scale unit",
                                    "constraints": {
                                        "allowedValues": [
                                            {
                                                "label": "1 scale unit",
                                                "description": "Supports 2 Gbps",
                                                "value": "1"
                                            },
                                            {
                                                "label": "2 scale units",
                                                "description": "Supports 4 Gbps",
                                                "value": "2"
                                            },
                                            {
                                                "label": "3 scale units",
                                                "description": "Supports 6 Gbps",
                                                "value": "3"
                                            },
                                            {
                                                "label": "4 scale units",
                                                "description": "Supports 8 Gbps",
                                                "value": "4"
                                            },
                                            {
                                                "label": "5 scale units",
                                                "description": "Supports 10 Gbps",
                                                "value": "5"
                                            },
                                            {
                                                "label": "6 scale units",
                                                "description": "Supports 12 Gbps",
                                                "value": "6"
                                            },
                                            {
                                                "label": "7 scale units",
                                                "description": "Supports 14 Gbps",
                                                "value": "7"
                                            },
                                            {
                                                "label": "8 scale units",
                                                "description": "Supports 16 Gbps",
                                                "value": "8"
                                            },
                                            {
                                                "label": "9 scale units",
                                                "description": "Supports 18 Gbps",
                                                "value": "9"
                                            },
                                            {
                                                "label": "10 scale units",
                                                "description": "Supports 20 Gbps",
                                                "value": "10"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "enableAzFwSecondary",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "label": "Deploy Azure Firewall in your second region",
                                    "defaultValue": "Yes (recommended)",
                                    "visible": "[or(equals(steps('connectivity').enableHub, 'vhub'), equals(steps('connectivity').enableHub, 'vwan'))]",
                                    "toolTip": "If 'Yes' is selected when also adding a subscription for connectivity, ARM will deploy Azure Firewall",
                                    "constraints": {
                                        "allowedValues": [
                                            {
                                                "label": "Yes (recommended)",
                                                "value": "Yes"
                                            },
                                            {
                                                "label": "No",
                                                "value": "No"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "firewallSkuSecondary",
                                    "type": "Microsoft.Common.DropDown",
                                    "label": "Select Azure Firewall tier for your second region",
                                    "defaultValue": "Premium",
                                    "multiselect": false,
                                    "selectAll": false,
                                    "filter": false,
                                    "multiLine": true,
                                    "visible": "[equals(steps('connectivity').esNetworkSecondarySubSection.enableAzFwSecondary, 'Yes')]",
                                    "toolTip": "Select Azure Firewall tier",
                                    "constraints": {
                                        "allowedValues": [
                                            {
                                                "label": "Basic",
                                                "description": "Basic Azure Firewall",
                                                "value": "Basic"
                                            },
                                            {
                                                "label": "Standard",
                                                "description": "Standard Azure Firewall",
                                                "value": "Standard"
                                            },
                                            {
                                                "label": "Premium",
                                                "description": "Premium Azure Firewall adds support for TLS inspection, IDPS, URL filtering and web categories.",
                                                "value": "Premium"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "esFWAZNoteSecondary",
                                    "type": "Microsoft.Common.InfoBox",
                                    "visible": "[if(or(equals(steps('connectivity').enableHub, 'vhub'), equals(steps('connectivity').enableHub, 'vwan')), and(equals(steps('connectivity').esNetworkSecondarySubSection.enableAzFwSecondary,'Yes'), contains(split('brazilsouth,canadacentral,centralus,eastus,eastus2,southcentralus,westus2,westus3,francecentral,germanywestcentral,northeurope,norwayeast,uksouth,westeurope,swedencentral,switzerlandnorth,qatarcentral,uaenorth,southafricanorth,australiaeast,centralindia,japaneast,koreacentral,southeastasia,eastasia,italynorth', ','), steps('connectivity').esNetworkSecondarySubSection.connectivityLocationSecondary)), false)]",
                                    "options": {
                                        "text": "ALZ enables Availability Zones for all services that it deploys by default for maximum resiliency in regions where Availability Zones are supported, including for Azure Firewall. Review the selected Availability Zones meet your architectural requirements and that you understand the added costs for inbound and outbound data transfers associated with Avaialability Zones, before proceeding. Click on this box to learn more about the Availability Zones and Azure Firewall.",
                                        "uri": "https://learn.microsoft.com/en-us/azure/firewall/features#built-in-high-availability",
                                        "style": "Info"
                                    }
                                },
                                {
                                    "name": "firewallZonesSecondary",
                                    "type": "Microsoft.Common.DropDown",
                                    "label": "Select Availability Zones for the Azure Firewall in your second region",
                                    "defaultValue": [{"value": "1"}, {"value": "2"}, {"value": "3"}],
                                    "multiselect": true,
                                    "selectAll": true,
                                    "filter": true,
                                    "visible": "[if(or(equals(steps('connectivity').enableHub, 'vhub'), equals(steps('connectivity').enableHub, 'vwan')), and(equals(steps('connectivity').esNetworkSecondarySubSection.enableAzFwSecondary,'Yes'), contains(split('brazilsouth,canadacentral,centralus,eastus,eastus2,southcentralus,westus2,westus3,francecentral,germanywestcentral,northeurope,norwayeast,uksouth,westeurope,swedencentral,switzerlandnorth,qatarcentral,uaenorth,southafricanorth,australiaeast,centralindia,japaneast,koreacentral,southeastasia,eastasia,italynorth', ','), steps('connectivity').esNetworkSecondarySubSection.connectivityLocationSecondary)), false)]",
                                    "toolTip": "If 'Yes' is selected when also adding a subscription for connectivity, ARM will deploy Azure Firewall to the selected region and availability zones.",
                                    "constraints": {
                                        "allowedValues": [
                                            {
                                                "label": "Zone 1",
                                                "value": "1"
                                            },
                                            {
                                                "label": "Zone 2",
                                                "value": "2"
                                            },
                                            {
                                                "label": "Zone 3",
                                                "value": "3"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "subnetMaskForAzFwSecondary",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Subnet for Azure Firewall in your second region",
                                    "toolTip": "Provide address prefix in CIDR notation (e.g 10.200.0.0/24)",
                                    "defaultValue": "10.200.0.0/24",
                                    "visible": "[and(equals(steps('connectivity').esNetworkSecondarySubSection.enableAzFwSecondary, 'Yes'), not(equals(steps('connectivity').enableHub, 'vwan')))]",
                                    "constraints": {
                                        "required": true,
                                        "validations": [
                                            {
                                                "regex": "^(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:\/(2[0-6]))$",
                                                "message": "Invalid CIDR range. The address prefix must be in the range [20,26]."
                                            },
                                            {
                                                "isValid": "[if(greaterOrEquals(last(split(steps('connectivity').esNetworkSecondarySubSection.esAddressHubHSSecondary, '/')), 8), equals(last(take(split(first(split(steps('connectivity').esNetworkSecondarySubSection.esAddressHubHSSecondary, '/')), '.'), 1)), last(take(split(first(split(steps('connectivity').esNetworkSecondarySubSection.subnetMaskForAzFwSecondary, '/')), '.'), 1))), true)]",
                                                "message": "CIDR range not within virtual network CIDR range (first octet)."
                                            },
                                            {
                                                "isValid": "[if(greaterOrEquals(last(split(steps('connectivity').esNetworkSecondarySubSection.esAddressHubHSSecondary, '/')), 16), equals(last(take(split(first(split(steps('connectivity').esNetworkSecondarySubSection.esAddressHubHSSecondary, '/')), '.'), 2)), last(take(split(first(split(steps('connectivity').esNetworkSecondarySubSection.subnetMaskForAzFwSecondary, '/')), '.'), 2))), true)]",
                                                "message": "CIDR range not within virtual network CIDR range (second octet)."
                                            },
                                            {
                                                "isValid": "[if(greaterOrEquals(last(split(steps('connectivity').esNetworkSecondarySubSection.esAddressHubHSSecondary, '/')), 24), equals(last(take(split(first(split(steps('connectivity').esNetworkSecondarySubSection.esAddressHubHSSecondary, '/')), '.'), 3)), last(take(split(first(split(steps('connectivity').esNetworkSecondarySubSection.subnetMaskForAzFwSecondary, '/')), '.'), 3))), true)]",
                                                "message": "CIDR range not within virtual network CIDR range (third octet)."
                                            },
                                            {
                                                "isValid": "[lessOrEquals(last(split(steps('connectivity').esNetworkSecondarySubSection.esAddressHubHSSecondary, '/')), last(split(steps('connectivity').esNetworkSecondarySubSection.subnetMaskForAzFwSecondary, '/')))]",
                                                "message": "CIDR range not within virtual network CIDR range (subnet mask)."
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "subnetMaskForAzFwMgmtSecondary",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Subnet for Azure Firewall Mgmt (Optional Only for Basic SKU) in your second region",
                                    "toolTip": "Provide address prefix in CIDR notation (e.g 10.200.0.0/26)",
                                    "defaultValue": "10.200.2.0/24",
                                    "visible": "[and(equals(steps('connectivity').esNetworkSecondarySubSection.enableAzFwSecondary, 'Yes'), equals(steps('connectivity').esNetworkSecondarySubSection.firewallSkuSecondary, 'Basic'), not(equals(steps('connectivity').enableHub, 'vwan')))]",
                                    "constraints": {
                                        "required": true,
                                        "validations": [
                                            {
                                                "regex": "^(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:\/(2[0-6]))$",
                                                "message": "Invalid CIDR range. The address prefix must be in the range [20,26]."
                                            },
                                            {
                                                "isValid": "[if(greaterOrEquals(last(split(steps('connectivity').esNetworkSecondarySubSection.esAddressHubHSSecondary, '/')), 8), equals(last(take(split(first(split(steps('connectivity').esNetworkSecondarySubSection.esAddressHubHSSecondary, '/')), '.'), 1)), last(take(split(first(split(steps('connectivity').esNetworkSecondarySubSection.subnetMaskForAzFwSecondary, '/')), '.'), 1))), true)]",
                                                "message": "CIDR range not within virtual network CIDR range (first octet)."
                                            },
                                            {
                                                "isValid": "[if(greaterOrEquals(last(split(steps('connectivity').esNetworkSecondarySubSection.esAddressHubHSSecondary, '/')), 16), equals(last(take(split(first(split(steps('connectivity').esNetworkSecondarySubSection.esAddressHubHSSecondary, '/')), '.'), 2)), last(take(split(first(split(steps('connectivity').esNetworkSecondarySubSection.subnetMaskForAzFwSecondary, '/')), '.'), 2))), true)]",
                                                "message": "CIDR range not within virtual network CIDR range (second octet)."
                                            },
                                            {
                                                "isValid": "[if(greaterOrEquals(last(split(steps('connectivity').esNetworkSecondarySubSection.esAddressHubHSSecondary, '/')), 24), equals(last(take(split(first(split(steps('connectivity').esNetworkSecondarySubSection.esAddressHubHSSecondary, '/')), '.'), 3)), last(take(split(first(split(steps('connectivity').esNetworkSecondarySubSection.subnetMaskForAzFwSecondary, '/')), '.'), 3))), true)]",
                                                "message": "CIDR range not within virtual network CIDR range (third octet)."
                                            },
                                            {
                                                "isValid": "[lessOrEquals(last(split(steps('connectivity').esNetworkSecondarySubSection.esAddressHubHSSecondary, '/')), last(split(steps('connectivity').esNetworkSecondarySubSection.subnetMaskForAzFwSecondary, '/')))]",
                                                "message": "CIDR range not within virtual network CIDR range (subnet mask)."
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "enableAzFwDnsProxySecondary",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "label": "Enable Azure Firewall as a DNS proxy in your second region",
                                    "defaultValue": "No",
                                    "visible": "[and(equals(steps('connectivity').esNetworkSecondarySubSection.enableAzFwSecondary, 'Yes'), not(equals(steps('connectivity').esNetworkSecondarySubSection.firewallSkuSecondary, 'Basic')))]",
                                    "toolTip": "If 'Yes' is selected when also adding a subscription for connectivity, ARM will enable Azure Firewall as a DNS Proxy.",
                                    "constraints": {
                                        "allowedValues": [
                                            {
                                                "label": "Yes",
                                                "value": "Yes"
                                            },
                                            {
                                                "label": "No",
                                                "value": "No"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "enablevWANRoutingIntentSecondary",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "label": "Enable vWAN Routing Intent in your second",
                                    "defaultValue": "No",
                                    "visible": "[and(not(equals(steps('connectivity').enableHub, 'No')), not(equals(steps('connectivity').enableHub, 'nva')), not(equals(steps('connectivity').enableHub, 'vhub')), equals(steps('connectivity').esNetworkSecondarySubSection.enableAzFwSecondary, 'Yes'))]",
                                    "toolTip": "Enable vWan Routing Intent and set Azure Firewall as the next hop either for Internet Traffic, Private Traffic or both",
                                    "constraints": {
                                        "allowedValues": [
                                            {
                                                "label": "Yes",
                                                "value": "Yes"
                                            },
                                            {
                                                "label": "No",
                                                "value": "No"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "vWANRoutingIntentforInternetTrafficSecondary",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "label": "Select Yes if you want to enable routing intent policy to apply on Internet Traffic for your second region",
                                    "defaultValue": "No",
                                    "visible": "[and(not(equals(steps('connectivity').enableHub, 'No')), not(equals(steps('connectivity').enableHub, 'nva')), not(equals(steps('connectivity').enableHub, 'vhub')), equals(steps('connectivity').enableAzFw, 'Yes'),equals(steps('connectivity').esNetworkSecondarySubSection.enablevWANRoutingIntentSecondary, 'Yes'))]",
                                    "toolTip": "Enable vWAN Routing Intent for Internet Traffic",
                                    "constraints": {
                                        "allowedValues": [
                                            {
                                                "label": "Yes",
                                                "value": "Yes"
                                            },
                                            {
                                                "label": "No",
                                                "value": "No"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "vWANRoutingIntentforPrivateTrafficSecondary",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "label": "Select Yes if you want to enable routing intent policy to apply on Private Traffic",
                                    "defaultValue": "No",
                                    "visible": "[and(not(equals(steps('connectivity').enableHub, 'No')), not(equals(steps('connectivity').enableHub, 'nva')), not(equals(steps('connectivity').enableHub, 'vhub')), equals(steps('connectivity').esNetworkSecondarySubSection.enableAzFwSecondary, 'Yes'),equals(steps('connectivity').esNetworkSecondarySubSection.enablevWANRoutingIntentSecondary, 'Yes'))]",
                                    "toolTip": "Enable vWAN Routing Intent for Private Traffic for your second region",
                                    "constraints": {
                                        "allowedValues": [
                                            {
                                                "label": "Yes",
                                                "value": "Yes"
                                            },
                                            {
                                                "label": "No",
                                                "value": "No"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "vWANHubRoutingPreferenceSecondary",
                                    "type": "Microsoft.Common.DropDown",
                                    "label": "Hub Routing Preference for secondary region",
                                    "defaultValue": "ExpressRoute (default)",
                                    "multiselect": false,
                                    "selectAll": false,
                                    "filter": false,
                                    "multiLine": true,
                                    "visible": "[and(not(equals(steps('connectivity').enableHub, 'No')), not(equals(steps('connectivity').enableHub, 'nva')), not(equals(steps('connectivity').enableHub, 'vhub')), not(equals(steps('connectivity').enableHub, 'No')), not(equals(steps('connectivity').enableHub, 'nva')), not(equals(steps('connectivity').enableHub, 'vhub')))]",
                                    "toolTip": "Preference used in selecting best path when the virtual hub learns multiple paths to the same destination route-prefix.<a href=\"https://learn.microsoft.com/azure/virtual-wan/about-virtual-hub-routing-preference\">Virtual hub routing preference</a>.",
                                    "constraints": {
                                        "allowedValues": [
                                            {
                                                "label": "ExpressRoute (default)",
                                                "description": "ExpressRoute is the preferred path. (default)",
                                                "value": "ExpressRoute"
                                            },
                                            {
                                                "label": "VPN",
                                                "description": "VPN is the preferred path",
                                                "value": "VpnGateway"
                                            },
                                            {
                                                "label": "AS Path",
                                                "description": "AS Path is the preferred path",
                                                "value": "ASPath"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "vWANHubCapacitySecondary",
                                    "type": "Microsoft.Common.DropDown",
                                    "label": "Virtual Hub Capacity in second region",
                                    "defaultValue": "",
                                    "multiselect": false,
                                    "selectAll": false,
                                    "filter": false,
                                    "multiLine": true,
                                    "visible": "[and(not(equals(steps('connectivity').enableHub, 'No')), not(equals(steps('connectivity').enableHub, 'nva')), not(equals(steps('connectivity').enableHub, 'vhub')), not(equals(steps('connectivity').enableHub, 'No')), not(equals(steps('connectivity').enableHub, 'nva')), not(equals(steps('connectivity').enableHub, 'vhub')))]",
                                    "toolTip": "Routing infrastructure units determine the minimum throughput of the Virtual WAN hub router and the number of Virtual Machines that can be deployed in Virtual Networks connected to the Virtual WAN hub. Two routing infrastructure units are included at no extra cost with a deployment of a hub.<a href=\"https://learn.microsoft.com/azure/virtual-wan/hub-settings#capacity\">Virtual Hub Capacity</a>.",
                                    "constraints": {
                                        "allowedValues": [
                                            {
                                                "label": "2",
                                                "description": "2 Routing Infrastructure Units, 3 Gbps Aggregate Throughput, Supports 2000 VMs",
                                                "value": "2"
                                            },
                                            {
                                                "label": "3",
                                                "description": "3 Routing Infrastructure Units, 3 Gbps Aggregate Throughput, Supports 3000 VMs",
                                                "value": "3"
                                            },
                                            {
                                                "label": "4",
                                                "description": "4 Routing Infrastructure Units, 4 Gbps Aggregate Throughput, Supports 4000 VMs",
                                                "value": "4"
                                            },
                                            {
                                                "label": "5",
                                                "description": "5 Routing Infrastructure Units, 5 Gbps Aggregate Throughput, Supports 5000 VMs",
                                                "value": "5"
                                            },
                                            {
                                                "label": "6",
                                                "description": "6 Routing Infrastructure Units, 6 Gbps Aggregate Throughput, Supports 6000 VMs",
                                                "value": "6"
                                            },
                                            {
                                                "label": "7",
                                                "description": "7 Routing Infrastructure Units, 7 Gbps Aggregate Throughput, Supports 7000 VMs",
                                                "value": "7"
                                            },
                                            {
                                                "label": "8",
                                                "description": "8 Routing Infrastructure Units, 8 Gbps Aggregate Throughput, Supports 8000 VMs",
                                                "value": "8"
                                            },
                                            {
                                                "label": "9",
                                                "description": "9 Routing Infrastructure Units, 9 Gbps Aggregate Throughput, Supports 9000 VMs",
                                                "value": "9"
                                            },
                                            {
                                                "label": "10",
                                                "description": "10 Routing Infrastructure Units, 10 Gbps Aggregate Throughput, Supports 10000 VMs",
                                                "value": "10"
                                            },
                                            {
                                                "label": "11",
                                                "description": "11 Routing Infrastructure Units, 11 Gbps Aggregate Throughput, Supports 11000 VMs",
                                                "value": "11"
                                            },
                                            {
                                                "label": "12",
                                                "description": "12 Routing Infrastructure Units, 12 Gbps Aggregate Throughput, Supports 12000 VMs",
                                                "value": "12"
                                            },
                                            {
                                                "label": "13",
                                                "description": "13 Routing Infrastructure Units, 13 Gbps Aggregate Throughput, Supports 13000 VMs",
                                                "value": "13"
                                            },
                                            {
                                                "label": "14",
                                                "description": "14 Routing Infrastructure Units, 14 Gbps Aggregate Throughput, Supports 14000 VMs",
                                                "value": "14"
                                            },
                                            {
                                                "label": "15",
                                                "description": "15 Routing Infrastructure Units, 15 Gbps Aggregate Throughput, Supports 15000 VMs",
                                                "value": "15"
                                            },
                                            {
                                                "label": "16",
                                                "description": "16 Routing Infrastructure Units, 16 Gbps Aggregate Throughput, Supports 16000 VMs",
                                                "value": "16"
                                            },
                                            {
                                                "label": "17",
                                                "description": "17 Routing Infrastructure Units, 17 Gbps Aggregate Throughput, Supports 17000 VMs",
                                                "value": "17"
                                            },
                                            {
                                                "label": "18",
                                                "description": "18 Routing Infrastructure Units, 18 Gbps Aggregate Throughput, Supports 18000 VMs",
                                                "value": "18"
                                            },
                                            {
                                                "label": "19",
                                                "description": "19 Routing Infrastructure Units, 19 Gbps Aggregate Throughput, Supports 19000 VMs",
                                                "value": "19"
                                            },
                                            {
                                                "label": "20",
                                                "description": "20 Routing Infrastructure Units, 20 Gbps Aggregate Throughput, Supports 20000 VMs",
                                                "value": "20"
                                            },
                                            {
                                                "label": "21",
                                                "description": "21 Routing Infrastructure Units, 21 Gbps Aggregate Throughput, Supports 21000 VMs",
                                                "value": "21"
                                            },
                                            {
                                                "label": "22",
                                                "description": "22 Routing Infrastructure Units, 22 Gbps Aggregate Throughput, Supports 22000 VMs",
                                                "value": "22"
                                            },
                                            {
                                                "label": "23",
                                                "description": "23 Routing Infrastructure Units, 23 Gbps Aggregate Throughput, Supports 23000 VMs",
                                                "value": "23"
                                            },
                                            {
                                                "label": "24",
                                                "description": "24 Routing Infrastructure Units, 24 Gbps Aggregate Throughput, Supports 24000 VMs",
                                                "value": "24"
                                            },
                                            {
                                                "label": "25",
                                                "description": "25 Routing Infrastructure Units, 25 Gbps Aggregate Throughput, Supports 25000 VMs",
                                                "value": "25"
                                            },
                                            {
                                                "label": "26",
                                                "description": "26 Routing Infrastructure Units, 26 Gbps Aggregate Throughput, Supports 26000 VMs",
                                                "value": "26"
                                            },
                                            {
                                                "label": "27",
                                                "description": "27 Routing Infrastructure Units, 27 Gbps Aggregate Throughput, Supports 27000 VMs",
                                                "value": "27"
                                            },
                                            {
                                                "label": "28",
                                                "description": "28 Routing Infrastructure Units, 28 Gbps Aggregate Throughput, Supports 28000 VMs",
                                                "value": "28"
                                            },
                                            {
                                                "label": "29",
                                                "description": "29 Routing Infrastructure Units, 29 Gbps Aggregate Throughput, Supports 29000 VMs",
                                                "value": "29"
                                            },
                                            {
                                                "label": "30",
                                                "description": "30 Routing Infrastructure Units, 30 Gbps Aggregate Throughput, Supports 30000 VMs",
                                                "value": "30"
                                            },
                                            {
                                                "label": "31",
                                                "description": "31 Routing Infrastructure Units, 31 Gbps Aggregate Throughput, Supports 31000 VMs",
                                                "value": "31"
                                            },
                                            {
                                                "label": "32",
                                                "description": "32 Routing Infrastructure Units, 32 Gbps Aggregate Throughput, Supports 32000 VMs",
                                                "value": "32"
                                            },
                                            {
                                                "label": "33",
                                                "description": "33 Routing Infrastructure Units, 33 Gbps Aggregate Throughput, Supports 33000 VMs",
                                                "value": "33"
                                            },
                                            {
                                                "label": "34",
                                                "description": "34 Routing Infrastructure Units, 34 Gbps Aggregate Throughput, Supports 34000 VMs",
                                                "value": "34"
                                            },
                                            {
                                                "label": "35",
                                                "description": "35 Routing Infrastructure Units, 35 Gbps Aggregate Throughput, Supports 35000 VMs",
                                                "value": "35"
                                            },
                                            {
                                                "label": "36",
                                                "description": "36 Routing Infrastructure Units, 36 Gbps Aggregate Throughput, Supports 36000 VMs",
                                                "value": "36"
                                            },
                                            {
                                                "label": "37",
                                                "description": "37 Routing Infrastructure Units, 37 Gbps Aggregate Throughput, Supports 37000 VMs",
                                                "value": "37"
                                            },
                                            {
                                                "label": "38",
                                                "description": "38 Routing Infrastructure Units, 38 Gbps Aggregate Throughput, Supports 38000 VMs",
                                                "value": "38"
                                            },
                                            {
                                                "label": "39",
                                                "description": "39 Routing Infrastructure Units, 39 Gbps Aggregate Throughput, Supports 39000 VMs",
                                                "value": "39"
                                            },
                                            {
                                                "label": "40",
                                                "description": "40 Routing Infrastructure Units, 40 Gbps Aggregate Throughput, Supports 40000 VMs",
                                                "value": "40"
                                            },
                                            {
                                                "label": "41",
                                                "description": "41 Routing Infrastructure Units, 41 Gbps Aggregate Throughput, Supports 41000 VMs",
                                                "value": "41"
                                            },
                                            {
                                                "label": "42",
                                                "description": "42 Routing Infrastructure Units, 42 Gbps Aggregate Throughput, Supports 42000 VMs",
                                                "value": "42"
                                            },
                                            {
                                                "label": "43",
                                                "description": "43 Routing Infrastructure Units, 43 Gbps Aggregate Throughput, Supports 43000 VMs",
                                                "value": "43"
                                            },
                                            {
                                                "label": "44",
                                                "description": "44 Routing Infrastructure Units, 44 Gbps Aggregate Throughput, Supports 44000 VMs",
                                                "value": "44"
                                            },
                                            {
                                                "label": "45",
                                                "description": "45 Routing Infrastructure Units, 45 Gbps Aggregate Throughput, Supports 45000 VMs",
                                                "value": "45"
                                            },
                                            {
                                                "label": "46",
                                                "description": "46 Routing Infrastructure Units, 46 Gbps Aggregate Throughput, Supports 46000 VMs",
                                                "value": "46"
                                            },
                                            {
                                                "label": "47",
                                                "description": "47 Routing Infrastructure Units, 47 Gbps Aggregate Throughput, Supports 47000 VMs",
                                                "value": "47"
                                            },
                                            {
                                                "label": "48",
                                                "description": "48 Routing Infrastructure Units, 48 Gbps Aggregate Throughput, Supports 48000 VMs",
                                                "value": "48"
                                            },
                                            {
                                                "label": "49",
                                                "description": "49 Routing Infrastructure Units, 49 Gbps Aggregate Throughput, Supports 49000 VMs",
                                                "value": "49"
                                            },
                                            {
                                                "label": "50",
                                                "description": "50 Routing Infrastructure Units, 50 Gbps Aggregate Throughput, Supports 50000 VMs",
                                                "value": "50"
                                            }
                                        ]
                                    }
                                }
                                ]
                            }
                        ]
                },
                {
                    "name": "identity",
                    "label": "Identity",
                    "subLabel": {
                        "preValidation": "",
                        "postValidation": ""
                    },
                    "bladeTitle": "ALZ - Identity Settings",
                    "elements": [
                        {
                            "name": "multiPlatformIdentitySub",
                            "type": "Microsoft.Common.InfoBox",
                            "visible": "[not(equals(steps('core').platformSubscription, 'Single'))]",
                            "options": {
                                "text": "To enable identity (AuthN/AuthZ) for workloads in landing zones, you must allocate an identity Subscription that is dedicated to host your Active Directory domain controllers. Please note, this Subscription will be moved to the identity Management Group, and ARM will assign the selected policies. We recommend using a new Subscription with no existing resources.",
                                "uri": "https://docs.microsoft.com/azure/cloud-adoption-framework/ready/enterprise-scale/identity-and-access-management",
                                "style": "Info"
                            }
                        },
                        {
                            "name": "singlePlatformIdentitySub",
                            "type": "Microsoft.Common.InfoBox",
                            "visible": "[equals(steps('core').platformSubscription, 'Single')]",
                            "options": {
                                "text": "To enable identity (AuthN/AuthZ) for workloads in landing zones, it is recommended to assign specific policies to govern the virtual machines used for Active Directory domain controllers.",
                                "uri": "https://docs.microsoft.com/azure/cloud-adoption-framework/ready/enterprise-scale/identity-and-access-management",
                                "style": "Info"
                            }
                        },
                        {
                            "name": "esIdentity",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Assign recommended policies to govern identity and domain controllers",
                            "defaultValue": "Yes (recommended)",
                            "toolTip": "If 'Yes' is selected when also adding a subscription for connectivity, Azure Policy will be assigned at the scope to govern your identity resources.",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes (recommended)",
                                        "value": "Yes"
                                    },
                                    {
                                        "label": "No",
                                        "value": "No"
                                    }
                                ]
                            },
                            "visible": true
                        },
                        {
                            "name": "esIdentitySubSection",
                            "type": "Microsoft.Common.Section",
                            "label": "Identity subscription",
                            "elements": [
                                {
                                    "name": "esIdentitySubUniqueWarning",
                                    "type": "Microsoft.Common.InfoBox",
                                    "visible": true,
                                    "options": {
                                        "text": "Ensure you select a subscription that is dedicated/unique for Identity. Selecting the same Subscription here for Management or Connectivity will result in a deployment failure. If you want to use a single Subscription for all platform resources, select 'Single' on the 'Azure Core Setup' blade.",
                                        "uri": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-subscriptions#organization-and-governance-design-considerations",
                                        "style": "Warning"
                                    }
                                },
                                {
                                    "name": "esIdentitySub",
                                    "type": "Microsoft.Common.DropDown",
                                    "label": "Identity subscription",
                                    "defaultValue": "[parse('[]')]",
                                    "toolTip": "",
                                    "multiselect": false,
                                    "selectAll": false,
                                    "filter": true,
                                    "filterPlaceholder": "Filter subscriptions...",
                                    "multiLine": true,
                                    "visible": true,
                                    "constraints": {
                                        "allowedValues": "[steps('basics').getSubscriptions.data]",
                                        "required": true
                                    }
                                }
                            ],
                            "visible": "[and(equals(steps('identity').esIdentity,'Yes'), not(equals(steps('core').platformSubscription, 'Single')))]"
                        },
                        {
                            "name": "identitypolicies",
                            "type": "Microsoft.Common.TextBlock",
                            "visible": "[equals(steps('identity').esIdentity,'Yes')]",
                            "options": {
                                "text": "Select which of the the recommended policies you will assign to your identity management group.",
                                "link": {
                                    "label": "Learn more",
                                    "uri": "https://docs.microsoft.com/en-us/azure/cloud-adoption-framework/ready/enterprise-scale/design-principles#policy-driven-governance"
                                }
                            }
                        },
                        {
                            "name": "denyMgmtPortsForIdentity",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Prevent inbound management ports from internet",
                            "defaultValue": "Yes (recommended)",
                            "toolTip": "If 'Yes' is selected, Azure Policy will be assigned and prevent inbound management ports (22, 3389) from internet.<br>Uses the custom policy <a href=\"https://www.azadvertizer.net/azpolicyadvertizer/Deny-MgmtPorts-From-Internet.html\">Management port access from the Internet should be blocked</a>.",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes (recommended)",
                                        "value": "Yes"
                                    },
                                    {
                                        "label": "No",
                                        "value": "No"
                                    }
                                ]
                            },
                            "visible": "[equals(steps('identity').esIdentity,'Yes')]"
                        },
                        {
                            "name": "denySubnetWithoutNsgForIdentity",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Ensure subnets are associated with NSG",
                            "defaultValue": "Yes (recommended)",
                            "toolTip": "If 'Yes' is selected, Azure Policy will be assigned to ensure NSGs must be associated with subnets being created.<br>Uses the custom policy <a href=\"https://www.azadvertizer.net/azpolicyadvertizer/Deny-Subnet-Without-Nsg.html\">Subnets should have a Network Security Group</a>.",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes (recommended)",
                                        "value": "Yes"
                                    },
                                    {
                                        "label": "No",
                                        "value": "No"
                                    }
                                ]
                            },
                            "visible": "[equals(steps('identity').esIdentity,'Yes')]"
                        },
                        {
                            "name": "denyPipForIdentity",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Prevent usage of public IP",
                            "defaultValue": "Yes (recommended)",
                            "toolTip": "If 'Yes' is selected, Azure Policy will be assigned to ensure public IP resources cannot be created.<br>Uses the policy <a href=\"https://www.azadvertizer.net/azpolicyadvertizer/6c112d4e-5bc7-47ae-a041-ea2d9dccd749.html\">Not allowed resource types</a> with parameters including Public IP Address resources.",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes (recommended)",
                                        "value": "Yes"
                                    },
                                    {
                                        "label": "No",
                                        "value": "No"
                                    }
                                ]
                            },
                            "visible": "[and(equals(steps('identity').esIdentity,'Yes'), not(equals(steps('core').platformSubscription, 'Single')))]"
                        },
                        {
                            "name": "enableVmBackupForIdentity",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Ensure Azure VMs (Windows & Linux) are enabled for Azure Backup",
                            "defaultValue": "Yes (recommended)",
                            "toolTip": "If 'Yes' is selected, Azure Policy will be assigned and enable Azure Backup on all VMs in the landing zones.<br>Uses the policy <a href=\"https://www.azadvertizer.net/azpolicyadvertizer/98d0b9f8-fd90-49c9-88e2-d3baf3b0dd86.html\">Configure backup on virtual machines without a given tag to a new recovery services vault with a default policy</a>.",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes (recommended)",
                                        "value": "Yes"
                                    },
                                    {
                                        "label": "No",
                                        "value": "No"
                                    }
                                ]
                            },
                            "visible": "[equals(steps('identity').esIdentity,'Yes')]"
                        },
                        {
                            "name": "esIdentityConnectivity",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Create virtual network and connect to the connectivity hub (optional)?",
                            "defaultValue": "Yes (recommended)",
                            "toolTip": "If 'Yes' is selected for corp landing zones, ARM will connect the subscriptions to the hub virtual network via VNet peering.",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes (recommended)",
                                        "value": "Yes"
                                    },
                                    {
                                        "label": "No",
                                        "value": "No"
                                    }
                                ]
                            },
                            "visible": "[and(and(equals(steps('identity').esIdentity,'Yes'), not(equals(steps('core').platformSubscription, 'Single'))), equals(steps('identity').esIdentity, 'Yes'), not(equals(steps('connectivity').enableHub,'No')))]"
                        },
                        {
                            "name": "identityAddressPrefix",
                            "type": "Microsoft.Common.TextBox",
                            "label": "Virtual network address space",
                            "placeholder": "",
                            "defaultValue": "10.110.0.0/24",
                            "toolTip": "The virtual network's address space, specified as one address prefixes in CIDR notation (e.g. 192.168.1.0/24)",
                            "constraints": {
                                "required": true,
                                "validations": [
                                    {
                                        "regex": "^(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:\/(1[0-9]|2[0-9]))$",
                                        "message": "Invalid CIDR range. The address prefix must be in the range [10,29]."
                                    }
                                ]
                            },
                            "visible": "[and(equals(steps('identity').esIdentityConnectivity, 'Yes'), not(equals(steps('connectivity').enableHub,'No')))]"
                        },
                        { 
                            "name": "esIdentitySecondarySubSection",
                            "type": "Microsoft.Common.Section",
                            "label": "Secondary Region Identity",
                            "visible": "[and(not(equals(steps('connectivity').enableHub, 'No')), equals(steps('core').deploySecondaryRegion, 'Yes'))]",
                            "elements":[
                                {
                                    "name": "esIdentityConnectivitySecondary",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "label": "Create virtual network and connect to the connectivity hub in your secondary region (optional)?",
                                    "defaultValue": "Yes (recommended)",
                                    "toolTip": "If 'Yes' is selected for corp landing zones, ARM will connect the subscriptions to the hub virtual network via VNet peering.",
                                    "constraints": {
                                        "allowedValues": [
                                            {
                                                "label": "Yes (recommended)",
                                                "value": "Yes"
                                            },
                                            {
                                                "label": "No",
                                                "value": "No"
                                            }
                                        ]
                                    },
                                    "visible": "[and(equals(steps('identity').esIdentityConnectivity, 'Yes'), not(equals(steps('connectivity').enableHub,'No')))]"
                                },
                                {
                                    "name": "identityAddressPrefixSecondary",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Virtual network address space",
                                    "placeholder": "",
                                    "defaultValue": "10.210.0.0/24",
                                    "toolTip": "The secondary virtual network's address space, specified as one address prefixes in CIDR notation (e.g. 192.168.1.0/24)",
                                    "constraints": {
                                        "required": true,
                                        "validations": [
                                            {
                                                "regex": "^(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:\/(1[0-9]|2[0-9]))$",
                                                "message": "Invalid CIDR range. The address prefix must be in the range [10,29]."
                                            }
                                        ]
                                    },
                                    "visible": "[and(equals(steps('identity').esIdentitySecondarySubSection.esIdentityConnectivitySecondary, 'Yes'), not(equals(steps('connectivity').enableHub,'No')))]"
                                }
                            ]
                            }                      
                    ]
                },
                {
                    "name": "landingZones",
                    "label": "Landing zones configuration",
                    "subLabel": {
                        "preValidation": "",
                        "postValidation": ""
                    },
                    "bladeTitle": "ALZ - Landing Zones Settings",
                    "elements": [
                        {
                            "name": "infoBox1",
                            "type": "Microsoft.Common.InfoBox",
                            "visible": true,
                            "options": {
                                "text": "You can optionally provide subscriptions for your first landing zones for both 'online' and 'corp' and assign recommended policies for 'landing zone', 'online' and 'corp' management groups that will ensure workloads will be secure, monitored, and protected according to best practices.",
                                "uri": "https://docs.microsoft.com/azure/cloud-adoption-framework/ready/enterprise-scale/design-principles#policy-driven-governance",
                                "style": "Info"
                            }
                        },
                        {
                            "name": "lzSection",
                            "type": "Microsoft.Common.Section",
                            "label": "Landing Zone Management Group",
                            "elements": [
                                {
                                    "name": "azMonText",
                                    "type": "Microsoft.Common.TextBlock",
                                    "visible": true,
                                    "options": {
                                        "text": "Select which of the the recommended policies you will assign to your landing zone management group.",
                                        "link": {
                                            "label": "Learn more",
                                            "uri": "https://docs.microsoft.com/en-us/azure/cloud-adoption-framework/ready/enterprise-scale/design-principles#policy-driven-governance"
                                        }
                                    }
                                },
                                {
                                    "name": "enableLzDdoS",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "label": "Enable DDoS Network Protection",
                                    "defaultValue": "Yes (recommended)",
                                    "visible": "[and(not(equals(steps('connectivity').enableHub,'No')),equals(steps('connectivity').enableDdoS,'Yes'))]",
                                    "toolTip": "If 'Yes' is selected when also adding a connectivity subscription earlier, DDoS Network Protection will be enabled.<br>Uses the policy <a href=\"https://www.azadvertizer.net/azpolicyadvertizer/94de2ad3-e0c1-4caf-ad78-5d47bbc83d3d.html\">Virtual networks should be protected by Azure DDoS Protection Standard</a>.",
                                    "constraints": {
                                        "allowedValues": [
                                            {
                                                "label": "Yes (recommended)",
                                                "value": "Yes"
                                            },
                                            {
                                                "label": "Audit only",
                                                "value": "Audit"
                                            },
                                            {
                                                "label": "No",
                                                "value": "No"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "enablePrivateDnsZonesForLzs",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "label": "Ensure private endpoints to Azure PaaS services are integrated with Azure Private DNS Zones in the corp connected landing zones",
                                    "defaultValue": "Yes (recommended)",
                                    "visible": "[equals(steps('connectivity').enablePrivateDnsZones, 'Yes')]",
                                    "toolTip": "If 'Yes' is selected then Azure Policy will ensure private endpoints to Azure PaaS services are integrated with Azure Private DNS Zones in the connectivity subscription on behalf of the users.<br>Uses the custom initiative <a href=\"https://www.azadvertizer.net/azpolicyinitiativesadvertizer/Deploy-Private-DNS-Zones.html\">Configure Azure PaaS services to use private DNS zones</a>.",
                                    "constraints": {
                                        "allowedValues": [
                                            {
                                                "label": "Yes (recommended)",
                                                "value": "Yes"
                                            },
                                            {
                                                "label": "Audit only",
                                                "value": "Audit"
                                            },
                                            {
                                                "label": "No",
                                                "value": "No"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "enableEncryptionInTransit",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "label": "Ensure encryption in transit is enabled for PaaS services",
                                    "defaultValue": "Yes (recommended)",
                                    "visible": true,
                                    "toolTip": "If 'Yes' is selected then Azure Policy will ensure PaaS resources uses TLS and SSL.<br>Uses the custom initiative <a href=\"https://www.azadvertizer.net/azpolicyinitiativesadvertizer/Enforce-EncryptTransit.html\">Deny or Deploy and append TLS requirements and SSL enforcement on resources without Encryption in transit</a>.",
                                    "constraints": {
                                        "allowedValues": [
                                            {
                                                "label": "Yes (recommended)",
                                                "value": "Yes"
                                            },
                                            {
                                                "label": "Audit only",
                                                "value": "Audit"
                                            },
                                            {
                                                "label": "No",
                                                "value": "No"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "enableVmMonitoring",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "label": "Ensure Azure VMs (Windows & Linux) and Azure Arc-enabled servers are being monitored",
                                    "defaultValue": "Yes (recommended)",
                                    "toolTip": "Enabling this Azure Policy will ensure that every virtual machine (Windows, Linux, including Azure Arc enabled servers) are onboarded to Azure Monitor and Security.<br>Uses the initiative <a href=\"https://www.azadvertizer.net/azpolicyinitiativesadvertizer/55f3eceb-5573-4f18-9695-226972c6d74a.html\">Enable Azure Monitor for VMs</a>.",
                                    "constraints": {
                                        "allowedValues": [
                                            {
                                                "label": "Yes (recommended)",
                                                "value": "Yes"
                                            },
                                            {
                                                "label": "Audit only",
                                                "value": "Audit"
                                            },
                                            {
                                                "label": "No",
                                                "value": "No"
                                            }
                                        ]
                                    },
                                    "visible": "[equals(steps('management').enableLogAnalytics,'Yes')]"
                                },
                                {
                                    "name": "enableVmssMonitoring",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "label": "Ensure Azure VMSS (Windows & Linux) are being monitored",
                                    "defaultValue": "Yes (recommended)",
                                    "toolTip": "Enabling this Azure Policy will ensure that every virtual machine scale set (Windows & Linux) are onboarded to Azure Monitor and Security.<br>Uses the initiative <a href=\"https://www.azadvertizer.net/azpolicyinitiativesadvertizer/75714362-cae7-409e-9b99-a8e5075b7fad.html\">Enable Azure Monitor for Virtual Machine Scale Sets</a>.",
                                    "constraints": {
                                        "allowedValues": [
                                            {
                                                "label": "Yes (recommended)",
                                                "value": "Yes"
                                            },
                                            {
                                                "label": "Audit only",
                                                "value": "Audit"
                                            },
                                            {
                                                "label": "No",
                                                "value": "No"
                                            }
                                        ]
                                    },
                                    "visible": "[equals(steps('management').enableLogAnalytics,'Yes')]"
                                },
                                {
                                    "name": "enableVmHybridMonitoring",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "label": "Ensure Hybrid VMs are being monitored",
                                    "defaultValue": "Yes (recommended)",
                                    "toolTip": "Enabling this Azure Policy will ensure that Azure Arc Enabled Hybrid VMs are monitored.",
                                    "constraints": {
                                        "allowedValues": [
                                            {
                                                "label": "Yes (recommended)",
                                                "value": "Yes"
                                            },
                                            {
                                                "label": "Audit only",
                                                "value": "Audit"
                                            },
                                            {
                                                "label": "No",
                                                "value": "No"
                                            }
                                        ]
                                    },
                                    "visible": "[equals(steps('management').enableLogAnalytics,'Yes')]"
                                },
                                {
                                    "name": "enableAksPolicy",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "label": "Enable Kubernetes (AKS) for Azure Policy",
                                    "defaultValue": "Yes (recommended)",
                                    "toolTip": "If 'Yes' is selected the Azure Policy Add-on to manage and report on the compliance state of your Azure Kubernetes Service (AKS) clusters will be enabled.<br>Uses the policy <a href=\"https://www.azadvertizer.net/azpolicyadvertizer/a8eff44f-8c92-45c3-a3fb-9880802d67a7.html\">Deploy Azure Policy Add-on to Azure Kubernetes Service clusters</a>.",
                                    "constraints": {
                                        "allowedValues": [
                                            {
                                                "label": "Yes (recommended)",
                                                "value": "Yes"
                                            },
                                            {
                                                "label": "Audit only",
                                                "value": "Audit"
                                            },
                                            {
                                                "label": "No",
                                                "value": "No"
                                            }
                                        ]
                                    },
                                    "visible": true
                                },
                                {
                                    "name": "denyAksPrivileged",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "label": "Prevent privileged containers in Kubernetes clusters",
                                    "defaultValue": "Yes (recommended)",
                                    "toolTip": "If 'Yes' is selected, policy will be assigned to prevent privileged containers in AKS.<br>Uses the policy <a href=\"https://www.azadvertizer.net/azpolicyadvertizer/95edb821-ddaf-4404-9732-666045e056b4.html\">Kubernetes cluster should not allow privileged containers</a>.",
                                    "constraints": {
                                        "allowedValues": [
                                            {
                                                "label": "Yes (recommended)",
                                                "value": "Yes"
                                            },
                                            {
                                                "label": "Audit only",
                                                "value": "Audit"
                                            },
                                            {
                                                "label": "No",
                                                "value": "No"
                                            }
                                        ]
                                    },
                                    "visible": true
                                },
                                {
                                    "name": "denyAksPrivilegedEscalation",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "label": "Prevent privileged escalation in Kubernetes clusters",
                                    "defaultValue": "Yes (recommended)",
                                    "toolTip": "If 'Yes' is selected, policy will be assigned to prevent privileged escalations in AKS.<br>Uses the policy <a href=\"https://www.azadvertizer.net/azpolicyadvertizer/1c6e92c9-99f0-4e55-9cf2-0c234dc48f99.html\">Kubernetes clusters should not allow container privilege escalation</a>.",
                                    "constraints": {
                                        "allowedValues": [
                                            {
                                                "label": "Yes (recommended)",
                                                "value": "Yes"
                                            },
                                            {
                                                "label": "Audit only",
                                                "value": "Audit"
                                            },
                                            {
                                                "label": "No",
                                                "value": "No"
                                            }
                                        ]
                                    },
                                    "visible": true
                                },
                                {
                                    "name": "denyHttpIngressForAks",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "label": "Ensure HTTPS ingress is enforced in Kubernetes clusters",
                                    "defaultValue": "Yes (recommended)",
                                    "toolTip": "If 'Yes' is selected, HTTPS ingress will be required in AKS.<br>Uses the policy <a href=\"https://www.azadvertizer.net/azpolicyadvertizer/1a5b4dca-0b6f-4cf5-907c-56316bc1bf3d.html\">Kubernetes clusters should be accessible only over HTTPS</a>.",
                                    "constraints": {
                                        "allowedValues": [
                                            {
                                                "label": "Yes (recommended)",
                                                "value": "Yes"
                                            },
                                            {
                                                "label": "Audit only",
                                                "value": "Audit"
                                            },
                                            {
                                                "label": "No",
                                                "value": "No"
                                            }
                                        ]
                                    },
                                    "visible": true
                                },
                                {
                                    "name": "enableVmBackup",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "label": "Ensure Azure VMs (Windows & Linux) are enabled for Azure Backup",
                                    "defaultValue": "Yes (recommended)",
                                    "toolTip": "If 'Yes' is selected, Azure Policy will be assigned and enable Azure Backup on all VMs in the landing zones.<br>Uses the policy <a href=\"https://www.azadvertizer.net/azpolicyadvertizer/98d0b9f8-fd90-49c9-88e2-d3baf3b0dd86.html\">Configure backup on virtual machines without a given tag to a new recovery services vault with a default policy</a>.",
                                    "constraints": {
                                        "allowedValues": [
                                            {
                                                "label": "Yes (recommended)",
                                                "value": "Yes"
                                            },
                                            {
                                                "label": "Audit only",
                                                "value": "Audit"
                                            },
                                            {
                                                "label": "No",
                                                "value": "No"
                                            }
                                        ]
                                    },
                                    "visible": true
                                },
                                {
                                    "name": "denyMgmtPorts",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "label": "Prevent inbound management ports from internet",
                                    "defaultValue": "Yes (recommended)",
                                    "toolTip": "If 'Yes' is selected, Azure Policy will be assigned and prevent inbound management ports (22, 3389) from internet.<br>Uses the custom policy <a href=\"https://www.azadvertizer.net/azpolicyadvertizer/Deny-MgmtPorts-From-Internet.html\">Management port access from the Internet should be blocked</a>.",
                                    "constraints": {
                                        "allowedValues": [
                                            {
                                                "label": "Yes (recommended)",
                                                "value": "Yes"
                                            },
                                            {
                                                "label": "Audit only",
                                                "value": "Audit"
                                            },
                                            {
                                                "label": "No",
                                                "value": "No"
                                            }
                                        ]
                                    },
                                    "visible": true
                                },
                                {
                                    "name": "denySubnetWithoutNsg",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "label": "Ensure subnets are associated with NSG",
                                    "defaultValue": "Yes (recommended)",
                                    "toolTip": "If 'Yes' is selected, Azure Policy will be assigned to ensure NSGs must be associated with subnets being created.<br>Uses the custom policy <a href=\"https://www.azadvertizer.net/azpolicyadvertizer/Deny-Subnet-Without-Nsg.html\">Subnets should have a Network Security Group</a>.",
                                    "constraints": {
                                        "allowedValues": [
                                            {
                                                "label": "Yes (recommended)",
                                                "value": "Yes"
                                            },
                                            {
                                                "label": "Audit only",
                                                "value": "Audit"
                                            },
                                            {
                                                "label": "No",
                                                "value": "No"
                                            }
                                        ]
                                    },
                                    "visible": true
                                },
                                {
                                    "name": "denyIpForwarding",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "label": "Prevent IP forwarding",
                                    "defaultValue": "Yes (recommended)",
                                    "toolTip": "If 'Yes' is selected, Azure Policy will be assigned and prevent IP forwarding.<br>Uses the policy <a href=\"https://www.azadvertizer.net/azpolicyadvertizer/88c0b9da-ce96-4b03-9635-f29a937e2900.html\">Network interfaces should disable IP forwarding</a>.",
                                    "constraints": {
                                        "allowedValues": [
                                            {
                                                "label": "Yes (recommended)",
                                                "value": "Yes"
                                            },
                                            {
                                                "label": "Audit only",
                                                "value": "Audit"
                                            },
                                            {
                                                "label": "No",
                                                "value": "No"
                                            }
                                        ]
                                    },
                                    "visible": true
                                },
                                {
                                    "name": "enableSqlEncryption",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "label": "Ensure Azure SQL is enabled with transparent data encryption",
                                    "defaultValue": "Yes (recommended)",
                                    "toolTip": "If 'Yes' is selected TDE will be enabled on all SQL instances.<br>Uses the policy <a href=\"https://www.azadvertizer.net/azpolicyadvertizer/86a912f6-9a06-4e26-b447-11b16ba8659f.html\">Deploy SQL DB transparent data encryption</a>.",
                                    "constraints": {
                                        "allowedValues": [
                                            {
                                                "label": "Yes (recommended)",
                                                "value": "Yes"
                                            },
                                            {
                                                "label": "Audit only",
                                                "value": "Audit"
                                            },
                                            {
                                                "label": "No",
                                                "value": "No"
                                            }
                                        ]
                                    },
                                    "visible": true
                                },
                                {
                                    "name": "enableSqlThreat",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "label": "Ensure Azure SQL Threat Detection is enabled",
                                    "defaultValue": "Yes (recommended)",
                                    "toolTip": "If 'Yes' is selected Azure Defender will be enabled on all SQL instances.<br>Uses the policy <a href=\"https://www.azadvertizer.net/azpolicyadvertizer/36d49e87-48c4-4f2e-beed-ba4ed02b71f5.html\">Configure Azure Defender to be enabled on SQL servers</a>.",
                                    "constraints": {
                                        "allowedValues": [
                                            {
                                                "label": "Yes (recommended)",
                                                "value": "Yes"
                                            },
                                            {
                                                "label": "Audit only",
                                                "value": "Audit"
                                            },
                                            {
                                                "label": "No",
                                                "value": "No"
                                            }
                                        ]
                                    },
                                    "visible": true
                                },
                                {
                                    "name": "enableSqlAudit",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "label": "Ensure auditing is enabled on Azure SQL",
                                    "defaultValue": "Yes (recommended)",
                                    "toolTip": "If 'Yes' is selected, Azure Policy will be assigned to ensure auditing is enabled on Azure SQL.<br>Uses the policy <a href=\"https://www.azadvertizer.net/azpolicyadvertizer/25da7dfb-0666-4a15-a8f5-402127efd8bb.html\">Configure SQL servers to have auditing enabled to Log Analytics workspace</a>.",
                                    "constraints": {
                                        "allowedValues": [
                                            {
                                                "label": "Yes (recommended)",
                                                "value": "Yes"
                                            },
                                            {
                                                "label": "Audit only",
                                                "value": "Audit"
                                            },
                                            {
                                                "label": "No",
                                                "value": "No"
                                            }
                                        ]
                                    },
                                    "visible": true
                                },
                                {
                                    "name": "enableStorageHttps",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "label": "Ensure secure connections (HTTPS) to storage accounts",
                                    "defaultValue": "Yes (recommended)",
                                    "toolTip": "If 'Yes' is selected, Azure Policy will be assigned to ensure storage can only be accessed using HTTPS.<br>Uses the policy <a href=\"https://www.azadvertizer.net/azpolicyadvertizer/404c3081-a854-4457-ae30-26a93ef643f9.html\">Secure transfer to storage accounts should be enabled</a>.",
                                    "constraints": {
                                        "allowedValues": [
                                            {
                                                "label": "Yes (recommended)",
                                                "value": "Yes"
                                            },
                                            {
                                                "label": "Audit only",
                                                "value": "Audit"
                                            },
                                            {
                                                "label": "No",
                                                "value": "No"
                                            }
                                        ]
                                    },
                                    "visible": true
                                },
                                {
                                    "name": "enforceKvGuardrails",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "label": "Enforce Key Vault recommended guardrails",
                                    "defaultValue": "Yes (recommended)",
                                    "toolTip": "If 'Yes' is selected, Azure Policy Initiative will be assigned to ensure recommended Key Vault policies are enabled.<br>Uses the custom initiative <a href=\"https://www.azadvertizer.net/azpolicyinitiativesadvertizer/Enforce-Guardrails-KeyVault.html\">Enforce recommended guardrails for Azure Key Vault.</a>.",
                                    "constraints": {
                                        "allowedValues": [
                                            {
                                                "label": "Yes (recommended)",
                                                "value": "Yes"
                                            },
                                            {
                                                "label": "Audit only",
                                                "value": "Audit"
                                            },
                                            {
                                                "label": "No",
                                                "value": "No"
                                            }
                                        ]
                                    },
                                    "visible": true
                                },
                                {
                                    "name": "auditAppGwWaf",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "label": "Audit WAF enabled on Application Gateways",
                                    "defaultValue": "Yes (recommended)",
                                    "toolTip": "If 'Yes' is selected, Azure Policy will be assigned to audit whether WAF is enabled on Application Gateways.<br>Uses the policy <a href=\"https://www.azadvertizer.net/azpolicyadvertizer/564feb30-bf6a-4854-b4bb-0d2d2d1e6c66.html\">Web Application Firewall (WAF) should be enabled for Application Gateway</a>.",
                                    "constraints": {
                                        "allowedValues": [
                                            {
                                                "label": "Yes (recommended)",
                                                "value": "Yes"
                                            },
                                            {
                                                "label": "Audit only",
                                                "value": "Audit"
                                            },
                                            {
                                                "label": "No",
                                                "value": "No"
                                            }
                                        ]
                                    },
                                    "visible": true
                                },
                                {
                                    "name": "enforceAcsb",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "label": "Enable Azure Compute Security Baseline compliance auditing",
                                    "defaultValue": "Yes (recommended)",
                                    "toolTip": "If 'Yes' is selected, Azure Policy will be assigned to audit whether Windows and Linux virtual machines are Azure Compute Security Baseline compliant.<br>Uses the custom initiative <a href=\"https://www.azadvertizer.net/azpolicyinitiativesadvertizer/Enforce-ACSB.html\">Enforce Azure Compute Security Benchmark compliance auditing</a>.",
                                    "constraints": {
                                        "allowedValues": [
                                            {
                                                "label": "Yes (recommended)",
                                                "value": "Yes"
                                            },
                                            {
                                                "label": "Audit only",
                                                "value": "Audit"
                                            },
                                            {
                                                "label": "No",
                                                "value": "No"
                                            }
                                        ]
                                    },
                                    "visible": true
                                }
                            ],
                            "visible": "[equals(steps('basics').cloudEnvironment.selection, 'AzureCloud')]"
                        },
                        {
                            "name": "corpOnlineSettingsInfo",
                            "type": "Microsoft.Common.InfoBox",
                            "visible": true,
                            "options": {
                                "text": "You can optionally provide subscriptions for your first landing zones for both 'online' and 'corp' and choose to enable the assignment of recommended policies for the corp and online landing zones that will enable policies according to best practices.",
                                "uri": "https://aka.ms/alz/policies",
                                "style": "Info"
                            }
                        },
                        {
                            "name": "corpSection",
                            "type": "Microsoft.Common.Section",
                            "label": "Corp Management Group",
                            "elements": [
                                {
                                    "name": "corpText",
                                    "type": "Microsoft.Common.TextBlock",
                                    "visible": true,
                                    "options": {
                                        "text": "Select the subscriptions you want to move to corp management group.",
                                        "link": {
                                            "label": "Learn more",
                                            "uri": "https://docs.microsoft.com/azure/cloud-adoption-framework/ready/enterprise-scale/design-principles#subscription-democratization"
                                        }
                                    }
                                },
                                {
                                    "name": "esLzConnectivity",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "label": "Connect corp landing zones to the connectivity hub (optional)?",
                                    "defaultValue": "No",
                                    "toolTip": "If 'Yes' is selected for corp landing zones, ARM will connect the subscriptions to the hub virtual network via VNet peering.",
                                    "constraints": {
                                        "allowedValues": [
                                            {
                                                "label": "Yes (recommended)",
                                                "value": "Yes"
                                            },
                                            {
                                                "label": "No",
                                                "value": "No"
                                            }
                                        ]
                                    },
                                    "visible": "[or(equals(steps('connectivity').enableHub, 'nva'), equals(steps('connectivity').enableHub, 'vhub'))]"
                                },
                                {
                                    "name": "esCorpLzSub",
                                    "type": "Microsoft.Common.DropDown",
                                    "label": "Corp landing zone subscriptions (optional)",
                                    "defaultValue": "[parse('[]')]",
                                    "toolTip": "",
                                    "multiselect": true,
                                    "selectAll": true,
                                    "filter": true,
                                    "filterPlaceholder": "Filter items ...",
                                    "multiLine": true,
                                    "visible": "[or(or(equals(steps('landingZones').corpSection.esLzConnectivity, 'No'), equals(steps('connectivity').enableHub, 'No')), equals(steps('connectivity').enableHub, 'vwan'), equals(steps('landingZones').corpSection.esLzConnectivity, 'No'))]",
                                    "constraints": {
                                        "allowedValues": "[steps('basics').getSubscriptions.data]",
                                        "required": false
                                    }
                                },
                                {
                                    "name": "lzConnectedSubs",
                                    "type": "Microsoft.Common.EditableGrid",
                                    "ariaLabel": "Add existing subscriptions into the management group landing zone and provide address space for virtual network peering",
                                    "label": "Corp connected landing zone subscriptions (optional)",
                                    "visible": "[equals(steps('landingZones').corpSection.esLzConnectivity, 'Yes')]",
                                    "constraints": {
                                        "width": "Full",
                                        "rows": {
                                            "count": {
                                                "min": 1,
                                                "max": 10
                                            }
                                        },
                                        "columns": [
                                            {
                                                "id": "subs",
                                                "header": "Subscription",
                                                "width": "1fr",
                                                "element": {
                                                    "name": "esLzConnectedSub",
                                                    "type": "Microsoft.Common.DropDown",
                                                    "label": "Landing zone subscription",
                                                    "defaultValue": "[parse('[]')]",
                                                    "toolTip": "",
                                                    "multiselect": false,
                                                    "selectAll": false,
                                                    "filter": true,
                                                    "filterPlaceholder": "Filter items ...",
                                                    "multiLine": false,
                                                    "constraints": {
                                                        "allowedValues": "[steps('basics').getSubscriptions.data]",
                                                        "required": false
                                                    }
                                                }
                                            },
                                            {
                                                "id": "addresses",
                                                "header": "Virtual Network Address space",
                                                "width": "1fr",
                                                "element": {
                                                    "type": "Microsoft.Common.TextBox",
                                                    "placeholder": "Ensure there are no overlapping IP addresses!",
                                                    "constraints": {
                                                        "required": true,
                                                        "validations": [
                                                            {
                                                                "regex": "^(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:\/(1[0-9]|2[0-4]))$",
                                                                "message": "Invalid CIDR range. The address prefix must be in the range [10,24]."
                                                            }
                                                        ]
                                                    }
                                                }
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "denyPublicEndpoints",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "label": "Prevent usage of Public Endpoints for Azure PaaS services in the corp connected landing zones",
                                    "defaultValue": "Yes (recommended)",
                                    "visible": true,
                                    "toolTip": "If 'Yes' is selected then Azure Policy will prevent PaaS resources to use public endpoints.<br>Uses the custom initiative <a href=\"https://www.azadvertizer.net/azpolicyinitiativesadvertizer/Deny-PublicPaaSEndpoints.html\">Public network access should be disabled for PaaS services</a>.",
                                    "constraints": {
                                        "allowedValues": [
                                            {
                                                "label": "Yes (recommended)",
                                                "value": "Yes"
                                            },
                                            {
                                                "label": "Audit only",
                                                "value": "Audit"
                                            },
                                            {
                                                "label": "No",
                                                "value": "No"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "denyPipOnNicForCorp",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "label": "Prevent usage of NICs with public IP(s) in the corp connected landing zones",
                                    "defaultValue": "Yes (recommended)",
                                    "visible": true,
                                    "toolTip": "If 'Yes' is selected then Azure Policy will prevent NICs with public IPs(s).<br>Uses the policy <a href=\"https://www.azadvertizer.net/azpolicyadvertizer/83a86a26-fd1f-447c-b59d-e51f44264114.html\">Network interfaces should not have public IPs</a>.",
                                    "constraints": {
                                        "allowedValues": [
                                            {
                                                "label": "Yes (recommended)",
                                                "value": "Yes"
                                            },
                                            {
                                                "label": "No",
                                                "value": "No"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "denyHybridNetworking",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "label": "Deny the deployment of vWAN/VPN/ERs, including Gateways, to Subscriptions in the Corp Management Group",
                                    "defaultValue": "Yes (recommended)",
                                    "toolTip": "If 'Yes' is selected for Corp, vWAN/VPN/ER, including Gateways, will be blocked from deployment to the Corp Management Group.<br>Uses the policy <a href=\"https://www.azadvertizer.net/azpolicyadvertizer/6c112d4e-5bc7-47ae-a041-ea2d9dccd749.html\">Not allowed resource types</a> with parameters for Express Route and VPN gateways.",
                                    "constraints": {
                                        "allowedValues": [
                                            {
                                                "label": "Yes (recommended)",
                                                "value": "Yes"
                                            },
                                            {
                                                "label": "Audit only",
                                                "value": "Audit"
                                            },
                                            {
                                                "label": "No",
                                                "value": "No"
                                            }
                                        ]
                                    },
                                    "visible": true
                                },
                                {
                                    "name": "auditPeDnsZones",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "label": "Audit the deployment of Private Link Private DNS Zones in the Corp Management Group",
                                    "defaultValue": "Yes (recommended)",
                                    "toolTip": "If 'Yes' is selected an audit policy will be enabled for checking if any Private Link Private DNS Zones are deployed in subscriptions in the Corp Management Group.<br>Uses the policy <a href=\"https://www.azadvertizer.net/azpolicyadvertizer/Audit-PrivateLinkDnsZones.html\">Audit the creation of Private Link Private DNS Zones</a>.",
                                    "constraints": {
                                        "allowedValues": [
                                            {
                                                "label": "Yes (recommended)",
                                                "value": "Yes"
                                            },
                                            {
                                                "label": "Audit only",
                                                "value": "Audit"
                                            },
                                            {
                                                "label": "No",
                                                "value": "No"
                                            }
                                        ]
                                    },
                                    "visible": true
                                }
                            ],
                            "visible": "[equals(steps('basics').cloudEnvironment.selection, 'AzureCloud')]"
                        },
                        {
                            "name": "onlineSection",
                            "type": "Microsoft.Common.Section",
                            "label": "Online Management Group",
                            "elements": [
                                {
                                    "name": "onlineText",
                                    "type": "Microsoft.Common.TextBlock",
                                    "visible": true,
                                    "options": {
                                        "text": "Select the subscriptions you want to move to online management group.",
                                        "link": {
                                            "label": "Learn more",
                                            "uri": "https://docs.microsoft.com/azure/cloud-adoption-framework/ready/enterprise-scale/design-principles#subscription-democratization"
                                        }
                                    }
                                },
                                {
                                    "name": "esOnlineLzSub",
                                    "type": "Microsoft.Common.DropDown",
                                    "label": "Online landing zone subscriptions (optional)",
                                    "defaultValue": "[parse('[]')]",
                                    "toolTip": "",
                                    "multiselect": true,
                                    "selectAll": true,
                                    "filter": true,
                                    "filterPlaceholder": "Filter items ...",
                                    "multiLine": true,
                                    "visible": true,
                                    "constraints": {
                                        "allowedValues": "[steps('basics').getSubscriptions.data]",
                                        "required": false
                                    }
                                },
                                {
                                    "name": "onlineSettingsInfo1",
                                    "type": "Microsoft.Common.InfoBox",
                                    "visible": true,
                                    "options": {
                                        "text": "There are no additional policy assignments for the online management group at this time, however, the online management group inherits and enforces the policies from the hierarchy above it.",
                                        "style": "Info"
                                    }
                                }
                            ],
                            "visible": "[equals(steps('basics').cloudEnvironment.selection, 'AzureCloud')]"
                        }
                    ]
                },
                {
                    "name": "decommissionedSandboxZones",
                    "label": "Decommissioned/Sandbox",
                    "subLabel": {
                        "preValidation": "",
                        "postValidation": ""
                    },
                    "bladeTitle": "ALZ - Decommissioned and Sandbox Landing Zones Settings",
                    "elements": [
                        {
                            "name": "infoBox2",
                            "type": "Microsoft.Common.InfoBox",
                            "visible": true,
                            "options": {
                                "text": "You can optionally choose to enable the assignment of recommended policies for the Decommissioned and Sandbox landing zones that will enable policies according to best practices.",
                                "uri": "https://aka.ms/alz/policies",
                                "style": "Info"
                            }
                        },
                        {
                            "name": "decommSection",
                            "type": "Microsoft.Common.Section",
                            "label": "Decommissioned Management Group",
                            "elements": [
                                {
                                    "name": "decommSettingsInfo",
                                    "type": "Microsoft.Common.InfoBox",
                                    "visible": "[equals(steps('basics').cloudEnvironment.selection, 'AzureCloud')]",
                                    "options": {
                                        "text": "The following policies will be enabled: <ul><li>Deny the deployment of new resources<li>Deploy an auto VM shutdown policy at UTC 00:00</ul>",
                                        "uri": "https://aka.ms/alz/policies",
                                        "style": "Info"
                                    }
                                },
                                {
                                    "name": "enableDecommissioned",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "label": "Enforce ALZ Recommended policy controls on the Decommissioned Management Group?",
                                    "defaultValue": "Yes (recommended)",
                                    "toolTip": "If 'Yes' is selected for Decommissioned, the Enforce-ALZ-Decomm initiative will be applied to the Decommissioned Management Group.<br>Uses the custom initiative <a href=\"https://www.azadvertizer.net/azpolicyinitiativesadvertizer/Enforce-ALZ-Decomm.html\">Enforce policies in the Decommissioned Landing Zone</a>.",
                                    "constraints": {
                                        "allowedValues": [
                                            {
                                                "label": "Yes (recommended)",
                                                "value": "Yes"
                                            },
                                            {
                                                "label": "Audit only",
                                                "value": "Audit"
                                            },
                                            {
                                                "label": "No",
                                                "value": "No"
                                            }
                                        ]
                                    },
                                    "visible": true
                                }
                            ],
                            "visible": "[equals(steps('basics').cloudEnvironment.selection, 'AzureCloud')]"
                        },
                        {
                            "name": "sandboxSection",
                            "type": "Microsoft.Common.Section",
                            "label": "Sandbox Management Group",
                            "elements": [
                                {
                                    "name": "sandboxSettingsInfo",
                                    "type": "Microsoft.Common.InfoBox",
                                    "visible": "[equals(steps('basics').cloudEnvironment.selection, 'AzureCloud')]",
                                    "options": {
                                        "text": "The following policies will be enabled: <ul><li>Deny vNET peering across subscriptions<li>Deny the deployment of vWAN/ER/VPN gateways</ul>",
                                        "uri": "https://aka.ms/alz/policies",
                                        "style": "Info"
                                    }
                                },
                                {
                                    "name": "enableSandbox",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "label": "Enforce ALZ recommended policy controls on the Sandbox Management Group?",
                                    "defaultValue": "Yes (recommended)",
                                    "toolTip": "If 'Yes' is selected for sandbox, the Enforce-ALZ-Sandbox initiative will be applied to the Sandbox Management Group.<br>Uses the custom initiative <a href=\"https://www.azadvertizer.net/azpolicyinitiativesadvertizer/Enforce-ALZ-Sandbox.html\">Enforce policies in the Sandbox Landing Zone</a>.",
                                    "constraints": {
                                        "allowedValues": [
                                            {
                                                "label": "Yes (recommended)",
                                                "value": "Yes"
                                            },
                                            {
                                                "label": "Audit only",
                                                "value": "Audit"
                                            },
                                            {
                                                "label": "No",
                                                "value": "No"
                                            }
                                        ]
                                    },
                                    "visible": true
                                }
                            ],
                            "visible": "[equals(steps('basics').cloudEnvironment.selection, 'AzureCloud')]"
                        }
                    ]
                },
                {
                    "name": "regulatory",
                    "label": "Regulatory Compliance",
                    "elements": [
                        {
                            "name": "regComplianceText",
                            "type": "Microsoft.Common.TextBlock",
                            "visible": true,
                            "options": {
                                "text": "You can optionally select one, or more, Regulatory Compliance built-in Policy Initiatives (Set Definitions) to assign to the Intermediate Root Management Group of your Azure Landing Zones hierarchy (e.g. Contoso).",
                                "link": {
                                    "label": "See available initiatives and control mappings...",
                                    "uri": "https://learn.microsoft.com/azure/azure-resource-manager/management/security-controls-policy"
                                }
                            }
                        },
                        {
                            "name": "regComplianceInfoMcsb",
                            "type": "Microsoft.Common.InfoBox",
                            "visible": true,
                            "options": {
                                "text": "The Microsoft Cloud Security Benchmark (MCSB) is already assigned in to the Intermediate Root Management Group of your Azure Landing Zones hierarchy (e.g. Contoso). Click on this box to see the controls mapped for this initiative and also find in the TOC other Regulatory Compliance built-in Policy Initiatives (Set Definitions)",
                                "uri": "https://learn.microsoft.com/azure/governance/policy/samples/azure-security-benchmark",
                                "style": "Info"
                            }
                        },
                        {
                            "name": "regComplianceInfoAlzPolicyAssignments",
                            "type": "Microsoft.Common.InfoBox",
                            "visible": true,
                            "options": {
                                "text": "Azure Landing Zones makes a number of default Azure Policy Assignments that help bootstrap your environment to be able to host workloads in Application Landing Zones (Azure Subscriptions). Click on this box to see the default ALZ Policy Assignments",
                                "uri": "https://aka.ms/alz/policies",
                                "style": "Info"
                            }
                        },
                        {
                            "name": "regComplianceSelectorCheck",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Do you wish to assign additional Regulatory Compliance Policy Initiatives to your Azure Landing Zones Management Groups hierarchy?",
                            "defaultValue": "No",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes",
                                        "value": "Yes"
                                    },
                                    {
                                        "label": "No",
                                        "value": "No"
                                    }
                                ]
                            },
                            "visible": true
                        },
                        {
                            "name": "regComplianceAlzMgDiagram",
                            "type": "Microsoft.Common.InfoBox",
                            "visible": "[equals(steps('regulatory').regComplianceSelectorCheck, 'Yes')]",
                            "options": {
                                "icon": "None",
                                "text": "<b>Azure Landing Zones Management Group Hierarchy</b><img src='https://learn.microsoft.com/en-gb/azure/cloud-adoption-framework/ready/landing-zone/design-area/media/sub-organization.png'>"
                            }
                        },
                        {
                            "name": "regComplianceWarnLite",
                            "type": "Microsoft.Common.InfoBox",
                            "visible": "[and(equals(steps('core').platformSubscription, 'Single'), equals(steps('regulatory').regComplianceSelectorCheck, 'Yes'))]",
                            "options": {
                                "text": "You have selected a single platform Management Group and Subscripiton instead of a dedicated Subscriptions and Management Groups for the platform services. Please do not select the management, identity or connectivity Management Groups in the drop downs below as this will cause the deployment to fail.",
                                "uri": "https://aka.ms/alz",
                                "style": "Warning"
                            }
                        },
                        {
                            "name": "regComplianceWarnParams",
                            "type": "Microsoft.Common.InfoBox",
                            "visible": "[equals(steps('regulatory').regComplianceSelectorCheck, 'Yes')]",
                            "options": {
                                "text": "Some Regulatory Compliance Policy Initiatives require specific parameter values to be set. Once you have selected the policies to assign and to which Management Group, please scroll down to provide any required parameter values. If you do not know the values for any of the required parameters requested below please leave them empty or enter a placeholder value and complete the ALZ deployment. You can then enter the Policy area in the Azure Portal once complete and edit the assignment parameter values at a later stage when you know the values. (click on this box to be taken to the Azure Policy Docs)",
                                "uri": "https://learn.microsoft.com/azure/governance/policy/assign-policy-portal",
                                "style": "Info"
                            }
                        },
                        {
                            "name": "regComplianceSelectorFull",
                            "type": "Microsoft.Common.EditableGrid",
                            "ariaLabel": "Assign regulatory compliance policies to the Management Group of your choice in Azure Landing Zones hierarchy",
                            "label": "Assign regulatory compliance policies to the Management Group of your choice in Azure Landing Zones hierarchy",
                            "visible": "[equals(steps('regulatory').regComplianceSelectorCheck, 'Yes')]",
                            "constraints": {
                                "width": "Full",
                                "rows": {
                                    "count": {
                                        "min": 1,
                                        "max": 20
                                    }
                                },
                                "columns": [
                                    {
                                        "id": "mg",
                                        "header": "Management Group To Assign To",
                                        "width": "1fr",
                                        "element": {
                                            "name": "regComplianceSelectorManagementGroups",
                                            "type": "Microsoft.Common.DropDown",
                                            "label": "Management Groups",
                                            "defaultValue": "[parse('[]')]",
                                            "toolTip": "",
                                            "multiselect": false,
                                            "selectAll": false,
                                            "filter": true,
                                            "filterPlaceholder": "Filter items ...",
                                            "multiLine": true,
                                            "constraints": {
                                                "allowedValues": [
                                                    {
                                                        "label": "Intermeditate Root Management Group",
                                                        "description": "e.g. Contoso",
                                                        "value": "contoso"
                                                    },
                                                    {
                                                        "label": "Platform Management Group",
                                                        "description": "e.g. Contoso -> Platform",
                                                        "value": "contoso-platform"
                                                    },
                                                    {
                                                        "label": "Management Management Group",
                                                        "description": "e.g. Contoso -> Platform -> Management",
                                                        "value": "contoso-management"
                                                    },
                                                    {
                                                        "label": "Identity Management Group",
                                                        "description": "e.g. Contoso -> Platform -> Identity",
                                                        "value": "contoso-identity"
                                                    },
                                                    {
                                                        "label": "Connectivity Management Group",
                                                        "description": "e.g. Contoso -> Platform -> Connectivity",
                                                        "value": "contoso-connectivity"
                                                    },
                                                    {
                                                        "label": "Landing Zones Management Group",
                                                        "description": "e.g. Contoso -> Landing Zones",
                                                        "value": "contoso-landingzones"
                                                    },
                                                    {
                                                        "label": "Corp Management Group",
                                                        "description": "e.g. Contoso -> Landing Zones -> Corp",
                                                        "value": "contoso-corp"
                                                    },
                                                    {
                                                        "label": "Online Management Group",
                                                        "description": "e.g. Contoso -> Landing Zones -> Online",
                                                        "value": "contoso-online"
                                                    },
                                                    {
                                                        "label": "Decommissioned Management Group",
                                                        "description": "e.g. Contoso -> Decommissioned",
                                                        "value": "contoso-decommissioned"
                                                    },
                                                    {
                                                        "label": "Sandbox Management Group",
                                                        "description": "e.g. Contoso -> Sandbox",
                                                        "value": "contoso-sandboxes"
                                                    }
                                                ],
                                                "required": false
                                            }
                                        }
                                    },
                                    {
                                        "id": "policy",
                                        "header": "Regulatory Compliance Policy Initative",
                                        "width": "1fr",
                                        "element": {
                                            "name": "regComplianceSelectorPolicies",
                                            "type": "Microsoft.Common.DropDown",
                                            "label": "Regulatory Compliance Policies",
                                            "defaultValue": "[parse('[]')]",
                                            "toolTip": "",
                                            "multiselect": false,
                                            "selectAll": false,
                                            "filter": true,
                                            "filterPlaceholder": "Filter Regulatory Compliance Policy Initiatives...",
                                            "multiLine": true,
                                            "visible": true,
                                            "constraints": {
                                                "allowedValues": "[steps('basics').getRegulatoryCompliancePolicies.data]",
                                                "required": false
                                            }
                                        }
                                    }
                                ]
                            }
                        },
                        {
                            "name": "regPolicyParamAusGovIsmRestricted",
                            "type": "Microsoft.Common.Section",
                            "label": "Australian Government ISM PROTECTED - Required Policy Initative Parameters",
                            "elements": [
                                {
                                    "name": "regCompliancePolicyParamAusGovIsmRestrictedNeededWarn",
                                    "type": "Microsoft.Common.InfoBox",
                                    "visible": "true",
                                    "options": {
                                        "text": "You have selected the Regulatory Policy Initaitve of Australian Government ISM PROTECTED that requires values for specific parameter values to be set. Please ensure you set the values for the required parameters for the policy in the below section.",
                                        "style": "Warning"
                                    }
                                },
                                {
                                    "name": "regCompPolParAusGovIsmRestrictedVmAdminsExclude",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "List of users that must be excluded in Windows VM Administrators group",
                                    "toolTip": "A semicolon-separated list of users that should be excluded in the Administrators local group; Ex: Administrator; myUser1; myUser2",
                                    "constraints": {
                                        "required": false
                                    }
                                },
                                {
                                    "name": "regCompPolParAusGovIsmRestrictedResourceTypes",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "label": "List of resource types that should have diagnostic logging enabled",
                                    "defaultValue": "All Resource Types",
                                    "toolTip": "You can select either all or none here in this portal experience, if you wish to be more granular please chose either option and then once deployed via the ALZ portal accelerator you can edit the assignment via the Policy area of the Azure Portal.",
                                    "constraints": {
                                        "allowedValues": [
                                            {
                                                "label": "All Resource Types",
                                                "value": "all"
                                            },
                                            {
                                                "label": "None",
                                                "value": "none"
                                            }
                                        ],
                                        "required": true
                                    },
                                    "visible": true
                                }
                            ],
                            "visible": "[if(contains(map(steps('regulatory').regComplianceSelectorFull, (item) => item.policy.id), '/providers/Microsoft.Authorization/policySetDefinitions/27272c0b-c225-4cc3-b8b0-f2534b093077'), true, false)]"
                        },
                        {
                            "name": "regPolicyParamMPAA",
                            "type": "Microsoft.Common.Section",
                            "label": "Motion Picture Association of America (MPAA) - Required Policy Initative Parameters",
                            "elements": [
                                {
                                    "name": "regCompliancePolicyParamMPAANeededWarn",
                                    "type": "Microsoft.Common.InfoBox",
                                    "visible": "true",
                                    "options": {
                                        "text": "You have selected the Regulatory Policy Initaitve of Motion Picture Association of America (MPAA) that requires values for specific parameter values to be set. Please ensure you set the values for the required parameters for the policy in the below section.",
                                        "style": "Warning"
                                    }
                                },
                                {
                                    "name": "regCompPolParMPAACertificateThumb",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Certificate thumbprints that should exist under the Trusted Root",
                                    "toolTip": "A semicolon-separated list of certificate thumbprints that should exist under the Trusted Root certificate store (Cert:\\LocalMachine\\Root). e.g. THUMBPRINT1;THUMBPRINT2;THUMBPRINT3",
                                    "constraints": {
                                        "required": false
                                    }
                                },
                                {
                                    "name": "regCompPolParMPAAApplicationName",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Application names to be installed on VMs",
                                    "toolTip": "A semicolon-separated list of the names of the applications that should be installed. e.g. 'python; powershell; Microsoft SQL Server 2014 (64-bit); Microsoft Visual Studio Code' or 'Microsoft SQL Server 2014*' (to match any application starting with 'Microsoft SQL Server 2014')'",
                                    "constraints": {
                                        "required": false
                                    }
                                },
                                {
                                    "name": "regCompPolParMPAAStoragePrefix",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Storage Account Prefix for Regional Storage Account to deploy diagnostic settings for Network Security Groups",
                                    "toolTip": "This prefix will be combined with the network security group location to form the created storage account name.",
                                    "constraints": {
                                        "required": false
                                    }
                                },
                                {
                                    "name": "regCompPolParMPAAResGroupPrefix",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Resource Group Name for Storage Account to deploy diagnostic settings for Network Security Groups",
                                    "toolTip": "The resource group that the storage account will be created in.",
                                    "constraints": {
                                        "required": false
                                    }
                                },
                                {
                                    "name": "regCompPolParMPAARBatchMetricName",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Metric name on which alert rules should be configured in Batch accounts",
                                    "toolTip": "The metric name that an alert rule must be enabled on",
                                    "constraints": {
                                        "required": false
                                    }
                                }
                            ],
                            "visible": "[if(contains(map(steps('regulatory').regComplianceSelectorFull, (item) => item.policy.id), '/providers/Microsoft.Authorization/policySetDefinitions/92646f03-e39d-47a9-9e24-58d60ef49af8'), true, false)]"
                        },
                        {
                            "name": "regPolicyParamSovBaseGlobal",
                            "type": "Microsoft.Common.Section",
                            "label": "Sovereignty Baseline - Global Policies - Required Policy Initative Parameters",
                            "elements": [
                                {
                                    "name": "regCompliancePolicyParamSovBaseGlobalNeededWarn",
                                    "type": "Microsoft.Common.InfoBox",
                                    "visible": "true",
                                    "options": {
                                        "text": "You have selected the Regulatory Policy Initaitve of Sovereignty Baseline - Global Policies that requires values for specific parameter values to be set. Please ensure you set the values for the required parameters for the policy in the below section.",
                                        "style": "Warning"
                                    }
                                },
                                {
                                    "name": "regCompPolParSovBaseGlobalRegions",
                                    "type": "Microsoft.Common.DropDown",
                                    "label": "The list of Azure Regions that are approved for usage",
                                    "defaultValue": [
                                        {
                                            "label": "eastus",
                                            "value": "eastus"
                                        },
                                        {
                                            "label": "eastus2",
                                            "value": "eastus2"
                                        },
                                        {
                                            "label": "southcentralus",
                                            "value": "southcentralus"
                                        },
                                        {
                                            "label": "westus2",
                                            "value": "westus2"
                                        },
                                        {
                                            "label": "westus3",
                                            "value": "westus3"
                                        },
                                        {
                                            "label": "australiaeast",
                                            "value": "australiaeast"
                                        },
                                        {
                                            "label": "southeastasia",
                                            "value": "southeastasia"
                                        },
                                        {
                                            "label": "northeurope",
                                            "value": "northeurope"
                                        },
                                        {
                                            "label": "swedencentral",
                                            "value": "swedencentral"
                                        },
                                        {
                                            "label": "uksouth",
                                            "value": "uksouth"
                                        },
                                        {
                                            "label": "westeurope",
                                            "value": "westeurope"
                                        },
                                        {
                                            "label": "centralus",
                                            "value": "centralus"
                                        },
                                        {
                                            "label": "southafricanorth",
                                            "value": "southafricanorth"
                                        },
                                        {
                                            "label": "centralindia",
                                            "value": "centralindia"
                                        },
                                        {
                                            "label": "eastasia",
                                            "value": "eastasia"
                                        },
                                        {
                                            "label": "japaneast",
                                            "value": "japaneast"
                                        },
                                        {
                                            "label": "koreacentral",
                                            "value": "koreacentral"
                                        },
                                        {
                                            "label": "canadacentral",
                                            "value": "canadacentral"
                                        },
                                        {
                                            "label": "francecentral",
                                            "value": "francecentral"
                                        },
                                        {
                                            "label": "germanywestcentral",
                                            "value": "germanywestcentral"
                                        },
                                        {
                                            "label": "italynorth",
                                            "value": "italynorth"
                                        },
                                        {
                                            "label": "norwayeast",
                                            "value": "norwayeast"
                                        },
                                        {
                                            "label": "polandcentral",
                                            "value": "polandcentral"
                                        },
                                        {
                                            "label": "switzerlandnorth",
                                            "value": "switzerlandnorth"
                                        },
                                        {
                                            "label": "uaenorth",
                                            "value": "uaenorth"
                                        },
                                        {
                                            "label": "brazilsouth",
                                            "value": "brazilsouth"
                                        },
                                        {
                                            "label": "centraluseuap",
                                            "value": "centraluseuap"
                                        },
                                        {
                                            "label": "israelcentral",
                                            "value": "israelcentral"
                                        },
                                        {
                                            "label": "qatarcentral",
                                            "value": "qatarcentral"
                                        },
                                        {
                                            "label": "northcentralus",
                                            "value": "northcentralus"
                                        },
                                        {
                                            "label": "westus",
                                            "value": "westus"
                                        },
                                        {
                                            "label": "japanwest",
                                            "value": "japanwest"
                                        },
                                        {
                                            "label": "eastus2euap",
                                            "value": "eastus2euap"
                                        },
                                        {
                                            "label": "westcentralus",
                                            "value": "westcentralus"
                                        },
                                        {
                                            "label": "southafricawest",
                                            "value": "southafricawest"
                                        },
                                        {
                                            "label": "australiacentral",
                                            "value": "australiacentral"
                                        },
                                        {
                                            "label": "australiacentral2",
                                            "value": "australiacentral2"
                                        },
                                        {
                                            "label": "australiasoutheast",
                                            "value": "australiasoutheast"
                                        },
                                        {
                                            "label": "koreasouth",
                                            "value": "koreasouth"
                                        },
                                        {
                                            "label": "southindia",
                                            "value": "southindia"
                                        },
                                        {
                                            "label": "westindia",
                                            "value": "westindia"
                                        },
                                        {
                                            "label": "canadaeast",
                                            "value": "canadaeast"
                                        },
                                        {
                                            "label": "francesouth",
                                            "value": "francesouth"
                                        },
                                        {
                                            "label": "germanynorth",
                                            "value": "germanynorth"
                                        },
                                        {
                                            "label": "norwaywest",
                                            "value": "norwaywest"
                                        },
                                        {
                                            "label": "switzerlandwest",
                                            "value": "switzerlandwest"
                                        },
                                        {
                                            "label": "ukwest",
                                            "value": "ukwest"
                                        },
                                        {
                                            "label": "uaecentral",
                                            "value": "uaecentral"
                                        },
                                        {
                                            "label": "brazilsoutheast",
                                            "value": "brazilsoutheast"
                                        }
                                    ],
                                    "toolTip": "Any non-global resources attempted to be deployed outsize of this region will be restricted.",
                                    "multiselect": true,
                                    "selectAll": true,
                                    "filter": true,
                                    "filterPlaceholder": "Filter Azure Regions...",
                                    "constraints": {
                                        "allowedValues": [
                                            {
                                                "label": "eastus",
                                                "value": "eastus"
                                            },
                                            {
                                                "label": "eastus2",
                                                "value": "eastus2"
                                            },
                                            {
                                                "label": "southcentralus",
                                                "value": "southcentralus"
                                            },
                                            {
                                                "label": "westus2",
                                                "value": "westus2"
                                            },
                                            {
                                                "label": "westus3",
                                                "value": "westus3"
                                            },
                                            {
                                                "label": "australiaeast",
                                                "value": "australiaeast"
                                            },
                                            {
                                                "label": "southeastasia",
                                                "value": "southeastasia"
                                            },
                                            {
                                                "label": "northeurope",
                                                "value": "northeurope"
                                            },
                                            {
                                                "label": "swedencentral",
                                                "value": "swedencentral"
                                            },
                                            {
                                                "label": "uksouth",
                                                "value": "uksouth"
                                            },
                                            {
                                                "label": "westeurope",
                                                "value": "westeurope"
                                            },
                                            {
                                                "label": "centralus",
                                                "value": "centralus"
                                            },
                                            {
                                                "label": "southafricanorth",
                                                "value": "southafricanorth"
                                            },
                                            {
                                                "label": "centralindia",
                                                "value": "centralindia"
                                            },
                                            {
                                                "label": "eastasia",
                                                "value": "eastasia"
                                            },
                                            {
                                                "label": "japaneast",
                                                "value": "japaneast"
                                            },
                                            {
                                                "label": "koreacentral",
                                                "value": "koreacentral"
                                            },
                                            {
                                                "label": "canadacentral",
                                                "value": "canadacentral"
                                            },
                                            {
                                                "label": "francecentral",
                                                "value": "francecentral"
                                            },
                                            {
                                                "label": "germanywestcentral",
                                                "value": "germanywestcentral"
                                            },
                                            {
                                                "label": "italynorth",
                                                "value": "italynorth"
                                            },
                                            {
                                                "label": "norwayeast",
                                                "value": "norwayeast"
                                            },
                                            {
                                                "label": "polandcentral",
                                                "value": "polandcentral"
                                            },
                                            {
                                                "label": "switzerlandnorth",
                                                "value": "switzerlandnorth"
                                            },
                                            {
                                                "label": "uaenorth",
                                                "value": "uaenorth"
                                            },
                                            {
                                                "label": "brazilsouth",
                                                "value": "brazilsouth"
                                            },
                                            {
                                                "label": "centraluseuap",
                                                "value": "centraluseuap"
                                            },
                                            {
                                                "label": "israelcentral",
                                                "value": "israelcentral"
                                            },
                                            {
                                                "label": "qatarcentral",
                                                "value": "qatarcentral"
                                            },
                                            {
                                                "label": "northcentralus",
                                                "value": "northcentralus"
                                            },
                                            {
                                                "label": "westus",
                                                "value": "westus"
                                            },
                                            {
                                                "label": "japanwest",
                                                "value": "japanwest"
                                            },
                                            {
                                                "label": "eastus2euap",
                                                "value": "eastus2euap"
                                            },
                                            {
                                                "label": "westcentralus",
                                                "value": "westcentralus"
                                            },
                                            {
                                                "label": "southafricawest",
                                                "value": "southafricawest"
                                            },
                                            {
                                                "label": "australiacentral",
                                                "value": "australiacentral"
                                            },
                                            {
                                                "label": "australiacentral2",
                                                "value": "australiacentral2"
                                            },
                                            {
                                                "label": "australiasoutheast",
                                                "value": "australiasoutheast"
                                            },
                                            {
                                                "label": "koreasouth",
                                                "value": "koreasouth"
                                            },
                                            {
                                                "label": "southindia",
                                                "value": "southindia"
                                            },
                                            {
                                                "label": "westindia",
                                                "value": "westindia"
                                            },
                                            {
                                                "label": "canadaeast",
                                                "value": "canadaeast"
                                            },
                                            {
                                                "label": "francesouth",
                                                "value": "francesouth"
                                            },
                                            {
                                                "label": "germanynorth",
                                                "value": "germanynorth"
                                            },
                                            {
                                                "label": "norwaywest",
                                                "value": "norwaywest"
                                            },
                                            {
                                                "label": "switzerlandwest",
                                                "value": "switzerlandwest"
                                            },
                                            {
                                                "label": "ukwest",
                                                "value": "ukwest"
                                            },
                                            {
                                                "label": "uaecentral",
                                                "value": "uaecentral"
                                            },
                                            {
                                                "label": "brazilsoutheast",
                                                "value": "brazilsoutheast"
                                            }
                                        ],
                                        "required": true
                                    },
                                    "visible": true
                                }
                            ],
                            "visible": "[if(contains(map(steps('regulatory').regComplianceSelectorFull, (item) => item.policy.id), '/providers/Microsoft.Authorization/policySetDefinitions/c1cbff38-87c0-4b9f-9f70-035c7a3b5523'), true, false)]"
                        },
                        {
                            "name": "regPolicyParamSovBaseConf",
                            "type": "Microsoft.Common.Section",
                            "label": "Sovereignty Baseline - Confidential Policies - Required Policy Initative Parameters",
                            "elements": [
                                {
                                    "name": "regCompliancePolicyParamSovBaseConfNeededWarn",
                                    "type": "Microsoft.Common.InfoBox",
                                    "visible": "true",
                                    "options": {
                                        "text": "You have selected the Regulatory Policy Initaitve of Sovereignty Baseline - Confidential Policies that requires values for specific parameter values to be set. Please ensure you set the values for the required parameters for the policy in the below section.",
                                        "style": "Warning"
                                    }
                                },
                                {
                                    "name": "regCompPolParSovBaseConfRegions",
                                    "type": "Microsoft.Common.DropDown",
                                    "label": "The list of Azure Regions that are approved for usage",
                                    "defaultValue": [
                                        {
                                            "label": "eastus",
                                            "value": "eastus"
                                        },
                                        {
                                            "label": "eastus2",
                                            "value": "eastus2"
                                        },
                                        {
                                            "label": "southcentralus",
                                            "value": "southcentralus"
                                        },
                                        {
                                            "label": "westus2",
                                            "value": "westus2"
                                        },
                                        {
                                            "label": "westus3",
                                            "value": "westus3"
                                        },
                                        {
                                            "label": "australiaeast",
                                            "value": "australiaeast"
                                        },
                                        {
                                            "label": "southeastasia",
                                            "value": "southeastasia"
                                        },
                                        {
                                            "label": "northeurope",
                                            "value": "northeurope"
                                        },
                                        {
                                            "label": "swedencentral",
                                            "value": "swedencentral"
                                        },
                                        {
                                            "label": "uksouth",
                                            "value": "uksouth"
                                        },
                                        {
                                            "label": "westeurope",
                                            "value": "westeurope"
                                        },
                                        {
                                            "label": "centralus",
                                            "value": "centralus"
                                        },
                                        {
                                            "label": "southafricanorth",
                                            "value": "southafricanorth"
                                        },
                                        {
                                            "label": "centralindia",
                                            "value": "centralindia"
                                        },
                                        {
                                            "label": "eastasia",
                                            "value": "eastasia"
                                        },
                                        {
                                            "label": "japaneast",
                                            "value": "japaneast"
                                        },
                                        {
                                            "label": "koreacentral",
                                            "value": "koreacentral"
                                        },
                                        {
                                            "label": "canadacentral",
                                            "value": "canadacentral"
                                        },
                                        {
                                            "label": "francecentral",
                                            "value": "francecentral"
                                        },
                                        {
                                            "label": "germanywestcentral",
                                            "value": "germanywestcentral"
                                        },
                                        {
                                            "label": "italynorth",
                                            "value": "italynorth"
                                        },
                                        {
                                            "label": "norwayeast",
                                            "value": "norwayeast"
                                        },
                                        {
                                            "label": "polandcentral",
                                            "value": "polandcentral"
                                        },
                                        {
                                            "label": "switzerlandnorth",
                                            "value": "switzerlandnorth"
                                        },
                                        {
                                            "label": "uaenorth",
                                            "value": "uaenorth"
                                        },
                                        {
                                            "label": "brazilsouth",
                                            "value": "brazilsouth"
                                        },
                                        {
                                            "label": "centraluseuap",
                                            "value": "centraluseuap"
                                        },
                                        {
                                            "label": "israelcentral",
                                            "value": "israelcentral"
                                        },
                                        {
                                            "label": "qatarcentral",
                                            "value": "qatarcentral"
                                        },
                                        {
                                            "label": "northcentralus",
                                            "value": "northcentralus"
                                        },
                                        {
                                            "label": "westus",
                                            "value": "westus"
                                        },
                                        {
                                            "label": "japanwest",
                                            "value": "japanwest"
                                        },
                                        {
                                            "label": "eastus2euap",
                                            "value": "eastus2euap"
                                        },
                                        {
                                            "label": "westcentralus",
                                            "value": "westcentralus"
                                        },
                                        {
                                            "label": "southafricawest",
                                            "value": "southafricawest"
                                        },
                                        {
                                            "label": "australiacentral",
                                            "value": "australiacentral"
                                        },
                                        {
                                            "label": "australiacentral2",
                                            "value": "australiacentral2"
                                        },
                                        {
                                            "label": "australiasoutheast",
                                            "value": "australiasoutheast"
                                        },
                                        {
                                            "label": "koreasouth",
                                            "value": "koreasouth"
                                        },
                                        {
                                            "label": "southindia",
                                            "value": "southindia"
                                        },
                                        {
                                            "label": "westindia",
                                            "value": "westindia"
                                        },
                                        {
                                            "label": "canadaeast",
                                            "value": "canadaeast"
                                        },
                                        {
                                            "label": "francesouth",
                                            "value": "francesouth"
                                        },
                                        {
                                            "label": "germanynorth",
                                            "value": "germanynorth"
                                        },
                                        {
                                            "label": "norwaywest",
                                            "value": "norwaywest"
                                        },
                                        {
                                            "label": "switzerlandwest",
                                            "value": "switzerlandwest"
                                        },
                                        {
                                            "label": "ukwest",
                                            "value": "ukwest"
                                        },
                                        {
                                            "label": "uaecentral",
                                            "value": "uaecentral"
                                        },
                                        {
                                            "label": "brazilsoutheast",
                                            "value": "brazilsoutheast"
                                        }
                                    ],
                                    "toolTip": "Any non-global resources attempted to be deployed outsize of this region will be restricted.",
                                    "multiselect": true,
                                    "selectAll": true,
                                    "filter": true,
                                    "filterPlaceholder": "Filter Azure Regions...",
                                    "constraints": {
                                        "allowedValues": [
                                            {
                                                "label": "eastus",
                                                "value": "eastus"
                                            },
                                            {
                                                "label": "eastus2",
                                                "value": "eastus2"
                                            },
                                            {
                                                "label": "southcentralus",
                                                "value": "southcentralus"
                                            },
                                            {
                                                "label": "westus2",
                                                "value": "westus2"
                                            },
                                            {
                                                "label": "westus3",
                                                "value": "westus3"
                                            },
                                            {
                                                "label": "australiaeast",
                                                "value": "australiaeast"
                                            },
                                            {
                                                "label": "southeastasia",
                                                "value": "southeastasia"
                                            },
                                            {
                                                "label": "northeurope",
                                                "value": "northeurope"
                                            },
                                            {
                                                "label": "swedencentral",
                                                "value": "swedencentral"
                                            },
                                            {
                                                "label": "uksouth",
                                                "value": "uksouth"
                                            },
                                            {
                                                "label": "westeurope",
                                                "value": "westeurope"
                                            },
                                            {
                                                "label": "centralus",
                                                "value": "centralus"
                                            },
                                            {
                                                "label": "southafricanorth",
                                                "value": "southafricanorth"
                                            },
                                            {
                                                "label": "centralindia",
                                                "value": "centralindia"
                                            },
                                            {
                                                "label": "eastasia",
                                                "value": "eastasia"
                                            },
                                            {
                                                "label": "japaneast",
                                                "value": "japaneast"
                                            },
                                            {
                                                "label": "koreacentral",
                                                "value": "koreacentral"
                                            },
                                            {
                                                "label": "canadacentral",
                                                "value": "canadacentral"
                                            },
                                            {
                                                "label": "francecentral",
                                                "value": "francecentral"
                                            },
                                            {
                                                "label": "germanywestcentral",
                                                "value": "germanywestcentral"
                                            },
                                            {
                                                "label": "italynorth",
                                                "value": "italynorth"
                                            },
                                            {
                                                "label": "norwayeast",
                                                "value": "norwayeast"
                                            },
                                            {
                                                "label": "polandcentral",
                                                "value": "polandcentral"
                                            },
                                            {
                                                "label": "switzerlandnorth",
                                                "value": "switzerlandnorth"
                                            },
                                            {
                                                "label": "uaenorth",
                                                "value": "uaenorth"
                                            },
                                            {
                                                "label": "brazilsouth",
                                                "value": "brazilsouth"
                                            },
                                            {
                                                "label": "centraluseuap",
                                                "value": "centraluseuap"
                                            },
                                            {
                                                "label": "israelcentral",
                                                "value": "israelcentral"
                                            },
                                            {
                                                "label": "qatarcentral",
                                                "value": "qatarcentral"
                                            },
                                            {
                                                "label": "northcentralus",
                                                "value": "northcentralus"
                                            },
                                            {
                                                "label": "westus",
                                                "value": "westus"
                                            },
                                            {
                                                "label": "japanwest",
                                                "value": "japanwest"
                                            },
                                            {
                                                "label": "eastus2euap",
                                                "value": "eastus2euap"
                                            },
                                            {
                                                "label": "westcentralus",
                                                "value": "westcentralus"
                                            },
                                            {
                                                "label": "southafricawest",
                                                "value": "southafricawest"
                                            },
                                            {
                                                "label": "australiacentral",
                                                "value": "australiacentral"
                                            },
                                            {
                                                "label": "australiacentral2",
                                                "value": "australiacentral2"
                                            },
                                            {
                                                "label": "australiasoutheast",
                                                "value": "australiasoutheast"
                                            },
                                            {
                                                "label": "koreasouth",
                                                "value": "koreasouth"
                                            },
                                            {
                                                "label": "southindia",
                                                "value": "southindia"
                                            },
                                            {
                                                "label": "westindia",
                                                "value": "westindia"
                                            },
                                            {
                                                "label": "canadaeast",
                                                "value": "canadaeast"
                                            },
                                            {
                                                "label": "francesouth",
                                                "value": "francesouth"
                                            },
                                            {
                                                "label": "germanynorth",
                                                "value": "germanynorth"
                                            },
                                            {
                                                "label": "norwaywest",
                                                "value": "norwaywest"
                                            },
                                            {
                                                "label": "switzerlandwest",
                                                "value": "switzerlandwest"
                                            },
                                            {
                                                "label": "ukwest",
                                                "value": "ukwest"
                                            },
                                            {
                                                "label": "uaecentral",
                                                "value": "uaecentral"
                                            },
                                            {
                                                "label": "brazilsoutheast",
                                                "value": "brazilsoutheast"
                                            }
                                        ],
                                        "required": true
                                    },
                                    "visible": true
                                }
                            ],
                            "visible": "[if(contains(map(steps('regulatory').regComplianceSelectorFull, (item) => item.policy.id), '/providers/Microsoft.Authorization/policySetDefinitions/03de05a4-c324-4ccd-882f-a814ea8ab9ea'), true, false)]"
                        },
                        {
                            "name": "regPolicyParamSwift2020",
                            "type": "Microsoft.Common.Section",
                            "label": "SWIFT CSP-CSCF v2020 - Required Policy Initative Parameters",
                            "elements": [
                                {
                                    "name": "regCompliancePolicyParamParamSwift2020NeededWarn",
                                    "type": "Microsoft.Common.InfoBox",
                                    "visible": "true",
                                    "options": {
                                        "text": "You have selected the Regulatory Policy Initaitve of SWIFT CSP-CSCF v2020 that requires values for specific parameter values to be set. Please ensure you set the values for the required parameters for the policy in the below section.",
                                        "style": "Warning"
                                    }
                                },
                                {
                                    "name": "regCompPolParSwift2020VmAdminsInclude",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "List of users that must be included in Windows VM Administrators group",
                                    "toolTip": "A semicolon-separated list of users that should be included in the Administrators local group; Ex: Administrator; myUser1; myUser2",
                                    "constraints": {
                                        "required": false
                                    }
                                },
                                {
                                    "name": "regCompPolParSwift2020DomainFqdn",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Domain Name (FQDN)",
                                    "toolTip": "The fully qualified domain name (FQDN) that the Windows VMs should be joined to",
                                    "constraints": {
                                        "required": false
                                    }
                                }
                            ],
                            "visible": "[if(contains(map(steps('regulatory').regComplianceSelectorFull, (item) => item.policy.id), '/providers/Microsoft.Authorization/policySetDefinitions/3e0c67fc-8c7c-406c-89bd-6b6bdc986a22'), true, false)]"
                        },
                        {
                            "name": "regPolicyParamCanadaFedPbmm",
                            "type": "Microsoft.Common.Section",
                            "label": "Canada Federal PBMM - Required Policy Initative Parameters",
                            "elements": [
                                {
                                    "name": "regCompliancePolicyParamCanadaFedPbmmNeededWarn",
                                    "type": "Microsoft.Common.InfoBox",
                                    "visible": "true",
                                    "options": {
                                        "text": "You have selected the Regulatory Policy Initaitve of Canada Federal PBMM that requires values for specific parameter values to be set. Please ensure you set the values for the required parameters for the policy in the below section.",
                                        "style": "Warning"
                                    }
                                },
                                {
                                    "name": "regCompPolParCanadaFedPbmmVmAdminsInclude",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "List of users that must be included in Windows VM Administrators group",
                                    "toolTip": "A semicolon-separated list of users that should be included in the Administrators local group; Ex: Administrator; myUser1; myUser2",
                                    "constraints": {
                                        "required": false
                                    }
                                },
                                {
                                    "name": "regCompPolParCanadaFedPbmmVmAdminsExclude",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "List of users that must be excluded in Windows VM Administrators group",
                                    "toolTip": "A semicolon-separated list of users that should be excluded in the Administrators local group; Ex: Administrator; myUser1; myUser2",
                                    "constraints": {
                                        "required": false
                                    }
                                }
                            ],
                            "visible": "[if(contains(map(steps('regulatory').regComplianceSelectorFull, (item) => item.policy.id), '/providers/Microsoft.Authorization/policySetDefinitions/4c4a5f27-de81-430b-b4e5-9cbd50595a87'), true, false)]"
                        },
                        {
                            "name": "regPolicyParamCisV2",
                            "type": "Microsoft.Common.Section",
                            "label": "CIS Microsoft Azure Foundations Benchmark v2.0.0 - Required Policy Initative Parameters",
                            "elements": [
                                {
                                    "name": "regCompliancePolicyParamCisV2NeededWarn",
                                    "type": "Microsoft.Common.InfoBox",
                                    "visible": "true",
                                    "options": {
                                        "text": "You have selected the Regulatory Policy Initaitve of CIS Microsoft Azure Foundations Benchmark v2.0.0 that requires values for specific parameter values to be set. Please ensure you set the values for the required parameters for the policy in the below section.",
                                        "style": "Warning"
                                    }
                                },
                                {
                                    "name": "regCompPolParCisV2KeyVaultKeysRotateDays",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "The maximum number of days before Keys in a Key Vault should be rotated.",
                                    "toolTip": "Keys should have a rotation policy ensuring that their rotation is scheduled within the specified number of days after creation.",
                                    "constraints": {
                                        "required": false
                                    },
                                    "defaultValue": 90
                                }
                            ],
                            "visible": "[if(contains(map(steps('regulatory').regComplianceSelectorFull, (item) => item.policy.id), '/providers/Microsoft.Authorization/policySetDefinitions/06f19060-9e68-4070-92ca-f15cc126059e'), true, false)]"
                        },
                        {
                            "name": "regPolicyParamCmmcL3",
                            "type": "Microsoft.Common.Section",
                            "label": "CMMC Level 3 - Required Policy Initative Parameters",
                            "elements": [
                                {
                                    "name": "regCompliancePolicyCmmcL3NeededWarn",
                                    "type": "Microsoft.Common.InfoBox",
                                    "visible": "true",
                                    "options": {
                                        "text": "You have selected the Regulatory Policy Initaitve of CMMC Level 3 that requires values for specific parameter values to be set. Please ensure you set the values for the required parameters for the policy in the below section.",
                                        "style": "Warning"
                                    }
                                },
                                {
                                    "name": "regCompPolParCmmcL3VmAdminsInclude",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "List of users that must be included in Windows VM Administrators group",
                                    "toolTip": "A semicolon-separated list of users that should be included in the Administrators local group; Ex: Administrator; myUser1; myUser2",
                                    "constraints": {
                                        "required": false
                                    }
                                },
                                {
                                    "name": "regCompPolParCmmcL3VmAdminsExclude",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "List of users that must be excluded in Windows VM Administrators group",
                                    "toolTip": "A semicolon-separated list of users that should be excluded in the Administrators local group; Ex: Administrator; myUser1; myUser2",
                                    "constraints": {
                                        "required": false
                                    }
                                }
                            ],
                            "visible": "[if(contains(map(steps('regulatory').regComplianceSelectorFull, (item) => item.policy.id), '/providers/Microsoft.Authorization/policySetDefinitions/b5629c75-5c77-4422-87b9-2509e680f8de'), true, false)]"
                        },
                        {
                            "name": "regPolicyParamHitrustHipaa",
                            "type": "Microsoft.Common.Section",
                            "label": "HITRUST/HIPAA - Required Policy Initative Parameters",
                            "elements": [
                                {
                                    "name": "regCompliancePolicyParamHitrustHipaaNeededWarn",
                                    "type": "Microsoft.Common.InfoBox",
                                    "visible": "true",
                                    "options": {
                                        "text": "You have selected the Regulatory Policy Initaitve of HITRUST/HIPAA that requires values for specific parameter values to be set. Please ensure you set the values for the required parameters for the policy in the below section.",
                                        "style": "Warning"
                                    }
                                },
                                {
                                    "name": "regCompPolParHitrustHipaaCertificateThumb",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Certificate thumbprints that should exist under the Trusted Root",
                                    "toolTip": "A semicolon-separated list of certificate thumbprints that should exist under the Trusted Root certificate store (Cert:\\LocalMachine\\Root). e.g. THUMBPRINT1;THUMBPRINT2;THUMBPRINT3",
                                    "constraints": {
                                        "required": false
                                    }
                                },
                                {
                                    "name": "regCompPolParHitrustHipaaApplicationName",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Application names to be installed on VMs",
                                    "toolTip": "A semicolon-separated list of the names of the applications that should be installed. e.g. 'python; powershell; Microsoft SQL Server 2014 (64-bit); Microsoft Visual Studio Code' or 'Microsoft SQL Server 2014*' (to match any application starting with 'Microsoft SQL Server 2014')'",
                                    "constraints": {
                                        "required": false
                                    }
                                },
                                {
                                    "name": "regCompPolParHitrustHipaaStoragePrefix",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Storage Account Prefix for Regional Storage Account to deploy diagnostic settings for Network Security Groups",
                                    "toolTip": "This prefix will be combined with the network security group location to form the created storage account name.",
                                    "constraints": {
                                        "required": false
                                    }
                                },
                                {
                                    "name": "regCompPolParHitrustHipaaResGroupPrefix",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Resource Group Name for Storage Account to deploy diagnostic settings for Network Security Groups",
                                    "toolTip": "The resource group that the storage account will be created in.",
                                    "constraints": {
                                        "required": false
                                    }
                                }
                            ],
                            "visible": "[if(contains(map(steps('regulatory').regComplianceSelectorFull, (item) => item.policy.id), '/providers/Microsoft.Authorization/policySetDefinitions/a169a624-5599-4385-a696-c8d643089fab'), true, false)]"
                        },
                        {
                            "name": "regPolicyParamIrs1075Sep2016",
                            "type": "Microsoft.Common.Section",
                            "label": "IRS1075 September 2016 - Required Policy Initative Parameters",
                            "elements": [
                                {
                                    "name": "regCompliancePolicyIrs1075Sep2016NeededWarn",
                                    "type": "Microsoft.Common.InfoBox",
                                    "visible": "true",
                                    "options": {
                                        "text": "You have selected the Regulatory Policy Initaitve of IRS1075 September 2016 that requires values for specific parameter values to be set. Please ensure you set the values for the required parameters for the policy in the below section.",
                                        "style": "Warning"
                                    }
                                },
                                {
                                    "name": "regCompPolParIrs1075Sep2016VmAdminsInclude",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "List of users that must be included in Windows VM Administrators group",
                                    "toolTip": "A semicolon-separated list of users that should be included in the Administrators local group; Ex: Administrator; myUser1; myUser2",
                                    "constraints": {
                                        "required": false
                                    }
                                },
                                {
                                    "name": "regCompPolParIrs1075Sep2016VmAdminsExclude",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "List of users that must be excluded in Windows VM Administrators group",
                                    "toolTip": "A semicolon-separated list of users that should be excluded in the Administrators local group; Ex: Administrator; myUser1; myUser2",
                                    "constraints": {
                                        "required": false
                                    }
                                }
                            ],
                            "visible": "[if(contains(map(steps('regulatory').regComplianceSelectorFull, (item) => item.policy.id), '/providers/Microsoft.Authorization/policySetDefinitions/105e0327-6175-4eb2-9af4-1fba43bdb39d'), true, false)]"
                        },
                        {
                            "name": "regPolicyParamNistSp800171R2",
                            "type": "Microsoft.Common.Section",
                            "label": "NIST SP 800-171 Rev. 2 - Required Policy Initative Parameters",
                            "elements": [
                                {
                                    "name": "regCompliancePolicyNistSp800171R2NeededWarn",
                                    "type": "Microsoft.Common.InfoBox",
                                    "visible": "true",
                                    "options": {
                                        "text": "You have selected the Regulatory Policy Initaitve of NIST SP 800-171 Rev. 2 that requires values for specific parameter values to be set. Please ensure you set the values for the required parameters for the policy in the below section.",
                                        "style": "Warning"
                                    }
                                },
                                {
                                    "name": "regCompPolParNistSp800171R2VmAdminsInclude",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "List of users that must be included in Windows VM Administrators group",
                                    "toolTip": "A semicolon-separated list of users that should be included in the Administrators local group; Ex: Administrator; myUser1; myUser2",
                                    "constraints": {
                                        "required": false
                                    }
                                },
                                {
                                    "name": "regCompPolParNistSp800171R2VmAdminsExclude",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "List of users that must be excluded in Windows VM Administrators group",
                                    "toolTip": "A semicolon-separated list of users that should be excluded in the Administrators local group; Ex: Administrator; myUser1; myUser2",
                                    "constraints": {
                                        "required": false
                                    }
                                }
                            ],
                            "visible": "[if(contains(map(steps('regulatory').regComplianceSelectorFull, (item) => item.policy.id), '/providers/Microsoft.Authorization/policySetDefinitions/03055927-78bd-4236-86c0-f36125a10dc9'), true, false)]"
                        },
                        {
                            "name": "regPolicyParamNewZelandIsmRestricted",
                            "type": "Microsoft.Common.Section",
                            "label": "New Zealand ISM Restricted - Required Policy Initative Parameters",
                            "elements": [
                                {
                                    "name": "regCompliancePolicyParamNewZelandIsmRestrictedNeededWarn",
                                    "type": "Microsoft.Common.InfoBox",
                                    "visible": "true",
                                    "options": {
                                        "text": "You have selected the Regulatory Policy Initaitve of New Zeland ISM Restricted that requires values for specific parameter values to be set. Please ensure you set the values for the required parameters for the policy in the below section.",
                                        "style": "Warning"
                                    }
                                },
                                {
                                    "name": "regCompPolParNZIsmRestrictedVmAdminsInclude",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "List of users that must be included in Windows VM Administrators group",
                                    "toolTip": "A semicolon-separated list of users that should be included in the Administrators local group; Ex: Administrator; myUser1; myUser2",
                                    "constraints": {
                                        "required": false
                                    }
                                },
                                {
                                    "name": "regCompPolParNZIsmRestrictedVmAdminsExclude",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "List of users that must be excluded in Windows VM Administrators group",
                                    "toolTip": "A semicolon-separated list of users that should be excluded in the Administrators local group; Ex: Administrator; myUser1; myUser2",
                                    "constraints": {
                                        "required": false
                                    }
                                }
                            ],
                            "visible": "[if(contains(map(steps('regulatory').regComplianceSelectorFull, (item) => item.policy.id), '/providers/Microsoft.Authorization/policySetDefinitions/d1a462af-7e6d-4901-98ac-61570b4ed22a'), true, false)]"
                        },
                        {
                            "name": "regPolicyParamSoc2Type2",
                            "type": "Microsoft.Common.Section",
                            "label": "SOC 2 Type 2 - Required Policy Initative Parameters",
                            "elements": [
                                {
                                    "name": "regCompliancePolicySoc2Type2NeededWarn",
                                    "type": "Microsoft.Common.InfoBox",
                                    "visible": "true",
                                    "options": {
                                        "text": "You have selected the Regulatory Policy Initaitve of SOC 2 Type 2 that requires values for specific parameter values to be set. Please ensure you set the values for the required parameters for the policy in the below section.",
                                        "style": "Warning"
                                    }
                                },
                                {
                                    "name": "regCompPolParSoc2Type2AllowedRegistries",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "AKS + Arc K8s - Allowed registry or registries regex",
                                    "toolTip": "The RegEx rule used to match allowed container image field in a Kubernetes cluster. For example, to allow any Azure Container Registry image by matching partial path: ^[^\\/]+\\.azurecr\\.io\\/.+$ and for multiple registries: ^([^\\/]+\\.azurecr\\.io|registry\\.io)\\/.+$",
                                    "constraints": {
                                        "required": false
                                    },
                                    "defaultValue": "^[^\\/]+\\.azurecr\\.io\\/.+$"
                                },
                                {
                                    "name": "regCompPolParSoc2Type2MaxCpuUnits",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "AKS + Arc K8s - Max allowed CPU units",
                                    "toolTip": "The maximum CPU units allowed for a container. E.g. 200m. For more information, please refer <a href=\"https://aka.ms/k8s-policy-pod-limits\">https://aka.ms/k8s-policy-pod-limits</a> ",
                                    "constraints": {
                                        "required": false
                                    },
                                    "defaultValue": "200m"
                                },
                                {
                                    "name": "regCompPolParSoc2Type2MaxMemoryBytes",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "AKS + Arc K8s - Max allowed memory bytes",
                                    "toolTip": "The maximum memory bytes allowed for a container. E.g. 1Gi. For more information, please refer <a href=\"https://aka.ms/k8s-policy-pod-limits\">https://aka.ms/k8s-policy-pod-limits</a> ",
                                    "constraints": {
                                        "required": false
                                    },
                                    "defaultValue": "1Gi"
                                }
                            ],
                            "visible": "[if(contains(map(steps('regulatory').regComplianceSelectorFull, (item) => item.policy.id), '/providers/Microsoft.Authorization/policySetDefinitions/4054785f-702b-4a98-9215-009cbd58b141'), true, false)]"
                        }
                    ]
                }
            ]
        },
        "outputs": {
            "parameters": {
                "enterpriseScaleCompanyPrefix": "[steps('core').enterpriseScaleCompanyPrefix]",
                "singlePlatformSubscriptionId": "[steps('core').singleSubscription.selector]",
                "denyClassicResources": "[steps('core').denyClassicResources]",
                "denyVMUnmanagedDisk": "[steps('core').denyVMUnmanagedDisk]",
                "telemetryOptOut": "[steps('core').cuaSection.telemetryOptOut]",
                "enforceKvGuardrailsPlat": "[steps('management').esPlatformMgmtGroup.enforceKvGuardrailsPlat]",
                "enableLogAnalytics": "[steps('management').enableLogAnalytics]",
                "enableChangeTracking": "[steps('management').enableChangeTracking]",
                "enableUpdateMgmt": "[steps('management').enableUpdateMgmt]",
                "enableVmInsights": "[steps('management').enableVmInsights]",
                "retentionInDays": "[string(steps('management').retentionInDays)]",
                "managementSubscriptionId": "[steps('management').esMgmtSubSection.esMgmtSub]",
                "enableAsc": "[steps('management').enableAsc]",
                "emailContactAsc": "[steps('management').emailContactAsc]",
                "enableAscForServers": "[steps('management').enableAscForServers]",
                "enableAscForServersVulnerabilityAssessments": "[steps('management').enableAscForServersVulnerabilityAssessments]",
                "vulnerabilityAssessmentProvider": "[steps('management').vulnerabilityAssessmentProvider]",
                "enableAscForOssDb": "[steps('management').enableAscForOssDb]",
                "enableAscForCosmosDbs": "[steps('management').enableAscForCosmosDbs]",
                "enableAscForAppServices": "[steps('management').enableAscForAppServices]",
                "enableAscForStorage": "[steps('management').enableAscForStorage]",
                "enableAscForSql": "[steps('management').enableAscForSql]",
                "enableAscForSqlOnVm": "[steps('management').enableAscForSqlOnVm]",
                "enableAscForKeyVault": "[steps('management').enableAscForKeyVault]",
                "enableAscForArm": "[steps('management').enableAscForArm]",
                "enableAscForApis": "[steps('management').enableAscForApis]",
                "enableAscForCspm": "[steps('management').enableAscForCspm]",
                "enableAscForDns": "[steps('management').enableAscForDns]",
                "enableAscForContainers": "[steps('management').enableAscForContainers]",
                "enableMDEndpoints": "[steps('management').enableMDEndpoints]",
                "enableMonitorBaselines": "[steps('monitor').enableMonitorBaselines]",
                "monitorAlertsResourceGroup": "[steps('monitor').monitorAlertsResourceGroup]",
                "emailContactActionGroup": "[steps('monitor').emailContactActionGroup]",
                "enableMonitorConnectivity": "[steps('monitor').enableMonitorConnectivity]",
                "enableMonitorIdentity": "[steps('monitor').enableMonitorIdentity]",
                "enableMonitorManagement": "[steps('monitor').enableMonitorManagement]",
                "enableMonitorLandingZones": "[steps('monitor').enableMonitorLandingZones]",
                "connectivitySubscriptionId": "[if(not(equals(steps('connectivity').esNwSubSection.esNwSub,steps('management').esMgmtSubSection.esMgmtSub)),steps('connectivity').esNwSubSection.esNwSub,'')]",
                "addressPrefix": "[coalesce(steps('connectivity').esAddressHubVWAN, steps('connectivity').esAddressHubHS, '')]",
                "connectivityLocation": "[steps('connectivity').connectivityLocation]",
                "enableDdoS": "[steps('connectivity').enableDdoS]",
                "enablePrivateDnsZones": "[steps('connectivity').enablePrivateDnsZones]",
                "privateDnsZonesToDeploy": "[steps('connectivity').privateDnsZones]",
                "enableVpnGw": "[steps('connectivity').enableVpnGw]",
                "gwRegionalOrAz": "[steps('connectivity').gwRegionalOrAz]",
                "enableVpnActiveActive": "[steps('connectivity').enableVpnActiveActive]",
                "gwRegionalSku": "[coalesce(steps('connectivity').gwRegionalSku, steps('connectivity').esGwNoAzSku)]",
                "gwAzSku": "[steps('connectivity').gwAzSku]",
                "vpnGateWayScaleUnit": "[steps('connectivity').vpnGateWayScaleUnit]",
                "subnetMaskForGw": "[steps('connectivity').subnetMaskForGw]",
                "enableErGw": "[steps('connectivity').enableErGw]",
                "erAzSku": "[steps('connectivity').erAzSku]",
                "erRegionalSku": "[coalesce(steps('connectivity').erRegionalSku, steps('connectivity').esErNoAzSku)]",
                "erRegionalOrAz": "[steps('connectivity').erRegionalOrAz]",
                "expressRouteScaleUnit": "[steps('connectivity').expressRouteScaleUnit]",
                "enableHub": "[steps('connectivity').enableHub]",
                "enableAzFw": "[steps('connectivity').enableAzFw]",
                "enableAzFwDnsProxy": "[if(equals(steps('connectivity').firewallSku, 'Basic'), 'No', steps('connectivity').enableAzFwDnsProxy)]",
                "firewallSku": "[steps('connectivity').firewallSku]",
                "firewallZones": "[steps('connectivity').firewallZones]",
                "subnetMaskForAzFw": "[steps('connectivity').subnetMaskForAzFw]",
                "subnetMaskForAzFwMgmt": "[steps('connectivity').subnetMaskForAzFwMgmt]",
                "enablevWANRoutingIntent": "[steps('connectivity').enablevWANRoutingIntent]",
                "internetTrafficRoutingPolicy": "[if(equals(steps('connectivity').vWANRoutingIntentforInternetTraffic, 'Yes'), 'true', 'false')]",
                "privateTrafficRoutingPolicy": "[if(equals(steps('connectivity').vWANRoutingIntentforPrivateTraffic, 'Yes'), 'true', 'false')]",
                "vWANHubRoutingPreference": "[steps('connectivity').vWANHubRoutingPreference]",
                "vWANHubCapacity": "[steps('connectivity').vWANHubCapacity]",
                "addressPrefixSecondary": "[coalesce(steps('connectivity').esNetworkSecondarySubSection.esAddressHubVWANSecondary, steps('connectivity').esNetworkSecondarySubSection.esAddressHubHSSecondary, '')]",
                "connectivityLocationSecondary": "[steps('connectivity').esNetworkSecondarySubSection.connectivityLocationSecondary]",
                "enablePrivateDnsZonesSecondary": "No",
                "privateDnsZonesToDeploySecondary": null,
                "enableVpnGwSecondary": "[steps('connectivity').esNetworkSecondarySubSection.enableVpnGwSecondary]",
                "gwRegionalOrAzSecondary": "[steps('connectivity').esNetworkSecondarySubSection.gwRegionalOrAzSecondary]",
                "enableVpnActiveActiveSecondary": "[steps('connectivity').esNetworkSecondarySubSection.enableVpnActiveActiveSecondary]",
                "gwRegionalSkuSecondary": "[coalesce(steps('connectivity').esNetworkSecondarySubSection.gwRegionalSkuSecondary, steps('connectivity').esNetworkSecondarySubSection.esGwNoAzSkuSecondary)]",
                "gwAzSkuSecondary": "[steps('connectivity').esNetworkSecondarySubSection.gwAzSkuSecondary]",
                "vpnGateWayScaleUnitSecondary": "[steps('connectivity').esNetworkSecondarySubSection.vpnGateWayScaleUnitSecondary]",
                "subnetMaskForGwSecondary": "[steps('connectivity').esNetworkSecondarySubSection.subnetMaskForGwSecondary]",
                "enableErGwSecondary": "[steps('connectivity').esNetworkSecondarySubSection.enableErGwSecondary]",
                "erAzSkuSecondary": "[steps('connectivity').esNetworkSecondarySubSection.erAzSkuSecondary]",
                "erRegionalSkuSecondary": "[coalesce(steps('connectivity').esNetworkSecondarySubSection.erRegionalSkuSecondary, steps('connectivity').esNetworkSecondarySubSection.esErNoAzSkuSecondary)]",
                "erRegionalOrAzSecondary": "[steps('connectivity').esNetworkSecondarySubSection.erRegionalOrAzSecondary]",
                "expressRouteScaleUnitSecondary": "[steps('connectivity').esNetworkSecondarySubSection.expressRouteScaleUnitSecondary]",
                "enableSecondaryRegion": "[steps('core').deploySecondaryRegion]",
                "enableHubSecondary": "[steps('connectivity').enableHub]",
                "enableAzFwSecondary": "[steps('connectivity').esNetworkSecondarySubSection.enableAzFwSecondary]",
                "enableAzFwDnsProxySecondary": "[if(equals(steps('connectivity').esNetworkSecondarySubSection.firewallSkuSecondary, 'Basic'), 'No', steps('connectivity').esNetworkSecondarySubSection.enableAzFwDnsProxySecondary)]",
                "firewallSkuSecondary": "[steps('connectivity').esNetworkSecondarySubSection.firewallSkuSecondary]",
                "firewallZonesSecondary": "[steps('connectivity').esNetworkSecondarySubSection.firewallZonesSecondary]",
                "subnetMaskForAzFwSecondary": "[steps('connectivity').esNetworkSecondarySubSection.subnetMaskForAzFwSecondary]",
                "subnetMaskForAzFwMgmtSecondary": "[steps('connectivity').esNetworkSecondarySubSection.subnetMaskForAzFwMgmtSecondary]",
                "enablevWANRoutingIntentSecondary": "[steps('connectivity').esNetworkSecondarySubSection.enablevWANRoutingIntentSecondary]",
                "internetTrafficRoutingPolicySecondary": "[if(equals(steps('connectivity').esNetworkSecondarySubSection.vWANRoutingIntentforInternetTrafficSecondary, 'Yes'), 'true', 'false')]",
                "privateTrafficRoutingPolicySecondary": "[if(equals(steps('connectivity').esNetworkSecondarySubSection.vWANRoutingIntentforPrivateTrafficSecondary, 'Yes'), 'true', 'false')]",
                "vWANHubRoutingPreferenceSecondary": "[steps('connectivity').esNetworkSecondarySubSection.vWANHubRoutingPreferenceSecondary]",
                "vWANHubCapacitySecondary": "[steps('connectivity').esNetworkSecondarySubSection.vWANHubCapacitySecondary]",
                "identitySubscriptionId": "[if(or(not(equals(steps('identity').esIdentitySubSection.esIdentitySub,steps('management').esMgmtSubSection.esMgmtSub)),not(equals(steps('identity').esIdentitySubSection.esIdentitySub,steps('connectivity').esNwSubSection.esNwSub))),steps('identity').esIdentitySubSection.esIdentitySub,'')]",
                "denyMgmtPortsForIdentity": "[steps('identity').denyMgmtPortsForIdentity]",
                "denySubnetWithoutNsgForIdentity": "[steps('identity').denySubnetWithoutNsgForIdentity]",
                "denyPipForIdentity": "[steps('identity').denyPipForIdentity]",
                "enableVmBackupForIdentity": "[steps('identity').enableVmBackupForIdentity]",
                "identityAddressPrefix": "[steps('identity').identityAddressPrefix]",
                "identityAddressPrefixSecondary": "[steps('identity').esIdentitySecondarySubSection.identityAddressPrefixSecondary]",
                "corpConnectedLzSubscriptionId": "[if(or(not(contains(steps('landingZones').corpSection.esCorpLzSub,steps('management').esMgmtSubSection.esMgmtSub)),not(contains(steps('landingZones').corpSection.esCorpLzSub,steps('connectivity').esNwSubSection.esNwSub))),steps('landingZones').corpSection.lzConnectedSubs,'')]",
                "corpLzSubscriptionId": "[if(or(not(contains(steps('landingZones').corpSection.esCorpLzSub,steps('management').esMgmtSubSection.esMgmtSub)),not(contains(steps('landingZones').corpSection.esCorpLzSub,steps('connectivity').esNwSubSection.esNwSub))),steps('landingZones').corpSection.esCorpLzSub,'')]",
                "onlineLzSubscriptionId": "[if(or(not(contains(steps('landingZones').onlineSection.esOnlineLzSub,steps('management').esMgmtSubSection.esMgmtSub)),not(contains(steps('landingZones').onlineSection.esOnlineLzSub,steps('connectivity').esNwSubSection.esNwSub))),steps('landingZones').onlineSection.esOnlineLzSub,'')]",
                "enableLzDdoS": "[steps('landingZones').lzSection.enableLzDdoS]",
                "denyPublicEndpoints": "[steps('landingZones').corpSection.denyPublicEndpoints]",
                "denyPipOnNicForCorp": "[steps('landingZones').corpSection.denyPipOnNicForCorp]",
                "enablePrivateDnsZonesForLzs": "[steps('landingZones').lzSection.enablePrivateDnsZonesForLzs]",
                "enableEncryptionInTransit": "[steps('landingZones').lzSection.enableEncryptionInTransit]",
                "enableVmMonitoring": "[steps('landingZones').lzSection.enableVmMonitoring]",
                "enableVmssMonitoring": "[steps('landingZones').lzSection.enableVmssMonitoring]",
                "enableVmHybridMonitoring": "[steps('landingZones').lzSection.enableVmHybridMonitoring]",
                "enableAksPolicy": "[steps('landingZones').lzSection.enableAksPolicy]",
                "denyAksPrivileged": "[steps('landingZones').lzSection.denyAksPrivileged]",
                "denyAksPrivilegedEscalation": "[steps('landingZones').lzSection.denyAksPrivilegedEscalation]",
                "denyHttpIngressForAks": "[steps('landingZones').lzSection.denyHttpIngressForAks]",
                "enableVmBackup": "[steps('landingZones').lzSection.enableVmBackup]",
                "denyMgmtPorts": "[steps('landingZones').lzSection.denyMgmtPorts]",
                "denySubnetWithoutNsg": "[steps('landingZones').lzSection.denySubnetWithoutNsg]",
                "denyIpForwarding": "[steps('landingZones').lzSection.denyIpForwarding]",
                "enableSqlEncryption": "[steps('landingZones').lzSection.enableSqlEncryption]",
                "enableSqlThreat": "[steps('landingZones').lzSection.enableSqlThreat]",
                "enableSqlAudit": "[steps('landingZones').lzSection.enableSqlAudit]",
                "enableStorageHttps": "[steps('landingZones').lzSection.enableStorageHttps]",
                "enforceKvGuardrails": "[steps('landingZones').lzSection.enforceKvGuardrails]",
                "denyHybridNetworking": "[steps('landingZones').corpSection.denyHybridNetworking]",
                "auditPeDnsZones": "[steps('landingZones').corpSection.auditPeDnsZones]",
                "auditAppGwWaf": "[steps('landingZones').lzSection.auditAppGwWaf]",
                "enforceAcsb": "[steps('landingZones').lzSection.enforceAcsb]",
                "enableDecommissioned": "[steps('decommissionedSandboxZones').decommSection.enableDecommissioned]",
                "enableSandbox": "[steps('decommissionedSandboxZones').sandboxSection.enableSandbox]",
                "userAssignedIdentityResourceGroup": "[steps('management').userAssignedIdentityResourceGroup]",
                "regulatoryComplianceInitativesToAssign": "[steps('regulatory').regComplianceSelectorFull]",
                "regCompPolParAusGovIsmRestrictedVmAdminsExclude": "[coalesce(steps('regulatory').regPolicyParamAusGovIsmRestricted.regCompPolParAusGovIsmRestrictedVmAdminsExclude, '')]",
                "regCompPolParAusGovIsmRestrictedResourceTypes": "[steps('regulatory').regPolicyParamAusGovIsmRestricted.regCompPolParAusGovIsmRestrictedResourceTypes]",
                "regCompPolParMPAACertificateThumb": "[coalesce(steps('regulatory').regPolicyParamMPAA.regCompPolParMPAACertificateThumb, '')]",
                "regCompPolParMPAAApplicationName": "[coalesce(steps('regulatory').regPolicyParamMPAA.regCompPolParMPAAApplicationName, '')]",
                "regCompPolParMPAAStoragePrefix": "[coalesce(steps('regulatory').regPolicyParamMPAA.regCompPolParMPAAStoragePrefix, '')]",
                "regCompPolParMPAAResGroupPrefix": "[coalesce(steps('regulatory').regPolicyParamMPAA.regCompPolParMPAAResGroupPrefix, '')]",
                "regCompPolParMPAARBatchMetricName": "[coalesce(steps('regulatory').regPolicyParamMPAA.regCompPolParMPAARBatchMetricName, '')]",
                "regCompPolParSovBaseGlobalRegions": "[steps('regulatory').regPolicyParamSovBaseGlobal.regCompPolParSovBaseGlobalRegions]",
                "regCompPolParSovBaseConfRegions": "[steps('regulatory').regPolicyParamSovBaseConf.regCompPolParSovBaseConfRegions]",
                "regCompPolParSwift2020VmAdminsInclude": "[coalesce(steps('regulatory').regPolicyParamSwift2020.regCompPolParSwift2020VmAdminsInclude, '')]",
                "regCompPolParSwift2020DomainFqdn": "[coalesce(steps('regulatory').regPolicyParamSwift2020.regCompPolParSwift2020DomainFqdn, '')]",
                "regCompPolParCanadaFedPbmmVmAdminsInclude": "[coalesce(steps('regulatory').regPolicyParamCanadaFedPbmm.regCompPolParCanadaFedPbmmVmAdminsInclude, '')]",
                "regCompPolParCanadaFedPbmmVmAdminsExclude": "[coalesce(steps('regulatory').regPolicyParamCanadaFedPbmm.regCompPolParCanadaFedPbmmVmAdminsExclude, '')]",
                "regCompPolParCisV2KeyVaultKeysRotateDays": "[coalesce(steps('regulatory').regPolicyParamCisV2.regCompPolParCisV2KeyVaultKeysRotateDays, 90)]",
                "regCompPolParCmmcL3VmAdminsInclude": "[coalesce(steps('regulatory').regPolicyParamCmmcL3.regCompPolParCmmcL3VmAdminsInclude, '')]",
                "regCompPolParCmmcL3VmAdminsExclude": "[coalesce(steps('regulatory').regPolicyParamCmmcL3.regCompPolParCmmcL3VmAdminsExclude, '')]",
                "regCompPolParHitrustHipaaCertificateThumb": "[coalesce(steps('regulatory').regPolicyParamHitrustHipaa.regCompPolParHitrustHipaaCertificateThumb, '')]",
                "regCompPolParHitrustHipaaApplicationName": "[coalesce(steps('regulatory').regPolicyParamHitrustHipaa.regCompPolParHitrustHipaaApplicationName, '')]",
                "regCompPolParHitrustHipaaStoragePrefix": "[coalesce(steps('regulatory').regPolicyParamHitrustHipaa.regCompPolParHitrustHipaaStoragePrefix, '')]",
                "regCompPolParHitrustHipaaResGroupPrefix": "[coalesce(steps('regulatory').regPolicyParamHitrustHipaa.regCompPolParHitrustHipaaResGroupPrefix, '')]",
                "regCompPolParIrs1075Sep2016VmAdminsInclude": "[coalesce(steps('regulatory').regPolicyParamIrs1075Sep2016.regCompPolParIrs1075Sep2016VmAdminsInclude, '')]",
                "regCompPolParIrs1075Sep2016VmAdminsExclude": "[coalesce(steps('regulatory').regPolicyParamIrs1075Sep2016.regCompPolParIrs1075Sep2016VmAdminsExclude, '')]",
                "regCompPolParNistSp800171R2VmAdminsInclude": "[coalesce(steps('regulatory').regPolicyParamNistSp800171R2.regCompPolParNistSp800171R2VmAdminsInclude, '')]",
                "regCompPolParNistSp800171R2VmAdminsExclude": "[coalesce(steps('regulatory').regPolicyParamNistSp800171R2.regCompPolParNistSp800171R2VmAdminsExclude, '')]",
                "regCompPolParNZIsmRestrictedVmAdminsInclude": "[coalesce(steps('regulatory').regPolicyParamNewZelandIsmRestricted.regCompPolParNZIsmRestrictedVmAdminsInclude, '')]",
                "regCompPolParNZIsmRestrictedVmAdminsExclude": "[coalesce(steps('regulatory').regPolicyParamNewZelandIsmRestricted.regCompPolParNZIsmRestrictedVmAdminsExclude, '')]",
                "regCompPolParSoc2Type2AllowedRegistries": "[coalesce(steps('regulatory').regPolicyParamSoc2Type2.regCompPolParSoc2Type2AllowedRegistries, '')]",
                "regCompPolParSoc2Type2MaxCpuUnits": "[coalesce(steps('regulatory').regPolicyParamSoc2Type2.regCompPolParSoc2Type2MaxCpuUnits, '')]",
                "regCompPolParSoc2Type2MaxMemoryBytes": "[coalesce(steps('regulatory').regPolicyParamSoc2Type2.regCompPolParSoc2Type2MaxMemoryBytes, '')]"
            },
            "kind": "Tenant",
            "location": "[steps('basics').resourceScope.location.name]"
        }
    }
}