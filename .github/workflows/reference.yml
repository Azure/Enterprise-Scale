name: Reference

on: 
  workflow_dispatch:

jobs:
  reference:
    name: Reference
    runs-on: ubuntu-latest
    steps:
      - name: Actions checkout
        uses: actions/checkout@v2
      - name: Run script
        shell: pwsh
        run: |
            Import-Module .\src\AzOps.psd1 -force
            Remove-Item -Path ".\AzOpsReference\3fc1081d-6105-4e19-b60c-1ec1252cf560" -Recurse -Force -Verbose
            Initialize-AzOpsRepository -SkipResourceGroup -GeneralizeTemplates -Force -Verbose
        env:
          AzOpsState: '.\AzOpsReference'
          GeneralizeTemplates: '1'