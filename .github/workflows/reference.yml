name: Reference

on: 
  workflow_dispatch:
    inputs:
      logLevel:
        description: 'Log level'
        required: true
        default: 'warning'
        
jobs:
  reference:
    name: Reference
    runs-on: ubuntu-latest
    steps:
      - name: Actions checkout
        uses: actions/checkout@v2
        with:
          path: enterprise-scale
      - name: Actions checkout
        uses: actions/checkout@v2
        with:
          repository: Azure/AzOps
          path: azops
      - name: Run script
        shell: pwsh
        run: |
            $env:PSModulePath = $env:PSModulePath + ":/usr/share/az_4.3.0"
            Import-Module .\azops\src\AzOps.psd1 -Force
            Get-ChildItem .\enterprise-scale\azopsreference
            #Remove-Item -Path ".\enterprise-scale\azopsreference\3fc1081d-6105-4e19-b60c-1ec1252cf560" -Recurse -Force -Verbose
            #Initialize-AzOpsRepository -SkipResourceGroup -GeneralizeTemplates -Force -Verbose
        env:
          AzOpsState: '.\AzOpsReference'
          GeneralizeTemplates: '1'