{
    "name": "Enforce-Backup-AzureChinaCloud",
    "type": "Microsoft.Authorization/policySetDefinitions",
    "apiVersion": "2021-06-01",
    "scope": null,
    "properties": {
        "policyType": "Custom",
        "displayName": "Enforce enhanced recovery and backup policies",
        "description": "Enforce enhanced recovery and backup policies on assigned scopes.",
        "metadata": {
            "version": "1.0.0",
            "category": "Backup",
            "source": "https://github.com/Azure/Enterprise-Scale/",
            "alzCloudEnvironments": [
                "AzureChinaCloud"
            ]
        },
        "version": "1.0.0",
        "parameters": {
            "effect": {
                "type": "String",
                "metadata": {
                    "displayName": "Effect",
                    "description": "Enable or disable the execution of the policy."
                },
                "allowedValues": [
                    "Audit",
                    "Disabled"
                ],
                "defaultValue": "Audit"
            },
            "checkLockedImmutabilityOnly": {
                "type": "Boolean",
                "metadata": {
                    "displayName": "checkLockedImmutabilityOnly",
                    "description": "This parameter checks if Immutability is locked for Backup Vaults in scope. Selecting 'true' will mark only vaults with Immutability 'Locked' as compliant. Selecting 'false' will mark vaults that have Immutability either 'Enabled' or 'Locked' as compliant."
                },
                "allowedValues": [
                    true,
                    false
                ],
                "defaultValue": false
            }
        },
        "policyDefinitions": [
            {
                "policyDefinitionReferenceId": "BackupBVault-Immutability",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2514263b-bc0d-4b06-ac3e-f262c0979018",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('effect')]"
                    },
                    "checkLockedImmutabiltyOnly": {
                        "value": "[[parameters('checkLockedImmutabilityOnly')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "BackupRVault-Immutability",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/d6f6f560-14b7-49a4-9fc8-d2c3a9807868",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('effect')]"
                    },
                    "checkLockedImmutabilityOnly": {
                        "value": "[[parameters('checkLockedImmutabilityOnly')]"
                    }
                },
                "groupNames": []
            }
        ],
        "policyDefinitionGroups": null
    }
}
